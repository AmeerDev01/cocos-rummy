{"version":3,"sources":["file:///Users/geliang/web/dibai/hall/assets/script/subGame/thor/components/Thor_RollerPanel.ts"],"names":["_decorator","instantiate","Label","Node","tween","UIOpacity","UITransform","Vec3","BaseComponent","AutoLauncherType","GameType","IconEffectType","RollerViewModel","thor_Audio","sourceManageSeletor","winShowViewModel","PrefabPathDefine","dataTransfer","DataKeyType","SoundPathDefine","TaskScheduler","changeAutoLauncherType","Thor_Roller","ccclass","property","Thor_RollerPanel","rollerViewModelMap","taskScheduler","stepNumber","betAmount","fadeDuration","effectColumnLength","effectCount","propertyNode","props_spr_MainRoller_list","props_spr_smallGameRoller_list","props_label_beil","props_label_rateNum","props_spr_tools_rate","props_btn_rate","props_spr_tools_beli","props_label_sg_num","props_add_freebox","props_label_rate","props","rollerMap","iconEffectData","iconEffect","NONE","coord","gameMode","currGameType","remainSubGameTimes","isRollEnd","isHasten","minigameCount","gameFreeGametotalMultiplier","events","allRollStop","probabilityDoublingSwitch","bl","isAccelerate","buyMiniGames","str","setRoleAttacks","isState","effectEnd","start","initState","bindEvent","on","EventType","TOUCH_END","e","target","getChildByName","position","x","dispatch","useProps","key","value","length","initRollerList","getComponent","to","opacity","setInterfaceStatus","setProbabilityPanel","forEach","roller","index","iconEffectArr","filter","i","map","setProps","time","Date","now","Math","random","timer","setInterval","comp","getDestroyed","clearInterval","cur","MAIN","node","active","SUBGAME1","props_label_num","targetPosition","originalPosition","clone","string","easing","call","scale","setScale","bet","formatAmountWithCommas","labelNode","labelComponent","state","setokkk","done","count","children","item","sparkling","multiplier","samllMultiplier","startWorldPos","worldPosition","targetWorldPos","addChild","uiTransform","startLocalPos","convertToNodeSpaceAR","targetLocalPos","y","setPosition","scheduleOnce","destroy","playOneShot","DROP_DOWN","dataItem","rollerViewModel","mountView","getFile","ROLLER","source","appendTo","rollerType","setEvent","rollEnd","rollerIndex","isAllStop","some","getRoundEnd","setRoleAttack","isplayIcon","connect","push","gameType","GAME_TYPE","stop","play","BG_MUSIC_MAIN","BG_MUSIC_1","destroyCallBack","destoryQueue","bindUI","update","deltaTime"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAASA,MAAAA,U,OAAAA,U;AAAuBC,MAAAA,W,OAAAA,W;AAAaC,MAAAA,K,OAAAA,K;AAAoBC,MAAAA,I,OAAAA,I;AAAMC,MAAAA,K,OAAAA,K;AAAOC,MAAAA,S,OAAAA,S;AAAWC,MAAAA,W,OAAAA,W;AAAmBC,MAAAA,I,OAAAA,I;;AACnGC,MAAAA,a,iBAAAA,a;;AAEAC,MAAAA,gB,iBAAAA,gB;AAAiCC,MAAAA,Q,iBAAAA,Q;AAAUC,MAAAA,c,iBAAAA,c;;AAC7CC,MAAAA,e;;AACEC,MAAAA,U,iBAAAA,U;AAAYC,MAAAA,mB,iBAAAA,mB;AAAqBC,MAAAA,gB,iBAAAA,gB;;AACjCC,MAAAA,gB,iBAAAA,gB;;AAGFC,MAAAA,Y;AAAgBC,MAAAA,W,iBAAAA,W;;AACdC,MAAAA,e,iBAAAA,e;;AACFC,MAAAA,a;;AAGEC,MAAAA,sB,kBAAAA,sB;;AACAC,MAAAA,W,kBAAAA,W;;;;;;;;;OAbH;AAAEC,QAAAA,OAAF;AAAWC,QAAAA;AAAX,O,GAAwBxB,U;;kCA6CjByB,gB,WADZF,OAAO,CAAC,kBAAD,C,gBAAR,MACaE,gBADb;AAAA;AAAA,0CAC4E;AAAA;AAAA;AAAA,eAEpEC,kBAFoE,GAE5B,EAF4B;AAAA,eAGnEC,aAHmE,GAGpC;AAAA;AAAA,+CAHoC;AAAA,eAInEC,UAJmE;AAAA,eAKnEC,SALmE;AAAA,eAMnEC,YANmE,GAMpD,GANoD;AAO3E;AAP2E,eAQnEC,kBARmE,GAQ9C,CAR8C;AAAA,eASnEC,WATmE,GASrD,CATqD;AAAA,eAYjEC,YAZiE,GAYlD;AACxB;AACAC,YAAAA,yBAAyB,EAAE,IAAI/B,IAAJ,EAFH;AAGxBgC,YAAAA,8BAA8B,EAAE,IAAIhC,IAAJ,EAHR;AAIxBiC,YAAAA,gBAAgB,EAAE,IAAIlC,KAAJ,EAJM;AAKxBmC,YAAAA,mBAAmB,EAAE,IAAInC,KAAJ,EALG;AAMxBoC,YAAAA,oBAAoB,EAAE,IAAInC,IAAJ,EANE;AAOxBoC,YAAAA,cAAc,EAAE,IAAIpC,IAAJ,EAPQ;AAQxBqC,YAAAA,oBAAoB,EAAE,IAAIrC,IAAJ,EARE;AASxBsC,YAAAA,kBAAkB,EAAE,IAAItC,IAAJ,EATI;AAUxBuC,YAAAA,iBAAiB,EAAE,IAAIvC,IAAJ,EAVK;AAWxBwC,YAAAA,gBAAgB,EAAE,IAAIxC,IAAJ;AAClB;AACA;;AAbwB,WAZkD;AAAA,eA4BpEyC,KA5BoE,GA4BpD;AACtBC,YAAAA,SAAS,EAAE,EADW;AAEtBC,YAAAA,cAAc,EAAE;AACfC,cAAAA,UAAU,EAAE;AAAA;AAAA,oDAAeC,IADZ;AAEfC,cAAAA,KAAK,EAAE;AAFQ,aAFM;AAMtBpB,YAAAA,SAAS,EAAE,EANW;AAOtBqB,YAAAA,QAAQ,EAAE,CAPY;AAQtBC,YAAAA,YAAY,EAAE,CARQ;AAStBC,YAAAA,kBAAkB,EAAE,CATE;AAUtBC,YAAAA,SAAS,EAAE,KAVW;AAWtBC,YAAAA,QAAQ,EAAE,KAXY;AAYtBC,YAAAA,aAAa,EAAE,CAZO;AAatBC,YAAAA,2BAA2B,EAAE;AAbP,WA5BoD;AAAA,eA2CpEC,MA3CoE,GA2CnD;AACvBC,YAAAA,WAAW,EAAE,MAAM,CAAG,CADC;AAEvBC,YAAAA,yBAAyB,EAAGC,EAAD,IAAiB,CAAG,CAFxB;AAGvBC,YAAAA,YAAY,EAAGD,EAAD,IAAiB,CAAG,CAHX;AAIvBE,YAAAA,YAAY,EAAGC,GAAD,IAAiB,CAAG,CAJX;AAKvBC,YAAAA,cAAc,EAAGC,OAAD,IAAsB,CAAG,CALlB;AAMvBC,YAAAA,SAAS,EAAE,MAAM,CAAG;AANG,WA3CmD;AAAA;;AAC3EC,QAAAA,KAAK,GAAG,CAAG;;AAkDDC,QAAAA,SAAS,GAAG;AACrB,iBAAO,EAAP;AAGA;;AACSC,QAAAA,SAAS,GAAS;AAC3B,eAAKpC,YAAL,CAAkBM,cAAlB,CAAiC+B,EAAjC,CAAoCnE,IAAI,CAACoE,SAAL,CAAeC,SAAnD,EAA+DC,CAAC,IAAI;AACnE;AACA,gBAAIb,EAAE,GAAGa,CAAC,CAACC,MAAF,CAASC,cAAT,CAAwB,kBAAxB,EAA4CC,QAA5C,CAAqDC,CAArD,GAAyD,CAAlE;AACA,iBAAKjC,KAAL,CAAWS,SAAX,IAAwB,KAAKI,MAAL,CAAYE,yBAAZ,CAAsC,CAACC,EAAvC,CAAxB,CAHmE,CAInE;AACA,WALD;AAMA,eAAK3B,YAAL,CAAkBO,oBAAlB,CAAuC8B,EAAvC,CAA0CnE,IAAI,CAACoE,SAAL,CAAeC,SAAzD,EAAqEC,CAAC,IAAI;AACzE,gBAAI,KAAK7B,KAAL,CAAWM,QAAX,KAAwB,CAAxB,IAA6B,KAAKN,KAAL,CAAWS,SAA5C,EAAuD;AACtD,mBAAKyB,QAAL,CAAc;AAAA;AAAA,oEAAuB;AAAA;AAAA,wDAAiB9B,IAAxC,CAAd;AACA,mBAAKS,MAAL,CAAYK,YAAZ,CAAyB,KAAKjC,SAA9B;AACA;AACD,WALD;AAOA;;AAESkD,QAAAA,QAAQ,CAACC,GAAD,EAAoBC,KAApB,EAAmD;AACpE,cAAID,GAAG,KAAK,WAAZ,EAAyB;AACxB,gBAAI,CAAC,KAAKtD,kBAAL,CAAwBwD,MAA7B,EAAqC;AACpC,mBAAKC,cAAL;AACA,aAFD,MAEO,CACN;AACA;AACA;AACA;AACA;AACD;;AACD,cAAIH,GAAG,KAAK,UAAZ,EAAwB;AACvB,iBAAKvB,MAAL,CAAYI,YAAZ,CAAyB,KAAKjB,KAAL,CAAWU,QAApC;AACA;;AACD,cAAI0B,GAAG,KAAK,WAAZ,EAAyB;AACxB5E,YAAAA,KAAK,CAAC,KAAK6B,YAAL,CAAkBO,oBAAlB,CAAuC4C,YAAvC,CAAoD/E,SAApD,CAAD,CAAL,CACEgF,EADF,CACK,KAAKvD,YADV,EACwB;AAAEwD,cAAAA,OAAO,EAAE,CAAC,KAAK1C,KAAL,CAAWS,SAAZ,GAAwB,GAAxB,GAA8B;AAAzC,aADxB,EAEEc,KAFF;AAGA/D,YAAAA,KAAK,CAAC,KAAK6B,YAAL,CAAkBK,oBAAlB,CAAuC8C,YAAvC,CAAoD/E,SAApD,CAAD,CAAL,CACEgF,EADF,CACK,KAAKvD,YADV,EACwB;AAAEwD,cAAAA,OAAO,EAAE,CAAC,KAAK1C,KAAL,CAAWS,SAAZ,GAAwB,GAAxB,GAA8B;AAAzC,aADxB,EAEEc,KAFF;;AAGA,gBAAI,KAAKvB,KAAL,CAAWS,SAAf,EAA0B;AACzB,mBAAKkC,kBAAL,CAAwB,KAAK3C,KAAL,CAAWM,QAAnC;AACA,mBAAKsC,mBAAL,CAAyB,KAAK5C,KAAL,CAAWM,QAApC;AACA;AACD;;AACD,cAAI8B,GAAG,KAAK,gBAAZ,EAA8B;AAC7B,iBAAKjD,kBAAL,GAA0B,CAA1B;AACA,iBAAKC,WAAL,GAAmB,CAAnB;AACA,iBAAKN,kBAAL,CAAwB+D,OAAxB,CAAgC,CAACC,MAAD,EAASC,KAAT,KAAmB;AAClD;AACA,oBAAMC,aAAa,GAAG,KAAKhD,KAAL,CAAWE,cAAX,CAA0BG,KAA1B,CAAgC4C,MAAhC,CAAuCC,CAAC,IAAIA,CAAC,CAAC,CAAD,CAAD,KAASH,KAArD,EAA4DI,GAA5D,CAAgED,CAAC,IAAIA,CAAC,CAAC,CAAD,CAAtE,CAAtB;;AACA,kBAAIF,aAAa,CAACV,MAAlB,EAA0B;AACzB,qBAAKnD,kBAAL,GADyB,CAEzB;;AACA2D,gBAAAA,MAAM,CAACM,QAAP,CAAgB;AACflD,kBAAAA,cAAc,EAAE;AACf8C,oBAAAA,aADe;AAEf7C,oBAAAA,UAAU,EAAE,KAAKH,KAAL,CAAWE,cAAX,CAA0BC,UAFvB;AAGfkD,oBAAAA,IAAI,EAAEC,IAAI,CAACC,GAAL,KAAaC,IAAI,CAACC,MAAL;AAHJ;AADD,iBAAhB;AAOA,oBAAIC,KAAK,GAAGC,WAAW,CAAC,MAAM;AAC7B,sBAAIb,MAAM,CAACc,IAAP,CAAYC,YAAZ,EAAJ,EAAgC;AAC/BC,oBAAAA,aAAa,CAACJ,KAAD,CAAb;AACA;AACD,iBAJsB,EAIpB,GAJoB,CAAvB;AAKA,eAfD,MAeO;AACNZ,gBAAAA,MAAM,CAACM,QAAP,CAAgB;AACflD,kBAAAA,cAAc,EAAE;AACf8C,oBAAAA,aAAa,EAAE,EADA;AAEf7C,oBAAAA,UAAU,EAAE;AAAA;AAAA,0DAAeC,IAFZ;AAGfiD,oBAAAA,IAAI,EAAEC,IAAI,CAACC,GAAL,KAAaC,IAAI,CAACC,MAAL;AAHJ;AADD,iBAAhB;AAOA;AACD,aA3BD;AA4BA;;AACD,cAAIrB,GAAG,KAAK,cAAZ,EAA4B;AAC3B,gBAAIC,KAAK,CAAC0B,GAAN,KAAc;AAAA;AAAA,sCAASC,IAA3B,EAAiC;AAChC,mBAAKC,IAAL,CAAUlC,cAAV,CAAyB,MAAzB,EAAiCmC,MAAjC,GAA0C,IAA1C;AACA,mBAAKD,IAAL,CAAUlC,cAAV,CAAyB,WAAzB,EAAsCmC,MAAtC,GAA+C,KAA/C;AACA,aAHD,MAGO,IAAI7B,KAAK,CAAC0B,GAAN,KAAc;AAAA;AAAA,sCAASI,QAA3B,EAAqC;AAC3C,mBAAKF,IAAL,CAAUlC,cAAV,CAAyB,MAAzB,EAAiCmC,MAAjC,GAA0C,KAA1C;AACA,mBAAKD,IAAL,CAAUlC,cAAV,CAAyB,WAAzB,EAAsCmC,MAAtC,GAA+C,IAA/C;AACA;AACD;;AACD,cAAI9B,GAAG,KAAK,eAAZ,EAA6B;AAC5B,gBAAIC,KAAK,CAAC0B,GAAN,GAAY,CAAhB,EAAmB;AAClB,mBAAK1E,YAAL,CAAkBS,iBAAlB,CAAoC0C,YAApC,CAAiD/E,SAAjD,EAA4DiF,OAA5D,GAAsE,CAAtE,CADkB,CAElB;;AACA,kBAAI0B,eAAe,GAAG,KAAK/E,YAAL,CAAkBS,iBAAlB,CAAoCiC,cAApC,CAAmD,qBAAnD,CAAtB;AACA,kBAAIsC,cAAc,GAAG,IAAI1G,IAAJ,CAAS,CAAC,GAAV,EAAe,CAAC,EAAhB,EAAoB,CAApB,CAArB;AACA,kBAAI2G,gBAAgB,GAAGF,eAAe,CAACpC,QAAhB,CAAyBuC,KAAzB,EAAvB,CALkB,CAKuC;;AACzD,mBAAKlF,YAAL,CAAkBS,iBAAlB,CAAoCoE,MAApC,GAA6C,IAA7C;AACAE,cAAAA,eAAe,CAAC5B,YAAhB,CAA6BlF,KAA7B,EAAoCkH,MAApC,GAA6C,MAAMnC,KAAK,CAAC0B,GAAZ,GAAkB,EAA/D;AACAvG,cAAAA,KAAK,CAAC,KAAK6B,YAAL,CAAkBS,iBAAlB,CAAoC0C,YAApC,CAAiD/E,SAAjD,CAAD,CAAL,CACEgF,EADF,CACK,GADL,EACU;AAAEC,gBAAAA,OAAO,EAAE;AAAX,eADV,EAC4B;AAAE+B,gBAAAA,MAAM,EAAE;AAAV,eAD5B,EACkD;AADlD,eAEEC,IAFF,CAEO,MAAM;AACXlH,gBAAAA,KAAK,CAAC4G,eAAD,CAAL,CACE3B,EADF,CACK,GADL,EACU;AAAET,kBAAAA,QAAQ,EAAEqC;AAAZ,iBADV,EACwC;AAAEI,kBAAAA,MAAM,EAAE;AAAV,iBADxC,EACiE;AAChE;AAFD,iBAGEhC,EAHF,CAGK,GAHL,EAGU;AAAEkC,kBAAAA,KAAK,EAAE,IAAIhH,IAAJ,CAAS,CAAT,EAAY,CAAZ,EAAe,GAAf;AAAT,iBAHV,EAG0C;AAAE8G,kBAAAA,MAAM,EAAE;AAAV,iBAH1C,EAGmE;AAHnE,iBAIEC,IAJF,CAIO,MAAM;AACXN,kBAAAA,eAAe,CAACpC,QAAhB,GAA2BsC,gBAA3B;AACAF,kBAAAA,eAAe,CAACQ,QAAhB,CAAyB,CAAzB,EAA4B,CAA5B,EAA+B,CAA/B;AACA,uBAAKvF,YAAL,CAAkBS,iBAAlB,CAAoCoE,MAApC,GAA6C,KAA7C;AACA,iBARF,EASE3C,KATF;AAUA,eAbF,EAcEA,KAdF;AAeA;AACD;;AACD,cAAIa,GAAG,KAAK,WAAZ,EAAyB;AACxB,gBAAI;AAAEnD,cAAAA,SAAF;AAAa4F,cAAAA;AAAb,gBAAqBxC,KAAK,CAAC0B,GAA/B;AACA,iBAAK9E,SAAL,GAAiB,CAACA,SAAS,GAAG,GAAb,EAAkB6F,sBAAlB,EAAjB;AACA,iBAAKzF,YAAL,CAAkBG,gBAAlB,CAAmCgF,MAAnC,GAA4C,CAACvF,SAAS,GAAG,GAAb,EAAkB6F,sBAAlB,EAA5C;AACA,iBAAKzF,YAAL,CAAkBI,mBAAlB,CAAsC+E,MAAtC,GAA+C,CAACK,GAAG,GAAG,EAAP,EAAWC,sBAAX,EAA/C;AACA;;AACD,cAAI1C,GAAG,KAAK,UAAZ,EAAwB;AACvB,iBAAKO,kBAAL,CAAwB,KAAK3C,KAAL,CAAWM,QAAnC;AACA,iBAAKsC,mBAAL,CAAyB,KAAK5C,KAAL,CAAWM,QAApC;AACA;;AACD,cAAI8B,GAAG,KAAK,oBAAZ,EAAkC;AACjC,iBAAK/C,YAAL,CAAkBQ,kBAAlB,CAAqC2C,YAArC,CAAkDlF,KAAlD,EAAyDkH,MAAzD,GAAkE,KAAKxE,KAAL,CAAWQ,kBAAX,GAAgC,EAAlG;AACA;;AACD,cAAI4B,GAAG,KAAK,6BAAZ,EAA2C;AAC1C,gBAAI2C,SAAS,GAAG,KAAK1F,YAAL,CAAkBU,gBAAlC,CAD0C,CACU;;AACpD,gBAAIsC,KAAK,CAAC0B,GAAN,GAAY,CAAhB,EAAmB;AAClBgB,cAAAA,SAAS,CAACb,MAAV,GAAmB,IAAnB;AACA,kBAAIc,cAAc,GAAGD,SAAS,CAACvC,YAAV,CAAuBlF,KAAvB,CAArB,CAFkB,CAEkC;;AACpD0H,cAAAA,cAAc,CAACR,MAAf,GAAwBnC,KAAK,CAAC0B,GAAN,GAAY,GAApC,CAHkB,CAGuB;AACzC;;AACAvG,cAAAA,KAAK,CAACuH,SAAD,CAAL,CACEtC,EADF,CACK,GADL,EACU;AAAEkC,gBAAAA,KAAK,EAAE,IAAIhH,IAAJ,CAAS,GAAT,EAAc,GAAd,EAAmB,GAAnB;AAAT,eADV,EAC8C;AAAE8G,gBAAAA,MAAM,EAAE;AAAV,eAD9C,EACqE;AADrE,eAEEhC,EAFF,CAEK,GAFL,EAEU;AAAEkC,gBAAAA,KAAK,EAAE,IAAIhH,IAAJ,CAAS,CAAT,EAAY,CAAZ,EAAe,CAAf;AAAT,eAFV,EAEwC;AAAE8G,gBAAAA,MAAM,EAAE;AAAV,eAFxC,EAE8D;AAF9D,eAGElD,KAHF;AAIA,aATD,MASO,CACN;AACA;AACD;AACD;;AACOoB,QAAAA,kBAAkB,CAACrC,QAAD,EAAW;AAAE;AACtC,cAAI,KAAKN,KAAL,CAAWS,SAAf,EAA0B;AAAE;AAC3B;AACA;;AACDjD,UAAAA,KAAK,CAAC,KAAK6B,YAAL,CAAkBK,oBAAlB,CAAuC8C,YAAvC,CAAoD/E,SAApD,CAAD,CAAL,CACEgF,EADF,CACK,KAAKvD,YADV,EACwB;AAAEwD,YAAAA,OAAO,EAAEpC,QAAQ,KAAK,CAAb,GAAiB,GAAjB,GAAuB;AAAlC,WADxB,EAEEiB,KAFF;AAGA;;AACOqB,QAAAA,mBAAmB,CAACtC,QAAD,EAAW2E,KAAX,EAAmB;AAAE;AAC/C,cAAIjE,EAAE,GAAGV,QAAQ,KAAK,CAAtB;AACA,cAAI+D,cAAc,GAAGrD,EAAE,GAAG,IAAIrD,IAAJ,CAAS,CAAC,EAAV,EAAc,CAAd,EAAiB,CAAjB,CAAH,GAAyB,IAAIA,IAAJ,CAAS,EAAT,EAAa,CAAb,EAAgB,CAAhB,CAAhD;AACAH,UAAAA,KAAK,CAAC,KAAK6B,YAAL,CAAkBM,cAAlB,CAAiCoC,cAAjC,CAAgD,kBAAhD,CAAD,CAAL,CACE2C,IADF,CACO,MAAM;AACX,gBAAI,CAAC1D,EAAL,EAAS;AACR,mBAAK3B,YAAL,CAAkBM,cAAlB,CAAiCoC,cAAjC,CAAgD,kBAAhD,EAAoEA,cAApE,CAAmF,qBAAnF,EAA0GmC,MAA1G,GAAmH,IAAnH;AACA,mBAAK7E,YAAL,CAAkBM,cAAlB,CAAiCoC,cAAjC,CAAgD,kBAAhD,EAAoEA,cAApE,CAAmF,sBAAnF,EAA2GmC,MAA3G,GAAoH,KAApH;AACA,aAHD,MAGO;AACN,mBAAK7E,YAAL,CAAkBM,cAAlB,CAAiCoC,cAAjC,CAAgD,kBAAhD,EAAoEA,cAApE,CAAmF,qBAAnF,EAA0GmC,MAA1G,GAAmH,KAAnH;AACA,mBAAK7E,YAAL,CAAkBM,cAAlB,CAAiCoC,cAAjC,CAAgD,kBAAhD,EAAoEA,cAApE,CAAmF,sBAAnF,EAA2GmC,MAA3G,GAAoH,IAApH;AACA;AACD,WATF,EAUEzB,EAVF,CAUK,KAAKvD,YAVV,EAUwB;AAAE8C,YAAAA,QAAQ,EAAEqC;AAAZ,WAVxB,EAWE9C,KAXF;AAYA/D,UAAAA,KAAK,CAAC,KAAK6B,YAAL,CAAkBO,oBAAlB,CAAuC4C,YAAvC,CAAoD/E,SAApD,CAAD,CAAL,CACEgF,EADF,CACK,KAAKvD,YADV,EACwB;AAAEwD,YAAAA,OAAO,EAAE,CAAC1B,EAAD,GAAM,GAAN,GAAY;AAAvB,WADxB,EAEEO,KAFF;AAGA;;AACD2D,QAAAA,OAAO,CAACC,IAAD,EAAO;AAAE;AACf,cAAIC,KAAK,GAAG,CAAZ,CADa,CAEb;;AACA,eAAK/F,YAAL,CAAkBC,yBAAlB,CAA4C+F,QAA5C,CAAqDxC,OAArD,CAA6DyC,IAAI,IAAI;AACnEA,YAAAA,IAAI,CAAC9C,YAAL;AAAA;AAAA,2CAAD,CAAgD+C,SAAhD,CAA0D,MAAM;AAC/DH,cAAAA,KAAK;;AACL,kBAAIA,KAAK,IAAI,KAAK/F,YAAL,CAAkBC,yBAAlB,CAA4C+F,QAA5C,CAAqD/C,MAAlE,EAA0E;AACzE6C,gBAAAA,IAAI;AACJ;AACD,aALD;AAMA,WAPD;AAQA,SAxO0E,CAyO3E;;;AACAK,QAAAA,UAAU,CAACL,IAAD,EAAO;AAChB,cAAIC,KAAK,GAAG,CAAZ;AACA,eAAK/F,YAAL,CAAkBC,yBAAlB,CAA4C+F,QAA5C,CAAqDxC,OAArD,CAA6DyC,IAAI,IAAI;AACnEA,YAAAA,IAAI,CAAC9C,YAAL;AAAA;AAAA,2CAAD,CAAgDgD,UAAhD,CAA2D,MAAM;AAChEJ,cAAAA,KAAK;;AACL,kBAAIA,KAAK,IAAI,KAAK/F,YAAL,CAAkBC,yBAAlB,CAA4C+F,QAA5C,CAAqD/C,MAAlE,EAA0E;AACzE6C,gBAAAA,IAAI;AACJ;AACD,aALD;AAMA,WAPD;AAQA,SApP0E,CAqP3E;;;AACAM,QAAAA,eAAe,CAACN,IAAD,EAAO;AACrB;AACA,cAAIO,aAAa,GAAG,KAAKrG,YAAL,CAAkBU,gBAAlB,CAAmC4F,aAAvD;AACA,cAAIC,cAAc,GAAG;AAAA;AAAA,oDAAiBhC,IAAjB,CAAsBK,IAAtB,CAA2BlC,cAA3B,CAA0C,mBAA1C,EAA+D4D,aAApF,CAHqB,CAIrB;;AACA,cAAI1B,IAAI,GAAG5G,WAAW,CAAC,KAAKgC,YAAL,CAAkBU,gBAAnB,CAAtB,CALqB,CAMrB;;AACA;AAAA;AAAA,oDAAiB6D,IAAjB,CAAsBK,IAAtB,CAA2B4B,QAA3B,CAAoC5B,IAApC,EAPqB,CAQrB;;AACA,cAAI6B,WAAW,GAAG;AAAA;AAAA,oDAAiBlC,IAAjB,CAAsBK,IAAtB,CAA2BzB,YAA3B,CAAwC9E,WAAxC,CAAlB,CATqB,CAUrB;;AACA,cAAIqI,aAAa,GAAGD,WAAW,CAACE,oBAAZ,CAAiCN,aAAjC,CAApB;AACA,cAAIO,cAAc,GAAGH,WAAW,CAACE,oBAAZ,CAAiCJ,cAAjC,CAArB;AACAK,UAAAA,cAAc,CAACC,CAAf,GAAmBD,cAAc,CAACC,CAAf,GAAmB,EAAtC,CAbqB,CAcrB;;AACAjC,UAAAA,IAAI,CAACkC,WAAL,CAAiBJ,aAAjB,EAfqB,CAgBrB;;AACAvI,UAAAA,KAAK,CAACyG,IAAD,CAAL,CACExB,EADF,CACK,GADL,EACU;AAAET,YAAAA,QAAQ,EAAEiE;AAAZ,WADV,EACwC;AAAExB,YAAAA,MAAM,EAAE;AAAV,WADxC,EAEEC,IAFF,CAEO,MAAM;AACX,iBAAK0B,YAAL,CAAkB,MAAI;AACtBnC,cAAAA,IAAI,CAACoC,OAAL;AACClB,cAAAA,IAAI;AACJ,aAHD,EAGE,GAHF;AAIA,WAPF,EAQE5D,KARF;AAUA;;AACOgB,QAAAA,cAAc,GAAG;AACxB;AAAA;AAAA,wCAAW+D,WAAX,CAAuB;AAAA;AAAA,kDAAgBC,SAAvC,EADwB,CAExB;;AACA,eAAKvG,KAAL,CAAWC,SAAX,CAAqB4C,OAArB,CAA8B2D,QAAD,IAAc;AAC1C,kBAAMC,eAAe,GAAG;AAAA;AAAA,sDAAsBC,SAAtB,CAAgC;AAAA;AAAA,8DAAsBC,OAAtB,CAA8B;AAAA;AAAA,sDAAiBC,MAA/C,EAAuDC,MAAvF,EAA+FC,QAA/F,CAAwG,KAAKzH,YAAL,CAAkBC,yBAA1H,EAAqJ8D,QAArJ,CAA8J;AACrL2D,cAAAA,UAAU,EAAEP,QADyK;AAC/J9F,cAAAA,QAAQ,EAAE,KAAKV,KAAL,CAAWU;AAD0I,aAA9J,EAErBsG,QAFqB,CAEZ;AACXC,cAAAA,OAAO,EAAGC,WAAD,IAAiB;AACzB,oBAAIC,SAAS,GAAG,CAAC,KAAKrI,kBAAL,CAAwBsI,IAAxB,CAA6B9B,IAAI,IAAI,CAACA,IAAI,CAAC1B,IAAL,CAAUyD,WAAV,EAAtC,CAAjB;AACAF,gBAAAA,SAAS,IAAI,KAAKtG,MAAL,CAAYC,WAAZ,EAAb;AACA,eAJU;AAKXwG,cAAAA,aAAa,EAAGtG,EAAD,IAAQ;AACtB,qBAAKH,MAAL,CAAYO,cAAZ,CAA2BJ,EAA3B;AACA,eAPU;AAQXM,cAAAA,SAAS,EAAE,MAAM;AAChB,oBAAI,KAAKnC,kBAAL,KAA4B,CAAhC,EAAmC;AAClC;AACA;;AACD,qBAAKC,WAAL;;AACA,oBAAI,KAAKA,WAAL,IAAoB,KAAKD,kBAA7B,EAAiD;AAChD,uBAAKA,kBAAL,GAA0B,CAA1B;AACA,uBAAK0B,MAAL,CAAYS,SAAZ;AACA;AACD,eAjBU;AAkBXiG,cAAAA,UAAU,EAAE,MAAM;AACjB,oBAAI,KAAKvH,KAAL,CAAWO,YAAX,IAA2B;AAAA;AAAA,0CAASyD,IAAxC,EAA8C,CAE7C,CAFD,MAEO,IAAI,KAAKhE,KAAL,CAAWO,YAAX,IAA2B;AAAA;AAAA,0CAAS4D,QAAxC,EAAkD,CAExD;AACD;AAxBU,aAFY,EA2BrBqD,OA3BqB,EAAxB;AA4BA,iBAAK1I,kBAAL,CAAwB2I,IAAxB,CAA6BhB,eAA7B;AACA,WA9BD;AA+BA,gBAAMiB,QAAQ,GAAG;AAAA;AAAA,4CAAa;AAAA;AAAA,0CAAYC,SAAzB,CAAjB;AACA;AAAA;AAAA,wCAAWC,IAAX;AACA;AAAA;AAAA,wCAAWC,IAAX,CAAgBH,QAAQ,KAAK;AAAA;AAAA,oCAAS1D,IAAtB,GAA6B;AAAA;AAAA,kDAAgB8D,aAA7C,GAA6D;AAAA;AAAA,kDAAgBC,UAA7F,EAAyG,IAAzG;AACA;;AAESC,QAAAA,eAAe,GAAS;AACjC,eAAKjJ,aAAL,CAAmBkJ,YAAnB;AACA;;AAESC,QAAAA,MAAM,GAAS,CAExB;;AAEDC,QAAAA,MAAM,CAACC,SAAD,EAAoB,CAEzB;;AAnU0E,O","sourcesContent":["import { _decorator, Component, instantiate, Label, Layout, log, Node, tween, UIOpacity, UITransform, Vec2, Vec3 } from 'cc';\r\nimport { BaseComponent } from '../../../base/BaseComponent';\r\nconst { ccclass, property } = _decorator;\r\nimport { AutoLauncherType, DirectionType, GameType, IconEffectType, RollerType } from '../type';\r\nimport RollerViewModel from '../viewModel/RollerViewModel';\r\nimport { thor_Audio, sourceManageSeletor, winShowViewModel } from '../index';\r\nimport { PrefabPathDefine } from '../sourceDefine/prefabDefine';\r\nimport { setRollRoundEnd } from '../store/actions/roller';\r\nimport { sktInstance } from '../socketConnect';\r\nimport dataTransfer, { DataKeyType } from '../dataTransfer';\r\nimport { SoundPathDefine } from '../sourceDefine/soundDefine';\r\nimport TaskScheduler, { Task } from '../../../utils/TaskScheduler';\r\nimport StepNumber from '../../../utils/StepNumber';\r\nimport { initToggle } from '../../../utils/tool';\r\nimport { changeAutoLauncherType } from '../store/actions/game';\r\nimport { Thor_Roller } from './Thor_Roller';\r\nexport interface IState {\r\n\r\n}\r\n\r\nexport interface IProps {\r\n\trollerMap: RollerType[]\r\n\ticonEffectData?: {\r\n\t\ticonEffect: IconEffectType,\r\n\t\tcoord: number[][]\r\n\t},\r\n\tjackpotAmount?: number\r\n\tbetAmount?: {},\r\n\tgameMode?: number,\r\n\tcurrGameType?: number,\r\n\tremainSubGameTimes?: number,\r\n\tisHasten?: boolean,\r\n\tisRollEnd?: boolean,\r\n\tminigameCount?: number,\r\n\tgameFreeGametotalMultiplier?: number,\r\n}\r\nexport interface IEvent {\r\n\t/**全部滚动已经停止 */\r\n\tallRollStop: () => void\r\n\tprobabilityDoublingSwitch: (bl: boolean) => void\r\n\tisAccelerate: (bl: boolean) => void\r\n\tbuyMiniGames: (str: string) => void\r\n\tsetRoleAttacks: (isState: boolean) => void\r\n\teffectEnd?: () => void\r\n}\r\n\r\n@ccclass('Thor_RollerPanel')\r\nexport class Thor_RollerPanel extends BaseComponent<IState, IProps, IEvent> {\r\n\tstart() { }\r\n\tpublic rollerViewModelMap: RollerViewModel[] = []\r\n\tprivate taskScheduler: TaskScheduler = new TaskScheduler()\r\n\tprivate stepNumber: StepNumber\r\n\tprivate betAmount: string\r\n\tprivate fadeDuration = 0.2\r\n\t// 闪动总的列数\r\n\tprivate effectColumnLength = 0;\r\n\tprivate effectCount = 0;\r\n\r\n\r\n\tprotected propertyNode = {\r\n\t\t/**滑槽主板 */\r\n\t\tprops_spr_MainRoller_list: new Node(),\r\n\t\tprops_spr_smallGameRoller_list: new Node(),\r\n\t\tprops_label_beil: new Label(),\r\n\t\tprops_label_rateNum: new Label(),\r\n\t\tprops_spr_tools_rate: new Node(),\r\n\t\tprops_btn_rate: new Node(),\r\n\t\tprops_spr_tools_beli: new Node(),\r\n\t\tprops_label_sg_num: new Node(),\r\n\t\tprops_add_freebox: new Node(),\r\n\t\tprops_label_rate: new Node(),\r\n\t\t/**jackpot的额度 */\r\n\t\t// props_Label_jackpot_num: new Label()\r\n\t}\r\n\r\n\tpublic props: IProps = {\r\n\t\trollerMap: [],\r\n\t\ticonEffectData: {\r\n\t\t\ticonEffect: IconEffectType.NONE,\r\n\t\t\tcoord: []\r\n\t\t},\r\n\t\tbetAmount: {},\r\n\t\tgameMode: 1,\r\n\t\tcurrGameType: 0,\r\n\t\tremainSubGameTimes: 0,\r\n\t\tisRollEnd: false,\r\n\t\tisHasten: false,\r\n\t\tminigameCount: 0,\r\n\t\tgameFreeGametotalMultiplier: 0,\r\n\t}\r\n\tpublic events: IEvent = {\r\n\t\tallRollStop: () => { },\r\n\t\tprobabilityDoublingSwitch: (bl: boolean) => { },\r\n\t\tisAccelerate: (bl: boolean) => { },\r\n\t\tbuyMiniGames: (str: string) => { },\r\n\t\tsetRoleAttacks: (isState: boolean) => { },\r\n\t\teffectEnd: () => { },\r\n\t}\r\n\tprotected initState() {\r\n\t\treturn {\r\n\r\n\t\t}\r\n\t}\r\n\tprotected bindEvent(): void {\r\n\t\tthis.propertyNode.props_btn_rate.on(Node.EventType.TOUCH_END, (e => {\r\n\t\t\t// if(this.props.gameMode!==3){\r\n\t\t\tlet bl = e.target.getChildByName('btn_olpn_kaiguan').position.x > 0\r\n\t\t\tthis.props.isRollEnd && this.events.probabilityDoublingSwitch(!bl)\r\n\t\t\t// }\r\n\t\t}))\r\n\t\tthis.propertyNode.props_spr_tools_beli.on(Node.EventType.TOUCH_END, (e => {\r\n\t\t\tif (this.props.gameMode !== 2 && this.props.isRollEnd) {\r\n\t\t\t\tthis.dispatch(changeAutoLauncherType(AutoLauncherType.NONE))\r\n\t\t\t\tthis.events.buyMiniGames(this.betAmount)\r\n\t\t\t}\r\n\t\t})\r\n\t\t)\r\n\t}\r\n\r\n\tprotected useProps(key: keyof IProps, value: { pre: any, cur: any }) {\r\n\t\tif (key === \"rollerMap\") {\r\n\t\t\tif (!this.rollerViewModelMap.length) {\r\n\t\t\t\tthis.initRollerList()\r\n\t\t\t} else {\r\n\t\t\t\t// roller组件自己去订阅store的数据，就不从这里更新了\r\n\t\t\t\t// this.rollerViewModelMap.forEach((roller, index) => {\r\n\t\t\t\t// \troller.setProps({ rollerType: this.props.rollerMap[index] })\r\n\t\t\t\t// })\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (key === 'isHasten') {\r\n\t\t\tthis.events.isAccelerate(this.props.isHasten)\r\n\t\t}\r\n\t\tif (key === \"isRollEnd\") {\r\n\t\t\ttween(this.propertyNode.props_spr_tools_beli.getComponent(UIOpacity))\r\n\t\t\t\t.to(this.fadeDuration, { opacity: !this.props.isRollEnd ? 128 : 256 })\r\n\t\t\t\t.start();\r\n\t\t\ttween(this.propertyNode.props_spr_tools_rate.getComponent(UIOpacity))\r\n\t\t\t\t.to(this.fadeDuration, { opacity: !this.props.isRollEnd ? 128 : 256 })\r\n\t\t\t\t.start();\r\n\t\t\tif (this.props.isRollEnd) {\r\n\t\t\t\tthis.setInterfaceStatus(this.props.gameMode)\r\n\t\t\t\tthis.setProbabilityPanel(this.props.gameMode)\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (key === \"iconEffectData\") {\r\n\t\t\tthis.effectColumnLength = 0;\r\n\t\t\tthis.effectCount = 0;\r\n\t\t\tthis.rollerViewModelMap.forEach((roller, index) => {\r\n\t\t\t\t//index=0情况下=>[0,0][0,2],...=> 获取到一个这种数组:[0,2],描述第几条数组要闪动的图标序号\r\n\t\t\t\tconst iconEffectArr = this.props.iconEffectData.coord.filter(i => i[0] === index).map(i => i[1])\r\n\t\t\t\tif (iconEffectArr.length) {\r\n\t\t\t\t\tthis.effectColumnLength++;\r\n\t\t\t\t\t//分配到各个滑槽\r\n\t\t\t\t\troller.setProps({\r\n\t\t\t\t\t\ticonEffectData: {\r\n\t\t\t\t\t\t\ticonEffectArr,\r\n\t\t\t\t\t\t\ticonEffect: this.props.iconEffectData.iconEffect,\r\n\t\t\t\t\t\t\ttime: Date.now() + Math.random()\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t})\r\n\t\t\t\t\tlet timer = setInterval(() => {\r\n\t\t\t\t\t\tif (roller.comp.getDestroyed()) {\r\n\t\t\t\t\t\t\tclearInterval(timer)\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}, 100)\r\n\t\t\t\t} else {\r\n\t\t\t\t\troller.setProps({\r\n\t\t\t\t\t\ticonEffectData: {\r\n\t\t\t\t\t\t\ticonEffectArr: [],\r\n\t\t\t\t\t\t\ticonEffect: IconEffectType.NONE,\r\n\t\t\t\t\t\t\ttime: Date.now() + Math.random()\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t})\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t}\r\n\t\tif (key === \"currGameType\") {\r\n\t\t\tif (value.cur === GameType.MAIN) {\r\n\t\t\t\tthis.node.getChildByName('main').active = true\r\n\t\t\t\tthis.node.getChildByName('smallGame').active = false\r\n\t\t\t} else if (value.cur === GameType.SUBGAME1) {\r\n\t\t\t\tthis.node.getChildByName('main').active = false\r\n\t\t\t\tthis.node.getChildByName('smallGame').active = true\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (key === \"minigameCount\") {\r\n\t\t\tif (value.cur > 2) {\r\n\t\t\t\tthis.propertyNode.props_add_freebox.getComponent(UIOpacity).opacity = 0;\r\n\t\t\t\t// 激活节点并进行渐显动画\r\n\t\t\t\tlet props_label_num = this.propertyNode.props_add_freebox.getChildByName('props_label_add_num')\r\n\t\t\t\tlet targetPosition = new Vec3(-580, -20, 1)\r\n\t\t\t\tlet originalPosition = props_label_num.position.clone(); // 保存原始位置\r\n\t\t\t\tthis.propertyNode.props_add_freebox.active = true\r\n\t\t\t\tprops_label_num.getComponent(Label).string = '+' + value.cur + ''\r\n\t\t\t\ttween(this.propertyNode.props_add_freebox.getComponent(UIOpacity))\r\n\t\t\t\t\t.to(0.3, { opacity: 255 }, { easing: 'smooth' }) // 渐显动画，持续时间0.3秒\r\n\t\t\t\t\t.call(() => {\r\n\t\t\t\t\t\ttween(props_label_num)\r\n\t\t\t\t\t\t\t.to(0.2, { position: targetPosition }, { easing: 'sineInOut' }) // 移动到目标位置，持续时间0.2秒\r\n\t\t\t\t\t\t\t// 可以添加其他动画效果，如缩放或旋转\r\n\t\t\t\t\t\t\t.to(0.5, { scale: new Vec3(0, 0, 1.2) }, { easing: 'sineInOut' }) // 举例：同时缩放\r\n\t\t\t\t\t\t\t.call(() => {\r\n\t\t\t\t\t\t\t\tprops_label_num.position = originalPosition\r\n\t\t\t\t\t\t\t\tprops_label_num.setScale(1, 1, 1)\r\n\t\t\t\t\t\t\t\tthis.propertyNode.props_add_freebox.active = false\r\n\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t.start();\r\n\t\t\t\t\t})\r\n\t\t\t\t\t.start();\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (key === \"betAmount\") {\r\n\t\t\tlet { betAmount, bet } = value.cur\r\n\t\t\tthis.betAmount = (betAmount * 100).formatAmountWithCommas()\r\n\t\t\tthis.propertyNode.props_label_beil.string = (betAmount * 100).formatAmountWithCommas()\r\n\t\t\tthis.propertyNode.props_label_rateNum.string = (bet * 25).formatAmountWithCommas()\r\n\t\t}\r\n\t\tif (key === \"gameMode\") {\r\n\t\t\tthis.setInterfaceStatus(this.props.gameMode)\r\n\t\t\tthis.setProbabilityPanel(this.props.gameMode)\r\n\t\t}\r\n\t\tif (key === \"remainSubGameTimes\") {\r\n\t\t\tthis.propertyNode.props_label_sg_num.getComponent(Label).string = this.props.remainSubGameTimes + \"\"\r\n\t\t}\r\n\t\tif (key === \"gameFreeGametotalMultiplier\") {\r\n\t\t\tlet labelNode = this.propertyNode.props_label_rate; // 获取 Label 节点\r\n\t\t\tif (value.cur > 0) {\r\n\t\t\t\tlabelNode.active = true\r\n\t\t\t\tlet labelComponent = labelNode.getComponent(Label); // 获取 Label 组件\r\n\t\t\t\tlabelComponent.string = value.cur + 'X'; // 设置 Label 文本\r\n\t\t\t\t// 创建一个缩放动画\r\n\t\t\t\ttween(labelNode)\r\n\t\t\t\t\t.to(0.1, { scale: new Vec3(1.2, 1.2, 1.2) }, { easing: 'sineOut' }) // 放大到 1.2 倍\r\n\t\t\t\t\t.to(0.1, { scale: new Vec3(1, 1, 1) }, { easing: 'sineIn' }) // 恢复原始大小\r\n\t\t\t\t\t.start();\r\n\t\t\t} else {\r\n\t\t\t\t// labelNode.active = false\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\tprivate setInterfaceStatus(gameMode) { // 小游戏面板\r\n\t\tif (this.props.isRollEnd) { // 滚动无法点击\r\n\t\t\treturn\r\n\t\t}\r\n\t\ttween(this.propertyNode.props_spr_tools_rate.getComponent(UIOpacity))\r\n\t\t\t.to(this.fadeDuration, { opacity: gameMode === 3 ? 128 : 256 })\r\n\t\t\t.start();\r\n\t}\r\n\tprivate setProbabilityPanel(gameMode, state?) { // 增加概率面板\r\n\t\tlet bl = gameMode !== 2\r\n\t\tlet targetPosition = bl ? new Vec3(-21, 0, 0) : new Vec3(21, 0, 0)\r\n\t\ttween(this.propertyNode.props_btn_rate.getChildByName('btn_olpn_kaiguan'))\r\n\t\t\t.call(() => {\r\n\t\t\t\tif (!bl) {\r\n\t\t\t\t\tthis.propertyNode.props_btn_rate.getChildByName('btn_olpn_kaiguan').getChildByName('icon_kaiguan_duihao').active = true\r\n\t\t\t\t\tthis.propertyNode.props_btn_rate.getChildByName('btn_olpn_kaiguan').getChildByName('icon_kaiguan_jiantou').active = false\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.propertyNode.props_btn_rate.getChildByName('btn_olpn_kaiguan').getChildByName('icon_kaiguan_duihao').active = false\r\n\t\t\t\t\tthis.propertyNode.props_btn_rate.getChildByName('btn_olpn_kaiguan').getChildByName('icon_kaiguan_jiantou').active = true\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t\t.to(this.fadeDuration, { position: targetPosition })\r\n\t\t\t.start();\r\n\t\ttween(this.propertyNode.props_spr_tools_beli.getComponent(UIOpacity))\r\n\t\t\t.to(this.fadeDuration, { opacity: !bl ? 128 : 256 })\r\n\t\t\t.start();\r\n\t}\r\n\tsetokkk(done) { //万能图标\r\n\t\tlet count = 0\r\n\t\t// thor_Audio.playOneShot(SoundPathDefine.SCATTER_SHOW)\r\n\t\tthis.propertyNode.props_spr_MainRoller_list.children.forEach(item => {\r\n\t\t\t(item.getComponent(Thor_Roller) as Thor_Roller).sparkling(() => {\r\n\t\t\t\tcount++\r\n\t\t\t\tif (count >= this.propertyNode.props_spr_MainRoller_list.children.length) {\r\n\t\t\t\t\tdone()\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t})\r\n\t}\r\n\t// 倍数图标执行\r\n\tmultiplier(done) {\r\n\t\tlet count = 0\r\n\t\tthis.propertyNode.props_spr_MainRoller_list.children.forEach(item => {\r\n\t\t\t(item.getComponent(Thor_Roller) as Thor_Roller).multiplier(() => {\r\n\t\t\t\tcount++\r\n\t\t\t\tif (count >= this.propertyNode.props_spr_MainRoller_list.children.length) {\r\n\t\t\t\t\tdone()\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t})\r\n\t}\r\n\t// 小游戏总倍数飞行\r\n\tsamllMultiplier(done) {\r\n\t\t// 获取起始和目标的世界坐标\r\n\t\tlet startWorldPos = this.propertyNode.props_label_rate.worldPosition;\r\n\t\tlet targetWorldPos = winShowViewModel.comp.node.getChildByName('props_spr_win_box').worldPosition;\r\n\t\t// 创建节点的实例\r\n\t\tlet node = instantiate(this.propertyNode.props_label_rate);\r\n\t\t// 将节点添加到目标节点所在的父节点\r\n\t\twinShowViewModel.comp.node.addChild(node);\r\n\t\t// 获取父节点的 UITransform 组件\r\n\t\tlet uiTransform = winShowViewModel.comp.node.getComponent(UITransform);\r\n\t\t// 将世界坐标转换为新父节点的局部坐标\r\n\t\tlet startLocalPos = uiTransform.convertToNodeSpaceAR(startWorldPos);\r\n\t\tlet targetLocalPos = uiTransform.convertToNodeSpaceAR(targetWorldPos);\r\n\t\ttargetLocalPos.y = targetLocalPos.y - 25\r\n\t\t// 设置节点的初始位置\r\n\t\tnode.setPosition(startLocalPos);\r\n\t\t// 执行缓动动画\r\n\t\ttween(node)\r\n\t\t\t.to(0.5, { position: targetLocalPos }, { easing: 'sineInOut' })\r\n\t\t\t.call(() => {\r\n\t\t\t\tthis.scheduleOnce(()=>{\r\n\t\t\t\tnode.destroy()\r\n\t\t\t\t\tdone()\r\n\t\t\t\t},0.5)\r\n\t\t\t})\r\n\t\t\t.start();\r\n\r\n\t}\r\n\tprivate initRollerList() {\r\n\t\tthor_Audio.playOneShot(SoundPathDefine.DROP_DOWN)\r\n\t\t//let node=this.props.currGameType==GameType.MAIN?this.propertyNode.props_spr_MainRoller_list:this.propertyNode.props_spr_smallGameRoller_list\r\n\t\tthis.props.rollerMap.forEach((dataItem) => {\r\n\t\t\tconst rollerViewModel = new RollerViewModel().mountView(sourceManageSeletor().getFile(PrefabPathDefine.ROLLER).source).appendTo(this.propertyNode.props_spr_MainRoller_list).setProps({\r\n\t\t\t\trollerType: dataItem, isHasten: this.props.isHasten\r\n\t\t\t}).setEvent({\r\n\t\t\t\trollEnd: (rollerIndex) => {\r\n\t\t\t\t\tlet isAllStop = !this.rollerViewModelMap.some(item => !item.comp.getRoundEnd())\r\n\t\t\t\t\tisAllStop && this.events.allRollStop()\r\n\t\t\t\t},\r\n\t\t\t\tsetRoleAttack: (bl) => {\r\n\t\t\t\t\tthis.events.setRoleAttacks(bl)\r\n\t\t\t\t},\r\n\t\t\t\teffectEnd: () => {\r\n\t\t\t\t\tif (this.effectColumnLength === 0) {\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tthis.effectCount++\r\n\t\t\t\t\tif (this.effectCount >= this.effectColumnLength) {\r\n\t\t\t\t\t\tthis.effectColumnLength = 0;\r\n\t\t\t\t\t\tthis.events.effectEnd()\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tisplayIcon: () => {\r\n\t\t\t\t\tif (this.props.currGameType == GameType.MAIN) {\r\n\r\n\t\t\t\t\t} else if (this.props.currGameType == GameType.SUBGAME1) {\r\n\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}).connect()\r\n\t\t\tthis.rollerViewModelMap.push(rollerViewModel)\r\n\t\t})\r\n\t\tconst gameType = dataTransfer(DataKeyType.GAME_TYPE)\r\n\t\tthor_Audio.stop()\r\n\t\tthor_Audio.play(gameType === GameType.MAIN ? SoundPathDefine.BG_MUSIC_MAIN : SoundPathDefine.BG_MUSIC_1, true)\r\n\t}\r\n\r\n\tprotected destroyCallBack(): void {\r\n\t\tthis.taskScheduler.destoryQueue()\r\n\t}\r\n\r\n\tprotected bindUI(): void {\r\n\r\n\t}\r\n\r\n\tupdate(deltaTime: number) {\r\n\r\n\t}\r\n}\r\n"]}