{"version":3,"sources":["file:///Users/geliang/web/dibai/hall/assets/script/subGame/dragonTiger/ViewModel/DragonTigerMainViewModel.ts"],"names":["Vec3","sys","find","UITransform","ViewModel","StoreInject","SKT_MAG_TYPE","sktInstance","sktMsgListener","sourceManageSeletor","PrefabPathDefine","HistoryWinViewModel","WinViewModel","LoseViewModel","EffectType","getStore","resetUserStore","setUserInfoAction","setHistoryListAction","setRoomLeftInfosAction","setRoomInfoSizeAction","setRoomRightInfosAction","setRoomWinInfosAction","setMemberBetAction","changeGoldAction","changeGameTypeAction","setMemberDataAction","resetHistoryStore","setPokerLeftAction","setPokerRightAction","setSendedPAction","setWinAction","setReadyPAction","setTipsAction","updatePokerInfo","resetPokerStore","initBetData","UsersViewModel","TitleViewModel","OnlineViewModel","bundlePkgName","global","lang","addToastAction","config","changeAllWinUsersAction","changeCancelBetDataAction","changeGoldDataAction","resetStore","setCountDownAction","setMyInfoAction","setNewBetDataAction","setOnlineNumber","setUsersInfoAction","gameCacheData","DragonTigerPanelViewModel","constructor","countDown","timer","begin","sendSktMessage","AUTH","token","localStorage","getItem","gameId","add","MY_INFO","data","myInfo","hallDispatch","content","write","k","InitGameModule","GameBoardInit","placeStr","closeSubGame","confirmContent","leftUsers","roomLeftInfoVos","rightUsers","roomRightInfoVos","roomId","memberId","goldData","gold","goldStr","icon","memberName","winGold","index","gameOption","lookOnIndex","memberBet","pokerInfo","pokerLeftNum","pokerRightNum","dispatch","roomInfoSize","sendedP","readySendP","win","gameType","setProps","oddsList","seconds","startCountdown","stopCountdown","typeThreeSeconds","saveRoomId","setUsersInfo","concat","comp","props","usersInfo","undefined","forEach","v","i","usersViewModel","initBSUsers","TOP_UP","GAME_TIP","CRASH","betSeconds","dragonTigerMemberDrawPrizeVo","updateWinUserInfo","dragonTigerWinMemberVo","dragonTigerSettlementVo","updateMyInfo","HISTORY","BET_ALL","memberData","getSeatIndex","isMyBet","betData","type","BET_RESPONSE","preBet","palyingModule","RechangeGlod","resultCode","sendBet","betAmount","betType","isMe","betId","amountArr","push","ALL_USERS","GAME_SHOW","GIVE_GIFT","seats","filter","receiveMemberId","length","seat","x","y","headLocations","endPos","viewNode","getComponent","convertToWorldSpaceAR","flyGift","giveMemberId","getHeadPos","giftId","parent","openUsers","openTitle","openOnline","setEvent","openHistoryPanel","openHistory","giveUsersGift","openWinPanel","openWin","openLosePanel","openLose","scheduleOnce","winType","winList","roomWinInfo","oddNewList","list","updateWinloss","isFrom","pos","myHeadPosition","onlineNumberPosition","window","clearInterval","setInterval","openGiftBox","nodeWrap","historyViewModel","mountView","getFile","MAIN_HISTORY_WIN","source","appendTo","effectType","EFFECT1","isModal","onClosePanel","unMount","EFFECT2","connect","winViewModel","MAIN_WIN","loseViewModel","MAIN_LOSE","MAIN_USERS","MAIN_TITLE","onlineViewModel","MAIN_ONLINES","setItem","unMountCallBack","clearCacheData","removeById","reverse","users","time","Date","now","leftItem","rightItem","storeState","store","getState","inject","state","historyList","history","userInfo","pokerDetail","durGameType","tips","selectChip","game","newBetData","allWinUsers","cancelBetData"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAkDA,MAAAA,I,OAAAA,I;AAAcC,MAAAA,G,OAAAA,G;AAAKC,MAAAA,I,OAAAA,I;AAAiBC,MAAAA,W,OAAAA,W;;AAC/EC,MAAAA,S;AAAaC,MAAAA,W,iBAAAA,W;;AAEXC,MAAAA,Y,iBAAAA,Y;AAA8BC,MAAAA,W,iBAAAA,W;AAAaC,MAAAA,c,iBAAAA,c;;AACcC,MAAAA,mB,iBAAAA,mB;;AACzDC,MAAAA,gB,iBAAAA,gB;;AAGFC,MAAAA,mB;;AAEAC,MAAAA,Y;;AACAC,MAAAA,a;;AAEEC,MAAAA,U,iBAAAA,U;;AAEAC,MAAAA,Q,kBAAAA,Q;;AACAC,MAAAA,c,kBAAAA,c;AAAgBC,MAAAA,iB,kBAAAA,iB;;AAChBC,MAAAA,oB,kBAAAA,oB;AAAsBC,MAAAA,sB,kBAAAA,sB;AAAwBC,MAAAA,qB,kBAAAA,qB;AAAuBC,MAAAA,uB,kBAAAA,uB;AAAyBC,MAAAA,qB,kBAAAA,qB;AAAuBC,MAAAA,kB,kBAAAA,kB;AAAoBC,MAAAA,gB,kBAAAA,gB;AAAkBC,MAAAA,oB,kBAAAA,oB;AAAsBC,MAAAA,mB,kBAAAA,mB;AAAqBC,MAAAA,iB,kBAAAA,iB;;AACtMC,MAAAA,kB,kBAAAA,kB;AAAoBC,MAAAA,mB,kBAAAA,mB;AAAqBC,MAAAA,gB,kBAAAA,gB;AAAkBC,MAAAA,Y,kBAAAA,Y;AAAcC,MAAAA,e,kBAAAA,e;AAAiBC,MAAAA,a,kBAAAA,a;AAA6CC,MAAAA,e,kBAAAA,e;AAAiBC,MAAAA,e,kBAAAA,e;;AACrIC,MAAAA,W,kBAAAA,W;;AACrBC,MAAAA,c;;AACAC,MAAAA,c;;AACAC,MAAAA,e;;AACEC,MAAAA,a,kBAAAA,a;;AACAC,MAAAA,M,kBAAAA,M;AAAQC,MAAAA,I,kBAAAA,I;;AACRC,MAAAA,c,kBAAAA,c;;AACFC,MAAAA,M;;AACEC,MAAAA,uB,kBAAAA,uB;AAAyBC,MAAAA,yB,kBAAAA,yB;AAA2BC,MAAAA,oB,kBAAAA,oB;AAAsBC,MAAAA,U,kBAAAA,U;AAAYC,MAAAA,kB,kBAAAA,kB;AAAoBC,MAAAA,e,kBAAAA,e;AAAiBC,MAAAA,mB,kBAAAA,mB;AAAqBC,MAAAA,e,kBAAAA,e;AAAiBC,MAAAA,kB,kBAAAA,kB;;AAC7IC,MAAAA,a,kBAAAA,a;;;;;;;;;AASvBC,MAAAA,yB,WADL;AAAA;AAAA,sCAAY;AAAA;AAAA,iCAAZ,C,gBAAD,MACMA,yBADN;AAAA;AAAA,kCACyF;AAEvF;AACAC,QAAAA,WAAW,GAAG;AACZ,gBAAM,uBAAN;AADY,eAFPC,SAEO;AAsWd;AAtWc,eAuWNC,KAvWM,GAuWU,CAvWV;AAEb;;AAESC,QAAAA,KAAK,GAAG;AAChB;AAEA;AACA;AAAA;AAAA,0CAAYC,cAAZ,CAA2B;AAAA;AAAA,4CAAaC,IAAxC,EAA8C;AAC5CC,YAAAA,KAAK,EAAE7D,GAAG,CAAC8D,YAAJ,CAAiBC,OAAjB,CAAyB,OAAzB,CADqC;AAE5CC,YAAAA,MAAM,EAAE;AAAA;AAAA,kCAAOA;AAF6B,WAA9C;AAKA;AAAA;AAAA,gDAAeC,GAAf,CAAmB;AAAA;AAAA,4CAAaC,OAAhC;AAAA;AAAA,8CAAyDC,IAAD,IAAU;AAAC;AACjE,gBAAI,CAACA,IAAD,IAAS,CAACA,IAAI,CAACC,MAAnB,EAA2B;AACzB;AAAA;AAAA,oCAAOC,YAAP,CAAoB;AAAA;AAAA,oDAAe;AAAEC,gBAAAA,OAAO,EAAE;AAAA;AAAA,kCAAKC,KAAL,CAAWC,CAAC,IAAIA,CAAC,CAACC,cAAF,CAAiBC,aAAjC,EAAgD,EAAhD,EAAoD;AAAEC,kBAAAA,QAAQ,EAAE;AAAZ,iBAApD;AAAX,eAAf,CAApB;AACA;AAAA;AAAA,oCAAOC,YAAP,CAAoB;AAAEC,gBAAAA,cAAc,EAAE;AAAA;AAAA,kCAAKN,KAAL,CAAWC,CAAC,IAAIA,CAAC,CAACC,cAAF,CAAiBC,aAAjC;AAAlB,eAApB;AACA;AACD,aAL+D,CAOhE;AACA;AACA;AACA;AACA;;;AACA;AAAA;AAAA,gDAAcI,SAAd,GAA0BX,IAAI,CAACY,eAA/B;AACA;AAAA;AAAA,gDAAcC,UAAd,GAA2Bb,IAAI,CAACc,gBAAhC;AACA;AAAA;AAAA,gDAAcC,MAAd,GAAuBf,IAAI,CAACe,MAA5B;AACA;AAAA;AAAA,gDAAcC,QAAd,GAAyBhB,IAAI,CAACC,MAAL,CAAYe,QAArC;AACA;AAAA;AAAA,gDAAcC,QAAd,GAAyBjB,IAAI,CAACiB,QAA9B;AACA,gBAAIhB,MAAM,GAAG;AACXiB,cAAAA,IAAI,EAAElB,IAAI,CAACC,MAAL,CAAYiB,IADP;AAEXC,cAAAA,OAAO,EAAEnB,IAAI,CAACC,MAAL,CAAYiB,IAAZ,GAAmB,EAFjB;AAGXE,cAAAA,IAAI,EAAEpB,IAAI,CAACC,MAAL,CAAYmB,IAHP;AAIXC,cAAAA,UAAU,EAAErB,IAAI,CAACC,MAAL,CAAYoB,UAJb;AAKXC,cAAAA,OAAO,EAAEtB,IAAI,CAACC,MAAL,CAAYqB,OALV;AAMXN,cAAAA,QAAQ,EAAEhB,IAAI,CAACC,MAAL,CAAYe,QANX;AAOXO,cAAAA,KAAK,EAAE;AAAA;AAAA,oCAAOC,UAAP,CAAkBC,WAPd;AAQXC,cAAAA,SAAS,EAAE1B,IAAI,CAACC,MAAL,CAAYyB;AARZ,aAAb;AAUA,kBAAMC,SAAS,GAAG;AAChBC,cAAAA,YAAY,EAAE5B,IAAI,CAAC4B,YADH;AAEhBC,cAAAA,aAAa,EAAC7B,IAAI,CAAC6B;AAFH,aAAlB;AAIA,iBAAKC,QAAL,CAAc;AAAA;AAAA,oDAAgB7B,MAAhB,CAAd;AACA,iBAAK6B,QAAL,CAAc;AAAA;AAAA,oDAAgB9B,IAAI,CAAC+B,YAArB,CAAd;AACA,iBAAKD,QAAL,CAAc;AAAA;AAAA,8DAAqB9B,IAAI,CAACiB,QAA1B,CAAd;AAEA,iBAAKa,QAAL,CAAc;AAAA;AAAA,wDAAkB,EAAE,GAAG9B,IAAI,CAACC;AAAV,aAAlB,CAAd;AACA,iBAAK6B,QAAL,CAAc;AAAA;AAAA,sDAAiB9B,IAAI,CAACC,MAAL,CAAYiB,IAA7B,CAAd;AACA,iBAAKY,QAAL,CAAc;AAAA;AAAA,sDAAiB9B,IAAI,CAACgC,OAAtB,CAAd;AACA,iBAAKF,QAAL,CAAc;AAAA;AAAA,oDAAgB9B,IAAI,CAACiC,UAArB,CAAd;AACA,iBAAKH,QAAL,CAAc;AAAA;AAAA,oDAAgBH,SAAhB,CAAd,EAvCgE,CAyChE;AACA;;AACA,iBAAKG,QAAL,CAAc;AAAA;AAAA,kEAAuB9B,IAAI,CAACY,eAA5B,CAAd;AACA,iBAAKkB,QAAL,CAAc;AAAA;AAAA,gEAAsB9B,IAAI,CAAC+B,YAA3B,CAAd;AACA,iBAAKD,QAAL,CAAc;AAAA;AAAA,oEAAwB9B,IAAI,CAACc,gBAA7B,CAAd;AACA,iBAAKgB,QAAL,CAAc;AAAA;AAAA,8CAAa9B,IAAI,CAACkC,GAAlB,CAAd;AACA,iBAAKJ,QAAL,CAAc;AAAA;AAAA,8DAAqB9B,IAAI,CAACmC,QAA1B,CAAd;AACA,iBAAKC,QAAL,CAAc;AACZC,cAAAA,QAAQ,EAAErC,IAAI,CAACqC,QADH,CAEZ;;AAFY,aAAd;;AAIA,gBAAIrC,IAAI,CAACmC,QAAL,KAAkB,CAAtB,EAAyB;AACvB,mBAAKL,QAAL,CAAc;AAAA;AAAA,4DAAmB9B,IAAI,CAACsC,OAAxB,CAAd;AACA,mBAAKjD,SAAL,GAAiBW,IAAI,CAACsC,OAAtB;AACA,mBAAKC,cAAL;AACA,mBAAKH,QAAL,CAAc;AACZE,gBAAAA,OAAO,EAAEtC,IAAI,CAACsC;AADF,eAAd;AAGD;;AAAA;;AACD,gBAAItC,IAAI,CAACmC,QAAL,KAAkB,CAAtB,EAAyB;AACvB,mBAAKK,aAAL;AACD;;AACD,gBAAIxC,IAAI,CAACmC,QAAL,KAAkB,CAAtB,EAAyB;AACvB,mBAAKC,QAAL,CAAc;AACZK,gBAAAA,gBAAgB,EAAEzC,IAAI,CAACsC;AADX,eAAd;AAGD;;AACD,iBAAKI,UAAL,CAAgB1C,IAAI,CAACe,MAArB,EApEgE,CAqEhE;;AACA,iBAAK4B,YAAL;AACA,iBAAKb,QAAL,CAAc;AAAA;AAAA,0DAAmB;AAAA;AAAA,gDAAcnB,SAAd,CAAwBiC,MAAxB,CAA+B;AAAA;AAAA,gDAAc/B,UAA7C,CAAnB,CAAd;;AACA,gBAAI,CAAC,KAAKgC,IAAL,CAAUC,KAAV,CAAgBC,SAAjB,IAA8B,KAAKF,IAAL,CAAUC,KAAV,CAAgBC,SAAhB,KAA8BC,SAAhE,EAA2E;AAAE;AAAQ;;AAAA;AACrF,iBAAKH,IAAL,CAAUC,KAAV,CAAgBC,SAAhB,CAA0BE,OAA1B,CAAkC,CAACC,CAAD,EAAIC,CAAJ,KAAU;AAC1CC,cAAAA,cAAc,CAACP,IAAf,CAAoBQ,WAApB,CAAgCH,CAAhC,EAAmCA,CAAC,CAAC3B,KAArC;AACD,aAFD;AAID,WA7ED;AA+EA;AAAA;AAAA,gDAAezB,GAAf,CAAmB;AAAA;AAAA,4CAAawD,MAAhC;AAAA;AAAA,8CAAwDtD,IAAD,IAAU;AAAC;AAChE,iBAAK8B,QAAL,CAAc;AAAA;AAAA,sDAAiB9B,IAAjB,CAAd;AACD,WAFD;AAIA;AAAA;AAAA,gDAAeF,GAAf,CAAmB;AAAA;AAAA,4CAAayD,QAAhC;AAAA;AAAA,8CAA0DvD,IAAD,IAAU;AAAC;AAClE,iBAAK8B,QAAL,CAAc;AAAA;AAAA,gDAAc9B,IAAd,CAAd;AACD,WAFD;AAIA;AAAA;AAAA,gDAAeF,GAAf,CAAmB;AAAA;AAAA,4CAAa0D,KAAhC;AAAA;AAAA,8CAAuDxD,IAAD,IAAU;AAAC;AAC/D,iBAAK8B,QAAL,CAAc;AAAA;AAAA,8DAAqB9B,IAAI,CAACmC,QAA1B,CAAd;AAEA,iBAAKC,QAAL,CAAc,CACZ;AADY,aAAd;;AAGA,gBAAIpC,IAAI,CAACmC,QAAL,KAAkB,CAAtB,EAAyB;AACvB,mBAAKL,QAAL,CAAc;AAAA;AAAA,4DAAmB9B,IAAI,CAACsC,OAAxB,CAAd;AACA,mBAAKjD,SAAL,GAAiBW,IAAI,CAACsC,OAAtB;AACA,mBAAKC,cAAL;AAEA,mBAAKH,QAAL,CAAc;AACZqB,gBAAAA,UAAU,EAAEzD,IAAI,CAACsC;AADL,eAAd;AAIA,mBAAKR,QAAL,CAAc;AAAA;AAAA,4DAAmB;AAAA;AAAA,kDAAcnB,SAAd,CAAwBiC,MAAxB,CAA+B;AAAA;AAAA,kDAAc/B,UAA7C,CAAnB,CAAd;AACD;;AACD,gBAAIb,IAAI,CAACmC,QAAL,KAAkB,CAAtB,EAAyB;AACvB,mBAAKK,aAAL;AACA,mBAAK1E,eAAL,CAAqBkC,IAAI,CAAC0D,4BAA1B;AACA,mBAAKC,iBAAL,CAAuB3D,IAAI,CAAC4D,sBAA5B;;AACA,kBAAI5D,IAAI,CAAC6D,uBAAT,EAAkC;AAChC,qBAAKC,YAAL,CAAkB9D,IAAI,CAAC6D,uBAAvB;AACD;AAEF;;AACD,gBAAI7D,IAAI,CAACmC,QAAL,KAAkB,CAAtB,EAAyB;AACvB,mBAAKC,QAAL,CAAc;AACZK,gBAAAA,gBAAgB,EAAEzC,IAAI,CAACsC;AADX,eAAd;AAGD;AACF,WA/BD,EAhGgB,CAiIhB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AAAA;AAAA,gDAAexC,GAAf,CAAmB;AAAA;AAAA,4CAAaiE,OAAhC;AAAA;AAAA,8CAAyD/D,IAAD,IAAU;AAAC;AACjE,iBAAK8B,QAAL,CAAc;AAAA;AAAA,8DAAqB,EAAE,GAAG9B;AAAL,aAArB,CAAd;AACD,WAFD;AAGA;AAAA;AAAA,gDAAeF,GAAf,CAAmB;AAAA;AAAA,4CAAakE,OAAhC;AAAA;AAAA,8CAAyDhE,IAAD,IAAU;AAAC;AACjE;AAAA;AAAA,gDAAciB,QAAd,GAAyBjB,IAAI,CAACiB,QAA9B;AACA,kBAAMD,QAAQ,GAAGhB,IAAI,CAACiE,UAAL,CAAgBjD,QAAjC;AACA,kBAAMO,KAAK,GAAG,KAAK2C,YAAL,CAAkBlD,QAAlB,CAAd;AACA,kBAAMmD,OAAO,GAAG,KAAKtB,IAAL,CAAUC,KAAV,CAAgB7C,MAAhB,CAAuBe,QAAvB,KAAoCA,QAApD;AACA,kBAAMoD,OAAO,GAAG;AAAA;AAAA,4CAAY7C,KAAZ,EAAmBP,QAAnB,EAA6BhB,IAAI,CAACiE,UAAL,CAAgBI,IAA7C,EAAmDrE,IAAI,CAACiE,UAAL,CAAgB/C,IAAnE,CAAhB;AACAkD,YAAAA,OAAO,CAACD,OAAR,GAAkBA,OAAlB;AACA,iBAAKrC,QAAL,CAAc;AAAA;AAAA,4DAAoBsC,OAApB,CAAd;AACA,iBAAKtC,QAAL,CAAc;AAAA;AAAA,8DAAqB9B,IAAI,CAACiB,QAA1B,CAAd;AACA,iBAAKa,QAAL,CAAc;AAAA;AAAA,4DAAoB9B,IAAI,CAACiE,UAAzB,CAAd;AACD,WAVD;AAWA;AAAA;AAAA,gDAAenE,GAAf,CAAmB;AAAA;AAAA,4CAAawE,YAAhC;AAAA;AAAA,8CAA8DtE,IAAD,IAAU;AAAC;AACtE,gBAAI,CAAC;AAAA;AAAA,kCAAOuE,MAAZ,EAAoB;AAClB,kBAAIvE,IAAJ,EAAU;AACR,qBAAK8B,QAAL,CAAc;AAAA;AAAA,8DAAmB9B,IAAI,CAAC0B,SAAxB,CAAd;AACA,qBAAKI,QAAL,CAAc;AAAA;AAAA,4DAAkB,EAAE,GAAG9B;AAAL,iBAAlB,CAAd;AACA,qBAAK8B,QAAL,CAAc;AAAA;AAAA,0DAAiB9B,IAAI,CAACkB,IAAtB,CAAd;AACD,eAJD,MAIO;AACL;AAAA;AAAA,sCAAOhB,YAAP,CAAoB;AAAA;AAAA,sDAAe;AAAEC,kBAAAA,OAAO,EAAE;AAAA;AAAA,oCAAKC,KAAL,CAAWC,CAAC,IAAIA,CAAC,CAACmE,aAAF,CAAgBC,YAAhC,EAA8C,EAA9C,EAAkD;AAAEjE,oBAAAA,QAAQ,EAAE;AAAZ,mBAAlD;AAAX,iBAAf,CAApB;AACD;AACF,aARD,MAQO,IAAIR,IAAI,CAAC0E,UAAL,KAAoB,CAAxB,EAA2B;AAChC,mBAAK5C,QAAL,CAAc;AAAA;AAAA,4DAAmB9B,IAAI,CAAC0B,SAAxB,CAAd;AACA,oBAAMiD,OAAO,GAAG;AACd5D,gBAAAA,MAAM,EAAE;AAAA;AAAA,oDAAcA,MADR;AAEdC,gBAAAA,QAAQ,EAAE,KAAK6B,IAAL,CAAUC,KAAV,CAAgB9B,QAFZ;AAGdK,gBAAAA,UAAU,EAAE,KAAKwB,IAAL,CAAUC,KAAV,CAAgBzB,UAHd;AAIdH,gBAAAA,IAAI,EAAElB,IAAI,CAAC4E,SAJG;AAKdC,gBAAAA,OAAO,EAAE7E,IAAI,CAAC6E,OALA;AAMdC,gBAAAA,IAAI,EAAE,IANQ;AAOdC,gBAAAA,KAAK,EAAE/E,IAAI,CAAC+E;AAPE,eAAhB;AASA,mBAAKlC,IAAL,CAAUmC,SAAV,CAAoBC,IAApB,CAAyBN,OAAzB;AACA,mBAAK7C,QAAL,CAAc;AAAA;AAAA,wDAAiB9B,IAAI,CAACkB,IAAtB,CAAd;AACA,mBAAKY,QAAL,CAAc;AAAA;AAAA,0DAAkB,EAAE,GAAG9B;AAAL,eAAlB,CAAd;AAED,aAfM,MAeA,IAAIA,IAAI,CAAC0E,UAAL,KAAoB1B,SAApB,IAAiChD,IAAI,CAAC0E,UAAL,KAAoB,CAAzD,EAA4D;AACjE,mBAAK5C,QAAL,CAAc;AAAA;AAAA,4DAAmB9B,IAAI,CAAC0B,SAAxB,CAAd;AACA,mBAAKI,QAAL,CAAc;AAAA;AAAA,0DAAkB,EAAE,GAAG9B;AAAL,eAAlB,CAAd;AACA,mBAAK8B,QAAL,CAAc;AAAA;AAAA,wDAAiB9B,IAAI,CAACkB,IAAtB,CAAd;AACA,oBAAMkD,OAAO,GAAG;AAAA;AAAA,8CAAY,KAAKvB,IAAL,CAAUC,KAAV,CAAgB7C,MAAhB,CAAuBsB,KAAnC,EAA0C,KAAKsB,IAAL,CAAUC,KAAV,CAAgB7C,MAAhB,CAAuBe,QAAjE,EAA2EhB,IAAI,CAAC6E,OAAhF,EAAyF7E,IAAI,CAAC4E,SAA9F,CAAhB;AACAR,cAAAA,OAAO,CAACD,OAAR,GAAkB,IAAlB,CALiE,CAK1C;;AACvBC,cAAAA,OAAO,CAACW,KAAR,GAAgB/E,IAAI,CAAC+E,KAArB;AACA,mBAAKjD,QAAL,CAAc;AAAA;AAAA,0EAA0BsC,OAA1B,CAAd;AAED;AACF,WAlCD,EAhKgB,CAmMhB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AAEA;;AACA;AAAA;AAAA,gDAAetE,GAAf,CAAmB;AAAA;AAAA,4CAAaoF,SAAhC;AAAA;AAAA,8CAA2DlF,IAAD,IAAU;AAAC;AACnE,iBAAK8B,QAAL,CAAc;AAAA;AAAA,oDAAgB9B,IAAhB,CAAd;AACA,iBAAK8B,QAAL,CAAc;AAAA;AAAA,gEAAsB9B,IAAtB,CAAd;AACD,WAHD,EA5NgB,CAgOhB;AAEA;AACA;AACA;AACA;AACA;AACA;AAEA;;AACA;AAAA;AAAA,gDAAeF,GAAf,CAAmB;AAAA;AAAA,4CAAaqF,SAAhC;AAAA;AAAA,8CAA2DnF,IAAD,IAAU;AAAC;AACnE,gBAAI,MAAM,KAAK6C,IAAL,CAAUC,KAAV,CAAgBX,QAA1B,EAAoC;AAClC;AACA,mBAAK9C,SAAL,GAAiBW,IAAI,CAACsC,OAAtB;AACA,mBAAKC,cAAL;AACD;AACF,WAND;AAQA;AAAA;AAAA,gDAAezC,GAAf,CAAmB;AAAA;AAAA,4CAAasF,SAAhC;AAAA;AAAA,8CAA2DpF,IAAD,IAAqB;AAAC;AAC9E,kBAAMqF,KAAK,GAAG,KAAKxC,IAAL,CAAUC,KAAV,CAAgBC,SAAhB,CAA0BuC,MAA1B,CAAiCpC,CAAC,IAAIA,CAAC,CAAClC,QAAF,KAAehB,IAAI,CAACuF,eAA1D,CAAd,CAD6E,CAE7E;;AACA,gBAAIF,KAAK,IAAIA,KAAK,CAACG,MAAN,GAAe,CAA5B,EAA+B;AAC7BH,cAAAA,KAAK,CAACpC,OAAN,CAAcwC,IAAI,IAAI;AACpB,sBAAM;AAAEC,kBAAAA,CAAF;AAAKC,kBAAAA;AAAL,oBAAW;AAAA;AAAA,sCAAOC,aAAP,CAAqBH,IAAI,CAAClE,KAA1B,CAAjB;AACA,sBAAMsE,MAAM,GAAG,KAAKC,QAAL,CAAcC,YAAd,CAA2BhK,WAA3B,EAAwCiK,qBAAxC,CAA8D,IAAIpK,IAAJ,CAAS8J,CAAT,EAAYC,CAAZ,CAA9D,CAAf;AACA;AAAA;AAAA,sCAAOM,OAAP,CAAejG,IAAI,CAACkG,YAApB,EAAkClG,IAAI,CAACuF,eAAvC,EAAwD,KAAKY,UAAL,CAAgBnG,IAAI,CAACkG,YAArB,EAAmC,IAAnC,CAAxD,EAAkGL,MAAlG,EAA0G7F,IAAI,CAACoG,MAA/G,EAAuH,KAAKN,QAAL,CAAcO,MAArI;AACD,eAJD;AAKD,aAND,MAMO;AACL;AAAA;AAAA,oCAAOJ,OAAP,CAAejG,IAAI,CAACkG,YAApB,EAAkClG,IAAI,CAACuF,eAAvC,EAAwD,KAAKY,UAAL,CAAgBnG,IAAI,CAACkG,YAArB,EAAmC,IAAnC,CAAxD,EACE,KAAKC,UAAL,CAAgBnG,IAAI,CAACuF,eAArB,EAAsC,KAAtC,CADF,EACgDvF,IAAI,CAACoG,MADrD,EAC6D,KAAKN,QAAL,CAAcO,MAD3E;AAED;AACF,WAbD;AAeA,eAAKC,SAAL;AACA,eAAKC,SAAL;AACA,eAAKC,UAAL;AAEA,eAAKC,QAAL,CAAc;AACZC,YAAAA,gBAAgB,EAAE,MAAM;AACtB,mBAAKC,WAAL;AACD,aAHW;AAIZC,YAAAA,aAAa,EAAE,MAAM,CAAG,CAJZ;AAMZC,YAAAA,YAAY,EAAE,MAAM;AAClB,mBAAKC,OAAL;AACD,aARW;AAUZC,YAAAA,aAAa,EAAE,MAAM;AACnB,mBAAKC,QAAL;AACD;AAZW,WAAd;AAeD;AAED;;;AACQlD,QAAAA,YAAY,CAAC9D,IAAD,EAAO;AACzB,eAAK6C,IAAL,CAAUoE,YAAV,CAAuB,MAAM;AAC3B,gBAAIhH,MAAM,GAAG;AACXiB,cAAAA,IAAI,EAAElB,IAAI,CAACC,MAAL,CAAYiB,IADP;AAEXC,cAAAA,OAAO,EAAEnB,IAAI,CAACC,MAAL,CAAYiB,IAAZ,GAAmB,EAFjB;AAGXE,cAAAA,IAAI,EAAEpB,IAAI,CAACC,MAAL,CAAYmB,IAHP;AAIXC,cAAAA,UAAU,EAAErB,IAAI,CAACC,MAAL,CAAYoB,UAJb;AAKXC,cAAAA,OAAO,EAAEtB,IAAI,CAACC,MAAL,CAAYqB,OALV;AAMXN,cAAAA,QAAQ,EAAEhB,IAAI,CAACC,MAAL,CAAYe,QANX;AAOXO,cAAAA,KAAK,EAAE;AAAA;AAAA,oCAAOC,UAAP,CAAkBC,WAPd;AAQXC,cAAAA,SAAS,EAAE1B,IAAI,CAACC,MAAL,CAAYyB,SARZ;AASXwF,cAAAA,OAAO,EAAElH,IAAI,CAACC;AATH,aAAb;AAWA;;AACA;AAAA;AAAA,gDAAckH,OAAd,GAAwBnH,IAAI,CAACoH,WAA7B,CAb2B,CAc3B;;AACA,iBAAKtF,QAAL,CAAc;AAAA;AAAA,oDAAgB7B,MAAhB,CAAd;AACA,iBAAK6B,QAAL,CAAc;AAAA;AAAA,oDAAgB9B,IAAI,CAAC+B,YAArB,CAAd;AAEA,iBAAKD,QAAL,CAAc;AAAA;AAAA,wDAAkB,EAAE,GAAG9B,IAAI,CAACC;AAAV,aAAlB,CAAd;AACA,iBAAK6B,QAAL,CAAc;AAAA;AAAA,sDAAiB9B,IAAI,CAACC,MAAL,CAAYiB,IAA7B,CAAd;AACA,iBAAKY,QAAL,CAAc;AAAA;AAAA,0DAAmB9B,IAAI,CAACC,MAAL,CAAYyB,SAA/B,CAAd;AACA,iBAAKI,QAAL,CAAc;AAAA;AAAA,gEAAsB9B,IAAI,CAACoH,WAA3B,CAAd;AACA,iBAAKtF,QAAL,CAAc;AAAA;AAAA,kEAAuB9B,IAAI,CAACY,eAA5B,CAAd;AACA,iBAAKkB,QAAL,CAAc;AAAA;AAAA,oEAAwB9B,IAAI,CAACc,gBAA7B,CAAd;AACD,WAxBD,EAwBE,CAxBF;AAyBD;AAEF;;;AACShD,QAAAA,eAAe,CAACkC,IAAD,EAAO;AAC5B,gBAAM2B,SAAS,GAAG;AAChBC,YAAAA,YAAY,EAAE5B,IAAI,CAAC4B,YADH;AAEhBC,YAAAA,aAAa,EAAC7B,IAAI,CAAC6B;AAFH,WAAlB;AAIA,eAAKC,QAAL,CAAc;AAAA;AAAA,kDAAgBH,SAAhB,CAAd,EAL4B,CAM5B;AACA;;AACA,eAAKG,QAAL,CAAc;AAAA;AAAA,oDAAiB9B,IAAI,CAACgC,OAAtB,CAAd;AACA,eAAKF,QAAL,CAAc;AAAA;AAAA,kDAAgB9B,IAAI,CAACiC,UAArB,CAAd;AACA,eAAKH,QAAL,CAAc;AAAA;AAAA,4CAAa9B,IAAI,CAACkC,GAAlB,CAAd;AACA,eAAKE,QAAL,CAAc;AACZiF,YAAAA,UAAU,EAAErH,IAAI,CAACsH;AADL,WAAd;AAGD;AACD;;;AACQ3D,QAAAA,iBAAiB,CAAC3D,IAAD,EAAO;AAC9B,eAAK6C,IAAL,CAAUoE,YAAV,CAAuB,MAAM;AAC3B,iBAAKM,aAAL,CAAmBvH,IAAI,CAACsH,IAAxB;AACE;AAAA;AAAA,gDAAc3G,SAAd,GAA0BX,IAAI,CAACY,eAA/B;AACA;AAAA;AAAA,gDAAcC,UAAd,GAA2Bb,IAAI,CAACc,gBAAhC,CAHyB,CAIzB;;AACA,iBAAK6B,YAAL;AACA,iBAAKb,QAAL,CAAc;AAAA;AAAA,oEAAwB9B,IAAI,CAACsH,IAA7B,CAAd;AACH,WAPD,EAOE,CAPF;AAQD;AAGD;;;AACQnB,QAAAA,UAAU,CAACnF,QAAD,EAAmBwG,MAAnB,EAAoC;AACpD,gBAAM/B,IAAI,GAAG,KAAK5C,IAAL,CAAUC,KAAV,CAAgBC,SAAhB,CAA0BjH,IAA1B,CAA+BoH,CAAC,IAAIA,CAAC,CAAClC,QAAF,KAAeA,QAAnD,CAAb;AACA,cAAIyG,GAAJ;;AACA,cAAIhC,IAAJ,EAAU;AACR,kBAAM;AAAEC,cAAAA,CAAF;AAAKC,cAAAA;AAAL,gBAAW;AAAA;AAAA,kCAAOC,aAAP,CAAqBH,IAAI,CAAClE,KAA1B,CAAjB;AACAkG,YAAAA,GAAG,GAAG,IAAI7L,IAAJ,CAAS8J,CAAT,EAAYC,CAAZ,CAAN;AACD,WAHD,MAGO,IAAI6B,MAAM,IAAI,KAAK3E,IAAL,CAAUC,KAAV,CAAgB7C,MAAhB,CAAuBe,QAAvB,KAAoCA,QAAlD,EAA4D;AACjEyG,YAAAA,GAAG,GAAG;AAAA;AAAA,kCAAOjG,UAAP,CAAkBkG,cAAxB;AACD,WAFM,MAEA,IAAIF,MAAJ,EAAY;AACjBC,YAAAA,GAAG,GAAG;AAAA;AAAA,kCAAOjG,UAAP,CAAkBmG,oBAAxB;AACD,WAFM,MAEA;AACL,mBAAO3E,SAAP;AACD;;AAED,iBAAO,KAAK8C,QAAL,CAAcC,YAAd,CAA2BhK,WAA3B,EAAwCiK,qBAAxC,CAA8DyB,GAA9D,CAAP;AACD;;AAIOlF,QAAAA,cAAc,GAAG;AACvB,cAAI,KAAKjD,KAAL,GAAa,CAAjB,EAAoB;AAClBsI,YAAAA,MAAM,CAACC,aAAP,CAAqB,KAAKvI,KAA1B;AACA,iBAAKA,KAAL,GAAa,CAAb;AACD;;AACD,eAAKwC,QAAL,CAAc;AAAA;AAAA,wDAAmB,KAAKzC,SAAL,EAAnB,CAAd;AACA,eAAKC,KAAL,GAAasI,MAAM,CAACE,WAAP,CAAmB,MAAM;AACpC,iBAAKhG,QAAL,CAAc;AAAA;AAAA,0DAAmB,KAAKzC,SAAL,EAAnB,CAAd;;AACA,gBAAI,KAAKA,SAAL,IAAkB,CAAtB,EAAyB;AACvBuI,cAAAA,MAAM,CAACC,aAAP,CAAqB,KAAKvI,KAA1B,EADuB,CAEvB;;AACA,mBAAKA,KAAL,GAAa,CAAb;AACD;AACF,WAPY,EAOV,IAPU,CAAb;AAQD;AACD;;;AACQkD,QAAAA,aAAa,GAAG;AACtB;AACA,cAAI,KAAKK,IAAL,CAAUC,KAAV,CAAgBzD,SAAhB,IAA6B,CAAjC,EAAoC;AAClC;AACD;;AACD,eAAKC,KAAL,IAAcsI,MAAM,CAACC,aAAP,CAAqB,KAAKvI,KAA1B,CAAd;AACA,eAAKA,KAAL,GAAa,CAAb;AACA,eAAKwC,QAAL,CAAc;AAAA;AAAA,wDAAmB,CAAnB,CAAd;AACD;;AAEMiG,QAAAA,WAAW,CAACC,QAAD,EAAkB,CAAG;;AAChCrB,QAAAA,WAAW,CAACqB,QAAD,EAAkB;AAClC,sCAAAC,gBAAgB,GAAG;AAAA;AAAA,4DAA0BC,SAA1B,CAAoC;AAAA;AAAA,4DAAsBC,OAAtB,CAA8B;AAAA;AAAA,oDAAiBC,gBAA/C,EAAiEC,MAArG,EAChBC,QADgB,CACPxM,IAAI,CAAC,QAAD,CADG,EACS;AAAEyM,YAAAA,UAAU,EAAE;AAAA;AAAA,0CAAWC,OAAzB;AAAkCC,YAAAA,OAAO,EAAE;AAA3C,WADT,EAC4DhC,QAD5D,CACqE;AACpFiC,YAAAA,YAAY,EAAE,MAAM;AAClBT,cAAAA,gBAAgB,CAACU,OAAjB,CAAyB;AAAA;AAAA,4CAAWC,OAApC;AACD;AAHmF,WADrE,EAKdC,OALc,EAAnB;AAMD;;AAEM/B,QAAAA,OAAO,CAACkB,QAAD,EAAkB;AAC9B,kCAAAc,YAAY,GAAG;AAAA;AAAA,8CAAmBZ,SAAnB,CAA6B;AAAA;AAAA,4DAAsBC,OAAtB,CAA8B;AAAA;AAAA,oDAAiBY,QAA/C,EAAyDV,MAAtF,EACZC,QADY,CACHxM,IAAI,CAAC,QAAD,CADD,EACa;AAAEyM,YAAAA,UAAU,EAAE;AAAA;AAAA,0CAAWC,OAAzB;AAAkCC,YAAAA,OAAO,EAAE;AAA3C,WADb,EACgEhC,QADhE,CACyE;AACpFiC,YAAAA,YAAY,EAAE,MAAM;AAClBI,cAAAA,YAAY,CAACH,OAAb,CAAqB;AAAA;AAAA,4CAAWC,OAAhC;AACD;AAHmF,WADzE,EAMVC,OANU,EAAf;AAQD;;AAGM7B,QAAAA,QAAQ,CAACgB,QAAD,EAAkB;AAC/B,mCAAAgB,aAAa,GAAG;AAAA;AAAA,gDAAoBd,SAApB,CAA8B;AAAA;AAAA,4DAAsBC,OAAtB,CAA8B;AAAA;AAAA,oDAAiBc,SAA/C,EAA0DZ,MAAxF,EACbC,QADa,CACJxM,IAAI,CAAC,QAAD,CADA,EACY;AAAEyM,YAAAA,UAAU,EAAE;AAAA;AAAA,0CAAWC,OAAzB;AAAkCC,YAAAA,OAAO,EAAE;AAA3C,WADZ,EAC+DhC,QAD/D,CACwE;AACpFiC,YAAAA,YAAY,EAAE,MAAM;AAClBM,cAAAA,aAAa,CAACL,OAAd,CAAsB;AAAA;AAAA,4CAAWC,OAAjC;AACD;AAHmF,WADxE,EAKXC,OALW,EAAhB;AAMD;;AACMvC,QAAAA,SAAS,CAAC0B,QAAD,EAAkB;AAChC,oCAAA5E,cAAc,GAAG;AAAA;AAAA,kDAAqB8E,SAArB,CAA+B;AAAA;AAAA,4DAAsBC,OAAtB,CAA8B;AAAA;AAAA,oDAAiBe,UAA/C,EAA2Db,MAA1F,EACdC,QADc,CACL,KAAKxC,QAAL,CAAcO,MADT,EACiB;AAAEkC,YAAAA,UAAU,EAAE;AAAA;AAAA,0CAAWC,OAAzB;AAAkCC,YAAAA,OAAO,EAAE;AAA3C,WADjB,EACqEhC,QADrE,CAC8E,EAD9E,EAGZoC,OAHY,EAAjB;AAKD;;AAEMtC,QAAAA,SAAS,CAACyB,QAAD,EAAkB;AAChC;AAAA;AAAA,kDAAqBE,SAArB,CAA+B;AAAA;AAAA,4DAAsBC,OAAtB,CAA8B;AAAA;AAAA,oDAAiBgB,UAA/C,EAA2Dd,MAA1F,EACGC,QADH,CACY,KAAKxC,QAAL,CAAcO,MAD1B,EACkC;AAAEkC,YAAAA,UAAU,EAAE;AAAA;AAAA,0CAAWC,OAAzB;AAAkCC,YAAAA,OAAO,EAAE;AAA3C,WADlC,EACsFhC,QADtF,CAC+F,EAD/F,EAGKoC,OAHL;AAKD;;AACMrC,QAAAA,UAAU,CAACwB,QAAD,EAAkB;AACjC,qCAAAoB,eAAe,GAAG;AAAA;AAAA,oDAAsBlB,SAAtB,CAAgC;AAAA;AAAA,4DAAsBC,OAAtB,CAA8B;AAAA;AAAA,oDAAiBkB,YAA/C,EAA6DhB,MAA7F,EACfC,QADe,CACN,KAAKxC,QAAL,CAAcO,MADR,EACgB;AAAEkC,YAAAA,UAAU,EAAE;AAAA;AAAA,0CAAWC,OAAzB;AAAkCC,YAAAA,OAAO,EAAE;AAA3C,WADhB,EACoEhC,QADpE,CAC6E,EAD7E,EAGboC,OAHa,EAAlB;AAKD;;AAEMnG,QAAAA,UAAU,CAAC3B,MAAD,EAAS;AACxBlF,UAAAA,GAAG,CAAC8D,YAAJ,CAAiB2J,OAAjB,CAAyB,QAAzB,EAAmCvI,MAAnC;AACD;;AAESwI,QAAAA,eAAe,GAAS;AAChC,eAAKC,cAAL;AACA;AAAA;AAAA,gDAAeC,UAAf;AAAA;AAAA;AACD;;AACMD,QAAAA,cAAc,GAAG;AACtB,eAAK1H,QAAL,CAAc;AAAA;AAAA,wCAAW,IAAX,CAAd;AACA,eAAKA,QAAL,CAAc;AAAA;AAAA,sDAAkB,IAAlB,CAAd;AACA,eAAKA,QAAL,CAAc;AAAA;AAAA,kDAAgB,IAAhB,CAAd;AACA,eAAKA,QAAL,CAAc;AAAA;AAAA,gDAAe,IAAf,CAAd;AACA,eAAKA,QAAL,CAAc;AAAA;AAAA,8CAAc,IAAd,CAAd;AACA,eAAKA,QAAL,CAAc;AAAA;AAAA,oDAAiB,CAAjB,CAAd;AACA,eAAKA,QAAL,CAAc;AAAA;AAAA,kDAAgB,CAAhB,CAAd;AACA,eAAKA,QAAL,CAAc;AAAA;AAAA,4DAAqB,IAArB,CAAd;AACA,eAAKA,QAAL,CAAc;AAAA;AAAA,4DAAqB,EAArB,CAAd;AACA,eAAKA,QAAL,CAAc;AAAA;AAAA,wDAAmB,IAAnB,CAAd;AACA,eAAKA,QAAL,CAAc;AAAA;AAAA,kDAAgB,IAAhB,CAAd;AACA,eAAKA,QAAL,CAAc;AAAA;AAAA,wDAAmB,IAAnB,CAAd;AACA,eAAKA,QAAL,CAAc;AAAA;AAAA,0DAAoB,IAApB,CAAd;AACA,eAAKA,QAAL,CAAc;AAAA;AAAA,0DAAoB,IAApB,CAAd;AACA,eAAKA,QAAL,CAAc;AAAA;AAAA,sEAA0B,IAA1B,CAAd;AACA,eAAKA,QAAL,CAAc;AAAA;AAAA,wDAAmB,IAAnB,CAAd;AACD;;AACOoC,QAAAA,YAAY,CAAClD,QAAD,EAAmB;AACrC;AACA;AACA,cAAI,CAAC,KAAK6B,IAAL,CAAUC,KAAV,CAAgBC,SAAjB,IAA8B,KAAKF,IAAL,CAAUC,KAAV,CAAgBC,SAAhB,KAA8BC,SAAhE,EAA2E;AAAE;AAAQ;;AAAA;AACrF,gBAAMyC,IAAI,GAAG,CAAC,GAAG,KAAK5C,IAAL,CAAUC,KAAV,CAAgBC,SAApB,EAA+B2G,OAA/B,GAAyC5N,IAAzC,CAA8CoH,CAAC,IAAIA,CAAC,CAAClC,QAAF,KAAeA,QAAlE,CAAb;;AACA,cAAIyE,IAAJ,EAAU;AACR,mBAAOA,IAAI,CAAClE,KAAZ;AACD;;AACD,iBAAO;AAAA;AAAA,gCAAOC,UAAP,CAAkBC,WAAzB;AACD;;AAEO8F,QAAAA,aAAa,CAACoC,KAAD,EAAmB;AACtC,cAAI,CAACA,KAAD,IAAUA,KAAK,CAACnE,MAAN,KAAiB,CAA/B,EAAkC;AAChC,iBAAK1D,QAAL,CAAc;AAAA;AAAA,oEAAwB,IAAxB,CAAd;AACA;AACD;;AACD6H,UAAAA,KAAK,CAACrE,MAAN,CAAapC,CAAC,IAAIA,CAAC,CAAChC,IAAF,KAAW,CAA7B,EAAgC+B,OAAhC,CAAwCC,CAAC,IAAI;AAC3CA,YAAAA,CAAC,CAAC3B,KAAF,GAAU,KAAK2C,YAAL,CAAkBhB,CAAC,CAAClC,QAApB,CAAV;AACAkC,YAAAA,CAAC,CAAC0G,IAAF,GAASC,IAAI,CAACC,GAAL,EAAT;AACD,WAHD,EALsC,CAStC;;AAEA,eAAKhI,QAAL,CAAc;AAAA;AAAA,kEAAwB6H,KAAxB,CAAd;AACD;;AAGOhH,QAAAA,YAAY,GAAG;AACrB;AACA,cAAI;AAAA;AAAA,8CAAchC,SAAlB,EAA6B;AAC3B;AAAA;AAAA,gDAAcA,SAAd,CAAwBsC,OAAxB,CAAgC,CAAC8G,QAAD,EAAW5G,CAAX,KAAiB;AAC/C4G,cAAAA,QAAQ,CAACxI,KAAT,GAAiB4B,CAAjB;AACD,aAFD;AAID;;AACD,cAAI;AAAA;AAAA,8CAActC,UAAlB,EAA8B;AAC5B;AAAA;AAAA,gDAAcA,UAAd,CAAyBoC,OAAzB,CAAiC,CAAC+G,SAAD,EAAY7G,CAAZ,KAAkB;AACjD6G,cAAAA,SAAS,CAACzI,KAAV,GAAkB,IAAI4B,CAAtB;AACD,aAFD;AAID;;AAED,cAAI;AAAA;AAAA,8CAAcxC,SAAd,KAA4BqC,SAAhC,EAA2C;AAAE;AAAA;AAAA,gDAAcrC,SAAd,GAA0B,EAA1B;AAA8B;;AAAA;;AAC3E,cAAI;AAAA;AAAA,8CAAcE,UAAd,KAA6BmC,SAAjC,EAA4C;AAAE;AAAA;AAAA,gDAAcnC,UAAd,GAA2B,EAA3B;AAA+B;;AAAA,WAhBxD,CAiBrB;AACA;AACA;AAEA;AACA;AACA;AAGD;;AAEMgI,QAAAA,OAAO,GAAG;AACf,gBAAMoB,UAAU,GAAG,KAAKC,KAAL,CAAWC,QAAX,EAAnB;AAEA,eAAKC,MAAL,CAAY,EAAZ,EAAiBC,KAAD,IAAsB;AACpC,mBAAO;AACLC,cAAAA,WAAW,EAAED,KAAK,CAACE,OAAN,CAAcD,WADtB;AAELjJ,cAAAA,UAAU,EAAEgJ,KAAK,CAACG,QAAN,CAAenJ,UAFtB;AAGLL,cAAAA,QAAQ,EAAEqJ,KAAK,CAACG,QAAN,CAAexJ,QAHpB;AAILI,cAAAA,IAAI,EAAEiJ,KAAK,CAACG,QAAN,CAAepJ,IAJhB;AAKLF,cAAAA,IAAI,EAAEmJ,KAAK,CAACE,OAAN,CAAcrJ,IALf;AAMLI,cAAAA,OAAO,EAAE+I,KAAK,CAACG,QAAN,CAAelJ,OANnB;AAOL4F,cAAAA,OAAO,EAAEmD,KAAK,CAACG,QAAN,CAAetD,OAPnB;AAQLxF,cAAAA,SAAS,EAAE2I,KAAK,CAACE,OAAN,CAAc7I,SARpB;AASLW,cAAAA,QAAQ,EAAE,EATL;AAULgF,cAAAA,UAAU,EAAE,EAVP;AAWL1F,cAAAA,SAAS,EAAC0I,KAAK,CAACI,WAAN,CAAkB9I,SAXvB;AAYLC,cAAAA,YAAY,EAAEyI,KAAK,CAACI,WAAN,CAAkB7I,YAZ3B;AAaLC,cAAAA,aAAa,EAAEwI,KAAK,CAACI,WAAN,CAAkB5I,aAb5B;AAcLG,cAAAA,OAAO,EAAEqI,KAAK,CAACI,WAAN,CAAkBzI,OAdtB;AAeLC,cAAAA,UAAU,EAAEoI,KAAK,CAACI,WAAN,CAAkBxI,UAfzB;AAgBLlB,cAAAA,MAAM,EAAE,EAhBH;AAiBLmB,cAAAA,GAAG,EAAEmI,KAAK,CAACI,WAAN,CAAkBvI,GAjBlB;AAkBLI,cAAAA,OAAO,EAAE,CAlBJ;AAmBLmB,cAAAA,UAAU,EAAE,CAnBP;AAoBLhB,cAAAA,gBAAgB,EAAE,CApBb;AAqBLN,cAAAA,QAAQ,EAAEkI,KAAK,CAACE,OAAN,CAAcpI,QArBnB;AAsBLuI,cAAAA,WAAW,EAAE,IAtBR;AAuBLC,cAAAA,IAAI,EAAEN,KAAK,CAACI,WAAN,CAAkBE,IAvBnB;;AAwBL;AACAC,cAAAA,UAAU,EAAEP,KAAK,CAACE,OAAN,CAAcK,UAzBrB;AA0BL3K,cAAAA,MAAM,EAAEoK,KAAK,CAACQ,IAAN,CAAW5K,MA1Bd;AA2BL8C,cAAAA,SAAS,EAAEsH,KAAK,CAACQ,IAAN,CAAW9H,SA3BjB;AA4BL1D,cAAAA,SAAS,EAAEgL,KAAK,CAACQ,IAAN,CAAWxL,SA5BjB;AA6BLyL,cAAAA,UAAU,EAAET,KAAK,CAACQ,IAAN,CAAWC,UA7BlB;AA8BLC,cAAAA,WAAW,EAAEV,KAAK,CAACQ,IAAN,CAAWE,WA9BnB;AA+BL9J,cAAAA,QAAQ,EAAEoJ,KAAK,CAACQ,IAAN,CAAW5J,QA/BhB;AAgCL+J,cAAAA,aAAa,EAAEX,KAAK,CAACQ,IAAN,CAAWG;AAhCrB,aAAP;AAkCD,WAnCD;AAoCA,iBAAO,IAAP;AACD;;AAljBsF,O;;yBAqjB1E7L,yB","sourcesContent":["import { Node, Animation, animation, Tween, Vec2, Vec3, Sprite, sys, find, sp, Label, UITransform } from \"cc\";\r\nimport ViewModel, { StoreInject } from \"../../../base/ViewModel\";\r\nimport { DragonTiger_MainPanel, IProps, IEvent } from \"../components/DragonTiger_MainPanel\";\r\nimport { SKT_MAG_TYPE, removeInstance, sktInstance, sktMsgListener } from \"../socketConnect\";\r\nimport { bundleDragonTiger, dragonTiger_Audio, mainGameViewModel, sourceManageSeletor } from '../index';\r\nimport { PrefabPathDefine } from '../sourceDefine/prefabDefine';\r\nimport UsersGiftViewModel from \"./DragonTigerUsersGiftViewModel\";\r\nimport HelpViewModel from \"./DragonTigerRuleViewModel\";\r\nimport HistoryWinViewModel from './DragonTigerHistoryWinViewModel';\r\nimport SetViewModel from './DragonTigerSetViewModel';\r\nimport WinViewModel from './DragonTigerWinViewModel';\r\nimport LoseViewModel from \"./DragonTigerLoseViewModel\";\r\nimport DownViewModel from './DragonTigerDownViewModel';\r\nimport { EffectType } from \"../../../utils/NodeIOEffect\";\r\nimport { StateType } from \"../store/reducer\";\r\nimport { getStore } from '../store';\r\nimport { resetUserStore, setUserInfoAction } from '../store/actions/userInfo';\r\nimport { setHistoryListAction, setRoomLeftInfosAction, setRoomInfoSizeAction, setRoomRightInfosAction, setRoomWinInfosAction, setMemberBetAction, changeGoldAction, changeGameTypeAction, setMemberDataAction, resetHistoryStore } from '../store/actions/history';\r\nimport { setPokerLeftAction, setPokerRightAction, setSendedPAction, setWinAction, setReadyPAction, setTipsAction, setVipAction, setLevelAction, updatePokerInfo, resetPokerStore } from '../store/actions/pokerDetail';\r\nimport dragonTigerConfig, { initBetData } from '../config';\r\nimport UsersViewModel from \"./DragonTigerUsersViewModel\";\r\nimport TitleViewModel from \"./DragonTigerTitleViewModel\";\r\nimport OnlineViewModel from \"./DragonTigerOnlineViewModel\";\r\nimport { bundlePkgName } from \"../sourceDefine\"\r\nimport { global, lang } from \"../../../hall\";\r\nimport { addToastAction } from \"../../../hall/store/actions/baseBoard\";\r\nimport config from \"../config\";\r\nimport { changeAllWinUsersAction, changeCancelBetDataAction, changeGoldDataAction, resetStore, setCountDownAction, setMyInfoAction, setNewBetDataAction, setOnlineNumber, setUsersInfoAction } from \"../store/actions/game\";\r\nimport { ResGiftVo, WinUser, gameCacheData } from \"../type\";\r\n\r\nexport let winViewModel: WinViewModel\r\nexport let loseViewModel: LoseViewModel\r\nexport let historyViewModel: HistoryWinViewModel\r\nexport let downViewModel: DownViewModel\r\nexport let usersViewModel: UsersViewModel\r\nexport let onlineViewModel: OnlineViewModel\r\n@StoreInject(getStore())\r\nclass DragonTigerPanelViewModel extends ViewModel<DragonTiger_MainPanel, IProps, IEvent> {\r\n  public countDown: number;\r\n  // private isClick:boolean=false\r\n  constructor() {\r\n    super('DragonTiger_MainPanel')\r\n  }\r\n\r\n  protected begin() {\r\n    // sktInstance.sendSktMessage(SKT_MAG_TYPE.AUTH, window.location.search.substring(6))\r\n\r\n    //  sys.localStorage.setItem(\"token\",config.testConfig.token)\r\n    sktInstance.sendSktMessage(SKT_MAG_TYPE.AUTH, {\r\n      token: sys.localStorage.getItem(\"token\"),\r\n      gameId: config.gameId\r\n    })\r\n\r\n    sktMsgListener.add(SKT_MAG_TYPE.MY_INFO, bundlePkgName, (data) => {//4\r\n      if (!data || !data.myInfo) {\r\n        global.hallDispatch(addToastAction({ content: lang.write(k => k.InitGameModule.GameBoardInit, {}, { placeStr: \"game init failed\" }) }))\r\n        global.closeSubGame({ confirmContent: lang.write(k => k.InitGameModule.GameBoardInit) });\r\n        return;\r\n      }\r\n\r\n      // if (!data.myInfo) {\r\n      //   global.hallDispatch(addToastAction({ content: lang.write(k => k.InitGameModule.GameBoardInit, {}, { placeStr: \"game init failed\" }) }))\r\n      //   global.closeSubGame({ confirmContent: lang.write(k => k.InitGameModule.GameBoardInit) });\r\n      //   return;\r\n      // }\r\n      gameCacheData.leftUsers = data.roomLeftInfoVos;\r\n      gameCacheData.rightUsers = data.roomRightInfoVos;\r\n      gameCacheData.roomId = data.roomId;\r\n      gameCacheData.memberId = data.myInfo.memberId;\r\n      gameCacheData.goldData = data.goldData;\r\n      let myInfo = {\r\n        gold: data.myInfo.gold,\r\n        goldStr: data.myInfo.gold + \"\",\r\n        icon: data.myInfo.icon,\r\n        memberName: data.myInfo.memberName,\r\n        winGold: data.myInfo.winGold,\r\n        memberId: data.myInfo.memberId,\r\n        index: config.gameOption.lookOnIndex,\r\n        memberBet: data.myInfo.memberBet,\r\n      }\r\n      const pokerInfo = {\r\n        pokerLeftNum: data.pokerLeftNum,\r\n        pokerRightNum:data.pokerRightNum,\r\n      }\r\n      this.dispatch(setMyInfoAction(myInfo));\r\n      this.dispatch(setOnlineNumber(data.roomInfoSize));\r\n      this.dispatch(changeGoldDataAction(data.goldData));\r\n\r\n      this.dispatch(setUserInfoAction({ ...data.myInfo }));\r\n      this.dispatch(changeGoldAction(data.myInfo.gold))\r\n      this.dispatch(setSendedPAction(data.sendedP));\r\n      this.dispatch(setReadyPAction(data.readySendP));\r\n      this.dispatch(updatePokerInfo(pokerInfo))\r\n\r\n      // this.dispatch(setPokerLeftAction(data.pokerLeftNum));\r\n      // this.dispatch(setPokerRightAction(data.pokerRightNum));\r\n      this.dispatch(setRoomLeftInfosAction(data.roomLeftInfoVos));\r\n      this.dispatch(setRoomInfoSizeAction(data.roomInfoSize))\r\n      this.dispatch(setRoomRightInfosAction(data.roomRightInfoVos));\r\n      this.dispatch(setWinAction(data.win));\r\n      this.dispatch(changeGameTypeAction(data.gameType));\r\n      this.setProps({\r\n        oddsList: data.oddsList,\r\n        // gameType: data.gameType,\r\n      });\r\n      if (data.gameType === 1) {\r\n        this.dispatch(setCountDownAction(data.seconds));\r\n        this.countDown = data.seconds;\r\n        this.startCountdown();\r\n        this.setProps({\r\n          seconds: data.seconds,\r\n        })\r\n      };\r\n      if (data.gameType === 2) {\r\n        this.stopCountdown()\r\n      }\r\n      if (data.gameType === 3) {\r\n        this.setProps({\r\n          typeThreeSeconds: data.seconds\r\n        })\r\n      }\r\n      this.saveRoomId(data.roomId);\r\n      //榜上所有用户信息\r\n      this.setUsersInfo();\r\n      this.dispatch(setUsersInfoAction(gameCacheData.leftUsers.concat(gameCacheData.rightUsers)))\r\n      if (!this.comp.props.usersInfo || this.comp.props.usersInfo === undefined) { return };\r\n      this.comp.props.usersInfo.forEach((v, i) => {\r\n        usersViewModel.comp.initBSUsers(v, v.index)\r\n      })\r\n\r\n    })\r\n\r\n    sktMsgListener.add(SKT_MAG_TYPE.TOP_UP, bundlePkgName, (data) => {//10\r\n      this.dispatch(changeGoldAction(data));\r\n    })\r\n\r\n    sktMsgListener.add(SKT_MAG_TYPE.GAME_TIP, bundlePkgName, (data) => {//11\r\n      this.dispatch(setTipsAction(data))\r\n    })\r\n\r\n    sktMsgListener.add(SKT_MAG_TYPE.CRASH, bundlePkgName, (data) => {//801\r\n      this.dispatch(changeGameTypeAction(data.gameType));\r\n\r\n      this.setProps({\r\n        // durGameType: data.gameType,\r\n      })\r\n      if (data.gameType === 1) {\r\n        this.dispatch(setCountDownAction(data.seconds));\r\n        this.countDown = data.seconds;\r\n        this.startCountdown();\r\n\r\n        this.setProps({\r\n          betSeconds: data.seconds,\r\n        })\r\n\r\n        this.dispatch(setUsersInfoAction(gameCacheData.leftUsers.concat(gameCacheData.rightUsers)))\r\n      }\r\n      if (data.gameType === 2) {\r\n        this.stopCountdown();\r\n        this.updatePokerInfo(data.dragonTigerMemberDrawPrizeVo)\r\n        this.updateWinUserInfo(data.dragonTigerWinMemberVo)\r\n        if (data.dragonTigerSettlementVo) {\r\n          this.updateMyInfo(data.dragonTigerSettlementVo)\r\n        }\r\n\r\n      }\r\n      if (data.gameType === 3) {\r\n        this.setProps({\r\n          typeThreeSeconds: data.seconds\r\n        })\r\n      }\r\n    })\r\n\r\n    // sktMsgListener.add(SKT_MAG_TYPE.POKER, bundlePkgName, (data) => {//805\r\n    //   // console.log(\"805\",data.pokerLeftNum,data.pokerRightNum);\r\n    //   const pokerInfo = {\r\n    //     pokerLeftNum: data.pokerLeftNum,\r\n    //     pokerRightNum:data.pokerRightNum,\r\n    //   }\r\n    //   this.dispatch(updatePokerInfo(pokerInfo))\r\n    //   // this.dispatch(setPokerLeftAction(data.pokerLeftNum));\r\n    //   // this.dispatch(setPokerRightAction(data.pokerRightNum));\r\n    //   this.dispatch(setSendedPAction(data.sendedP));\r\n    //   this.dispatch(setReadyPAction(data.readySendP));\r\n    //   this.dispatch(setWinAction(data.win));\r\n    //   this.setProps({\r\n    //     oddNewList: data.list,\r\n    //   })\r\n    // })\r\n\r\n    sktMsgListener.add(SKT_MAG_TYPE.HISTORY, bundlePkgName, (data) => {//806\r\n      this.dispatch(setHistoryListAction({ ...data }))\r\n    })\r\n    sktMsgListener.add(SKT_MAG_TYPE.BET_ALL, bundlePkgName, (data) => {//802\r\n      gameCacheData.goldData = data.goldData;\r\n      const memberId = data.memberData.memberId;\r\n      const index = this.getSeatIndex(memberId);\r\n      const isMyBet = this.comp.props.myInfo.memberId === memberId;\r\n      const betData = initBetData(index, memberId, data.memberData.type, data.memberData.gold);\r\n      betData.isMyBet = isMyBet;\r\n      this.dispatch(setNewBetDataAction(betData));\r\n      this.dispatch(changeGoldDataAction(data.goldData))\r\n      this.dispatch(setMemberDataAction(data.memberData))\r\n    })\r\n    sktMsgListener.add(SKT_MAG_TYPE.BET_RESPONSE, bundlePkgName, (data) => {//803\r\n      if (!config.preBet) {\r\n        if (data) {\r\n          this.dispatch(setMemberBetAction(data.memberBet))\r\n          this.dispatch(setUserInfoAction({ ...data }))\r\n          this.dispatch(changeGoldAction(data.gold))\r\n        } else {\r\n          global.hallDispatch(addToastAction({ content: lang.write(k => k.palyingModule.RechangeGlod, {}, { placeStr: \"对不起，您的金币不足，请充值!\" }) }))\r\n        }\r\n      } else if (data.resultCode === 0) {\r\n        this.dispatch(setMemberBetAction(data.memberBet))\r\n        const sendBet = {\r\n          roomId: gameCacheData.roomId,\r\n          memberId: this.comp.props.memberId,\r\n          memberName: this.comp.props.memberName,\r\n          gold: data.betAmount,\r\n          betType: data.betType,\r\n          isMe: true,\r\n          betId: data.betId\r\n        }\r\n        this.comp.amountArr.push(sendBet);\r\n        this.dispatch(changeGoldAction(data.gold))\r\n        this.dispatch(setUserInfoAction({ ...data }))\r\n\r\n      } else if (data.resultCode !== undefined && data.resultCode !== 0) {\r\n        this.dispatch(setMemberBetAction(data.memberBet))\r\n        this.dispatch(setUserInfoAction({ ...data }))\r\n        this.dispatch(changeGoldAction(data.gold));\r\n        const betData = initBetData(this.comp.props.myInfo.index, this.comp.props.myInfo.memberId, data.betType, data.betAmount);\r\n        betData.isMyBet = true;//当前用户是否下注\r\n        betData.betId = data.betId;\r\n        this.dispatch(changeCancelBetDataAction(betData))\r\n\r\n      }\r\n    })\r\n    // sktMsgListener.add(SKT_MAG_TYPE.SETTLEMENT, bundlePkgName, (data) => {//804\r\n    //   let myInfo = {\r\n    //     gold: data.myInfo.gold,\r\n    //     goldStr: data.myInfo.gold + \"\",\r\n    //     icon: data.myInfo.icon,\r\n    //     memberName: data.myInfo.memberName,\r\n    //     winGold: data.myInfo.winGold,\r\n    //     memberId: data.myInfo.memberId,\r\n    //     index: config.gameOption.lookOnIndex,\r\n    //     memberBet: data.myInfo.memberBet,\r\n    //     winType: data.myInfo\r\n    //   }\r\n    //   gameCacheData.winList = data.roomWinInfo;\r\n    //   // const myHead = convertHeadType(data.myInfo);\r\n    //   this.dispatch(setMyInfoAction(myInfo));\r\n    //   this.dispatch(setOnlineNumber(data.roomInfoSize));\r\n\r\n    //   this.dispatch(setUserInfoAction({ ...data.myInfo }));\r\n    //   this.dispatch(changeGoldAction(data.myInfo.gold))\r\n    //   this.dispatch(setMemberBetAction(data.myInfo.memberBet))\r\n    //   this.dispatch(setRoomWinInfosAction(data.roomWinInfo))\r\n    //   this.dispatch(setRoomLeftInfosAction(data.roomLeftInfoVos));\r\n    //   this.dispatch(setRoomRightInfosAction(data.roomRightInfoVos));\r\n\r\n    // })\r\n    sktMsgListener.add(SKT_MAG_TYPE.ALL_USERS, bundlePkgName, (data) => {//807\r\n      this.dispatch(setOnlineNumber(data));\r\n      this.dispatch(setRoomInfoSizeAction(data))\r\n    })\r\n    // sktMsgListener.add(SKT_MAG_TYPE.OTHER_WIN, bundlePkgName, (data) => {//808\r\n\r\n    //   this.updateWinloss(data.list)\r\n    //   gameCacheData.leftUsers = data.roomLeftInfoVos;\r\n    //   gameCacheData.rightUsers = data.roomRightInfoVos;\r\n    //   //榜上所有用户信息\r\n    //   this.setUsersInfo();\r\n    //   this.dispatch(changeAllWinUsersAction(data.list))\r\n\r\n    // })\r\n    sktMsgListener.add(SKT_MAG_TYPE.GAME_SHOW, bundlePkgName, (data) => {//810\r\n      if (1 === this.comp.props.gameType) {\r\n        // 拿到最新的倒计时后，就减掉1秒\r\n        this.countDown = data.seconds;\r\n        this.startCountdown();\r\n      }\r\n    })\r\n\r\n    sktMsgListener.add(SKT_MAG_TYPE.GIVE_GIFT, bundlePkgName, (data: ResGiftVo) => {//11\r\n      const seats = this.comp.props.usersInfo.filter(v => v.memberId === data.receiveMemberId);\r\n      // 如果展示座位上有两个相同人，就同时送两次\r\n      if (seats && seats.length > 1) {\r\n        seats.forEach(seat => {\r\n          const { x, y } = config.headLocations[seat.index];\r\n          const endPos = this.viewNode.getComponent(UITransform).convertToWorldSpaceAR(new Vec3(x, y))\r\n          global.flyGift(data.giveMemberId, data.receiveMemberId, this.getHeadPos(data.giveMemberId, true), endPos, data.giftId, this.viewNode.parent);\r\n        })\r\n      } else {\r\n        global.flyGift(data.giveMemberId, data.receiveMemberId, this.getHeadPos(data.giveMemberId, true),\r\n          this.getHeadPos(data.receiveMemberId, false), data.giftId, this.viewNode.parent);\r\n      }\r\n    })\r\n\r\n    this.openUsers();\r\n    this.openTitle();\r\n    this.openOnline();\r\n\r\n    this.setEvent({\r\n      openHistoryPanel: () => {\r\n        this.openHistory();\r\n      },\r\n      giveUsersGift: () => { },\r\n\r\n      openWinPanel: () => {\r\n        this.openWin();\r\n      },\r\n\r\n      openLosePanel: () => {\r\n        this.openLose();\r\n      },\r\n\r\n    })\r\n  }\r\n\r\n  /**更新结算后的用户信息 */\r\n  private updateMyInfo(data) {\r\n    this.comp.scheduleOnce(() => {\r\n      let myInfo = {\r\n        gold: data.myInfo.gold,\r\n        goldStr: data.myInfo.gold + \"\",\r\n        icon: data.myInfo.icon,\r\n        memberName: data.myInfo.memberName,\r\n        winGold: data.myInfo.winGold,\r\n        memberId: data.myInfo.memberId,\r\n        index: config.gameOption.lookOnIndex,\r\n        memberBet: data.myInfo.memberBet,\r\n        winType: data.myInfo\r\n      }\r\n      /**弹窗前四位赢的玩家 */\r\n      gameCacheData.winList = data.roomWinInfo;\r\n      // const myHead = convertHeadType(data.myInfo);\r\n      this.dispatch(setMyInfoAction(myInfo));\r\n      this.dispatch(setOnlineNumber(data.roomInfoSize));\r\n  \r\n      this.dispatch(setUserInfoAction({ ...data.myInfo }));\r\n      this.dispatch(changeGoldAction(data.myInfo.gold))\r\n      this.dispatch(setMemberBetAction(data.myInfo.memberBet))\r\n      this.dispatch(setRoomWinInfosAction(data.roomWinInfo))\r\n      this.dispatch(setRoomLeftInfosAction(data.roomLeftInfoVos));\r\n      this.dispatch(setRoomRightInfosAction(data.roomRightInfoVos));\r\n    },5)\r\n  }\r\n\r\n /**更新牌的信息 */\r\n  private updatePokerInfo(data) {\r\n    const pokerInfo = {\r\n      pokerLeftNum: data.pokerLeftNum,\r\n      pokerRightNum:data.pokerRightNum,\r\n    }\r\n    this.dispatch(updatePokerInfo(pokerInfo))\r\n    // this.dispatch(setPokerLeftAction(data.pokerLeftNum));\r\n    // this.dispatch(setPokerRightAction(data.pokerRightNum));\r\n    this.dispatch(setSendedPAction(data.sendedP));\r\n    this.dispatch(setReadyPAction(data.readySendP));\r\n    this.dispatch(setWinAction(data.win));\r\n    this.setProps({\r\n      oddNewList: data.list,\r\n    })\r\n  }\r\n  /**更新每局所有赢的玩家信息 */\r\n  private updateWinUserInfo(data) {\r\n    this.comp.scheduleOnce(() => {\r\n      this.updateWinloss(data.list)\r\n        gameCacheData.leftUsers = data.roomLeftInfoVos;\r\n        gameCacheData.rightUsers = data.roomRightInfoVos;\r\n        //榜上所有用户信息\r\n        this.setUsersInfo();\r\n        this.dispatch(changeAllWinUsersAction(data.list))\r\n    },5)\r\n  }\r\n\r\n\r\n  /**获得获得用户所在位置 */\r\n  private getHeadPos(memberId: string, isFrom: boolean) {\r\n    const seat = this.comp.props.usersInfo.find(v => v.memberId === memberId);\r\n    let pos;\r\n    if (seat) {\r\n      const { x, y } = config.headLocations[seat.index];\r\n      pos = new Vec3(x, y);\r\n    } else if (isFrom && this.comp.props.myInfo.memberId === memberId) {\r\n      pos = config.gameOption.myHeadPosition;\r\n    } else if (isFrom) {\r\n      pos = config.gameOption.onlineNumberPosition;\r\n    } else {\r\n      return undefined;\r\n    }\r\n\r\n    return this.viewNode.getComponent(UITransform).convertToWorldSpaceAR(pos);\r\n  }\r\n\r\n  // 开始倒计时\r\n  private timer: number = 0;\r\n  private startCountdown() {\r\n    if (this.timer > 0) {\r\n      window.clearInterval(this.timer);\r\n      this.timer = 0;\r\n    }\r\n    this.dispatch(setCountDownAction(this.countDown--));\r\n    this.timer = window.setInterval(() => {\r\n      this.dispatch(setCountDownAction(this.countDown--));\r\n      if (this.countDown <= 0) {\r\n        window.clearInterval(this.timer);\r\n        // this.stopCountdown();//测试为0时不展示时钟\r\n        this.timer = 0;\r\n      }\r\n    }, 1000)\r\n  }\r\n  /**停止倒计时 */\r\n  private stopCountdown() {\r\n    // 如果倒计时已经为0了，不处理了\r\n    if (this.comp.props.countDown <= 0) {\r\n      return;\r\n    }\r\n    this.timer && window.clearInterval(this.timer);\r\n    this.timer = 0;\r\n    this.dispatch(setCountDownAction(0));\r\n  }\r\n\r\n  public openGiftBox(nodeWrap?: Node) { }\r\n  public openHistory(nodeWrap?: Node) {\r\n    historyViewModel = new HistoryWinViewModel().mountView(sourceManageSeletor().getFile(PrefabPathDefine.MAIN_HISTORY_WIN).source)\r\n      .appendTo(find(\"Canvas\"), { effectType: EffectType.EFFECT1, isModal: true }).setEvent({\r\n        onClosePanel: () => {\r\n          historyViewModel.unMount(EffectType.EFFECT2)\r\n        }\r\n      }).connect()\r\n  }\r\n\r\n  public openWin(nodeWrap?: Node) {\r\n    winViewModel = new WinViewModel().mountView(sourceManageSeletor().getFile(PrefabPathDefine.MAIN_WIN).source)\r\n      .appendTo(find(\"Canvas\"), { effectType: EffectType.EFFECT1, isModal: true }).setEvent({\r\n        onClosePanel: () => {\r\n          winViewModel.unMount(EffectType.EFFECT2)\r\n        }\r\n\r\n      }).connect()\r\n\r\n  }\r\n\r\n\r\n  public openLose(nodeWrap?: Node) {\r\n    loseViewModel = new LoseViewModel().mountView(sourceManageSeletor().getFile(PrefabPathDefine.MAIN_LOSE).source)\r\n      .appendTo(find(\"Canvas\"), { effectType: EffectType.EFFECT1, isModal: true }).setEvent({\r\n        onClosePanel: () => {\r\n          loseViewModel.unMount(EffectType.EFFECT2)\r\n        }\r\n      }).connect()\r\n  }\r\n  public openUsers(nodeWrap?: Node) {\r\n    usersViewModel = new UsersViewModel().mountView(sourceManageSeletor().getFile(PrefabPathDefine.MAIN_USERS).source)\r\n      .appendTo(this.viewNode.parent, { effectType: EffectType.EFFECT1, isModal: false }).setEvent({\r\n\r\n      }).connect()\r\n\r\n  }\r\n\r\n  public openTitle(nodeWrap?: Node) {\r\n    new TitleViewModel().mountView(sourceManageSeletor().getFile(PrefabPathDefine.MAIN_TITLE).source)\r\n      .appendTo(this.viewNode.parent, { effectType: EffectType.EFFECT1, isModal: false }).setEvent({\r\n\r\n      }).connect()\r\n\r\n  }\r\n  public openOnline(nodeWrap?: Node) {\r\n    onlineViewModel = new OnlineViewModel().mountView(sourceManageSeletor().getFile(PrefabPathDefine.MAIN_ONLINES).source)\r\n      .appendTo(this.viewNode.parent, { effectType: EffectType.EFFECT1, isModal: false }).setEvent({\r\n\r\n      }).connect()\r\n\r\n  }\r\n\r\n  public saveRoomId(roomId) {\r\n    sys.localStorage.setItem(\"roomId\", roomId)\r\n  }\r\n\r\n  protected unMountCallBack(): void {\r\n    this.clearCacheData();\r\n    sktMsgListener.removeById(bundlePkgName)\r\n  }\r\n  public clearCacheData() {\r\n    this.dispatch(resetStore(null));\r\n    this.dispatch(resetHistoryStore(null));\r\n    this.dispatch(resetPokerStore(null));\r\n    this.dispatch(resetUserStore(null));\r\n    this.dispatch(setTipsAction(null));\r\n    this.dispatch(setSendedPAction(0));\r\n    this.dispatch(setReadyPAction(0));\r\n    this.dispatch(changeGameTypeAction(null));\r\n    this.dispatch(changeGoldDataAction({}));\r\n    this.dispatch(setMemberBetAction(null));\r\n    this.dispatch(updatePokerInfo(null));\r\n    this.dispatch(setPokerLeftAction(null));\r\n    this.dispatch(setPokerRightAction(null));\r\n    this.dispatch(setNewBetDataAction(null));\r\n    this.dispatch(changeCancelBetDataAction(null));\r\n    this.dispatch(setUsersInfoAction(null));\r\n  }\r\n  private getSeatIndex(memberId: string) {\r\n    // 倒起找，原因是因为有可能重复上榜，右边上榜优先\r\n    // console.log(this.comp.props.usersInfo);\r\n    if (!this.comp.props.usersInfo || this.comp.props.usersInfo === undefined) { return };\r\n    const seat = [...this.comp.props.usersInfo].reverse().find(v => v.memberId === memberId);\r\n    if (seat) {\r\n      return seat.index;\r\n    }\r\n    return config.gameOption.lookOnIndex;\r\n  }\r\n\r\n  private updateWinloss(users: WinUser[]) {\r\n    if (!users || users.length === 0) {\r\n      this.dispatch(changeAllWinUsersAction(null))\r\n      return;\r\n    }\r\n    users.filter(v => v.gold !== 0).forEach(v => {\r\n      v.index = this.getSeatIndex(v.memberId);\r\n      v.time = Date.now()\r\n    })\r\n    // console.log(\"users-----\",users);\r\n\r\n    this.dispatch(changeAllWinUsersAction(users))\r\n  }\r\n\r\n\r\n  private setUsersInfo() {\r\n    /** 初始化榜上用户信息 */\r\n    if (gameCacheData.leftUsers) {\r\n      gameCacheData.leftUsers.forEach((leftItem, i) => {\r\n        leftItem.index = i\r\n      })\r\n\r\n    }\r\n    if (gameCacheData.rightUsers) {\r\n      gameCacheData.rightUsers.forEach((rightItem, i) => {\r\n        rightItem.index = 3 + i;\r\n      })\r\n\r\n    }\r\n\r\n    if (gameCacheData.leftUsers === undefined) { gameCacheData.leftUsers = [] };\r\n    if (gameCacheData.rightUsers === undefined) { gameCacheData.rightUsers = [] };\r\n    // console.log(\"gameCacheData.leftUsers\", gameCacheData.leftUsers);\r\n    // console.log(\"gameCacheData.rightUsers\",gameCacheData.rightUsers);\r\n    // console.log(gameCacheData.leftUsers.concat(gameCacheData.rightUsers));\r\n\r\n    // window.setTimeout(()=>{\r\n    // this.dispatch(setUsersInfoAction(gameCacheData.leftUsers.concat(gameCacheData.rightUsers)))\r\n    // },4000)\r\n\r\n\r\n  }\r\n\r\n  public connect() {\r\n    const storeState = this.store.getState() as StateType;\r\n\r\n    this.inject({}, (state: StateType) => {\r\n      return {\r\n        historyList: state.history.historyList,\r\n        memberName: state.userInfo.memberName,\r\n        memberId: state.userInfo.memberId,\r\n        icon: state.userInfo.icon,\r\n        gold: state.history.gold,\r\n        winGold: state.userInfo.winGold,\r\n        winType: state.userInfo.winType,\r\n        memberBet: state.history.memberBet,\r\n        oddsList: [],\r\n        oddNewList: [],\r\n        pokerInfo:state.pokerDetail.pokerInfo,\r\n        pokerLeftNum: state.pokerDetail.pokerLeftNum,\r\n        pokerRightNum: state.pokerDetail.pokerRightNum,\r\n        sendedP: state.pokerDetail.sendedP,\r\n        readySendP: state.pokerDetail.readySendP,\r\n        roomId: \"\",\r\n        win: state.pokerDetail.win,\r\n        seconds: 0,\r\n        betSeconds: 0,\r\n        typeThreeSeconds: 0,\r\n        gameType: state.history.gameType,\r\n        durGameType: null,\r\n        tips: state.pokerDetail.tips,\r\n        /**选择的筹码 */\r\n        selectChip: state.history.selectChip,\r\n        myInfo: state.game.myInfo,\r\n        usersInfo: state.game.usersInfo,\r\n        countDown: state.game.countDown,\r\n        newBetData: state.game.newBetData,\r\n        allWinUsers: state.game.allWinUsers,\r\n        goldData: state.game.goldData,\r\n        cancelBetData: state.game.cancelBetData,\r\n      }\r\n    })\r\n    return this\r\n  }\r\n}\r\n\r\nexport default DragonTigerPanelViewModel\r\n"]}