{"version":3,"sources":["file:///Users/geliang/web/dibai/hall/assets/script/subGame/yxx/components/Yxx_Test.ts"],"names":["_decorator","Button","Node","BaseComponent","changeOnlineNumber","changeSeatBet","joinGame","otherJoinGame","quitGame","seatBet","GameStatus","config","initBetData","initHeadType","changeGameStatus","countdown","ccclass","property","Yxx_Test","propertyNode","props_bet_btn","props_online","props_join","props_other_join","props_start_game","props_quit_game","props","seats","onlineNumber","gameStatus","events","otherIndex","t","start","initState","bindEvent","node","on","EventType","TOUCH_END","bet","dispatch","BET","headType","random","gameOption","seatNumber","has","headUrl","gold","goldStr","userId","Date","parse","toString","level","name","winloss","startCountdown","count","window","setInterval","clearInterval","result","time","betTypes","randomBetType","STOP_BET","setTimeout","isMyBet","index","Math","floor","chipIndex","chipTypes","length","betData","value","max","useProps","key","cur","bindUI","update","deltaTime"],"mappings":"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","sourcesContent":["import { _decorator, Button, Component, Game, log, Node } from 'cc';\r\nimport { BaseComponent } from '../../../base/BaseComponent';\r\nimport { changeOnlineNumber, changeSeat, changeSeatBet, initState, joinGame, otherJoinGame, quitGame } from '../store/actions/game';\r\nimport { seatBet } from '../store/actions/bet';\r\nimport { BetData, BetType, GameStatus, HeadType, Result } from '../type';\r\nimport config, { initBetData, initHeadType } from '../config';\r\nimport { changeGameStatus, countdown } from '../store/actions/gameFlow';\r\nconst { ccclass, property } = _decorator;\r\n\r\nexport interface IState {\r\n\r\n}\r\n\r\nexport interface IProps {\r\n\tseats: HeadType[],\r\n\tonlineNumber: number,\r\n\tgameStatus: GameStatus\r\n}\r\nexport interface IEvent {\r\n\r\n}\r\n\r\n@ccclass('Yxx_Test')\r\nexport class Yxx_Test extends BaseComponent<IState, IProps, IEvent> {\r\n\tstart() {\r\n\r\n\t}\r\n\r\n\tprotected propertyNode = {\r\n\t\tprops_bet_btn: new Button(),\r\n\t\tprops_online: new Button(),\r\n\t\tprops_join: new Button(),\r\n\t\tprops_other_join: new Button(),\r\n\t\tprops_start_game: new Button(),\r\n\t\tprops_quit_game: new Button(),\r\n\t}\r\n\r\n\tpublic props: IProps = {\r\n\t\tseats: [],\r\n\t\tonlineNumber: 0,\r\n\t\tgameStatus: null\r\n\t}\r\n\r\n\tpublic events: IEvent = {\r\n\r\n\t}\r\n\r\n\tprotected initState() {\r\n\t\treturn {\r\n\r\n\t\t}\r\n\t}\r\n\r\n\tprivate otherIndex = 0;\r\n\tprotected bindEvent(): void {\r\n\t\tthis.propertyNode.props_bet_btn.node.on(Node.EventType.TOUCH_END, () => {\r\n\t\t\tthis.bet();\r\n\t\t})\r\n\r\n\t\tthis.propertyNode.props_online.node.on(Node.EventType.TOUCH_END, () => {\r\n\t\t\tthis.dispatch(changeOnlineNumber(this.props.onlineNumber + 1));\r\n\t\t});\r\n\r\n\t\tthis.propertyNode.props_start_game.node.on(Node.EventType.TOUCH_END, () => {\r\n\t\t\tthis.dispatch(changeGameStatus(GameStatus.BET, 5, null));\r\n\t\t});\r\n\r\n\t\tthis.propertyNode.props_join.node.on(Node.EventType.TOUCH_END, () => {\r\n\t\t\tconst headType = initHeadType(this.random(config.gameOption.seatNumber));\r\n\t\t\theadType.has = true;\r\n\t\t\theadType.headUrl = \"\";\r\n\t\t\theadType.gold = 100000;\r\n\t\t\theadType.goldStr = '';\r\n\t\t\theadType.userId = Date.parse(new Date().toString()).toString();\r\n\t\t\theadType.level = this.random(3) + 1;\r\n\t\t\theadType.name = '大佬';\r\n\t\t\theadType.winloss = 0;\r\n\t\t\tthis.dispatch(joinGame(headType));\r\n\t\t});\r\n\t\tthis.propertyNode.props_other_join.node.on(Node.EventType.TOUCH_END, () => {\r\n\t\t\tthis.otherIndex = this.random(config.gameOption.seatNumber);\r\n\r\n\t\t\tconst headType = initHeadType(this.otherIndex);\r\n\t\t\theadType.has = true;\r\n\t\t\theadType.headUrl = \"\";\r\n\t\t\theadType.gold = 100000;\r\n\t\t\theadType.goldStr = '';\r\n\t\t\theadType.userId = Date.parse(new Date().toString()).toString();\r\n\t\t\theadType.level = 3;\r\n\t\t\theadType.name = \"外专局还是-\" + this.otherIndex\r\n\t\t\theadType.winloss = 0;\r\n\r\n\t\t\tthis.dispatch(otherJoinGame(headType));\r\n\t\t});\r\n\r\n\t\tthis.propertyNode.props_quit_game.node.on(Node.EventType.TOUCH_END, () => {\r\n\t\t\tthis.quitGame();\r\n\t\t});\r\n\t}\r\n\r\n\tprivate t: number = 0;\r\n\tprivate startCountdown(count: number) {\r\n\t\tif (this.t > 0) return;\r\n\t\tthis.dispatch(countdown(count));\r\n\t\tthis.t = window.setInterval(() => {\r\n\t\t\tthis.dispatch(countdown(--count));\r\n\t\t\tif (count <= 0) {\r\n\t\t\t\twindow.clearInterval(this.t);\r\n\t\t\t\tthis.t = 0;\r\n\r\n\t\t\t\tconst result: Result = {\r\n\t\t\t\t\ttime: Date.parse(new Date().toString()),\r\n\t\t\t\t\tbetTypes: [\r\n\t\t\t\t\t\tthis.randomBetType(),\r\n\t\t\t\t\t\tthis.randomBetType(),\r\n\t\t\t\t\t\tthis.randomBetType(),\r\n\t\t\t\t\t\t// BetType.CHOOK,\r\n\t\t\t\t\t\t// BetType.CHOOK,\r\n\t\t\t\t\t\t// BetType.CHOOK,\r\n\t\t\t\t\t]\r\n\t\t\t\t}\r\n\r\n\t\t\t\tthis.dispatch(changeGameStatus(GameStatus.STOP_BET, 0, result));\r\n\r\n\t\t\t\twindow.setTimeout(() => {\r\n\t\t\t\t\tthis.dispatch(changeGameStatus(GameStatus.BET, count, result));\r\n\t\t\t\t}, 13000);\r\n\t\t\t}\r\n\t\t}, 1000)\r\n\t}\r\n\r\n\tprivate bet(): void {\r\n\t\tif (this.props.gameStatus !== GameStatus.BET) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tlet isMyBet = false;\r\n\t\tlet index = Math.floor(Math.random() * config.gameOption.seatNumber + 1);\r\n\t\t// index = this.otherIndex;\r\n\t\tlet chipIndex = Math.floor(Math.random() * config.chipTypes.length);\r\n\r\n\t\tconst betData = initBetData(index, \"1\", this.randomBetType(), config.chipTypes[chipIndex].value)\r\n\t\tbetData.isMyBet = isMyBet;\r\n\t\tthis.dispatch(seatBet(betData));\r\n\t\tthis.dispatch(changeSeatBet(betData));\r\n\t}\r\n\r\n\tprivate randomBetType(): BetType {\r\n\t\treturn this.random(6) + 1;\r\n\t}\r\n\r\n\tprivate quitGame() {\r\n\t\t// let index = Math.floor(Math.random() * config.gameOption.seatNumber);\r\n\r\n\t\tthis.dispatch(quitGame(this.props.seats[this.otherIndex].userId));\r\n\r\n\t}\r\n\r\n\tprivate random(max: number) {\r\n\t\treturn Math.floor(Math.random() * max)\r\n\t}\r\n\r\n\tprotected useProps(key: keyof IProps, value: { pre: any, cur: any }) {\r\n\t\tif (key === 'gameStatus') {\r\n\t\t\tif (value.cur === GameStatus.BET) {\r\n\t\t\t\tthis.startCountdown(5);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tprotected bindUI(): void {\r\n\r\n\t}\r\n\r\n\tupdate(deltaTime: number) {\r\n\r\n\t}\r\n}\r\n\r\n"]}