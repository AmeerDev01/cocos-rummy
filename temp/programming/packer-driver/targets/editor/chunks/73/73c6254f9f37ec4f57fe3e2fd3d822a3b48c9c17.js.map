{"version":3,"sources":["file:///Users/geliang/web/dibai/hall/assets/script/subGame/gxfcV2/components/GxfcV2_Icon.ts"],"names":["GxfcV2Icon","UITransform","Vec3","instantiate","sp","Sprite","sourceManageSeletor","PrefabPathDefine","getNodeByNameDeep","IconId","config","SpriteFramePathDefine","SkeletalPathDefine","SkeletonAnimationPlayer","constructor","iconConfig","isPoolObject","node","faceNode","faceAnimationNode","skeleton","sprite","use","iconIndex","borderNode","amountNode","amount","callback","getFile","ICON","source","getComponent","width","normalRollOption","singleRollerWidth","height","singleRollerHeight","Skeleton","active","removeFromParent","buildIcon","listenerSkeletonEvent","setCompleteListener","isValid","hideWin","resetIcon","parentNode","addChild","setScale","scale","getId","id","restore","skeletonData","skeletonName","setAnimation","animationArr","spriteFrame","fileName","destory","getNode","getHeight","getIconIndex","setPosition","value","offset","distance","setWorldPosition","worldPosition","clone","add","setJinWildPosition","getPosition","playWin","isBorder","loop","parent","SCATTER","playBeetleAnimation","done","setSiblingIndex","children","length","playJinWild","WILD2","playAnimation","playScatterWin","count","skeletonPlayer","stopAnimation","clearTracks","pauseWin","WILD1","icon_jinfa","changeToJinWild","icon_jin_wild","isUse","setAmount","showBg","getChildByName","hideBg","showAmount","hideAmount","getAmountNode","getAmount","destroy"],"mappings":"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","sourcesContent":["import { Node, UITransform, Vec3, instantiate, sp, Sprite, Label, Mask, Graphics } from \"cc\";\r\nimport { sourceManageSeletor } from \"../index\";\r\nimport { PrefabPathDefine } from \"../sourceDefine/prefabDefine\";\r\nimport { getNodeByNameDeep } from \"../../../utils/tool\";\r\nimport { IconId } from \"../type\";\r\nimport config from \"../config\";\r\nimport { SpriteFramePathDefine } from \"../sourceDefine/spriteDefine\";\r\nimport { SkeletalPathDefine } from \"../sourceDefine/skeletalDefine\";\r\nimport SkeletonAnimationPlayer from \"../../../utils/SkeletonPlay\";\r\n\r\nexport class GxfcV2Icon {\r\n  private node: Node;\r\n  public faceNode: Node;\r\n  private faceAnimationNode: Node;\r\n  private iconConfig;\r\n  private skeleton: sp.Skeleton;\r\n  private sprite: Sprite\r\n  private use = false;\r\n  private iconIndex = 0;\r\n\r\n  private borderNode: Node;\r\n  private amountNode: Node;\r\n\r\n  private amount: number = 0;\r\n\r\n  private isPoolObject = true;\r\n  private callback;\r\n\r\n  constructor(iconConfig, isPoolObject: boolean = true) {\r\n    this.iconConfig = iconConfig;\r\n    this.isPoolObject = isPoolObject;\r\n    this.node = instantiate(sourceManageSeletor().getFile(PrefabPathDefine.ICON).source);\r\n    this.node.getComponent(UITransform).width = config.normalRollOption.singleRollerWidth;\r\n    this.node.getComponent(UITransform).height = config.normalRollOption.singleRollerHeight;\r\n\r\n    this.faceNode = getNodeByNameDeep(\"face\", this.node);\r\n    this.faceAnimationNode = getNodeByNameDeep(\"face-animation\", this.node);\r\n\r\n    this.sprite = this.faceNode.getComponent(Sprite);\r\n    this.skeleton = this.faceAnimationNode.getComponent(sp.Skeleton);\r\n\r\n    this.borderNode = getNodeByNameDeep(\"focusBorder\", this.node);\r\n    this.borderNode.active = true;\r\n    this.borderNode.removeFromParent();\r\n\r\n    // if (this.isBeetleIcon() || this.isSunGod()) {\r\n      // this.amountNode = getNodeByNameDeep(\"amount\", this.node);\r\n      // this.amountNode.active = true;\r\n      // this.amountNode.getComponent(Label).string = this.isBeetleIcon() ? \"0\" : \"\";\r\n      // this.listenerSkeletonEvent();\r\n      // this.amount = 0;\r\n    // }\r\n\r\n    this.buildIcon();\r\n  }\r\n\r\n  // public isBeetleIcon() {\r\n    // return this.iconConfig.id === IconId.BEETLE\r\n  // }\r\n\r\n  // public isSunGod() {\r\n    // return this.iconConfig.id === IconId.SUN_GOD\r\n  // }\r\n\r\n  private listenerSkeletonEvent() {\r\n    this.skeleton.setCompleteListener(() => {\r\n      if (this.node.isValid && this.callback) {\r\n        this.callback && this.callback();\r\n        this.callback = null;\r\n        this.hideWin();\r\n      }\r\n    })\r\n  }\r\n\r\n  /**获得图标 */\r\n  public resetIcon(iconConfig, parentNode?: Node, iconIndex?: number) {\r\n    \r\n    this.use = true;\r\n    this.iconConfig = iconConfig;\r\n    this.iconIndex = iconIndex;\r\n    parentNode && parentNode.addChild(this.node);\r\n    this.node.setScale(iconConfig.scale[0], iconConfig.scale[1]);\r\n    this.faceAnimationNode.setScale(iconConfig.scale[0], iconConfig.scale[1]);\r\n    // if (parentNode && parentNode.name === \"props_wild_icon_list\") {\r\n    //   console.log(\"this.node\",this.node);\r\n      \r\n    //   console.log(\"parentNode\",parentNode);\r\n    //   console.log(\"iconConfig\",iconConfig);\r\n      \r\n    // }\r\n  }\r\n\r\n  public getId() {\r\n    return this.iconConfig.id;\r\n  }\r\n\r\n  /**归还到缓存池 */\r\n  public restore() {\r\n    if (this.node && this.node.isValid) {\r\n      this.use = false;\r\n      this.iconIndex = -1;\r\n      this.node.active = true;\r\n      this.node.removeFromParent();\r\n      // if (this.amountNode) {\r\n        // this.amount = 0;\r\n        // this.amountNode.getComponent(Label).string = this.isBeetleIcon() ? '0' : '';\r\n      // }\r\n      const skeletonData = sourceManageSeletor().getFile(this.iconConfig.skeletonName).source;\r\n      this.skeleton.skeletonData = skeletonData;\r\n      this.skeleton.setAnimation(0, this.iconConfig.animationArr[0], false);\r\n      this.sprite.spriteFrame = sourceManageSeletor().getFile(this.iconConfig.fileName).source;\r\n      !this.isPoolObject && this.destory();\r\n    }\r\n  }\r\n\r\n  public getNode() {\r\n    return this.node;\r\n  }\r\n\r\n  public getHeight() {\r\n    return this.node.getComponent(UITransform).height;\r\n  }\r\n\r\n  public getIconIndex() {\r\n    return this.iconIndex;\r\n  }\r\n\r\n  public setPosition(value: Vec3) {\r\n    if (this.node) {\r\n      this.node.setPosition(value);\r\n      const offset = new Vec3(this.iconConfig.distance[0], this.iconConfig.distance[1]);\r\n      this.faceAnimationNode.setWorldPosition(this.node.worldPosition.clone().add(offset));\r\n      this.borderNode.setWorldPosition(this.node.worldPosition);\r\n    }\r\n  }\r\n\r\n  public setJinWildPosition() {\r\n    if (this.node) {\r\n      this.node.setPosition(this.getPosition());\r\n      const offset = new Vec3(-4, 5);\r\n      this.faceAnimationNode.setWorldPosition(this.node.worldPosition.clone().add(offset));\r\n      this.borderNode.setWorldPosition(this.node.worldPosition);\r\n\r\n    }\r\n  }\r\n\r\n  public getPosition() {\r\n    return this.node.getPosition();\r\n  }\r\n\r\n  private buildIcon() {\r\n    this.faceAnimationNode.active = false;\r\n    this.faceAnimationNode.removeFromParent();\r\n\r\n    const skeletonData = sourceManageSeletor().getFile(this.iconConfig.skeletonName).source;\r\n    this.skeleton.skeletonData = skeletonData;\r\n    this.skeleton.setAnimation(0, this.iconConfig.animationArr[0], false);\r\n    this.sprite.spriteFrame = sourceManageSeletor().getFile(this.iconConfig.fileName).source;\r\n\r\n  }\r\n\r\n  /**播放普通中奖 */\r\n  public playWin(parentNode: Node, isBorder: boolean = true, loop: boolean = true) {\r\n    const offset = new Vec3(this.iconConfig.distance[0], this.iconConfig.distance[1]);\r\n    if (!this.faceAnimationNode.active) {\r\n      this.faceAnimationNode.active = true;\r\n      // console.log(\"playWin \", this.iconConfig.id, \" parent \" + this.faceAnimationNode.parent);\r\n      if (!this.faceAnimationNode.parent) {\r\n        parentNode.addChild(this.faceAnimationNode)\r\n        this.faceAnimationNode.setWorldPosition(this.node.worldPosition.clone().add(offset));\r\n      }\r\n    }\r\n\r\n    if (isBorder && !this.borderNode.active) {\r\n      this.borderNode.active = true;\r\n      if (!this.borderNode.parent) {\r\n        parentNode.addChild(this.borderNode)\r\n        this.borderNode.setWorldPosition(this.node.worldPosition);\r\n      }\r\n    }\r\n\r\n    this.faceNode.active = false;\r\n    if (this.sprite.spriteFrame !== sourceManageSeletor().getFile(this.iconConfig.fileName).source) {\r\n      this.skeleton.setAnimation(0, \"dynamic\", loop);\r\n      // let count\r\n      // let skeletonPlayer=  new SkeletonAnimationPlayer(this.skeleton, \"dynamic\", true, () => {\r\n        // count++\r\n        // if (count >= 1) {\r\n          // skeletonPlayer.stopAnimation()\r\n          // this.sprite.spriteFrame = sourceManageSeletor().getFile(SpriteFramePathDefine.icon_jinfa).source;\r\n          // this.faceNode.active = true;\r\n          // this.faceAnimationNode.active = false;\r\n        // }\r\n    //  })\r\n    //  skeletonPlayer.playAnimation()\r\n    } else {\r\n      if (this.iconConfig.id === IconId.SCATTER) {\r\n        this.skeleton.setAnimation(0, this.iconConfig.animationArr[2], loop);\r\n      } else {\r\n        this.skeleton.setAnimation(0, this.iconConfig.animationArr[1], loop);\r\n      }\r\n    }\r\n  }\r\n\r\n  /**播放甲壳虫动画 */\r\n  public playBeetleAnimation(done) {\r\n    // if (!this.isBeetleIcon()) {\r\n    //   done && done();\r\n    //   return;\r\n    // }\r\n    this.callback = done;\r\n    this.faceAnimationNode.active = true;\r\n    this.node.addChild(this.faceAnimationNode);\r\n    this.faceAnimationNode.setWorldPosition(this.node.worldPosition);\r\n    this.faceNode.active = false;\r\n\r\n    this.amountNode.setSiblingIndex(this.node.children.length);\r\n    this.skeleton.setAnimation(0, this.iconConfig.animationArr[1], true);\r\n  }\r\n\r\n  /**播放金wild撒元宝动画 */\r\n  public playJinWild(parentNode,done) {\r\n    if (this.iconConfig.id !== IconId.WILD2) {\r\n      this.setJinWildPosition()\r\n      done && done();\r\n      return\r\n    }\r\n    const offset = new Vec3(this.iconConfig.distance[0], this.iconConfig.distance[1]);\r\n    if (!this.faceAnimationNode.active) {\r\n      this.faceAnimationNode.active = true;\r\n      // console.log(\"playWin \", this.iconConfig.id, \" parent \" + this.faceAnimationNode.parent);\r\n      if (!this.faceAnimationNode.parent) {\r\n        parentNode.addChild(this.faceAnimationNode)\r\n        this.faceAnimationNode.setWorldPosition(this.node.worldPosition.clone().add(offset));\r\n      }\r\n    }\r\n    this.faceNode.active = false;\r\n    // this.skeleton.setAnimation(0, this.iconConfig.animationArr[2], true);\r\n    new SkeletonAnimationPlayer(this.skeleton, \"animation4\", false, () => {\r\n      done && done();\r\n    }).playAnimation()\r\n  }\r\n\r\n    /**播放scatter进入小游戏动画 */\r\n    public playScatterWin(parentNode: Node, done, loop: boolean = false) {\r\n      const offset = new Vec3(this.iconConfig.distance[0], this.iconConfig.distance[1]);\r\n      if (!this.faceAnimationNode.active) {\r\n        this.faceAnimationNode.active = true;\r\n        if (!this.faceAnimationNode.parent) {\r\n          parentNode.addChild(this.faceAnimationNode)\r\n          this.faceAnimationNode.setWorldPosition(this.node.worldPosition.clone().add(offset));\r\n        }\r\n      }\r\n  \r\n      this.faceNode.active = false;\r\n      // if (this.iconConfig.id === IconId.SCATTER) {//scatter\r\n      //   const skeletonData = sourceManageSeletor().getFile(SkeletalPathDefine.TUBIAO_SCATTER).source;\r\n      //   this.skeleton.skeletonData = skeletonData;\r\n      // }\r\n      let count = 0;\r\n      const skeletonPlayer = new SkeletonAnimationPlayer(this.skeleton, this.iconConfig.animationArr[1], false, () => {\r\n        count++;\r\n        if (count >= 1) {\r\n          skeletonPlayer.stopAnimation()\r\n          this.skeleton.clearTracks()\r\n          this.faceNode.active = true;\r\n          this.faceAnimationNode.active = false;\r\n        }\r\n      })\r\n      skeletonPlayer.playAnimation()\r\n  \r\n    }\r\n\r\n  /**隐藏普通中奖 */\r\n  public hideWin() {\r\n    this.faceAnimationNode.active = false;\r\n    this.faceAnimationNode.removeFromParent();\r\n    this.borderNode.active = false;\r\n    this.borderNode.removeFromParent();\r\n\r\n    this.faceNode.active = true;\r\n    this.skeleton.setAnimation(0, this.iconConfig.animationArr[0], false);\r\n  }\r\n\r\n  public pauseWin() {\r\n    this.borderNode.active = false;\r\n    \r\n    if (this.iconConfig.id === IconId.WILD1 || this.iconConfig.id === IconId.WILD2) {\r\n      this.skeleton.clearTracks()\r\n    } \r\n    if (this.sprite.spriteFrame !== sourceManageSeletor().getFile(this.iconConfig.fileName).source) {\r\n      this.sprite.spriteFrame = sourceManageSeletor().getFile(SpriteFramePathDefine.icon_jinfa).source;\r\n      this.skeleton.setAnimation(0, \"static\", false);\r\n    }\r\n    this.skeleton.setAnimation(0, this.iconConfig.animationArr[0], false);\r\n    \r\n  }\r\n\r\n  public changeToJinWild() {\r\n    this.sprite.spriteFrame = sourceManageSeletor().getFile(SpriteFramePathDefine.icon_jinfa).source;\r\n    this.skeleton.skeletonData = sourceManageSeletor().getFile(SkeletalPathDefine.icon_jin_wild).source;\r\n    \r\n  }\r\n\r\n  /**是否使用 */\r\n  public isUse() {\r\n    return this.use;\r\n  }\r\n\r\n  public setAmount(amount) {\r\n    // this.amount = amount;\r\n    // if (amount > 0) {\r\n    //   this.amountNode.active = true;\r\n    // }\r\n    // const amountStr = amount >= 10000 ? amount.formatAmountWithLetter() : amount.formatAmountWithCommas()\r\n    // this.amountNode.getComponent(Label).string = amountStr;\r\n  }\r\n\r\n  public showBg() {\r\n    this.node.getChildByName(\"bg\").active = true;\r\n  }\r\n\r\n  public hideBg() {\r\n    this.node.getChildByName(\"bg\").active = false;\r\n  }\r\n\r\n  public showAmount() {\r\n    // this.isBeetleIcon() && (this.amountNode.active = false);\r\n  }\r\n  public hideAmount() {\r\n    this.amountNode.active = false;\r\n    this.amount = 0;\r\n  }\r\n\r\n  public getAmountNode() {\r\n    return this.amountNode;\r\n  }\r\n\r\n  public getAmount() {\r\n    return this.amount;\r\n  }\r\n\r\n  public destory() {\r\n    this.node.isValid && this.node.destroy();\r\n    this.faceAnimationNode.destroy();\r\n    this.borderNode.destroy();\r\n    this.node = null;\r\n    this.iconConfig = null;\r\n    this.skeleton = null;\r\n  }\r\n}"]}