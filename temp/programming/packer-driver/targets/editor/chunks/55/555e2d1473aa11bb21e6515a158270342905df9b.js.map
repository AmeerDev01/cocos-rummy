{"version":3,"sources":["file:///Users/geliang/web/dibai/hall/assets/script/hall/viewModel/ShareSureViewModel.ts"],"names":["ShareSureViewModel","fetcher","ViewModel","EffectType","addToastAction","changeWebView","loadRecommendData","ApiUrl","lang","constructor","begin","dispatch","setEvent","close","unMount","EFFECT2","batalActing","actingId","send","RECOMMEND_BIND","promotionCode","then","rsp","content","write","k","MainPaneModule","ShareSure","placeStr","comp","events","catch","e","connect","inject","state"],"mappings":";;;8HASMA,kB;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AATGC,MAAAA,O,iBAAAA,O;;AACFC,MAAAA,S;;AACEC,MAAAA,U,iBAAAA,U;;AAEAC,MAAAA,c,iBAAAA,c;AAAgBC,MAAAA,a,iBAAAA,a;AAAeC,MAAAA,iB,iBAAAA,iB;;AAE/BC,MAAAA,M,iBAAAA,M;;AACAC,MAAAA,I,iBAAAA,I;;;;;;;AAEHR,MAAAA,kB,GAAN,MAAMA,kBAAN;AAAA;AAAA,kCAA2E;AACzES,QAAAA,WAAW,GAAG;AACZ,gBAAM,gBAAN;AACD;;AAESC,QAAAA,KAAK,GAAG;AAChB,eAAKC,QAAL,CAAc;AAAA;AAAA,8CAAc,KAAd,CAAd;AACA,eAAKC,QAAL,CAAc;AACZC,YAAAA,KAAK,EAAE,MAAM;AACX,mBAAKC,OAAL,CAAa;AAAA;AAAA,4CAAWC,OAAxB;AACA,mBAAKJ,QAAL,CAAc;AAAA;AAAA,kDAAc,IAAd,CAAd;AACD,aAJW;AAKZK,YAAAA,WAAW,EAAGC,QAAD,IAAsB;AACjC;AAAA;AAAA,sCAAQC,IAAR,CAAa;AAAA;AAAA,oCAAOC,cAApB,EAAoC;AAAEC,gBAAAA,aAAa,EAAEH;AAAjB,eAApC,EAAiE,MAAjE,EAAyEI,IAAzE,CAA+EC,GAAD,IAAS;AACrF,qBAAKX,QAAL,CAAc;AAAA;AAAA,sDAAe;AAAEY,kBAAAA,OAAO,EAAE;AAAA;AAAA,oCAAKC,KAAL,CAAWC,CAAC,IAAIA,CAAC,CAACC,cAAF,CAAiBC,SAAjC,EAA2C,EAA3C,EAA8C;AAAEC,oBAAAA,QAAQ,EAAC;AAAX,mBAA9C;AAAX,iBAAf,CAAd,EADqF,CAErF;;AACA,qBAAKjB,QAAL,CAAc;AAAA;AAAA,4DAAkB,CAAlB,CAAd;AACA,qBAAKkB,IAAL,CAAUC,MAAV,CAAiBjB,KAAjB;AACD,eALD,EAKGkB,KALH,CAKUC,CAAD,IAAO,CACd;AACD,eAPD;AAQD;AAdW,WAAd;AAgBD;;AAEMC,QAAAA,OAAO,GAAG;AACf,eAAKC,MAAL,CAAY,EAAZ,EAAiBC,KAAD,IAAsB;AACpC,mBAAO,EAAP;AAED,WAHD;AAIA,iBAAO,IAAP;AACD;;AA/BwE,O;;yBAkC5DnC,kB","sourcesContent":["import { fetcher } from \"../index\"\r\nimport ViewModel from \"../../base/ViewModel\"\r\nimport { EffectType } from \"../../utils/NodeIOEffect\"\r\nimport { Hall_ShareSure, IEvent, IProps } from \"../components/Hall_ShareSure\"\r\nimport { addToastAction, changeWebView, loadRecommendData } from \"../store/actions/baseBoard\"\r\nimport { StateType } from \"../store/reducer\"\r\nimport { ApiUrl } from \"../apiUrl\"\r\nimport { lang } from \"../index\"\r\n\r\nclass ShareSureViewModel extends ViewModel<Hall_ShareSure, IProps, IEvent> {\r\n  constructor() {\r\n    super('Hall_ShareSure')\r\n  }\r\n\r\n  protected begin() {\r\n    this.dispatch(changeWebView(false));\r\n    this.setEvent({\r\n      close: () => {\r\n        this.unMount(EffectType.EFFECT2);\r\n        this.dispatch(changeWebView(true));\r\n      },\r\n      batalActing: (actingId: string) => {\r\n        fetcher.send(ApiUrl.RECOMMEND_BIND, { promotionCode: actingId }, \"post\").then((rsp) => {\r\n          this.dispatch(addToastAction({ content: lang.write(k => k.MainPaneModule.ShareSure,{},{ placeStr:\"绑定成功\" }) }))\r\n          // 绑定之后重新加载推荐数据\r\n          this.dispatch(loadRecommendData(0));\r\n          this.comp.events.close();\r\n        }).catch((e) => {\r\n          //this.dispatch(addToastAction({ content: e }))\r\n        })\r\n      }\r\n    })\r\n  }\r\n\r\n  public connect() {\r\n    this.inject({}, (state: StateType) => {\r\n      return {\r\n      }\r\n    })\r\n    return this\r\n  }\r\n}\r\n\r\nexport default ShareSureViewModel"]}