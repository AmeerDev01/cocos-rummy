{"version":3,"sources":["file:///Users/geliang/web/dibai/hall/assets/script/subGame/bandarQiuQiu/viewModel/BandarQiuQiuGameBoardViewModel.ts"],"names":["Game","UITransform","Vec3","_decorator","find","game","sys","ViewModel","StoreInject","GameStatus","gameCacheData","SKT_MAG_TYPE","sktInstance","sktMsgListener","bundlePkgName","mainGameViewModel","sourceManageSelector","config","initBetData","global","lang","addToastAction","BaseViewModel","PrefabPathDefine","EffectType","BetAreaViewModel","FooterViewModel","WinViewModel","LoseViewModel","UsersViewModel","setCountDownAction","setGameStatusAction","setGoldAction","setInitGameStatusAction","setLayCountDownAction","setMyInfoAction","setMyWinLose","setOnlineNumber","setSecondsAction","setTipsAction","setUsersInfoAction","TitleViewModel","changeAllWinUsersAction","changeWinAreaRateAction","changeGoldDataAction","setMemberBetAction","setNewBetDataAction","changeCardTypeAction","changeCancelBetDataAction","HistoryViewModel","CardsViewModel","SendCardsViewModel","getStore","changeMaxHistoryAction","changeMinHistoryAction","changeBlueCardAction","changeRedCardAction","changeTwinNumAction","BeginViewModel","BANKER_ID","ccclass","property","GameBoardViewModel","constructor","gameType","BET","countDown","layCountdown","winArea","winCardRate","allCardRate","isShowGame","timer","timer2","begin","listenerAuth","listenerUserJoinOrQuit","initView","on","EVENT_HIDE","EVENT_SHOW","isUnMount","add","TOP_UP","data","dispatch","GAME_TIP","POKER","lotteryVo","blue","red","twinNum","blueNum","redNum","greenType","blueType","redType","cardType","winType","GAMESTATUS_CRASH","seconds","window","setTimeout","startCountdown","stopLayCountdown","openSendCard","leftUsers","concat","rightUsers","STOP_BET","stopCountdown","list","startLayCountdown","WAIT","BET_ALL","preBet","gold","memberBet","resultCode","sendBet","roomId","memberId","comp","props","myInfo","memberName","betAmount","betType","isMe","betId","betAreaViewModel","amountArr","push","undefined","betData","index","isMyBet","HISTORY","winLoseList","BET_RESPONSE","memberData","getSeatIndex","type","goldData","SETTLEMENT","goldStr","icon","winGold","gameOption","lookOnIndex","winList","roomWinInfo","ALL_USERS","OTHER_WIN","updateWinloss","roomLeftInfoVos","roomRightInfoVos","setUsersInfo","GAME_SHOW","gameStatus","GIVE_GIFT","seats","usersInfo","filter","v","receiveMemberId","length","forEach","seat","x","y","headLocations","endPos","viewNode","getComponent","convertToWorldSpaceAR","flyGift","giveMemberId","getHeadPos","giftId","parent","setEvent","openHistoryPanel","openHistory","openWinPanel","openWin","openLosePanel","openLose","sendGameShowEvent","sendSktMessage","isFrom","pos","dealerPosition","myHeadPosition","onlineNumberPosition","addOnce","AUTH","localStorage","setItem","JSON","stringify","token","getItem","gameId","JOIN_GAME","hallDispatch","content","write","k","InitGameModule","GameBoardInit","placeStr","closeSubGame","confirmContent","leftMember","rightMember","createMinHistory","drawPrizeResults","time","newQiuQiuLotteryVo","cardRoll","cardViewModel","getPropertyNode","props_note_card_roll","cardBack","props_node_card_back","active","changeCardUpDown","playWinBg","playWinAnimation","i","usersViewModel","initBSUsers","openUsers","openTitle","openHeGuan","openBetArea","openFooter","openCards","openBeginAnim","clearInterval","setInterval","beginViewModel","layCountDown","unMountCallBack","clearData","removeById","titleViewModel","clearCacheData","nodeWrap","historyViewModel","mountView","getFile","MAIN_HISTORY_WIN","source","appendTo","effectType","EFFECT1","isModal","onClosePanel","unMount","EFFECT2","connect","heGuanViewModel","MANI_HE_GUAN","MAIN_USERS","MAIN_TITLE","MAIN_BET_AREA","MAIN_CARDS","footerViewModel","MAIN_FOOTER","MAIN_BEGIN","sendCardsViewModel","MAIN_SEND_CARD","winViewModel","MAIN_WIN","loseViewModel","MAIN_LOSE","reverse","users","Date","now","leftItem","rightItem","inject","state","minHistory","history","myWinLose"],"mappings":"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","sourcesContent":["import { Game, Node, UITransform, Vec3, _decorator, find, game, sys } from \"cc\"\r\nimport ViewModel, { StoreInject } from \"../../../base/ViewModel\"\r\nimport { BandarQiuQiu_gameBoard, IProps, IEvent } from \"../components/BandarQiuQiu_gameBoard\"\r\nimport { StateType } from \"../store/reducer\"\r\nimport { GameStatus, ResGiftVo, gameCacheData } from \"../type\";\r\nimport { SKT_MAG_TYPE, sktInstance, sktMsgListener } from \"../socketConnect\";\r\nimport { bundlePkgName } from \"../sourceDefine\";\r\nimport { mainGameViewModel, sourceManageSelector } from \"../index\";\r\nimport config, { initBetData } from \"../config\";\r\nimport { global, lang } from \"../../../hall\";\r\nimport { addToastAction } from \"../../../hall/store/actions/baseBoard\";\r\nimport BaseViewModel from \"../../../common/viewModel/BaseViewModel\";\r\nimport { PrefabPathDefine } from \"../sourceDefine/prefabDefine\";\r\nimport { EffectType } from \"../../../utils/NodeIOEffect\";\r\nimport BetAreaViewModel from \"./BandarQiuQiuBetAreaViewModel\";\r\nimport FooterViewModel from \"./BandarQiuQiuFooterViewModel\";\r\nimport WinViewModel from \"./BandarQiuQiuWinViewModel\";\r\nimport LoseViewModel from \"./BandarQiuQiuLoseViewModel\";\r\nimport UsersViewModel from \"./BandarQiuQiuUsersViewModel\";\r\nimport { setCountDownAction, setGameStatusAction, setGoldAction, setInitGameStatusAction, setLayCountDownAction, setMyInfoAction, setMyWinLose, setOnlineNumber, setSecondsAction, setTipsAction, setUsersInfoAction } from \"../store/actions/game\";\r\nimport TitleViewModel from \"./BandarQiuQiuTitleViewModel\";\r\nimport { WinUser, changeAllWinUsersAction, changeWinAreaRateAction, changeGoldDataAction, setMemberBetAction, setNewBetDataAction, changeCardTypeAction, changeCancelBetDataAction } from \"../store/actions/bet\";\r\nimport HistoryViewModel from \"./BandarQiuQiuMaxHistoryViewModel\";\r\nimport CardsViewModel from \"./BandarQiuQiuCardsViewModel\";\r\nimport SendCardsViewModel from \"./BandarQiuQiuSendCardViewModel\";\r\nimport { getStore } from \"../store\";\r\nimport { changeMaxHistoryAction, changeMinHistoryAction } from \"../store/actions/history\";\r\nimport { changeBlueCardAction, changeRedCardAction, changeTwinNumAction } from \"../store/actions/pokerDetail\";\r\nimport BeginViewModel from \"./BandarQiuQIuBeginViewModel\";\r\nimport { BANKER_ID } from \"../../../common/viewModel/GiftUserViewModel\";\r\n\r\nconst { ccclass, property } = _decorator;\r\n\r\n\r\nexport let historyViewModel:HistoryViewModel\r\nexport let usersViewModel:UsersViewModel\r\nexport let footerViewModel:FooterViewModel\r\nexport let betAreaViewModel:BetAreaViewModel\r\nexport let winViewModel:WinViewModel\r\nexport let loseViewModel: LoseViewModel\r\nexport let sendCardsViewModel: SendCardsViewModel\r\nexport let cardViewModel: CardsViewModel\r\nexport let beginViewModel: BeginViewModel\r\nexport let titleViewModel: TitleViewModel\r\nexport let heGuanViewModel\r\n@StoreInject(getStore())\r\nclass GameBoardViewModel extends ViewModel<BandarQiuQiu_gameBoard, IProps, IEvent> {\r\n  private gameType: GameStatus = GameStatus.BET;\r\n  public countDown: number;\r\n  private layCountdown: number;\r\n  // private isInit: boolean = true;\r\n  private winArea: number[] = [];\r\n  private winCardRate: number[] = [];\r\n  private allCardRate: number[] = [];\r\n  private isShowGame: boolean = true;\r\n  constructor() {\r\n      super('BandarQiuQiu_gameBoard')     \r\n  }\r\n  \r\n  protected begin() { \r\n\r\n    this.listenerAuth();//认证\r\n    this.listenerUserJoinOrQuit();\r\n        // 初始化界面\r\n    this.initView();\r\n    game.on(Game.EVENT_HIDE,()=>{//游戏切入后台\r\n      this.isShowGame = false;\r\n    })\r\n    game.on(Game.EVENT_SHOW,()=>{//游戏进入\r\n      this.isShowGame = true;\r\n      if (!mainGameViewModel.isUnMount) {\r\n        \r\n      }\r\n      \r\n    })\r\n    sktMsgListener.add(SKT_MAG_TYPE.TOP_UP, bundlePkgName, (data) => {//10\r\n      this.dispatch(setGoldAction(data))\r\n    })\r\n    sktMsgListener.add(SKT_MAG_TYPE.GAME_TIP, bundlePkgName, (data) => {//11\r\n      this.dispatch(setTipsAction(data))\r\n    })\r\n\r\n    sktMsgListener.add(SKT_MAG_TYPE.POKER, bundlePkgName, (data) => {//805  \r\n      this.dispatch(changeBlueCardAction(data.lotteryVo.blue));\r\n      this.dispatch(changeRedCardAction(data.lotteryVo.red));\r\n      let twinNum = { blueNum: data.lotteryVo.blueNum, redNum: data.lotteryVo.redNum };\r\n      let greenType; let blueType; let redType;\r\n      if (data.lotteryVo.greenType) {\r\n        greenType = data.lotteryVo.greenType;\r\n      } else {\r\n        greenType = 0;\r\n      }\r\n      if (data.lotteryVo.blueType) {\r\n        blueType = data.lotteryVo.blueType;\r\n      } else {\r\n        blueType = 0;\r\n      }\r\n      if (data.lotteryVo.redType) {\r\n        redType = data.lotteryVo.redType;\r\n      } else {\r\n        redType = 0;\r\n      }\r\n      let cardType={greenType,blueType,redType}\r\n      this.dispatch(changeTwinNumAction(twinNum));\r\n      this.dispatch(changeWinAreaRateAction(data.lotteryVo.winType));\r\n      this.dispatch(changeCardTypeAction(cardType))\r\n      \r\n    })\r\n    sktMsgListener.add(SKT_MAG_TYPE.GAMESTATUS_CRASH, bundlePkgName, (data) => {//8101\r\n      // this.isInit = false;\r\n      if(data.gameType === GameStatus.BET && data.seconds > 0){\r\n        this.winArea=[];\r\n        this.winCardRate=[];\r\n        this.allCardRate = []\r\n        this.dispatch(setSecondsAction(data.seconds));\r\n        this.countDown = 15;\r\n    \r\n        window.setTimeout(() => {\r\n          this.dispatch(setCountDownAction(this.countDown));\r\n          this.dispatch(setGameStatusAction(GameStatus.BET));\r\n          this.startCountdown();\r\n        },4500)\r\n       \r\n        this.stopLayCountdown();\r\n        if (data.seconds === 19) {\r\n          if(!this.isShowGame){ return }\r\n          this.openSendCard();\r\n        }\r\n        this.dispatch(setUsersInfoAction(gameCacheData.leftUsers.concat(gameCacheData.rightUsers)));\r\n      } else if (data.gameType === GameStatus.STOP_BET) {\r\n        this.stopCountdown();\r\n        this.dispatch(setGameStatusAction(GameStatus.STOP_BET));\r\n        this.dispatch(changeMinHistoryAction(data.data.list))\r\n    \r\n      }else {\r\n        this.winCardRate=[];\r\n        this.allCardRate=[];\r\n        this.winArea=[]\r\n        this.layCountdown = data.seconds;\r\n        this.startLayCountdown();\r\n        this.dispatch(setGameStatusAction(GameStatus.WAIT));\r\n        this.dispatch(setLayCountDownAction(data.seconds));\r\n      }\r\n    })\r\n    sktMsgListener.add(SKT_MAG_TYPE.BET_ALL,bundlePkgName,(data)=>{//802\r\n      if (!config.preBet) {\r\n        this.dispatch(setGoldAction(data.gold))\r\n        this.dispatch(setMemberBetAction(data.memberBet))\r\n        \r\n      } else if (data.resultCode === 0) { \r\n        const sendBet = {\r\n          roomId: gameCacheData.roomId,\r\n          memberId: this.comp.props.myInfo.memberId,\r\n          memberName: this.comp.props.myInfo.memberName,\r\n          gold: data.betAmount,\r\n          betType: data.betType,\r\n          isMe: true,\r\n          betId:data.betId\r\n        }\r\n        betAreaViewModel.comp.amountArr.push(sendBet);\r\n        this.dispatch(setGoldAction(data.gold))\r\n        this.dispatch(setMemberBetAction(data.memberBet))\r\n      } else if (data.resultCode !== undefined && data.resultCode !== 0) {\r\n        this.dispatch(setGoldAction(data.gold))\r\n        this.dispatch(setMemberBetAction(data.memberBet))\r\n        const betData = initBetData(this.comp.props.myInfo.index, this.comp.props.myInfo.memberId,data.betType, data.betAmount);\r\n        betData.betId = data.betId;\r\n        betData.isMyBet = true;\r\n\r\n        this.dispatch(changeCancelBetDataAction(betData))\r\n      }\r\n    })\r\n    sktMsgListener.add(SKT_MAG_TYPE.HISTORY,bundlePkgName,(data)=>{//806\r\n      this.dispatch(changeMaxHistoryAction(data.winLoseList))\r\n    })\r\n    sktMsgListener.add(SKT_MAG_TYPE.BET_RESPONSE,bundlePkgName,(data)=>{//8102\r\n      const memberId = data.memberData.memberId ;\r\n      const index = this.getSeatIndex(memberId);\r\n      const isMyBet = this.comp.props.myInfo.memberId === memberId;\r\n      // console.log(data.goldData[data.memberData.type]);\r\n      \r\n      const betData = initBetData(index, memberId,data.memberData.type, data.memberData.gold);\r\n      betData.isMyBet = isMyBet;\r\n      gameCacheData.goldData = data.goldData;\r\n      this.dispatch(setNewBetDataAction(betData));\r\n      this.dispatch(changeGoldDataAction(data.goldData))\r\n      // console.log(data);\r\n    })\r\n    sktMsgListener.add(SKT_MAG_TYPE.SETTLEMENT,bundlePkgName,(data)=>{//804\r\n      // console.log(data);\r\n      let myInfo = {\r\n        gold:data.myInfo.gold,\r\n        goldStr:data.myInfo.gold+\"\",\r\n        icon:data.myInfo.icon,\r\n        memberName:data.myInfo.memberName,\r\n        winGold:data.myInfo.winGold,\r\n        memberId:data.myInfo.memberId,\r\n        index:config.gameOption.lookOnIndex,\r\n        memberBet:data.myInfo.memberBet,\r\n        winType:data.myInfo\r\n      }\r\n      gameCacheData.winList = data.roomWinInfo;\r\n      this.dispatch(setMyInfoAction(myInfo));\r\n      this.dispatch(setGoldAction(data.myInfo.gold))\r\n      this.dispatch(setMyWinLose(data.myInfo.winType))\r\n    \r\n    })\r\n    sktMsgListener.add(SKT_MAG_TYPE.ALL_USERS,bundlePkgName,(data)=>{//807\r\n      // 改变在线人数\r\n      this.dispatch(setOnlineNumber(data));\r\n    })\r\n\r\n    sktMsgListener.add(SKT_MAG_TYPE.OTHER_WIN,bundlePkgName,(data)=>{//808\r\n\r\n      this.updateWinloss(data.list)\r\n      // 改变在线人数\r\n      // this.dispatch(setOnlineNumber(data.roomInfoSize));\r\n      gameCacheData.leftUsers = data.roomLeftInfoVos;\r\n      gameCacheData.rightUsers = data.roomRightInfoVos;\r\n      //榜上所有用户信息\r\n      this.setUsersInfo();\r\n\r\n    \r\n    })\r\n    sktMsgListener.add(SKT_MAG_TYPE.GAME_SHOW, bundlePkgName, (data: any) => {//810\r\n      if (GameStatus.BET === this.comp.props.gameStatus) {\r\n      \r\n        this.countDown = data.seconds;\r\n        this.startCountdown();\r\n      }\r\n    })\r\n\r\n    sktMsgListener.add(SKT_MAG_TYPE.GIVE_GIFT, bundlePkgName, (data: ResGiftVo) => {//11\r\n      const seats = this.comp.props.usersInfo.filter(v => v.memberId === data.receiveMemberId);\r\n      // 如果展示座位上有两个相同人，就同时送两次\r\n      if (seats && seats.length > 1) {\r\n        seats.forEach(seat => {\r\n          const { x, y } = config.headLocations[seat.index];\r\n          const endPos = this.viewNode.getComponent(UITransform).convertToWorldSpaceAR(new Vec3(x, y))\r\n          global.flyGift(data.giveMemberId, data.receiveMemberId, this.getHeadPos(data.giveMemberId, true), endPos, data.giftId, this.viewNode.parent);\r\n        })\r\n      } else {\r\n        global.flyGift(data.giveMemberId, data.receiveMemberId, this.getHeadPos(data.giveMemberId, true),\r\n          this.getHeadPos(data.receiveMemberId, false), data.giftId, this.viewNode.parent);\r\n      }\r\n    })\r\n\r\n      this.setEvent({\r\n      openHistoryPanel:()=>{\r\n        this.openHistory()\r\n      },\r\n\r\n      openWinPanel:()=>{\r\n        this.openWin();\r\n      },\r\n    \r\n      openLosePanel:()=>{\r\n        this.openLose();\r\n      },\r\n      sendGameShowEvent: () => {\r\n        sktInstance.sendSktMessage(SKT_MAG_TYPE.GAME_SHOW, { roomId: gameCacheData.roomId });\r\n      }\r\n    })\r\n  }\r\n\r\n\r\n  /**获得获得用户所在位置 */\r\n  private getHeadPos(memberId: string, isFrom: boolean) {\r\n    const seat = this.comp.props.usersInfo.find(v => v.memberId === memberId);\r\n    let pos;\r\n    if (seat) {\r\n      const { x, y } = config.headLocations[seat.index];\r\n      pos = new Vec3(x, y);\r\n    } else if (BANKER_ID === memberId) {\r\n      pos = config.gameOption.dealerPosition;\r\n    } else if (isFrom && this.comp.props.myInfo.memberId === memberId) {\r\n      pos = config.gameOption.myHeadPosition;\r\n    } else if (isFrom) {\r\n      pos = config.gameOption.onlineNumberPosition;\r\n    } else {\r\n      return undefined;\r\n    }\r\n\r\n    return this.viewNode.getComponent(UITransform).convertToWorldSpaceAR(pos);\r\n  }\r\n      \r\n  /**\r\n   * 认证消息监听及处理\r\n   */\r\n  private listenerAuth() {\r\n    sktMsgListener.addOnce(SKT_MAG_TYPE.AUTH, bundlePkgName, (data: any) => {\r\n      sys.localStorage.setItem(\"auth\", JSON.stringify(data));\r\n    })\r\n\r\n    // sys.localStorage.setItem(\"token\",config.testConfig.token)\r\n    // sys.localStorage.setItem(\"token\",window.location.search.substring(6))\r\n\r\n    sktInstance.sendSktMessage(SKT_MAG_TYPE.AUTH, {\r\n      token: sys.localStorage.getItem(\"token\"),\r\n      gameId: config.gameId\r\n    });\r\n\r\n  }\r\n\r\n   /**\r\n   * 监听用户进出游戏\r\n   */\r\n  private listenerUserJoinOrQuit() {\r\n    sktMsgListener.add(SKT_MAG_TYPE.JOIN_GAME, bundlePkgName, (data) => {//4\r\n      if (!data) {\r\n        global.hallDispatch(addToastAction({ content: lang.write(k => k.InitGameModule.GameBoardInit,{},{ placeStr:\"game init failed\" }) }))\r\n        global.closeSubGame({\r\n          confirmContent: lang.write(k => k.InitGameModule.GameBoardInit)\r\n        });\r\n        return;\r\n      }\r\n      gameCacheData.leftUsers = data.leftMember;\r\n      gameCacheData.rightUsers = data.rightMember;\r\n      gameCacheData.roomId = data.roomId;\r\n      gameCacheData.memberId = data.myInfo.memberId;\r\n      this.dispatch(setInitGameStatusAction(data.gameType));\r\n      this.dispatch(changeGoldDataAction(data.goldData));\r\n      let myInfo={\r\n        gold:data.myInfo.gold,\r\n        goldStr:data.myInfo.gold+\"\",\r\n        icon:data.myInfo.icon,\r\n        memberName:data.myInfo.memberName,\r\n        winGold:data.myInfo.winGold,\r\n        memberId:data.myInfo.memberId,\r\n        index:config.gameOption.lookOnIndex,\r\n        memberBet:data.myInfo.memberBet,\r\n      }\r\n      this.dispatch(setMyInfoAction(myInfo));\r\n      this.dispatch(setGoldAction(data.myInfo.gold));\r\n      this.comp.createMinHistory(data.drawPrizeResults);\r\n      if (data.gameType === GameStatus.BET) {\r\n          this.dispatch(setSecondsAction(data.seconds));\r\n          this.winArea = [];\r\n          this.winCardRate = [];\r\n          this.allCardRate = [];\r\n          \r\n        if (data.seconds > 0) {\r\n          if (data.seconds > 15) {\r\n            this.countDown = 15;\r\n            let time = data.seconds - 15;\r\n            window.setTimeout(() => {\r\n              this.dispatch(setCountDownAction(this.countDown));\r\n              this.dispatch(setGameStatusAction(GameStatus.BET));\r\n              this.startCountdown();\r\n            },time*1000)\r\n          } else {\r\n            this.countDown = data.seconds;\r\n            this.dispatch(setCountDownAction(this.countDown));\r\n            this.dispatch(setGameStatusAction(GameStatus.BET));\r\n            this.startCountdown();\r\n          }\r\n          if (data.seconds === 19) {\r\n            if(!this.isShowGame){ return }\r\n            this.openSendCard();\r\n          }\r\n        } else {\r\n          this.stopCountdown();\r\n          if (!data.newQiuQiuLotteryVo || data.newQiuQiuLotteryVo.length === 0) { return };\r\n          this.dispatch(changeBlueCardAction(data.newQiuQiuLotteryVo.blue));\r\n          this.dispatch(changeRedCardAction(data.newQiuQiuLotteryVo.red));\r\n          let twinNum = { blueNum: data.newQiuQiuLotteryVo.blueNum, redNum: data.newQiuQiuLotteryVo.redNum };\r\n          let greenType; let blueType; let redType;\r\n          if (data.newQiuQiuLotteryVo.greenType) {\r\n            greenType = data.newQiuQiuLotteryVo.greenType;\r\n          } else {\r\n            greenType = 0;\r\n          }\r\n          if (data.newQiuQiuLotteryVo.blueType) {\r\n            blueType = data.newQiuQiuLotteryVo.blueType;\r\n          } else {\r\n            blueType = 0;\r\n          }\r\n          if (data.newQiuQiuLotteryVo.redType) {\r\n            redType = data.newQiuQiuLotteryVo.redType;\r\n          } else {\r\n            redType = 0;\r\n          }\r\n          let cardType = { greenType, blueType, redType }\r\n          this.dispatch(changeTwinNumAction(twinNum));\r\n          this.dispatch(changeWinAreaRateAction(data.newQiuQiuLotteryVo.winType))\r\n          this.dispatch(changeCardTypeAction(cardType));\r\n        }\r\n          \r\n         \r\n      } else if (data.gameType === GameStatus.STOP_BET) {\r\n        this.dispatch(setGameStatusAction(null));\r\n        this.stopCountdown();\r\n        if (!data.newQiuQiuLotteryVo || data.newQiuQiuLotteryVo.length === 0) { return };\r\n        let cardRoll = cardViewModel.comp.getPropertyNode().props_note_card_roll as Node;\r\n        let cardBack = cardViewModel.comp.getPropertyNode().props_node_card_back as Node;\r\n        cardBack.active = false;\r\n        cardRoll.active = true;\r\n        cardViewModel.comp.changeCardUpDown(data.newQiuQiuLotteryVo.blue,data.newQiuQiuLotteryVo.red)\r\n        let twinNum = { blueNum: data.newQiuQiuLotteryVo.blueNum, redNum: data.newQiuQiuLotteryVo.redNum };\r\n        let greenType; let blueType; let redType;\r\n        if (data.newQiuQiuLotteryVo.greenType) {\r\n          greenType = data.newQiuQiuLotteryVo.greenType;\r\n        } else {\r\n          greenType = 0;\r\n        }\r\n        if (data.newQiuQiuLotteryVo.blueType) {\r\n          blueType = data.newQiuQiuLotteryVo.blueType;\r\n        } else {\r\n          blueType = 0;\r\n        }\r\n        if (data.newQiuQiuLotteryVo.redType) {\r\n          redType = data.newQiuQiuLotteryVo.redType;\r\n        } else {\r\n          redType = 0;\r\n        }\r\n        let cardType = { greenType, blueType, redType }\r\n        this.dispatch(changeTwinNumAction(twinNum));\r\n        cardViewModel.comp.playWinBg(twinNum, cardType)\r\n        betAreaViewModel.comp.playWinAnimation(data.newQiuQiuLotteryVo.winType)\r\n        this.dispatch(changeCardTypeAction(cardType));\r\n       }else if(data.gameType === GameStatus.WAIT && data.seconds > 0){\r\n          this.winArea = [];\r\n          this.winCardRate = [];\r\n          this.allCardRate = [];\r\n          if (data.seconds !== 0) {\r\n            this.layCountdown = data.seconds;\r\n            this.startLayCountdown();\r\n          }\r\n          this.dispatch(setGameStatusAction(GameStatus.WAIT));\r\n          this.dispatch(setLayCountDownAction(data.seconds));\r\n          \r\n       }\r\n\r\n      // 改变在线人数\r\n      // this.dispatch(setOnlineNumber(data.memberNum));\r\n      //榜上所有用户信息\r\n      this.setUsersInfo()\r\n      this.dispatch(setUsersInfoAction(gameCacheData.leftUsers.concat(gameCacheData.rightUsers)));\r\n      if (!this.comp.props.usersInfo || this.comp.props.usersInfo === undefined) { return };\r\n      this.comp.props.usersInfo.forEach((v, i) => {\r\n        usersViewModel.comp.initBSUsers(v,v.index)\r\n      })\r\n \r\n    })\r\n\r\n  }\r\n  \r\n      public initView(){\r\n\r\n        this.openUsers();\r\n        this.openTitle();\r\n        this.openHeGuan();\r\n        this.openBetArea();\r\n        this.openFooter();\r\n        this.openCards();\r\n        // this.openSendCard();\r\n        this.openBeginAnim();\r\n      }\r\n\r\n\r\n      // 开始倒计时\r\n      private timer: number = 0;\r\n      private startCountdown() {\r\n        if (this.timer > 0) {\r\n          window.clearInterval(this.timer);\r\n          this.timer = 0;\r\n        }\r\n        this.dispatch(setCountDownAction(this.countDown--));\r\n        this.timer = window.setInterval(() => {\r\n          this.dispatch(setCountDownAction(this.countDown--));\r\n          if (this.countDown <= 0) {\r\n            window.clearInterval(this.timer);\r\n            // this.stopCountdown();//测试为0时不展示时钟\r\n            this.timer = 0;\r\n          }\r\n        }, 1000)\r\n      }\r\n      private timer2: number = 0;\r\n      private startLayCountdown() {\r\n        if (this.timer2 > 0) {\r\n          window.clearInterval(this.timer2);\r\n          this.timer2 = 0;\r\n        }\r\n        this.dispatch(setLayCountDownAction(this.layCountdown--));\r\n        this.timer2 = window.setInterval(() => {\r\n          this.dispatch(setLayCountDownAction(this.layCountdown--));\r\n          if (this.layCountdown <= 0) {\r\n            window.clearInterval(this.timer2);\r\n            // this.stopCountdown();//测试为0时不展示时钟\r\n            this.timer2 = 0;\r\n          }\r\n        }, 1000)\r\n      }\r\n        /**停止倒计时 */\r\n      private stopCountdown() {\r\n        // 如果倒计时已经为0了，不处理了\r\n        if (this.comp.props.countDown <= 0) {\r\n          return;\r\n        }\r\n        this.timer && window.clearInterval(this.timer);\r\n        this.timer = 0;\r\n        this.dispatch(setCountDownAction(0));\r\n      }\r\n      /**停止倒计时 */\r\n      private stopLayCountdown() {\r\n        // 如果倒计时已经为0了，不处理了\r\n        if (beginViewModel.comp.props.layCountDown <= 0) {\r\n          return;\r\n        }\r\n        this.timer2 && window.clearInterval(this.timer2);\r\n        this.timer2 = 0;\r\n        this.dispatch(setLayCountDownAction(0));\r\n      }\r\n\r\n  \r\n  protected unMountCallBack(): void {\r\n    this.clearData()\r\n    sktMsgListener.removeById(bundlePkgName)\r\n  }\r\n  private clearData() {\r\n    titleViewModel.clearCacheData()\r\n  }\r\n\r\n    \r\n  \r\n      public openHistory(nodeWrap?: Node) {\r\n        historyViewModel = new HistoryViewModel().mountView(sourceManageSelector().getFile(PrefabPathDefine.MAIN_HISTORY_WIN).source)\r\n          .appendTo(this.viewNode.parent, { effectType: EffectType.EFFECT1, isModal: true }).setEvent({\r\n            onClosePanel: () => {\r\n              historyViewModel.unMount(EffectType.EFFECT2)\r\n            }\r\n          }).connect()\r\n\r\n      }\r\n\r\n      public openHeGuan(nodeWrap?: Node) {\r\n        heGuanViewModel = new BaseViewModel(\"BandarQiuQiu_heGuan\").mountView(sourceManageSelector().getFile(PrefabPathDefine.MANI_HE_GUAN).source)\r\n        .appendTo(this.viewNode, { effectType: EffectType.EFFECT1, isModal: false }).setEvent({\r\n          \r\n          }).connect()\r\n      }\r\n\r\n\r\n      public openUsers(nodeWrap?: Node) {\r\n        usersViewModel = new UsersViewModel().mountView(sourceManageSelector().getFile(PrefabPathDefine.MAIN_USERS).source)\r\n        .appendTo(this.viewNode, { effectType: EffectType.EFFECT1, isModal: false }).setEvent({\r\n        \r\n          }).connect()\r\n      }\r\n    \r\n      public openTitle(nodeWrap?: Node) {\r\n        titleViewModel = new TitleViewModel().mountView(sourceManageSelector().getFile(PrefabPathDefine.MAIN_TITLE).source)\r\n        .appendTo(this.viewNode, { effectType: EffectType.EFFECT1, isModal: false }).setEvent({\r\n          \r\n          }).connect()  \r\n      }\r\n      public openBetArea() {\r\n        betAreaViewModel = new BetAreaViewModel().mountView(sourceManageSelector().getFile(PrefabPathDefine.MAIN_BET_AREA).source)\r\n        .appendTo(this.viewNode, { effectType: EffectType.EFFECT1, isModal: false }).setEvent({\r\n          \r\n          }).connect()  \r\n      }\r\n      public openCards() {\r\n        cardViewModel  = new CardsViewModel().mountView(sourceManageSelector().getFile(PrefabPathDefine.MAIN_CARDS).source)\r\n        .appendTo(this.viewNode, { effectType: EffectType.EFFECT1, isModal: false }).setEvent({\r\n          \r\n          }).connect()  \r\n      }\r\n      public openFooter(){\r\n        footerViewModel = new FooterViewModel().mountView(sourceManageSelector().getFile(PrefabPathDefine.MAIN_FOOTER).source)\r\n        .appendTo(this.viewNode, { effectType: EffectType.EFFECT1, isModal: false }).setEvent({\r\n          \r\n          }).connect()  \r\n      }\r\n\r\n      public openBeginAnim(){\r\n         beginViewModel =new BeginViewModel().mountView(sourceManageSelector().getFile(PrefabPathDefine.MAIN_BEGIN).source)\r\n        .appendTo(this.viewNode,{effectType:EffectType.EFFECT1,isModal:false}).setEvent({\r\n          \r\n        }).connect()\r\n      }\r\n\r\n      public openSendCard(){\r\n        sendCardsViewModel =new SendCardsViewModel().mountView(sourceManageSelector().getFile(PrefabPathDefine.MAIN_SEND_CARD).source)\r\n        .appendTo(this.viewNode,{effectType:EffectType.EFFECT1,isModal:false}).connect()\r\n      }\r\n\r\n      public openWin(nodeWrap?: Node) {\r\n        winViewModel = new WinViewModel().mountView(sourceManageSelector().getFile(PrefabPathDefine.MAIN_WIN).source)\r\n          .appendTo(find(\"Canvas\"), { effectType: EffectType.EFFECT1, isModal: true }).setEvent({\r\n            onClosePanel: () => {\r\n              winViewModel.unMount(EffectType.EFFECT2)\r\n            }\r\n    \r\n          }).connect()\r\n    \r\n      }\r\n    \r\n      public openLose(nodeWrap?: Node) {\r\n        loseViewModel = new LoseViewModel().mountView(sourceManageSelector().getFile(PrefabPathDefine.MAIN_LOSE).source)\r\n          .appendTo(find(\"Canvas\"), { effectType: EffectType.EFFECT1, isModal: true }).setEvent({\r\n            onClosePanel: () => {\r\n              loseViewModel.unMount(EffectType.EFFECT2)\r\n            }\r\n          }).connect()\r\n      }\r\n\r\n      private getSeatIndex(memberId: string) {\r\n        // 倒起找，原因是因为有可能重复上榜，右边上榜优先\r\n        const seat = [...this.comp.props.usersInfo].reverse().find(v => v.memberId === memberId);\r\n        if (seat) {\r\n          return seat.index;\r\n        }\r\n        return config.gameOption.lookOnIndex;\r\n      }\r\n\r\n      private updateWinloss(users:WinUser[]) {\r\n        if (!users || users.length === 0) {\r\n          this.dispatch(changeAllWinUsersAction(null))\r\n          return;\r\n        }\r\n        users.filter(v => v.gold !== 0).forEach(v => {\r\n          v.index=this.getSeatIndex(v.memberId);\r\n          v.time=Date.now()\r\n        })\r\n        // console.log(\"users-----\",users);\r\n        \r\n        this.dispatch(changeAllWinUsersAction(users))\r\n      }\r\n    \r\n\r\n      private setUsersInfo(){\r\n          /** 初始化榜上用户信息 */\r\n        if(gameCacheData.leftUsers){\r\n          gameCacheData.leftUsers.forEach((leftItem,i)=>{\r\n            leftItem.index=i\r\n          })\r\n    \r\n        }\r\n        if(gameCacheData.rightUsers){\r\n          gameCacheData.rightUsers.forEach((rightItem,i)=>{\r\n            rightItem.index=3+i\r\n          })\r\n    \r\n        }\r\n        if (gameCacheData.leftUsers === undefined) { gameCacheData.leftUsers = [] };\r\n        if (gameCacheData.rightUsers === undefined) { gameCacheData.rightUsers = [] };\r\n\r\n        // this.dispatch(setUsersInfoAction(gameCacheData.leftUsers.concat(gameCacheData.rightUsers)));\r\n\r\n  }\r\n  \r\n    public connect() {\r\n      this.inject({}, (state: StateType) => {\r\n        return {\r\n          minHistory:state.history.minHistory,\r\n          countDown:state.game.countDown,\r\n          usersInfo:state.game.usersInfo,\r\n          myInfo:state.game.myInfo,\r\n          myWinLose:state.game.myWinLose,\r\n          gameStatus: state.game.gameStatus,\r\n          // initGameType:null,\r\n        }\r\n      })\r\n      return this\r\n    }\r\n      \r\n}\r\n\r\nexport default GameBoardViewModel"]}