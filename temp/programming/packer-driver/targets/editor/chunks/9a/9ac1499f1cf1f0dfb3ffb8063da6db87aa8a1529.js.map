{"version":3,"sources":["file:///Users/geliang/web/dibai/hall/assets/script/common/components/Common_ModalBox.ts"],"names":["_decorator","Button","Label","Node","WebView","BaseComponent","global","lang","addToastAction","ToastType","ccclass","property","Common_ModalBox","props","content","type","url","events","onCloseHandler","onCancleHandler","onOkHandler","propertyNode","props_Label_content","props_btn_updata_cancel","props_btn_updata_ok","props_spr_updata_tipsBg","props_webView_spr_updata_tipsBg","props_WebView","props_btn_dt_off","start","initState","bindEvent","node","on","EventType","TOUCH_END","useProps","key","value","active","string","bindUI","ERROR","hallDispatch","write","k","MainPaneModule","LoadUrlError","placeStr","update","deltaTime"],"mappings":"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","sourcesContent":["import { _decorator, Button, Component, instantiate, Label, Node, UITransform, Vec3, WebView } from 'cc';\r\nimport { BaseComponent } from '../../base/BaseComponent';\r\nimport { global, lang } from '../../hall';\r\nimport { addToastAction, ToastType } from '../../hall/store/actions/baseBoard';\r\nconst { ccclass, property } = _decorator;\r\n\r\n\r\nexport interface IState {\r\n}\r\n\r\nexport interface IProps {\r\n\tcontent: string,\r\n\ttype: \"Prompt\" | \"Confirm\",\r\n\turl: string\r\n}\r\nexport interface IEvent {\r\n\t/**返回true，自动关闭 */\r\n\tonCancleHandler?: () => boolean\r\n\t/**返回true，自动关闭 */\r\n\tonOkHandler?: () => boolean\r\n\tonCloseHandler: () => void\r\n}\r\n\r\n@ccclass('Common_ModalBox')\r\nexport class Common_ModalBox extends BaseComponent<IState, IProps, IEvent> {\r\n\tstart() { }\r\n\r\n\tpublic props: IProps = {\r\n\t\tcontent: \"\",\r\n\t\ttype: \"Confirm\",\r\n\t\turl: \"\"\r\n\t}\r\n\r\n\tpublic events: IEvent = {\r\n\t\tonCloseHandler: () => { },\r\n\t\tonCancleHandler: () => true,\r\n\t\tonOkHandler: () => true\r\n\t}\r\n\r\n\tprotected initState() {\r\n\t\treturn {}\r\n\t}\r\n\r\n\tprotected propertyNode = {\r\n\t\tprops_Label_content: new Label(),\r\n\t\tprops_btn_updata_cancel: new Button(),\r\n\t\tprops_btn_updata_ok: new Button(),\r\n\t\tprops_spr_updata_tipsBg: new Node(),\r\n\t\tprops_webView_spr_updata_tipsBg: new Node(),\r\n\t\tprops_WebView: new WebView(),\r\n\t\tprops_btn_dt_off: new Button()\r\n\t}\r\n\r\n\tprotected bindEvent(): void {\r\n\t\tthis.propertyNode.props_btn_updata_cancel.node.on(Node.EventType.TOUCH_END, () => {\r\n\t\t\tif (this.events.onCancleHandler()) {\r\n\t\t\t\tthis.events.onCloseHandler()\r\n\t\t\t}\r\n\t\t})\r\n\t\tthis.propertyNode.props_btn_updata_ok.node.on(Node.EventType.TOUCH_END, () => {\r\n\t\t\tif (this.events.onOkHandler()) {\r\n\t\t\t\tthis.events.onCloseHandler()\r\n\t\t\t}\r\n\t\t})\r\n\t\tthis.propertyNode.props_btn_dt_off.node.on(Node.EventType.TOUCH_END, () => {\r\n\t\t\tthis.events.onCloseHandler()\r\n\t\t})\r\n\t}\r\n\r\n\tprotected useProps(key: keyof IProps, value: { pre: any, cur: any }) {\r\n\t\tif (key === \"content\") {\r\n\t\t\tthis.propertyNode.props_spr_updata_tipsBg.active = true\r\n\t\t\tthis.propertyNode.props_Label_content.string = this.props.content\r\n\t\t}\r\n\t\tif (key === \"type\") {\r\n\t\t\tif (this.props.type === \"Confirm\") {\r\n\t\t\t\tthis.propertyNode.props_btn_updata_cancel.node.active = true\r\n\t\t\t\tthis.propertyNode.props_btn_updata_ok.node.active = true\r\n\t\t\t} else if (this.props.type === \"Prompt\") {\r\n\t\t\t\tthis.propertyNode.props_btn_updata_cancel.node.active = false\r\n\t\t\t\tthis.propertyNode.props_btn_updata_ok.node.active = true\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (key === \"url\" && this.props.url) {\r\n\t\t\tthis.propertyNode.props_spr_updata_tipsBg.active = false\r\n\t\t\tthis.propertyNode.props_webView_spr_updata_tipsBg.active = true\r\n\t\t\tthis.propertyNode.props_WebView.url = this.props.url\r\n\t\t}\r\n\t}\r\n\tprotected bindUI(): void {\r\n\t\tthis.propertyNode.props_webView_spr_updata_tipsBg.active = this.props.url ? true : false\r\n\t\tif (this.props.url) {\r\n\t\t\tthis.propertyNode.props_spr_updata_tipsBg.active = false\r\n\t\t\tthis.propertyNode.props_WebView.url = this.props.url\r\n\t\t\tthis.propertyNode.props_WebView.node.on(WebView.EventType.ERROR, () => {\r\n\t\t\t\tglobal.hallDispatch(addToastAction({ content: lang.write(k => k.MainPaneModule.LoadUrlError, {}, { placeStr: \"此链接无法加载\" }), type: ToastType.ERROR }))\r\n\t\t\t}, this);\r\n\t\t}\r\n\t}\r\n\r\n\tupdate(deltaTime: number) {\r\n\r\n\t}\r\n}\r\n\r\n"]}