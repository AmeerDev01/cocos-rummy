{"version":3,"sources":["file:///Users/geliang/web/dibai/hall/assets/script/subGame/fish/components/Fish_Test.ts"],"names":["EditBox","Node","Toggle","Vec3","_decorator","screen","view","BaseComponent","mainViewModel","fishConfig","SKT_MAG_TYPE","sktMsgListener","config","fishCommondConfig","ccclass","property","Fish_Test","propertyNode","props_btn_Info","props_change_bg","props_clear_fish","props_scale","props","events","start","initState","bindEvent","lastId","count","node","getChildByName","on","EventType","TOUCH_END","getFishManager","clearAllSceneAllFish","fishNo","getComponent","string","cuvNo","Angle","startPos","split","addFish","object_id","fish_id","Number","cve_id","run_t","spos","parseInt","breserve","angle","user_info","TOGGLE","e","getBatteryManager","getMyselfBatteryObj","setLockFisState","isChecked","selfUserId","enterRoomVo","roomId","seats","order","cedit","icon","nickName","ip","playerId","sex","ready","bullet","offline","vip","level","dispath","JOIN_ROOM","scence","scenceId","fishs","batterys","testConfig","score","num","power","skin","insteadPlayers","window","setTimeout","REQ_SCENCE","id","randomInt","getBackgroundSceneManager","cutBackgroundScene","setSendYrbyReqHit","msg","fishInfo","find","v","fishConfigId","lst","fishId","max_rate","roomViewModel","clearAllFish","scale","getVisibleSize","width","scene_size","setScale","max","Math","floor","random","useProps","key","value","bindUI","console","log","getResolutionPolicy","windowSize","resolution","devicePixelRatio","update","deltaTime"],"mappings":"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","sourcesContent":["import { EditBox, Node, Toggle, UITransform, Vec3, _decorator, screen, view } from 'cc';\r\nimport { BaseComponent } from '../../../base/BaseComponent';\r\nimport { mainViewModel } from '../index';\r\nimport { fishBackgroundConfig } from '../config/ByBackgroundConfig';\r\nimport { fishConfig } from '../config/ByFishConfig';\r\nimport { Shake } from '../../../utils/Shake';\r\nimport { SKT_MAG_TYPE, sktMsgListener } from '../socketConnect';\r\nimport { EnterGameVo, EnterRoomVo } from '../type';\r\nimport config from '../config';\r\nimport { fishCommondConfig } from '../config/ByCommonConfig';\r\nconst { ccclass, property } = _decorator;\r\n\r\nexport interface IState {\r\n}\r\n\r\nexport interface IProps {\r\n}\r\nexport interface IEvent {\r\n}\r\n\r\n@ccclass('Fish_Test')\r\nexport class Fish_Test extends BaseComponent<IState, IProps, IEvent> {\r\n\tstart() {\r\n\t}\r\n\r\n\tprotected propertyNode = {\r\n\t\tprops_btn_Info: new Node(),\r\n\t\tprops_change_bg: new Node(),\r\n\t\tprops_clear_fish: new Node(),\r\n\t\tprops_scale: new Node(),\r\n\t}\r\n\tpublic props: IProps = {\r\n\t}\r\n\r\n\tpublic events: IEvent = {\r\n\t}\r\n\r\n\tprotected initState() {\r\n\t\treturn {\r\n\r\n\t\t}\r\n\t}\r\n\r\n\tprotected bindEvent(): void {\r\n\t\tlet lastId;\r\n\t\tlet count = 0;\r\n\t\tthis.node.getChildByName('Button').on(Node.EventType.TOUCH_END, () => {\r\n\t\t\tlastId && mainViewModel.getFishManager().clearAllSceneAllFish();\r\n\t\t\tconst fishNo = this.node.getChildByName('FishNo').getComponent(EditBox).string\r\n\t\t\tconst cuvNo = this.node.getChildByName('CuvNo').getComponent(EditBox).string\r\n\t\t\tconst Angle = this.node.getChildByName('Angle').getComponent(EditBox).string\r\n\t\t\tconst startPos = this.node.getChildByName('startPos').getComponent(EditBox).string.split(',');\r\n\t\t\tmainViewModel.getFishManager().addFish({\r\n\t\t\t\tobject_id: count++,\r\n\t\t\t\tfish_id: Number(fishNo),\r\n\t\t\t\tcve_id: Number(cuvNo),\r\n\t\t\t\trun_t: 0,\r\n\t\t\t\tspos: new Vec3(parseInt(startPos[0]), parseInt(startPos[1])),\r\n\t\t\t\tbreserve: false,\r\n\t\t\t\tangle: Number(Angle),\r\n\t\t\t\tuser_info: {},\r\n\t\t\t});\r\n\t\t})\r\n\r\n\t\tthis.node.getChildByName('SuoDing').on(Toggle.EventType.TOGGLE, (e: Toggle) => {\r\n\t\t\tmainViewModel.getBatteryManager().getMyselfBatteryObj().setLockFisState(e.isChecked);\r\n\t\t})\r\n\r\n\t\tthis.propertyNode.props_btn_Info.on(Node.EventType.TOUCH_END, () => {\r\n\t\t\tconfig.selfUserId = '10000';\r\n\t\t\tconst enterRoomVo = {\r\n\t\t\t\troomId: 1,\r\n\t\t\t\tseats: [\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\t/**座位顺序(0-5) */\r\n\t\t\t\t\t\torder: 2,\r\n\t\t\t\t\t\t/**当前积分 */\r\n\t\t\t\t\t\tcedit: 100000,\r\n\t\t\t\t\t\t/**头像地址 */\r\n\t\t\t\t\t\ticon: '1',\r\n\t\t\t\t\t\t/**玩家昵称 */\r\n\t\t\t\t\t\tnickName: '测试',\r\n\t\t\t\t\t\t/**玩家IP */\r\n\t\t\t\t\t\tip: 'string',\r\n\t\t\t\t\t\t/**玩家ID */\r\n\t\t\t\t\t\tplayerId: config.selfUserId,\r\n\t\t\t\t\t\t/**性别 */\r\n\t\t\t\t\t\tsex: 1,\r\n\t\t\t\t\t\t/**准备状态 */\r\n\t\t\t\t\t\tready: 0,\r\n\t\t\t\t\t\t/**子弹数量 */\r\n\t\t\t\t\t\tbullet: 1000000,\r\n\t\t\t\t\t\t/**离线(即被系统托管),0:没有离线,非0:离线 */\r\n\t\t\t\t\t\toffline: 0,\r\n\t\t\t\t\t\t/**vip等级 */\r\n\t\t\t\t\t\tvip: 1,\r\n\t\t\t\t\t\t/**等级 */\r\n\t\t\t\t\t\tlevel: 1,\r\n\t\t\t\t\t}\r\n\t\t\t\t]\r\n\t\t\t}\r\n\t\t\tsktMsgListener.dispath(SKT_MAG_TYPE.JOIN_ROOM, enterRoomVo);\r\n\r\n\t\t\tconst scence = {\r\n\t\t\t\t/**场景id */\r\n\t\t\t\tscenceId: 1,\r\n\t\t\t\t/**鱼 */\r\n\t\t\t\tfishs: [],\r\n\t\t\t\t/**炮台 */\r\n\t\t\t\tbatterys: [\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\t/**玩家id */\r\n\t\t\t\t\t\tplayerId: config.testConfig.playerId,\r\n\t\t\t\t\t\t/**座位顺序 */\r\n\t\t\t\t\t\torder: 1,\r\n\t\t\t\t\t\t/**炮管分数 */\r\n\t\t\t\t\t\tscore: 1,\r\n\t\t\t\t\t\t/**炮管数量 */\r\n\t\t\t\t\t\tnum: 0,\r\n\t\t\t\t\t\t/**是否能量炮(0:不是,非0:能量炮) */\r\n\t\t\t\t\t\tpower: 0,\r\n\t\t\t\t\t\t/**皮肤 */\r\n\t\t\t\t\t\tskin: 1\r\n\t\t\t\t\t}\r\n\t\t\t\t],\r\n\t\t\t\t/**代发碰撞玩家列表 */\r\n\t\t\t\tinsteadPlayers: [],\r\n\t\t\t}\r\n\r\n\t\t\twindow.setTimeout(() => {\r\n\t\t\t\tsktMsgListener.dispath(SKT_MAG_TYPE.REQ_SCENCE, scence);\r\n\t\t\t}, 100)\r\n\t\t})\r\n\t\tthis.propertyNode.props_change_bg.on(Node.EventType.TOUCH_END, () => {\r\n\t\t\tconst id = this.randomInt(16) + 1;\r\n\t\t\tmainViewModel.getBackgroundSceneManager().cutBackgroundScene(id);\r\n\t\t})\r\n\r\n\t\tmainViewModel.setSendYrbyReqHit((msg) => {\r\n\t\t\tconst fishInfo = fishConfig.find(v => v.id === msg.fishConfigId);\r\n\t\t\t// mainViewModel.fishDeath(1, msg.fishId, fishInfo.max_rate);\r\n\r\n\t\t\tconst lst = [\r\n\t\t\t\t{\r\n\t\t\t\t\tfishId: msg.fishId,\r\n\t\t\t\t\tscore: fishInfo.max_rate\r\n\t\t\t\t}, {\r\n\t\t\t\t\tfishId: msg.fishId + 1,\r\n\t\t\t\t\tscore: fishInfo.max_rate\r\n\t\t\t\t}, {\r\n\t\t\t\t\tfishId: msg.fishId + 2,\r\n\t\t\t\t\tscore: fishInfo.max_rate\r\n\t\t\t\t}\r\n\t\t\t]\r\n\t\t\t// mainViewModel.fishLstDeath(1, lst)\r\n\t\t})\r\n\r\n\t\tthis.propertyNode.props_clear_fish.on(Node.EventType.TOUCH_END, () => {\r\n\t\t\tmainViewModel.roomViewModel.clearAllFish();\r\n\t\t})\r\n\t\tthis.propertyNode.props_scale.on(Toggle.EventType.TOGGLE, (e: Toggle) => {\r\n\t\t\tconst scale = e.isChecked ? view.getVisibleSize().width / fishCommondConfig.scene_size.width : 1\r\n\t\t\tmainViewModel.setScale(scale)\r\n\t\t})\r\n\t}\r\n\r\n\tprivate randomInt(max) {\r\n\t\tif (max < 2) {\r\n\t\t\treturn 0;\r\n\t\t}\r\n\t\treturn Math.floor(Math.random() * max)\r\n\t}\r\n\r\n\tprotected useProps(key: keyof IProps, value: { pre: any, cur: any }) {\r\n\t}\r\n\r\n\tprotected bindUI(): void {\r\n\t\tconsole.log(view.getResolutionPolicy());\r\n\t\tconsole.log(view.getVisibleSize());\r\n\t\tconsole.log(view.getVisibleSize());\r\n\t\tconsole.log(screen.windowSize);\r\n\t\tconsole.log(screen.resolution);\r\n\t\tconsole.log(screen.devicePixelRatio);\r\n\t}\r\n\r\n\tupdate(deltaTime: number) {\r\n\r\n\t}\r\n}\r\n\r\n"]}