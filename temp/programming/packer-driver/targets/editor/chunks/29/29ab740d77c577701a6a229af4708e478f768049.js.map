{"version":3,"sources":["file:///Users/geliang/web/dibai/hall/assets/script/subGame/yxx/components/Yxx_GameBoard.ts"],"names":["_decorator","Animation","Button","instantiate","Label","Node","sp","Sprite","tween","Vec3","BaseComponent","global","lang","addToastAction","config","playBtnClick","playDong","playSieve","playTimeout","sourceManageSeletor","yxxAudio","SoundPathDefine","SpriteFramePathDefine","AnimationStatus","BetType","GameStatus","BANKER_ID","GameType","ccclass","property","Yxx_GameBoard","isComplete","propertyNode","props_bg","props_gameBoard","props_desk_bg","props_menu","props_btn_title_return","props_btn_title_menu","props_btn_title_set","props_btn_title_help","props_mask_titrle","props_label_countDownNum","props_countdown_bg","props_xiazhu_begin","props_xiazhu_end","props_result_wait","props_dice_container1","props_dice_container2","props_dice","props_open_panzi","props_open_gai","props_close_panzi","props_close_gai","props_heguan_zc","props_heguan_kaijiang","props_remind_repeat","props_remind_noBet","props_heguan_node","props","gameStatus","newResult","myHead","seats","countdown","tipType","events","openSettingView","openWinLossView","userInfos","balance","clearView","changeAnimationStatus","animationStatus","quitGame","openRulePanel","giveGift","value","memberId","num","isShowMenu","start","initState","bindEvent","bindEvent1","node","on","EventType","TOUCH_END","updateMenuStatus","betAmount","hallDispatch","content","write","k","palyingModule","GameExit","placeStr","getSkeleton","setCompleteListener","enabled","scheduleOnceEnhance","playPrizeAnimation","index","playOpenGaiAnimation","FLY_CHIP","HEAD_ADD_GOLD","winloss","balanceTime","playCloseGaiAnimation","FINISHED","showGiftWindow","YXX","undefined","useProps","key","updateCountDown","cur","BET","unscheduleAllCallbacks","resetSkeleton","getCountdownSkeleton","updateHeGuan","STOP_BET","type","openNoBet","openRemindRepeat","string","active","paused","sk","setAnimation","isBet","getComponent","Skeleton","bindUI","removeAllChildren","initHandle","play","addDice","playOneShot","SIEVE","CLOSE_GAI","kaijiang","positions","randomDicePosition","betTypes","forEach","v","createDice","KAI_GAI","handle","delay","scheduleOnce","Math","floor","random","dicePosition","length","arr","splice","betType","position","parent","spriteFrame","getFile","getDiceName","source","setScale","addChild","setPosition","CHOOK","DICE_4","CRAB","DICE_5","DEER","DICE_3","FISH","DICE_6","GOURD","DICE_2","SHRIMP","DICE_1","getGameNode","initEnd","defaultClip","anStatus","getState","name","isPlaying","speed","time","duration","destroyCallBack","call","update","deltaTime"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAASA,MAAAA,U,OAAAA,U;AAAYC,MAAAA,S,OAAAA,S;AAAWC,MAAAA,M,OAAAA,M;AAAQC,MAAAA,W,OAAAA,W;AAAaC,MAAAA,K,OAAAA,K;AAAOC,MAAAA,I,OAAAA,I;AAAMC,MAAAA,E,OAAAA,E;AAAIC,MAAAA,M,OAAAA,M;AAAQC,MAAAA,K,OAAAA,K;AAAoBC,MAAAA,I,OAAAA,I;;AACzFC,MAAAA,a,iBAAAA,a;;AACAC,MAAAA,M,iBAAAA,M;AAAQC,MAAAA,I,iBAAAA,I;;AACRC,MAAAA,c,iBAAAA,c;;AACFC,MAAAA,M;;AACEC,MAAAA,Y,iBAAAA,Y;AAAcC,MAAAA,Q,iBAAAA,Q;AAAUC,MAAAA,S,iBAAAA,S;AAAWC,MAAAA,W,iBAAAA,W;AAAaC,MAAAA,mB,iBAAAA,mB;AAAqBC,MAAAA,Q,iBAAAA,Q;;AACrEC,MAAAA,e,iBAAAA,e;;AACAC,MAAAA,qB,iBAAAA,qB;;AACAC,MAAAA,e,iBAAAA,e;AAA0BC,MAAAA,O,iBAAAA,O;AAASC,MAAAA,U,iBAAAA,U;;AACnCC,MAAAA,S,kBAAAA,S;AAAWC,MAAAA,Q,kBAAAA,Q;;;;;;;;;OACd;AAAEC,QAAAA,OAAF;AAAWC,QAAAA;AAAX,O,GAAwB7B,U;;+BAkCjB8B,a,WADZF,OAAO,CAAC,eAAD,C,gBAAR,MACaE,aADb;AAAA;AAAA,0CACyE;AAAA;AAAA;AAAA,eAIhEC,UAJgE,GAInD,KAJmD;AAAA,eAM9DC,YAN8D,GAM/C;AACxBC,YAAAA,QAAQ,EAAE,IAAI5B,IAAJ,EADc;AAExB6B,YAAAA,eAAe,EAAE,IAAI7B,IAAJ,EAFO;AAGxB8B,YAAAA,aAAa,EAAE,IAAI9B,IAAJ,EAHS;AAIxB+B,YAAAA,UAAU,EAAE,IAAI/B,IAAJ,EAJY;AAKxBgC,YAAAA,sBAAsB,EAAE,IAAInC,MAAJ,EALA;AAMxBoC,YAAAA,oBAAoB,EAAE,IAAIpC,MAAJ,EANE;AAOxBqC,YAAAA,mBAAmB,EAAE,IAAIrC,MAAJ,EAPG;AAQxBsC,YAAAA,oBAAoB,EAAE,IAAItC,MAAJ,EARE;AASxBuC,YAAAA,iBAAiB,EAAE,IAAIxC,SAAJ,EATK;AAUxByC,YAAAA,wBAAwB,EAAE,IAAItC,KAAJ,EAVF;AAWxBuC,YAAAA,kBAAkB,EAAE,IAAItC,IAAJ,EAXI;AAYxBuC,YAAAA,kBAAkB,EAAE,IAAIvC,IAAJ,EAZI;AAaxBwC,YAAAA,gBAAgB,EAAE,IAAIxC,IAAJ,EAbM;AAcxByC,YAAAA,iBAAiB,EAAE,IAAIzC,IAAJ,EAdK;AAgBxB0C,YAAAA,qBAAqB,EAAE,IAAI1C,IAAJ,EAhBC;AAiBxB2C,YAAAA,qBAAqB,EAAE,IAAI3C,IAAJ,EAjBC;AAkBxB4C,YAAAA,UAAU,EAAE,IAAI5C,IAAJ,EAlBY;AAmBxB6C,YAAAA,gBAAgB,EAAE,IAAI7C,IAAJ,EAnBM;AAoBxB8C,YAAAA,cAAc,EAAE,IAAI9C,IAAJ,EApBQ;AAqBxB+C,YAAAA,iBAAiB,EAAE,IAAI/C,IAAJ,EArBK;AAsBxBgD,YAAAA,eAAe,EAAE,IAAIhD,IAAJ,EAtBO;AAuBxBiD,YAAAA,eAAe,EAAE,IAAIjD,IAAJ,EAvBO;AAwBxBkD,YAAAA,qBAAqB,EAAE,IAAIlD,IAAJ,EAxBC;AAyBxBmD,YAAAA,mBAAmB,EAAE,IAAInD,IAAJ,EAzBG;AA0BxBoD,YAAAA,kBAAkB,EAAE,IAAIpD,IAAJ,EA1BI;AA2BxBqD,YAAAA,iBAAiB,EAAE,IAAIrD,IAAJ;AA3BK,WAN+C;AAAA,eAoCjEsD,KApCiE,GAoCjD;AACtBC,YAAAA,UAAU,EAAE,IADU;AAEtBC,YAAAA,SAAS,EAAE,IAFW;AAGtBC,YAAAA,MAAM,EAAE,IAHc;AAItBC,YAAAA,KAAK,EAAE,EAJe;AAKtBC,YAAAA,SAAS,EAAE,CALW;AAMtBC,YAAAA,OAAO,EAAE;AANa,WApCiD;AAAA,eA6CjEC,MA7CiE,GA6ChD;AACvBC,YAAAA,eAAe,EAAE,MAAM,CAAG,CADH;AAEvBC,YAAAA,eAAe,EAAE,CAACC,SAAD,EAAwBC,OAAxB,KAA4C,CAAG,CAFzC;AAGvBC,YAAAA,SAAS,EAAE,MAAM,CAAG,CAHG;AAIvBC,YAAAA,qBAAqB,EAAGC,eAAD,IAAsC,CAAG,CAJzC;AAKvBC,YAAAA,QAAQ,EAAE,MAAM,CAAG,CALI;AAMvBC,YAAAA,aAAa,EAAE,MAAM,CAAG,CAND;AAOvBC,YAAAA,QAAQ,EAAE,CAACC,KAAD,EAAgBC,QAAhB,EAAkCC,GAAlC,KAAkD,CAAG;AAPxC,WA7CgD;AAAA,eA6DhEC,UA7DgE,GA6DnD,KA7DmD;AAAA;;AACxEC,QAAAA,KAAK,GAAG,CACP;;AAqDSC,QAAAA,SAAS,GAAG;AACrB,iBAAO,EAAP;AAGA;;AAGSC,QAAAA,SAAS,GAAS;AAC3B,eAAKC,UAAL;AACA;;AACOA,QAAAA,UAAU,GAAS;AAC1B,eAAKpD,YAAL,CAAkBM,oBAAlB,CAAuC+C,IAAvC,CAA4CC,EAA5C,CAA+CjF,IAAI,CAACkF,SAAL,CAAeC,SAA9D,EAAyE,MAAM;AAC9E;AAAA;AAAA;AACA,iBAAKC,gBAAL;AACA,WAHD;AAKA,eAAKzD,YAAL,CAAkBO,mBAAlB,CAAsC8C,IAAtC,CAA2CC,EAA3C,CAA8CjF,IAAI,CAACkF,SAAL,CAAeC,SAA7D,EAAwE,MAAM;AAC7E;AAAA;AAAA;AACA,iBAAKtB,MAAL,CAAYC,eAAZ;AACA,WAHD;AAIA,eAAKnC,YAAL,CAAkBQ,oBAAlB,CAAuC6C,IAAvC,CAA4CC,EAA5C,CAA+CjF,IAAI,CAACkF,SAAL,CAAeC,SAA9D,EAAyE,MAAM;AAC9E;AAAA;AAAA;AACA,iBAAKtB,MAAL,CAAYS,aAAZ;AACA,WAHD;AAKA,eAAK3C,YAAL,CAAkBK,sBAAlB,CAAyCgD,IAAzC,CAA8CC,EAA9C,CAAiDjF,IAAI,CAACkF,SAAL,CAAeC,SAAhE,EAA2E,MAAM;AAChF,gBAAI,KAAK7B,KAAL,CAAWG,MAAX,CAAkB4B,SAAlB,GAA8B,CAAlC,EAAqC;AACpC;AAAA;AAAA,oCAAOC,YAAP,CAAoB;AAAA;AAAA,oDAAe;AAAEC,gBAAAA,OAAO,EAAE;AAAA;AAAA,kCAAKC,KAAL,CAAWC,CAAC,IAAIA,CAAC,CAACC,aAAF,CAAgBC,QAAhC,EAA0C,EAA1C,EAA8C;AAAEC,kBAAAA,QAAQ,EAAE;AAAZ,iBAA9C;AAAX,eAAf,CAApB;AACA;AACA;;AACD,iBAAK/B,MAAL,CAAYQ,QAAZ;AACA;AAAA;AAAA;AACA,WAPD;AASA,eAAKwB,WAAL,CAAiB,KAAKlE,YAAL,CAAkBY,kBAAnC,EAAuDuD,mBAAvD,CAA2E,MAAM;AAChF,iBAAKD,WAAL,CAAiB,KAAKlE,YAAL,CAAkBY,kBAAnC,EAAuDwD,OAAvD,GAAiE,KAAjE;AACA,WAFD;AAGA,eAAKF,WAAL,CAAiB,KAAKlE,YAAL,CAAkBa,gBAAnC,EAAqDsD,mBAArD,CAAyE,MAAM;AAC9E,iBAAKD,WAAL,CAAiB,KAAKlE,YAAL,CAAkBa,gBAAnC,EAAqDuD,OAArD,GAA+D,KAA/D,CAD8E,CAG9E;;AACA,iBAAKC,mBAAL,CAAyB,MAAM;AAC9B,kBAAI,CAAC,KAAK1C,KAAL,CAAWE,SAAhB,EAA2B;AAC3B,mBAAKyC,kBAAL;AACA,aAHD,EAGG,GAHH;AAIA,WARD;AAUA,eAAKJ,WAAL,CAAiB,KAAKlE,YAAL,CAAkBkB,gBAAnC,EAAqDiD,mBAArD,CAA0EI,KAAD,IAAW,CACnF;AACA,WAFD,EArC0B,CAyC1B;;AACA,eAAKL,WAAL,CAAiB,KAAKlE,YAAL,CAAkBmB,cAAnC,EAAmDgD,mBAAnD,CAAwEI,KAAD,IAAW;AACjF,iBAAKC,oBAAL,CAA0B,KAA1B,EADiF,CAGjF;;AACA,iBAAKH,mBAAL,CAAyB,MAAM;AAC9B,mBAAKnC,MAAL,CAAYM,qBAAZ,CAAkC;AAAA;AAAA,sDAAgBiC,QAAlD;AACA,mBAAKvC,MAAL,CAAYM,qBAAZ,CAAkC;AAAA;AAAA,sDAAgBkC,aAAlD;AACA,aAHD,EAGG,CAHH,EAJiF,CASjF;;AACA,iBAAKL,mBAAL,CAAyB,MAAM;AAC9B,mBAAK1C,KAAL,CAAWG,MAAX,CAAkB4B,SAAlB,GAA8B,CAA9B,IAAmC,KAAKxB,MAAL,CAAYE,eAAZ,CAA4B,IAA5B,EAAkC,KAAKT,KAAL,CAAWG,MAAX,CAAkB6C,OAApD,CAAnC;AAEA,oBAAMC,WAAW,GAAG,CAApB,CAH8B,CAI9B;;AACA,mBAAKP,mBAAL,CAAyB,MAAM;AAC9B,qBAAKnC,MAAL,CAAYK,SAAZ;AACA,eAFD,EAEGqC,WAFH,EAL8B,CAQ9B;;AACA,mBAAKP,mBAAL,CAAyB,MAAM;AAC9B,qBAAKQ,qBAAL,CAA2B,IAA3B;AACA,eAFD,EAEGD,WAAW,GAAG,CAFjB;AAGA,aAZD,EAYG,CAZH;AAaA,WAvBD,EA1C0B,CAmE1B;;AACA,eAAKV,WAAL,CAAiB,KAAKlE,YAAL,CAAkBqB,eAAnC,EAAoD8C,mBAApD,CAAyEI,KAAD,IAAW;AAClF,iBAAKM,qBAAL,CAA2B,KAA3B;AACA,iBAAKX,WAAL,CAAiB,KAAKlE,YAAL,CAAkBc,iBAAnC,EAAsDsD,OAAtD,GAAgE,IAAhE;AACA,WAHD;AAKA,eAAKpE,YAAL,CAAkBS,iBAAlB,CAAoC6C,EAApC,CAAuCrF,SAAS,CAACsF,SAAV,CAAoBuB,QAA3D,EAAqE,MAAM;AAC1E,iBAAK9B,UAAL,GAAkB,CAAC,KAAKA,UAAxB;AACA,WAFD;AAIA,eAAKhD,YAAL,CAAkB0B,iBAAlB,CAAoC4B,EAApC,CAAuCjF,IAAI,CAACkF,SAAL,CAAeC,SAAtD,EAAiE,MAAM;AACtE;AAAA;AAAA,kCAAOuB,cAAP,CAAsB;AAAA;AAAA,sCAASC,GAA/B,EAAoCC,SAApC,EAAgDpC,KAAD,IAAmB;AACjE,mBAAKX,MAAL,CAAYU,QAAZ,CAAqBC,KAArB;AAAA;AAAA,0CAAuC,CAAvC;AACA,aAFD;AAGA,WAJD;AAKA;;AAESqC,QAAAA,QAAQ,CAACC,GAAD,EAAoBtC,KAApB,EAAmD;AACpE,cAAIsC,GAAG,KAAK,WAAZ,EAAyB;AACxB,iBAAKC,eAAL,CAAqBvC,KAAK,CAACwC,GAA3B;AACA,WAFD,MAEO,IAAIF,GAAG,KAAK,YAAZ,EAA0B;AAChC;AACA,gBAAItC,KAAK,CAACwC,GAAN,KAAc;AAAA;AAAA,0CAAWC,GAA7B,EAAkC;AACjC,mBAAKC,sBAAL;AACA,mBAAKrB,WAAL,CAAiB,KAAKlE,YAAL,CAAkBY,kBAAnC,EAAuDwD,OAAvD,GAAiE,IAAjE;AACA,mBAAKF,WAAL,CAAiB,KAAKlE,YAAL,CAAkBa,gBAAnC,EAAqDuD,OAArD,GAA+D,KAA/D,CAHiC,CAIjC;;AACA,mBAAKF,WAAL,CAAiB,KAAKlE,YAAL,CAAkBc,iBAAnC,EAAsDsD,OAAtD,GAAgE,IAAhE,CALiC,CAMjC;;AACA,mBAAKlC,MAAL,CAAYK,SAAZ;AACA,mBAAKiD,aAAL,CAAmB,KAAKC,oBAAL,EAAnB;AACA,mBAAKC,YAAL,CAAkB,KAAlB,EATiC,CAUjC;;AACA,mBAAKb,qBAAL,CAA2B,KAA3B;AACA,mBAAKL,oBAAL,CAA0B,KAA1B;AACA,aAbD,MAaO,IAAI3B,KAAK,CAACwC,GAAN,KAAc;AAAA;AAAA,0CAAWM,QAA7B,EAAuC;AAC7C,mBAAKzB,WAAL,CAAiB,KAAKlE,YAAL,CAAkBa,gBAAnC,EAAqDuD,OAArD,GAA+D,IAA/D;AAEA,mBAAKsB,YAAL,CAAkB,IAAlB;AACA;AACD,WApBM,MAoBA,IAAIP,GAAG,KAAK,SAAR,IAAqBtC,KAAK,CAACwC,GAA/B,EAAoC;AAC1C,gBAAI,KAAK1D,KAAL,CAAWM,OAAX,CAAmB2D,IAAnB,KAA4B,CAAhC,EAAmC;AAClC,mBAAKC,SAAL;AACA,aAFD,MAEO,IAAI,KAAKlE,KAAL,CAAWM,OAAX,CAAmB2D,IAAnB,KAA4B,CAAhC,EAAmC;AACzC,mBAAKE,gBAAL;AACA;AACD;AACD;;AAEOV,QAAAA,eAAe,CAACpD,SAAD,EAAoB;AAC1C,cAAI,CAAC,KAAKjC,UAAV,EAAsB;AACtB,eAAKC,YAAL,CAAkBU,wBAAlB,CAA2CqF,MAA3C,GAAoD/D,SAAS,GAAG,EAAhE;AACA,eAAKhC,YAAL,CAAkBW,kBAAlB,CAAqCqF,MAArC,GAA8ChE,SAAS,GAAG,CAA1D;AACA,eAAKyD,oBAAL,GAA4BQ,MAA5B,GAAqCjE,SAAS,GAAG,CAAjD;AACAA,UAAAA,SAAS,KAAK,CAAd,IAAmB;AAAA;AAAA,2CAAnB;AACAA,UAAAA,SAAS,IAAI,CAAb,IAAkB,KAAKwD,aAAL,CAAmB,KAAKC,oBAAL,EAAnB,CAAlB;AACA;AAED;;;AACQD,QAAAA,aAAa,CAACU,EAAD,EAAkB;AACtCA,UAAAA,EAAE,CAACC,YAAH,CAAgB,CAAhB,EAAmB,WAAnB,EAAgC,IAAhC;AACA;;AAEO7B,QAAAA,kBAAkB,GAAG;AAC5B,cAAI,CAAC,KAAK8B,KAAL,EAAL,EAAmB;AAClB,iBAAKlC,WAAL,CAAiB,KAAKlE,YAAL,CAAkBc,iBAAnC,EAAsDsD,OAAtD,GAAgE,KAAhE;AACA;;AACD,eAAKI,oBAAL,CAA0B,IAA1B;AACA;;AAEOiB,QAAAA,oBAAoB,GAAG;AAC9B,iBAAO,KAAKzF,YAAL,CAAkBW,kBAAlB,CAAqC0F,YAArC,CAAkD/H,EAAE,CAACgI,QAArD,CAAP;AACA;;AAEOpC,QAAAA,WAAW,CAACb,IAAD,EAAa;AAC/B,iBAAOA,IAAI,CAACgD,YAAL,CAAkB/H,EAAE,CAACgI,QAArB,CAAP;AACA;;AAESC,QAAAA,MAAM,GAAS;AACxB;AACA,eAAKrC,WAAL,CAAiB,KAAKlE,YAAL,CAAkBY,kBAAnC,EAAuDwD,OAAvD,GAAiE,KAAjE;AACA,eAAKF,WAAL,CAAiB,KAAKlE,YAAL,CAAkBa,gBAAnC,EAAqDuD,OAArD,GAA+D,KAA/D;AACA,eAAKpE,YAAL,CAAkBW,kBAAlB,CAAqCqF,MAArC,GAA8C,KAA9C;AACA,eAAKhG,YAAL,CAAkBe,qBAAlB,CAAwCyF,iBAAxC;AAEA,eAAKhC,oBAAL,CAA0B,KAA1B;AACA,eAAKK,qBAAL,CAA2B,KAA3B,EARwB,CAUxB;;AAEA,eAAK4B,UAAL,CAAgB,KAAhB;AACA;;AAEOjC,QAAAA,oBAAoB,CAACkC,IAAD,EAAgB;AAC3C,cAAIA,IAAI,IAAI,KAAKN,KAAL,EAAZ,EAA0B;AACzB;AACA;;AACD,eAAKlC,WAAL,CAAiB,KAAKlE,YAAL,CAAkBkB,gBAAnC,EAAqDkD,OAArD,GAA+DsC,IAA/D;AACA,eAAKxC,WAAL,CAAiB,KAAKlE,YAAL,CAAkBmB,cAAnC,EAAmDiD,OAAnD,GAA6DsC,IAA7D;AACA,eAAKxC,WAAL,CAAiB,KAAKlE,YAAL,CAAkBkB,gBAAnC,EAAqD+E,MAArD,GAA8D,CAACS,IAA/D;AACA,eAAKxC,WAAL,CAAiB,KAAKlE,YAAL,CAAkBmB,cAAnC,EAAmD8E,MAAnD,GAA4D,CAACS,IAA7D;;AACA,cAAI,CAACA,IAAL,EAAW;AACV,iBAAK1G,YAAL,CAAkBe,qBAAlB,CAAwCiF,MAAxC,GAAiD,KAAjD;AACA;;AACDU,UAAAA,IAAI,IAAI,KAAKC,OAAL,EAAR;AACA;;AAEO9B,QAAAA,qBAAqB,CAAC6B,IAAD,EAAgB;AAC5C,cAAIA,IAAI,IAAI,KAAKN,KAAL,EAAZ,EAA0B;AACzB;AACA;;AACD,eAAKlC,WAAL,CAAiB,KAAKlE,YAAL,CAAkBoB,iBAAnC,EAAsDgD,OAAtD,GAAgEsC,IAAhE;AACA,eAAKxC,WAAL,CAAiB,KAAKlE,YAAL,CAAkBqB,eAAnC,EAAoD+C,OAApD,GAA8DsC,IAA9D;AACA,eAAKxC,WAAL,CAAiB,KAAKlE,YAAL,CAAkBoB,iBAAnC,EAAsD6E,MAAtD,GAA+D,CAACS,IAAhE;AACA,eAAKxC,WAAL,CAAiB,KAAKlE,YAAL,CAAkBqB,eAAnC,EAAoD4E,MAApD,GAA6D,CAACS,IAA9D;AACA,eAAK1G,YAAL,CAAkBgB,qBAAlB,CAAwCgF,MAAxC,GAAiDU,IAAjD;;AACA,cAAI,CAACA,IAAL,EAAW;AACV,iBAAK1G,YAAL,CAAkBgB,qBAAlB,CAAwCgF,MAAxC,GAAiD,KAAjD;AACA,WAFD,MAEO;AACN;AACA,iBAAK3B,mBAAL,CAAyB,MAAM;AAC9B;AAAA;AAAA;AACA;AAAA;AAAA,wCAASuC,WAAT,CAAqB;AAAA;AAAA,sDAAgBC,KAArC;AACA,aAHD,EAGG,CAHH;AAIA,iBAAKxC,mBAAL,CAAyB,MAAM;AAC9B;AAAA;AAAA;AACA,aAFD,EAEG,GAFH;AAGA,iBAAKnC,MAAL,CAAYM,qBAAZ,CAAkC;AAAA;AAAA,oDAAgBsE,SAAlD;AACA;AACD;;AAEOpB,QAAAA,YAAY,CAACqB,QAAD,EAAoB;AACvC,eAAK7C,WAAL,CAAiB,KAAKlE,YAAL,CAAkBuB,qBAAnC,EAA0D6C,OAA1D,GAAoE2C,QAApE;AACA,eAAK7C,WAAL,CAAiB,KAAKlE,YAAL,CAAkBsB,eAAnC,EAAoD8C,OAApD,GAA8D,CAAC2C,QAA/D;AACA;AAED;;;AACQJ,QAAAA,OAAO,GAAG;AACjB;AACA,eAAK3G,YAAL,CAAkBe,qBAAlB,CAAwCiF,MAAxC,GAAiD,IAAjD,CAFiB,CAGjB;;AACA,eAAKhG,YAAL,CAAkBe,qBAAlB,CAAwCyF,iBAAxC;AACA,eAAKxG,YAAL,CAAkBgB,qBAAlB,CAAwCwF,iBAAxC,GALiB,CAMjB;;AACA,gBAAMQ,SAAS,GAAG,KAAKC,kBAAL,EAAlB,CAPiB,CAQjB;;AACA,eAAKtF,KAAL,CAAWE,SAAX,IAAwB,KAAKF,KAAL,CAAWE,SAAX,CAAqBqF,QAArB,CAA8BC,OAA9B,CAAsC,CAACC,CAAD,EAAI7C,KAAJ,KAAc;AAC3E,iBAAK8C,UAAL,CAAgBD,CAAhB,EAAmBJ,SAAS,CAACzC,KAAD,CAA5B,EAAqC,KAAKvE,YAAL,CAAkBe,qBAAvD;AACA,iBAAKsG,UAAL,CAAgBD,CAAhB,EAAmBJ,SAAS,CAACzC,KAAD,CAA5B,EAAqC,KAAKvE,YAAL,CAAkBgB,qBAAvD;AACA,WAHuB,CAAxB,CATiB,CAajB;;AACA,eAAKqD,mBAAL,CAAyB,MAAM;AAC9B,iBAAKrE,YAAL,CAAkBe,qBAAlB,CAAwCiF,MAAxC,GAAiD,KAAjD;AACA,WAFD,EAEG,IAFH;AAIA,eAAK3B,mBAAL,CAAyB,MAAM;AAC9B;AAAA;AAAA;AACA,WAFD,EAEG,GAFH,EAlBiB,CAqBjB;;AACA,eAAKA,mBAAL,CAAyB,MAAM;AAC9B,iBAAKnC,MAAL,CAAYM,qBAAZ,CAAkC;AAAA;AAAA,oDAAgB8E,OAAlD;AACA,WAFD,EAEG,GAFH;AAGA;;AAEOjD,QAAAA,mBAAmB,CAACkD,MAAD,EAAmBC,KAAnB,EAAkC;AAC5D;AACA,eAAKC,YAAL,CAAkBF,MAAlB,EAA0BC,KAA1B;AACA;;AAEOpB,QAAAA,KAAK,GAAG;AACf,iBAAO,KAAKzE,KAAL,IAAc,KAAKA,KAAL,CAAWC,UAAX,KAA0B;AAAA;AAAA,wCAAW0D,GAA1D;AACA;;AAEO2B,QAAAA,kBAAkB,GAAG;AAC5B,gBAAM1C,KAAK,GAAGmD,IAAI,CAACC,KAAL,CAAWD,IAAI,CAACE,MAAL,KAAgB;AAAA;AAAA,gCAAOC,YAAP,CAAoBC,MAA/C,CAAd;AACA,gBAAMC,GAAG,GAAG,CAAC,GAAG;AAAA;AAAA,gCAAOF,YAAX,CAAZ;AACAE,UAAAA,GAAG,CAACC,MAAJ,CAAWzD,KAAX,EAAkB,CAAlB;AACA,iBAAOwD,GAAP;AACA;;AAEOV,QAAAA,UAAU,CAACY,OAAD,EAAmBC,QAAnB,EAAmCC,MAAnC,EAAiD;AAClE,gBAAM9E,IAAI,GAAGlF,WAAW,CAAC,KAAK6B,YAAL,CAAkBiB,UAAnB,CAAxB;AACAoC,UAAAA,IAAI,CAACgD,YAAL,CAAkB9H,MAAlB,EAA0B6J,WAA1B,GAAwC;AAAA;AAAA,4DAAsBC,OAAtB,CAA8B,KAAKC,WAAL,CAAiBL,OAAjB,CAA9B,EAAyDM,MAAjG;AACAlF,UAAAA,IAAI,CAACmF,QAAL,CAAc,IAAI/J,IAAJ,CAAS,GAAT,EAAc,GAAd,CAAd;AACA0J,UAAAA,MAAM,CAACM,QAAP,CAAgBpF,IAAhB;AACAA,UAAAA,IAAI,CAACqF,WAAL,CAAiBR,QAAjB;AACA;;AAEOI,QAAAA,WAAW,CAACL,OAAD,EAAmB;AACrC,cAAI;AAAA;AAAA,kCAAQU,KAAR,KAAkBV,OAAtB,EAA+B;AAC9B,mBAAO;AAAA;AAAA,gEAAsBW,MAA7B;AACA,WAFD,MAEO,IAAI;AAAA;AAAA,kCAAQC,IAAR,KAAiBZ,OAArB,EAA8B;AACpC,mBAAO;AAAA;AAAA,gEAAsBa,MAA7B;AACA,WAFM,MAEA,IAAI;AAAA;AAAA,kCAAQC,IAAR,KAAiBd,OAArB,EAA8B;AACpC,mBAAO;AAAA;AAAA,gEAAsBe,MAA7B;AACA,WAFM,MAEA,IAAI;AAAA;AAAA,kCAAQC,IAAR,KAAiBhB,OAArB,EAA8B;AACpC,mBAAO;AAAA;AAAA,gEAAsBiB,MAA7B;AACA,WAFM,MAEA,IAAI;AAAA;AAAA,kCAAQC,KAAR,KAAkBlB,OAAtB,EAA+B;AACrC,mBAAO;AAAA;AAAA,gEAAsBmB,MAA7B;AACA,WAFM,MAEA,IAAI;AAAA;AAAA,kCAAQC,MAAR,KAAmBpB,OAAvB,EAAgC;AACtC,mBAAO;AAAA;AAAA,gEAAsBqB,MAA7B;AACA;AACD;;AAEMC,QAAAA,WAAW,GAAG;AACpB,iBAAO,KAAKvJ,YAAL,CAAkBE,eAAzB;AACA;;AAEMuG,QAAAA,UAAU,CAACT,MAAD,EAAkB;AAClC,eAAKhG,YAAL,CAAkBC,QAAlB,CAA2B+F,MAA3B,GAAoCA,MAApC;AACA,eAAKhG,YAAL,CAAkBG,aAAlB,CAAgC6F,MAAhC,GAAyCA,MAAzC;AACA,eAAKhG,YAAL,CAAkBI,UAAlB,CAA6B4F,MAA7B,GAAsCA,MAAtC;AACA,eAAKhG,YAAL,CAAkBc,iBAAlB,CAAoCkF,MAApC,GAA6CA,MAA7C;AACA,eAAKhG,YAAL,CAAkBsB,eAAlB,CAAkC0E,MAAlC,GAA2CA,MAA3C;AACA,eAAKhG,YAAL,CAAkBuB,qBAAlB,CAAwCyE,MAAxC,GAAiDA,MAAjD;AACA,eAAKjG,UAAL,GAAkBiG,MAAlB;AACA;;AAEMwD,QAAAA,OAAO,GAAG;AAChB,eAAK/C,UAAL,CAAgB,IAAhB;AACA;;AAEOhD,QAAAA,gBAAgB,GAAG;AAC1B,cAAI,CAAC,KAAKzD,YAAL,CAAkBS,iBAAnB,IAAwC,CAAC,KAAKT,YAAL,CAAkBS,iBAAlB,CAAoCgJ,WAAjF,EAA8F;AAC7F;AACA;;AACD,gBAAMC,QAAQ,GAAG,KAAK1J,YAAL,CAAkBS,iBAAlB,CAAoCkJ,QAApC,CAA6C,KAAK3J,YAAL,CAAkBS,iBAAlB,CAAoCgJ,WAApC,CAAgDG,IAA7F,CAAjB;;AACA,cAAIF,QAAQ,CAACG,SAAb,EAAwB;AACvB;AACA,WAPyB,CAQ1B;;;AACA,cAAI,KAAK7G,UAAT,EAAqB;AACpB0G,YAAAA,QAAQ,CAACI,KAAT,GAAiB,CAAC,CAAlB;AACAJ,YAAAA,QAAQ,CAACK,IAAT,GAAgBL,QAAQ,CAACM,QAAzB;AACA,WAHD,MAGO;AACNN,YAAAA,QAAQ,CAACI,KAAT,GAAiB,CAAjB;AACAJ,YAAAA,QAAQ,CAACK,IAAT,GAAgB,CAAhB;AACA;;AACD,eAAK/J,YAAL,CAAkBS,iBAAlB,CAAoCiG,IAApC;AACA;;AAESuD,QAAAA,eAAe,GAAS;AACjC,eAAK1E,sBAAL;AACA;;AAEMM,QAAAA,SAAS,GAAG;AAClB,eAAK7F,YAAL,CAAkByB,kBAAlB,CAAqCuE,MAArC,GAA8C,IAA9C;AACAxH,UAAAA,KAAK,CAAC,KAAKwB,YAAL,CAAkByB,kBAAnB,CAAL,CACE+F,KADF,CACQ,CADR,EAEE0C,IAFF,CAEO,MAAM;AACX,iBAAKlK,YAAL,CAAkByB,kBAAlB,CAAqCuE,MAArC,GAA8C,KAA9C;AACA,WAJF,EAKE/C,KALF;AAMA;;AACM6C,QAAAA,gBAAgB,GAAG;AACzB,eAAK9F,YAAL,CAAkBwB,mBAAlB,CAAsCwE,MAAtC,GAA+C,IAA/C;AACAxH,UAAAA,KAAK,CAAC,KAAKwB,YAAL,CAAkBwB,mBAAnB,CAAL,CACEgG,KADF,CACQ,CADR,EAEE0C,IAFF,CAEO,MAAM;AACX,iBAAKlK,YAAL,CAAkBwB,mBAAlB,CAAsCwE,MAAtC,GAA+C,KAA/C;AACA,WAJF,EAKE/C,KALF;AAMA;;AAEDkH,QAAAA,MAAM,CAACC,SAAD,EAAoB,CAEzB;;AA9YuE,O","sourcesContent":["import { _decorator, Animation, Button, instantiate, Label, Node, sp, Sprite, tween, UITransform, Vec3 } from 'cc';\r\nimport { BaseComponent } from '../../../base/BaseComponent';\r\nimport { global, lang } from '../../../hall';\r\nimport { addToastAction } from '../../../hall/store/actions/baseBoard';\r\nimport config from '../config';\r\nimport { playBtnClick, playDong, playSieve, playTimeout, sourceManageSeletor, yxxAudio } from '../index';\r\nimport { SoundPathDefine } from '../sourceDefine/soundDefine';\r\nimport { SpriteFramePathDefine } from '../sourceDefine/spriteDefine';\r\nimport { AnimationStatus, BetData, BetType, GameStatus, HeadType, Result, TipType, UserInfo } from '../type';\r\nimport { BANKER_ID, GameType } from '../../../common/viewModel/GiftUserViewModel';\r\nconst { ccclass, property } = _decorator;\r\n\r\nexport interface IState {\r\n\r\n}\r\n\r\nexport interface IProps {\r\n\tgameStatus: GameStatus,\r\n\t/**最新结果 */\r\n\tnewResult: Result,\r\n\t/**座位 */\r\n\tseats: HeadType[],\r\n\tmyHead: HeadType,\r\n\tcountdown: number,\r\n\t/**提示类型 */\r\n\ttipType: TipType,\r\n}\r\nexport interface IEvent {\r\n\t/**打开设置面板 */\r\n\topenSettingView: () => void,\r\n\t/**打开输赢结算面板 */\r\n\topenWinLossView: (userInfos: UserInfo[], balance: number) => void,\r\n\t/**清空 */\r\n\tclearView: () => void,\r\n\t/**改变动画状态 */\r\n\tchangeAnimationStatus: (animationStatus: AnimationStatus) => void,\r\n\t/**退出游戏 */\r\n\tquitGame: () => void,\r\n\t/**打开规则 */\r\n\topenRulePanel: () => void,\r\n\tgiveGift: (value: number, memberId: string, num: number) => void,\r\n}\r\n\r\n@ccclass('Yxx_GameBoard')\r\nexport class Yxx_GameBoard extends BaseComponent<IState, IProps, IEvent> {\r\n\tstart() {\r\n\t}\r\n\r\n\tprivate isComplete = false;\r\n\r\n\tprotected propertyNode = {\r\n\t\tprops_bg: new Node(),\r\n\t\tprops_gameBoard: new Node(),\r\n\t\tprops_desk_bg: new Node(),\r\n\t\tprops_menu: new Node(),\r\n\t\tprops_btn_title_return: new Button(),\r\n\t\tprops_btn_title_menu: new Button(),\r\n\t\tprops_btn_title_set: new Button(),\r\n\t\tprops_btn_title_help: new Button(),\r\n\t\tprops_mask_titrle: new Animation(),\r\n\t\tprops_label_countDownNum: new Label(),\r\n\t\tprops_countdown_bg: new Node(),\r\n\t\tprops_xiazhu_begin: new Node(),\r\n\t\tprops_xiazhu_end: new Node(),\r\n\t\tprops_result_wait: new Node(),\r\n\r\n\t\tprops_dice_container1: new Node(),\r\n\t\tprops_dice_container2: new Node(),\r\n\t\tprops_dice: new Node(),\r\n\t\tprops_open_panzi: new Node(),\r\n\t\tprops_open_gai: new Node(),\r\n\t\tprops_close_panzi: new Node(),\r\n\t\tprops_close_gai: new Node(),\r\n\t\tprops_heguan_zc: new Node(),\r\n\t\tprops_heguan_kaijiang: new Node(),\r\n\t\tprops_remind_repeat: new Node(),\r\n\t\tprops_remind_noBet: new Node(),\r\n\t\tprops_heguan_node: new Node(),\r\n\t}\r\n\r\n\tpublic props: IProps = {\r\n\t\tgameStatus: null,\r\n\t\tnewResult: null,\r\n\t\tmyHead: null,\r\n\t\tseats: [],\r\n\t\tcountdown: 0,\r\n\t\ttipType: null,\r\n\t}\r\n\r\n\tpublic events: IEvent = {\r\n\t\topenSettingView: () => { },\r\n\t\topenWinLossView: (userInfos: UserInfo[], balance: number) => { },\r\n\t\tclearView: () => { },\r\n\t\tchangeAnimationStatus: (animationStatus: AnimationStatus) => { },\r\n\t\tquitGame: () => { },\r\n\t\topenRulePanel: () => { },\r\n\t\tgiveGift: (value: number, memberId: string, num: number) => { }\r\n\t}\r\n\r\n\tprotected initState() {\r\n\t\treturn {\r\n\r\n\t\t}\r\n\t}\r\n\r\n\tprivate isShowMenu = false;\r\n\tprotected bindEvent(): void {\r\n\t\tthis.bindEvent1();\r\n\t}\r\n\tprivate bindEvent1(): void {\r\n\t\tthis.propertyNode.props_btn_title_menu.node.on(Node.EventType.TOUCH_END, () => {\r\n\t\t\tplayBtnClick();\r\n\t\t\tthis.updateMenuStatus();\r\n\t\t});\r\n\r\n\t\tthis.propertyNode.props_btn_title_set.node.on(Node.EventType.TOUCH_END, () => {\r\n\t\t\tplayBtnClick();\r\n\t\t\tthis.events.openSettingView();\r\n\t\t});\r\n\t\tthis.propertyNode.props_btn_title_help.node.on(Node.EventType.TOUCH_END, () => {\r\n\t\t\tplayBtnClick();\r\n\t\t\tthis.events.openRulePanel();\r\n\t\t});\r\n\r\n\t\tthis.propertyNode.props_btn_title_return.node.on(Node.EventType.TOUCH_END, () => {\r\n\t\t\tif (this.props.myHead.betAmount > 0) {\r\n\t\t\t\tglobal.hallDispatch(addToastAction({ content: lang.write(k => k.palyingModule.GameExit, {}, { placeStr: \"您有下注，不能退出\" }) }));\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tthis.events.quitGame();\r\n\t\t\tplayBtnClick();\r\n\t\t});\r\n\r\n\t\tthis.getSkeleton(this.propertyNode.props_xiazhu_begin).setCompleteListener(() => {\r\n\t\t\tthis.getSkeleton(this.propertyNode.props_xiazhu_begin).enabled = false;\r\n\t\t})\r\n\t\tthis.getSkeleton(this.propertyNode.props_xiazhu_end).setCompleteListener(() => {\r\n\t\t\tthis.getSkeleton(this.propertyNode.props_xiazhu_end).enabled = false;\r\n\r\n\t\t\t// 结束动画之后，开始播放开奖动画\r\n\t\t\tthis.scheduleOnceEnhance(() => {\r\n\t\t\t\tif (!this.props.newResult) return;\r\n\t\t\t\tthis.playPrizeAnimation();\r\n\t\t\t}, 0.5)\r\n\t\t})\r\n\r\n\t\tthis.getSkeleton(this.propertyNode.props_open_panzi).setCompleteListener((index) => {\r\n\t\t\t// log(\"props_open_panzi end\");\r\n\t\t})\r\n\r\n\t\t// 开盖动画结束之后暂停开盖动画，同时开始关闭盖子的动画\r\n\t\tthis.getSkeleton(this.propertyNode.props_open_gai).setCompleteListener((index) => {\r\n\t\t\tthis.playOpenGaiAnimation(false);\r\n\r\n\t\t\t// 所有延时动画都要加上如果下注状态就不处理了\r\n\t\t\tthis.scheduleOnceEnhance(() => {\r\n\t\t\t\tthis.events.changeAnimationStatus(AnimationStatus.FLY_CHIP);\r\n\t\t\t\tthis.events.changeAnimationStatus(AnimationStatus.HEAD_ADD_GOLD);\r\n\t\t\t}, 3)\r\n\r\n\t\t\t// 开盖动画结束之后，给一定延时打开结算面板一个延时\r\n\t\t\tthis.scheduleOnceEnhance(() => {\r\n\t\t\t\tthis.props.myHead.betAmount > 0 && this.events.openWinLossView(null, this.props.myHead.winloss);\r\n\r\n\t\t\t\tconst balanceTime = 3;\r\n\t\t\t\t// 结算面板打开之后，给一定延时清除数据\r\n\t\t\t\tthis.scheduleOnceEnhance(() => {\r\n\t\t\t\t\tthis.events.clearView();\r\n\t\t\t\t}, balanceTime)\r\n\t\t\t\t// 结算面板打开之后，给一定延时开始播放关盖动画，比清空数据要稍晚一点\r\n\t\t\t\tthis.scheduleOnceEnhance(() => {\r\n\t\t\t\t\tthis.playCloseGaiAnimation(true);\r\n\t\t\t\t}, balanceTime + 1)\r\n\t\t\t}, 3)\r\n\t\t})\r\n\r\n\t\t// 关闭盖子动画结束之后，暂停动画，同时显示待开盖的动画\r\n\t\tthis.getSkeleton(this.propertyNode.props_close_gai).setCompleteListener((index) => {\r\n\t\t\tthis.playCloseGaiAnimation(false);\r\n\t\t\tthis.getSkeleton(this.propertyNode.props_result_wait).enabled = true;\r\n\t\t})\r\n\r\n\t\tthis.propertyNode.props_mask_titrle.on(Animation.EventType.FINISHED, () => {\r\n\t\t\tthis.isShowMenu = !this.isShowMenu;\r\n\t\t});\r\n\r\n\t\tthis.propertyNode.props_heguan_node.on(Node.EventType.TOUCH_END, () => {\r\n\t\t\tglobal.showGiftWindow(GameType.YXX, undefined, (value: number) => {\r\n\t\t\t\tthis.events.giveGift(value, BANKER_ID, 0);\r\n\t\t\t})\r\n\t\t});\r\n\t}\r\n\r\n\tprotected useProps(key: keyof IProps, value: { pre: any, cur: any }) {\r\n\t\tif (key === 'countdown') {\r\n\t\t\tthis.updateCountDown(value.cur);\r\n\t\t} else if (key === 'gameStatus') {\r\n\t\t\t// log(\"game board ==\", key, value);\r\n\t\t\tif (value.cur === GameStatus.BET) {\r\n\t\t\t\tthis.unscheduleAllCallbacks();\r\n\t\t\t\tthis.getSkeleton(this.propertyNode.props_xiazhu_begin).enabled = true;\r\n\t\t\t\tthis.getSkeleton(this.propertyNode.props_xiazhu_end).enabled = false;\r\n\t\t\t\t// 由于把应用切换到后台之后，前面动画就暂停了，因此在开始下注之后，强行关闭动画\r\n\t\t\t\tthis.getSkeleton(this.propertyNode.props_result_wait).enabled = true;\r\n\t\t\t\t// 清理界面\r\n\t\t\t\tthis.events.clearView();\r\n\t\t\t\tthis.resetSkeleton(this.getCountdownSkeleton());\r\n\t\t\t\tthis.updateHeGuan(false);\r\n\t\t\t\t// 停止动画\r\n\t\t\t\tthis.playCloseGaiAnimation(false);\r\n\t\t\t\tthis.playOpenGaiAnimation(false);\r\n\t\t\t} else if (value.cur === GameStatus.STOP_BET) {\r\n\t\t\t\tthis.getSkeleton(this.propertyNode.props_xiazhu_end).enabled = true;\r\n\r\n\t\t\t\tthis.updateHeGuan(true);\r\n\t\t\t}\r\n\t\t} else if (key === 'tipType' && value.cur) {\r\n\t\t\tif (this.props.tipType.type === 0) {\r\n\t\t\t\tthis.openNoBet();\r\n\t\t\t} else if (this.props.tipType.type === 1) {\r\n\t\t\t\tthis.openRemindRepeat();\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tprivate updateCountDown(countdown: number) {\r\n\t\tif (!this.isComplete) return;\r\n\t\tthis.propertyNode.props_label_countDownNum.string = countdown + \"\";\r\n\t\tthis.propertyNode.props_countdown_bg.active = countdown > 0;\r\n\t\tthis.getCountdownSkeleton().paused = countdown > 3;\r\n\t\tcountdown === 3 && playTimeout();\r\n\t\tcountdown <= 0 && this.resetSkeleton(this.getCountdownSkeleton());\r\n\t}\r\n\r\n\t/**重置骨骼动画 */\r\n\tprivate resetSkeleton(sk: sp.Skeleton) {\r\n\t\tsk.setAnimation(0, \"animation\", true)\r\n\t}\r\n\r\n\tprivate playPrizeAnimation() {\r\n\t\tif (!this.isBet()) {\r\n\t\t\tthis.getSkeleton(this.propertyNode.props_result_wait).enabled = false;\r\n\t\t}\r\n\t\tthis.playOpenGaiAnimation(true);\r\n\t}\r\n\r\n\tprivate getCountdownSkeleton() {\r\n\t\treturn this.propertyNode.props_countdown_bg.getComponent(sp.Skeleton);\r\n\t}\r\n\r\n\tprivate getSkeleton(node: Node) {\r\n\t\treturn node.getComponent(sp.Skeleton);\r\n\t}\r\n\r\n\tprotected bindUI(): void {\r\n\t\t// this.propertyNode.props_mask_titrle.enabled = false;\r\n\t\tthis.getSkeleton(this.propertyNode.props_xiazhu_begin).enabled = false;\r\n\t\tthis.getSkeleton(this.propertyNode.props_xiazhu_end).enabled = false;\r\n\t\tthis.propertyNode.props_countdown_bg.active = false;\r\n\t\tthis.propertyNode.props_dice_container1.removeAllChildren();\r\n\r\n\t\tthis.playOpenGaiAnimation(false);\r\n\t\tthis.playCloseGaiAnimation(false);\r\n\r\n\t\t// this.updateHeGuan(false);\r\n\r\n\t\tthis.initHandle(false);\r\n\t}\r\n\r\n\tprivate playOpenGaiAnimation(play: boolean) {\r\n\t\tif (play && this.isBet()) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tthis.getSkeleton(this.propertyNode.props_open_panzi).enabled = play;\r\n\t\tthis.getSkeleton(this.propertyNode.props_open_gai).enabled = play;\r\n\t\tthis.getSkeleton(this.propertyNode.props_open_panzi).paused = !play;\r\n\t\tthis.getSkeleton(this.propertyNode.props_open_gai).paused = !play;\r\n\t\tif (!play) {\r\n\t\t\tthis.propertyNode.props_dice_container1.active = false;\r\n\t\t}\r\n\t\tplay && this.addDice();\r\n\t}\r\n\r\n\tprivate playCloseGaiAnimation(play: boolean) {\r\n\t\tif (play && this.isBet()) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tthis.getSkeleton(this.propertyNode.props_close_panzi).enabled = play;\r\n\t\tthis.getSkeleton(this.propertyNode.props_close_gai).enabled = play;\r\n\t\tthis.getSkeleton(this.propertyNode.props_close_panzi).paused = !play;\r\n\t\tthis.getSkeleton(this.propertyNode.props_close_gai).paused = !play;\r\n\t\tthis.propertyNode.props_dice_container2.active = play;\r\n\t\tif (!play) {\r\n\t\t\tthis.propertyNode.props_dice_container2.active = false;\r\n\t\t} else {\r\n\t\t\t// playSieve();\r\n\t\t\tthis.scheduleOnceEnhance(() => {\r\n\t\t\t\tplaySieve();\r\n\t\t\t\tyxxAudio.playOneShot(SoundPathDefine.SIEVE);\r\n\t\t\t}, 1);\r\n\t\t\tthis.scheduleOnceEnhance(() => {\r\n\t\t\t\tplayDong()\r\n\t\t\t}, 2.7);\r\n\t\t\tthis.events.changeAnimationStatus(AnimationStatus.CLOSE_GAI);\r\n\t\t}\r\n\t}\r\n\r\n\tprivate updateHeGuan(kaijiang: boolean) {\r\n\t\tthis.getSkeleton(this.propertyNode.props_heguan_kaijiang).enabled = kaijiang;\r\n\t\tthis.getSkeleton(this.propertyNode.props_heguan_zc).enabled = !kaijiang;\r\n\t}\r\n\r\n\t/**添加骰子 */\r\n\tprivate addDice() {\r\n\t\t// 添加骰子的时候开盖盘子上面的骰子\r\n\t\tthis.propertyNode.props_dice_container1.active = true;\r\n\t\t// 清理历史骰子\r\n\t\tthis.propertyNode.props_dice_container1.removeAllChildren();\r\n\t\tthis.propertyNode.props_dice_container2.removeAllChildren();\r\n\t\t// 随机骰子位置\r\n\t\tconst positions = this.randomDicePosition();\r\n\t\t// 同时添加开盖盘子和关闭盖子盘子上面的骰子\r\n\t\tthis.props.newResult && this.props.newResult.betTypes.forEach((v, index) => {\r\n\t\t\tthis.createDice(v, positions[index], this.propertyNode.props_dice_container1);\r\n\t\t\tthis.createDice(v, positions[index], this.propertyNode.props_dice_container2);\r\n\t\t})\r\n\t\t// 由于挂载在开盖盘子上面的节点在动画结束时隐藏有一点点延迟，因此这里模拟同步动画时间\r\n\t\tthis.scheduleOnceEnhance(() => {\r\n\t\t\tthis.propertyNode.props_dice_container1.active = false;\r\n\t\t}, 1.87);\r\n\r\n\t\tthis.scheduleOnceEnhance(() => {\r\n\t\t\tplayDong()\r\n\t\t}, 0.5);\r\n\t\t// 播放添加历史记录动画\r\n\t\tthis.scheduleOnceEnhance(() => {\r\n\t\t\tthis.events.changeAnimationStatus(AnimationStatus.KAI_GAI);\r\n\t\t}, 1.2);\r\n\t}\r\n\r\n\tprivate scheduleOnceEnhance(handle: Function, delay: number) {\r\n\t\t// if (this.isBet()) return;\r\n\t\tthis.scheduleOnce(handle, delay);\r\n\t}\r\n\r\n\tprivate isBet() {\r\n\t\treturn this.props && this.props.gameStatus === GameStatus.BET;\r\n\t}\r\n\r\n\tprivate randomDicePosition() {\r\n\t\tconst index = Math.floor(Math.random() * config.dicePosition.length);\r\n\t\tconst arr = [...config.dicePosition];\r\n\t\tarr.splice(index, 1);\r\n\t\treturn arr;\r\n\t}\r\n\r\n\tprivate createDice(betType: BetType, position: Vec3, parent: Node) {\r\n\t\tconst node = instantiate(this.propertyNode.props_dice);\r\n\t\tnode.getComponent(Sprite).spriteFrame = sourceManageSeletor().getFile(this.getDiceName(betType)).source;\r\n\t\tnode.setScale(new Vec3(0.9, 0.9))\r\n\t\tparent.addChild(node);\r\n\t\tnode.setPosition(position);\r\n\t}\r\n\r\n\tprivate getDiceName(betType: BetType) {\r\n\t\tif (BetType.CHOOK === betType) {\r\n\t\t\treturn SpriteFramePathDefine.DICE_4;\r\n\t\t} else if (BetType.CRAB === betType) {\r\n\t\t\treturn SpriteFramePathDefine.DICE_5;\r\n\t\t} else if (BetType.DEER === betType) {\r\n\t\t\treturn SpriteFramePathDefine.DICE_3;\r\n\t\t} else if (BetType.FISH === betType) {\r\n\t\t\treturn SpriteFramePathDefine.DICE_6;\r\n\t\t} else if (BetType.GOURD === betType) {\r\n\t\t\treturn SpriteFramePathDefine.DICE_2;\r\n\t\t} else if (BetType.SHRIMP === betType) {\r\n\t\t\treturn SpriteFramePathDefine.DICE_1;\r\n\t\t}\r\n\t}\r\n\r\n\tpublic getGameNode() {\r\n\t\treturn this.propertyNode.props_gameBoard\r\n\t}\r\n\r\n\tpublic initHandle(active: boolean) {\r\n\t\tthis.propertyNode.props_bg.active = active;\r\n\t\tthis.propertyNode.props_desk_bg.active = active;\r\n\t\tthis.propertyNode.props_menu.active = active;\r\n\t\tthis.propertyNode.props_result_wait.active = active;\r\n\t\tthis.propertyNode.props_heguan_zc.active = active;\r\n\t\tthis.propertyNode.props_heguan_kaijiang.active = active;\r\n\t\tthis.isComplete = active;\r\n\t}\r\n\r\n\tpublic initEnd() {\r\n\t\tthis.initHandle(true);\r\n\t}\r\n\r\n\tprivate updateMenuStatus() {\r\n\t\tif (!this.propertyNode.props_mask_titrle || !this.propertyNode.props_mask_titrle.defaultClip) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tconst anStatus = this.propertyNode.props_mask_titrle.getState(this.propertyNode.props_mask_titrle.defaultClip.name);\r\n\t\tif (anStatus.isPlaying) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\t// 动画倒放\r\n\t\tif (this.isShowMenu) {\r\n\t\t\tanStatus.speed = -1;\r\n\t\t\tanStatus.time = anStatus.duration;\r\n\t\t} else {\r\n\t\t\tanStatus.speed = 1;\r\n\t\t\tanStatus.time = 0;\r\n\t\t}\r\n\t\tthis.propertyNode.props_mask_titrle.play();\r\n\t}\r\n\r\n\tprotected destroyCallBack(): void {\r\n\t\tthis.unscheduleAllCallbacks();\r\n\t}\r\n\r\n\tpublic openNoBet() {\r\n\t\tthis.propertyNode.props_remind_noBet.active = true;\r\n\t\ttween(this.propertyNode.props_remind_noBet)\r\n\t\t\t.delay(2)\r\n\t\t\t.call(() => {\r\n\t\t\t\tthis.propertyNode.props_remind_noBet.active = false;\r\n\t\t\t})\r\n\t\t\t.start()\r\n\t}\r\n\tpublic openRemindRepeat() {\r\n\t\tthis.propertyNode.props_remind_repeat.active = true;\r\n\t\ttween(this.propertyNode.props_remind_repeat)\r\n\t\t\t.delay(2)\r\n\t\t\t.call(() => {\r\n\t\t\t\tthis.propertyNode.props_remind_repeat.active = false;\r\n\t\t\t})\r\n\t\t\t.start()\r\n\t}\r\n\r\n\tupdate(deltaTime: number) {\r\n\r\n\t}\r\n}\r\n\r\n"]}