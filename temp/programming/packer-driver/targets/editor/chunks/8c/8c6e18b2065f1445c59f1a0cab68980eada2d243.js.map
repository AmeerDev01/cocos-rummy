{"version":3,"sources":["file:///Users/geliang/web/dibai/hall/assets/script/common/fish/BackgroundSceneManager.ts"],"names":["BackgroundSceneManager","UITransform","Vec3","tween","createAnimationNode","getAnimation","BackgroundScene","seaWaveZOrder","backgroundConfig","gameTextureConfig","backgroundMusConfig","sceneSize","sceneParent","seaWaveObject","seaWaveSize","backgroundCommon","currentScene","frontScene","cutSceneState","cutSceneTime","cutSceneTimeAdd","currentSceneID","frontSceneID","sourceManage","fishManager","musicEffectPlayer","scaleRatio","lastChangeTime","init","parent","textureConfig","common","cut_t","k","data","v","quitRoom","uninit","createSeawaveObj","wave_src_id","addChild","setWorldPosition","active","setSiblingIndex","getComponent","setScale","cutBackgroundScene","id","currentTime","Date","now","clearFishCacheData","sceneInfo","pos","width","height","multiplyScalar","children","length","play","mus_id","need_t","to","worldPosition","call","start","clearAllFish","console","log","getSceneState","forceChangeBkMus","musSrc","playBgm","file","resumeBkMus","getBkMusicId","update","dt","stop","uiRoot","destroy","getCurrentBkSenceObj","getCurrentSceneId","getFrontSceneId"],"mappings":"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","sourcesContent":["import { Node, Sprite, UITransform, Vec3, tween } from \"cc\"\r\nimport SourceManage from \"../../base/SourceManage\"\r\nimport { createAnimationNode, getAnimation, setSpriteFrameBySpriteAtlas } from \"./FishTool\"\r\nimport { FishManager } from \"./FishManager\"\r\nimport { BackgroundScene } from \"./BackgroundScene\"\r\nimport { MusicEffectPlayer } from \"./MusicEffectPlayer\"\r\n\r\n/**\r\n  背景场景切换管理\r\n */\r\nlet seaWaveZOrder = 1000000\r\n\r\n\r\n\r\n////////////////////////////////////////////////////////////////////\r\nexport class BackgroundSceneManager {\r\n  // config\r\n  private backgroundConfig = null\r\n  private gameTextureConfig = null\r\n  private backgroundMusConfig = null\r\n\r\n  // val\r\n  private sceneSize = null\r\n  private sceneParent: Node = null\r\n  private seaWaveObject: Node = null\r\n  private seaWaveSize = null\r\n  private backgroundCommon = null\r\n  private currentScene: BackgroundScene = null\r\n  private frontScene: BackgroundScene = null\r\n  private cutSceneState = 0 //背景场景状态  0 无场景，1 场景切换完成，2 正在切换场景\r\n  private cutSceneTime = 0\r\n  private cutSceneTimeAdd = 0\r\n  private currentSceneID = -1\r\n  private frontSceneID = -1\r\n\r\n  private sourceManage: SourceManage;\r\n  private fishManager: FishManager;\r\n  private musicEffectPlayer: MusicEffectPlayer;\r\n\r\n  /**缩放比例 */\r\n  private scaleRatio = 1;\r\n  private lastChangeTime = 0;\r\n\r\n  public init(parent, backgroundConfig, textureConfig, backgroundMusConfig, sceneSize, sourceManage: SourceManage,\r\n    fishManager: FishManager, musicEffectPlayer: MusicEffectPlayer, scaleRatio: number) {\r\n    this.sceneParent = parent\r\n    this.backgroundConfig = backgroundConfig\r\n    this.gameTextureConfig = textureConfig\r\n    this.backgroundMusConfig = backgroundMusConfig\r\n\r\n    this.backgroundCommon = this.backgroundConfig.common\r\n    this.cutSceneTime = this.backgroundCommon.cut_t\r\n    this.sceneSize = sceneSize\r\n    this.sourceManage = sourceManage\r\n    this.fishManager = fishManager\r\n    this.musicEffectPlayer = musicEffectPlayer\r\n    this.scaleRatio = scaleRatio;\r\n\r\n    for (const k in this.backgroundConfig.data) {\r\n      const v = this.backgroundConfig.data[k];\r\n      if (v === null) continue;\r\n      // textureCaheMgr.addImage(this.gameTextureConfig[v.bk_pic_id].file)\r\n    }\r\n  }\r\n\r\n  public quitRoom() {\r\n    this.cutSceneState = 0\r\n  }\r\n\r\n  public uninit() {\r\n    if (this.backgroundConfig) {\r\n      for (const k in this.backgroundConfig.data) {\r\n        const v = this.backgroundConfig.data[k];\r\n        if (v === null) continue;\r\n        // textureCaheMgr.removeTextureForKey(this.gameTextureConfig[v.bk_pic_id].file)\r\n      }\r\n    }\r\n\r\n    this.backgroundConfig = null\r\n    this.gameTextureConfig = null\r\n    this.backgroundMusConfig = null\r\n\r\n    this.sceneSize = null\r\n    this.sceneParent = null\r\n    this.seaWaveObject = null\r\n    this.seaWaveSize = null\r\n    this.backgroundCommon = null\r\n    this.currentScene = null\r\n    this.frontScene = null\r\n    this.cutSceneState = 0\r\n    this.cutSceneTime = 0\r\n    this.cutSceneTimeAdd = 0\r\n    this.currentSceneID = -1\r\n    this.frontSceneID = -1\r\n  }\r\n\r\n  public createSeawaveObj() {\r\n    // this.seaWaveObject = g_CreateSprite(this.gameTextureConfig[this.backgroundCommon.wave_src_id])\r\n    this.seaWaveObject = createAnimationNode(this.sourceManage, this.sceneParent, this.gameTextureConfig[this.backgroundCommon.wave_src_id], false, true)\r\n    this.sceneParent.addChild(this.seaWaveObject)\r\n    this.seaWaveObject.setWorldPosition(new Vec3(0, 0))\r\n    this.seaWaveObject.active = false\r\n    this.seaWaveObject.setSiblingIndex(seaWaveZOrder)\r\n    this.seaWaveSize = this.seaWaveObject.getComponent(UITransform);\r\n\r\n    this.seaWaveObject.setScale(new Vec3(this.scaleRatio, this.scaleRatio))\r\n  }\r\n\r\n  public cutBackgroundScene(id) {\r\n    const currentTime = Date.now();\r\n    // 如果切换场景的事件小于5秒，就不切换\r\n    if (currentTime - this.lastChangeTime <= 5 * 1000) {\r\n      return;\r\n    }\r\n    this.lastChangeTime = currentTime;\r\n    this.fishManager.clearFishCacheData()\r\n\r\n    if (this.currentScene) {\r\n      this.frontScene = this.currentScene\r\n      this.currentScene = null\r\n    }\r\n\r\n    let sceneInfo = this.backgroundConfig.data[id]\r\n    if (sceneInfo) {\r\n      this.currentScene = new BackgroundScene(this.sceneParent, this.sourceManage, this.sceneSize, this.scaleRatio);\r\n      this.currentScene.init(this.cutSceneState, this.backgroundCommon.cut_t, sceneInfo,\r\n        this.backgroundMusConfig, this.gameTextureConfig, this.sceneSize, this.musicEffectPlayer)\r\n\r\n      this.frontSceneID = this.currentSceneID\r\n      this.currentSceneID = id\r\n\r\n      let pos = new Vec3(this.sceneSize.width + this.seaWaveSize.width / 4, this.sceneSize.height / 2)\r\n      this.seaWaveObject.setWorldPosition(pos.multiplyScalar(this.scaleRatio))\r\n      this.seaWaveObject.setSiblingIndex(this.sceneParent.children.length);\r\n      if (this.cutSceneState === 0) {\r\n        this.seaWaveObject.active = false\r\n      } else {\r\n        this.seaWaveObject.active = true\r\n      }\r\n\r\n      if (this.cutSceneState === 1) {\r\n        this.musicEffectPlayer.play(this.backgroundCommon.mus_id)\r\n        getAnimation(this.seaWaveObject).play();\r\n        let need_t = this.backgroundCommon.cut_t * ((this.sceneSize.width + 2.8 * this.seaWaveSize.width / 4) / this.sceneSize.width)\r\n        this.cutSceneTime = need_t\r\n        tween(this.seaWaveObject)\r\n          .to(need_t, { worldPosition: new Vec3(-this.seaWaveSize.width / 2, this.sceneSize.height / 2, 0).multiplyScalar(this.scaleRatio) })\r\n          .call(() => {\r\n            // this.seaWaveObject.active = false\r\n          }).start()\r\n\r\n        this.cutSceneState = 2\r\n        this.cutSceneTimeAdd = 0\r\n        // currentScene.zIndex = (seaWaveZOrder - 100)\r\n      } else {\r\n        this.cutSceneState = 1\r\n        this.cutSceneTimeAdd = 0\r\n        this.fishManager.clearAllFish()\r\n        console.log(\"cut background scene complete, currentSceneID ========== \" + this.currentSceneID)\r\n      }\r\n    } else {\r\n      this.cutSceneState = 0\r\n      this.cutSceneTimeAdd = 0\r\n      this.currentSceneID = -1\r\n      this.frontSceneID = -1\r\n      console.log(\"cut background scene failed, scene is !exist.\")\r\n    }\r\n  }\r\n\r\n  public getSceneState() {\r\n    return this.cutSceneState\r\n  }\r\n\r\n  public forceChangeBkMus(id) {\r\n    let musSrc = this.backgroundMusConfig && this.backgroundMusConfig[id]\r\n    if (musSrc) {\r\n      // AudioEngine.playMusic(musSrc.file, true)\r\n      this.musicEffectPlayer.playBgm(musSrc.file);\r\n    }\r\n  }\r\n\r\n  public resumeBkMus() {\r\n    let musSrc = this.backgroundMusConfig && this.backgroundMusConfig[this.currentScene.getBkMusicId()]\r\n    if (this.currentScene && musSrc) {\r\n      // AudioEngine.playMusic(musSrc.file, true)\r\n      this.musicEffectPlayer.playBgm(musSrc.file);\r\n    }\r\n  }\r\n\r\n  public update(dt) {\r\n    if (this.cutSceneState === 2) {\r\n      if (this.cutSceneTimeAdd >= this.cutSceneTime) {\r\n        this.cutSceneState = 1\r\n        this.cutSceneTimeAdd = 0\r\n        this.seaWaveObject.active = (false)\r\n        getAnimation(this.seaWaveObject).stop();\r\n        this.currentScene.uiRoot.setSiblingIndex(0)\r\n\r\n        if (this.frontScene) {\r\n          this.frontScene.destroy()\r\n\r\n          this.frontScene = null\r\n          this.cutSceneState = 1\r\n          this.cutSceneTimeAdd = 0\r\n\r\n          this.fishManager.clearAllFish()\r\n\r\n          console.log(\"cut background scene complete, currentSceneID ========== \" + this.currentSceneID)\r\n        }\r\n      } else {\r\n        this.cutSceneTimeAdd = this.cutSceneTimeAdd + dt\r\n      }\r\n    }\r\n  }\r\n\r\n  public getCurrentBkSenceObj() {\r\n    return this.currentScene\r\n  }\r\n\r\n  public getCurrentSceneId() {\r\n    return this.currentSceneID\r\n  }\r\n\r\n  public getFrontSceneId() {\r\n    return this.frontSceneID\r\n  }\r\n}\r\n\r\n"]}