{"version":3,"sources":["file:///Users/geliang/web/dibai/hall/assets/script/subGame/dfdc/components/BlessedWealthy_rollerIcon.ts"],"names":["_decorator","Label","Node","sp","UIOpacity","UITransform","Vec3","BaseComponent","GameType","IconEffectType","sourceManageSeletor","ccclass","property","BlessedWealthy_rollerIcon","propertyNode","props_iconWrap","props_iconId","props_index","props_dfdc_huoyankuangxiao","props","iconData","iconEffect","NONE","iconYuanBaoEffect","iconFreeGameEffect","viewGameType","isRollEnd","events","start","initState","bindEvent","useProps","key","value","console","log","cur","uiTrasform","node","getComponent","width","height","iconNodeSprite","getChildByName","active","iconNode","Skeleton","skeletonData","getFile","uiData","fileName","source","animation","animationArr","setScale","scale","x","y","z","getPosition","setPosition","distance","string","iconId","queueIndex","isActive","NORMAIL","LargeIcon","uiOpacity","updateRenderer","bindUI","update","deltaTime"],"mappings":"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","sourcesContent":["import { _decorator, Component, debug, instantiate, Label, Node, bezier, ParticleSystem2D, Skeleton, sp, Sprite, tween, UIOpacity, UITransform, Vec3 } from 'cc';\r\nimport { BaseComponent } from '../../../base/BaseComponent';\r\nimport { GameType, IconEffectType, IconType } from '../type';\r\nimport { sourceManageSeletor } from '../index';\r\nimport { SkeletalPathDefine } from '../sourceDefine/skeletalDefine';\r\nimport dataTransfer, { DataKeyType } from '../dataTransfer';\r\nimport BaseViewModel from '../../../common/viewModel/BaseViewModel';\r\nimport { PrefabPathDefine } from '../sourceDefine/prefabDefine';\r\nimport { EffectType } from '../../../utils/NodeIOEffect';\r\nimport { rollerPanelViewModel } from '../viewModel/GameBoardViewModel';\r\nimport { getNodePositionInCanvas } from '../../../utils/tool';\r\nconst { ccclass, property } = _decorator;\r\n\r\nexport interface IState {\r\n\r\n}\r\n\r\nexport interface IProps {\r\n\ticonData?: IconType\r\n\t/**将这个属性单拎出来，节约性能，不然每次都要重新初始化icon的界面 */\r\n\ticonEffect?: IconEffectType,\r\n\ticonYuanBaoEffect?: IconEffectType,\r\n\ticonFreeGameEffect?:IconEffectType,\r\n\tviewGameType: GameType,\r\n\tisRollEnd:boolean,\r\n}\r\nexport interface IEvent {\r\n\r\n}\r\n\r\n@ccclass('BlessedWealthy_rollerIcon')\r\nexport class BlessedWealthy_rollerIcon extends BaseComponent<IState, IProps, IEvent> {\r\n\tstart() { }\r\n\r\n\tprotected propertyNode = {\r\n\t\tprops_iconWrap: new Node(),\r\n\t\tprops_iconId: new Label(),\r\n\t\tprops_index: new Label(),\r\n\t\tprops_dfdc_huoyankuangxiao: new Node(),\r\n\r\n\t}\r\n\r\n\tpublic props: IProps = {\r\n\t\ticonData: null,\r\n\t\ticonEffect: IconEffectType.NONE,\r\n\t\ticonYuanBaoEffect: IconEffectType.NONE,\r\n\t\ticonFreeGameEffect: IconEffectType.NONE,\r\n\t\tviewGameType: GameType.NONE,\r\n\t\tisRollEnd:true,\r\n\t}\r\n\r\n\tpublic events: IEvent = {\r\n\r\n\t}\r\n\r\n\tprotected initState() {\r\n\t\treturn {\r\n\r\n\t\t}\r\n\t}\r\n\r\n\tprotected bindEvent(): void {\r\n\r\n\t}\r\n\r\n\tprotected useProps(key: keyof IProps, value: { pre: any, cur: any }) {\r\n\t\tif (key === \"iconData\") {\r\n\t\t\tconsole.log(\"iconData\",value.cur);\r\n\t\t\t\r\n\t\t\tconst uiTrasform = this.node.getComponent(UITransform)\r\n\t\t\tuiTrasform.width = this.props.iconData.width\r\n\t\t\tuiTrasform.height = this.props.iconData.height\r\n\t\t\t// const iconNodeSkeleton = this.propertyNode.props_iconWrap.getChildByName(\"iconNode_skeleton\")\r\n\t\t\tconst iconNodeSprite = this.propertyNode.props_iconWrap.getChildByName(\"iconNode_sprite\")\r\n\t\t\t// iconNodeSkeleton.active = false\r\n\t\t\ticonNodeSprite.active = false\r\n\r\n\t\t\tlet iconNode: Node\r\n\t\t\ticonNode = iconNodeSprite\r\n\t\t\ticonNodeSprite.active = true\r\n\t\t\ticonNodeSprite.getComponent(sp.Skeleton).skeletonData = sourceManageSeletor().getFile(this.props.iconData.uiData.fileName).source\r\n\t\t\ticonNodeSprite.getComponent(sp.Skeleton).animation = this.props.iconData.uiData.animationArr[0];\r\n\r\n\t\t\ticonNode.setScale(new Vec3(...this.props.iconData.uiData.scale))\r\n\t\r\n\t\t\tconst { x, y, z } = iconNode.getPosition()\r\n\t\t\ticonNode.setPosition(new Vec3(x + this.props.iconData.uiData.distance[0], y + this.props.iconData.uiData.distance[1], x))\r\n\t\t\tthis.propertyNode.props_iconId.string = this.props.iconData.iconId + \"\"\r\n\t\t\tthis.propertyNode.props_index.string = this.props.iconData.queueIndex + \"\";\r\n\t\t\t\r\n\t\t}\r\n\t\tif (key === \"iconEffect\") {\r\n\t\t\t// if (this.props && this.props.isRollEnd) {\r\n\t\t\t\t\r\n\t\t\t// }\r\n\r\n\t\t\t//闪动框\r\n\t\t\tconst iconNodeSprite = this.propertyNode.props_iconWrap.getChildByName(\"iconNode_sprite\")\r\n\t\t\tconst isActive = (value.cur === IconEffectType.NORMAIL && !this.props.iconData.LargeIcon)\r\n\t\t\tthis.propertyNode.props_dfdc_huoyankuangxiao.active = isActive\r\n\t\t\tconst uiOpacity = this.propertyNode.props_dfdc_huoyankuangxiao.getComponent(UIOpacity) as UIOpacity;\r\n\t\t\t// if (isActive) {\r\n\t\t\t// \t//闪动 repeatForever 重复执行一个动作\r\n\t\t\t// \tconst t = tween(uiOpacity).to(0.4, { opacity: 255 }).to(0.4, { opacity: 0 });\r\n\t\t\t// \tt.start();\r\n\t\t\t// }\r\n\r\n\t\t\ticonNodeSprite.getComponent(sp.Skeleton).updateRenderer()\r\n\t\t\ticonNodeSprite.getComponent(sp.Skeleton).animation = this.props.iconData.uiData.animationArr[isActive ? 1 : 0];\r\n\t\t\tconst { x, y, z } = iconNodeSprite.getPosition()\r\n\t\t\t// iconNodeSprite.setPosition(new Vec3(x + this.props.iconData.uiData.distance[0], y + this.props.iconData.uiData.distance[1], x))\r\n\t\t}\r\n\t\t// if (key === \"iconYuanBaoEffect\") {\r\n\t\t// \tif (!value.cur) { return }\r\n\t\t// \t//元宝闪动框\r\n\t\t// \tconst iconNodeSprite = this.propertyNode.props_iconWrap.getChildByName(\"iconNode_sprite\")\r\n\t\t// \tconst isActive = (value.cur === IconEffectType.YUANBAO && !this.props.iconData.LargeIcon);\r\n\t\t// \ticonNodeSprite.getComponent(sp.Skeleton).updateRenderer();\r\n\t\t// \ticonNodeSprite.getComponent(sp.Skeleton).skeletonData = sourceManageSeletor().getFile(SkeletalPathDefine.TUBIAO_YUANBAO).source;\r\n\t\t// \ticonNodeSprite.getComponent(sp.Skeleton).animation = this.props.iconData.uiData.animationArr[isActive ? 1 : 0];\r\n\t\t// \ttween(iconNodeSprite).delay(1).call(() => { \r\n\t\t// \t\tlet yuanBaoRate = dataTransfer(DataKeyType.ICON_YUANBAO_EFFECT_DATA).yuanBaoMagnification;\r\n\t\t// \t\tlet yuanBaoWinNum = dataTransfer(DataKeyType.ICON_YUANBAO_EFFECT_DATA).yuanBaoAmount;\r\n\t\t// \t\t/**展示元宝中奖框 */\r\n\t\t// \t\tif (!this.node) { return }\r\n\t\t// \t\tconst yuanBaoTotalBet = new BaseViewModel(\"phoenix_yuanbao_totalBet\").mountView(sourceManageSeletor().getFile(PrefabPathDefine.PHOENIX_TOTAL_BET).source)\r\n\t\t// \t\t\t.appendTo(rollerPanelViewModel.viewNode, { effectType: EffectType.EFFECT1, isModal: true })\r\n\t\t// \t\t\t.setEvent({}).setProps({\r\n\t\t// \t\t\t\tyuanBaoRate: \"X\" + yuanBaoRate,\r\n\t\t// \t\t\t\tyuanBaoWinNum: yuanBaoWinNum + \"\",\r\n\t\t// \t\t\t}).connect()\r\n\t\t// \t}).start()\r\n\t\t\r\n\t\t// \tconst { x, y, z } = iconNodeSprite.getPosition();\r\n\t\t// \ticonNodeSprite.setPosition(new Vec3(x + this.props.iconData.uiData.distance[0], y + this.props.iconData.uiData.distance[1], x))\r\n\t\t// }\r\n\t\t\r\n\t\t// if (key === \"iconFreeGameEffect\") {\r\n\t\t// \tif (!value.cur) { return }\r\n\t\t// \t//元宝闪动框\r\n\t\t// \tconst iconNodeSprite = this.propertyNode.props_iconWrap.getChildByName(\"iconNode_sprite\")\r\n\t\t// \tconst isActive = (value.cur === IconEffectType.FREEEGAMEZ && !this.props.iconData.LargeIcon);\r\n\t\t// \ticonNodeSprite.getComponent(sp.Skeleton).updateRenderer();\r\n\t\t// \ticonNodeSprite.getComponent(sp.Skeleton).skeletonData = sourceManageSeletor().getFile(SkeletalPathDefine.TUBIAO_SKELETON).source;\r\n\t\t// \ticonNodeSprite.getComponent(sp.Skeleton).animation = this.props.iconData.uiData.animationArr[isActive ? 1 : 0];\r\n\t\t// \tconst { x, y, z } = iconNodeSprite.getPosition();\r\n\t\t// \ticonNodeSprite.setPosition(new Vec3(x + this.props.iconData.uiData.distance[0], y + this.props.iconData.uiData.distance[1], x))\r\n\t\t// }\r\n\t}\r\n\r\n\r\n\tprotected bindUI(): void {\r\n\r\n\t}\r\n\r\n\tupdate(deltaTime: number) {\r\n\r\n\t}\r\n}\r\n\r\n"]}