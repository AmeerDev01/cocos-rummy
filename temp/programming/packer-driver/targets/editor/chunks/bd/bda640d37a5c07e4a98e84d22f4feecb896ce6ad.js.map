{"version":3,"sources":["file:///Users/geliang/web/dibai/hall/assets/script/subGame/bandarQiuQiu/components/BandarQiuQiu_betArea.ts"],"names":["_decorator","Game","game","instantiate","Label","bezier","Node","tween","UIOpacity","UITransform","Vec3","BaseComponent","BetType","CardStatus","gameCacheData","GameStatus","ChipViewModel","TaskScheduler","Task","formatNumber","getNodeByNameDeep","getNodePositionInCanvas","config","initBetData","SKT_MAG_TYPE","sktInstance","mainGameViewModel","playChip","playGetCoin","sourceManageSelector","PrefabPathDefine","footerViewModel","usersViewModel","global","lang","ToastPosition","addToastAction","ccclass","property","BandarQiuQiu_betArea","betLoading","betAreaInfo","Map","isLockBet","tweens","isShowGame","isFlyStar","areaInfo","lastArr","amountArr","taskScheduler","propertyNode","props_btn_blue_win","props_btn_blue_twin","props_btn_blue_qiu","props_btn_red_win","props_btn_red_twin","props_btn_red_qiu","props_btn_green_win","props_btn_green_twins","props_btn_green_qiuqiu","props","gameStatus","gold","selectChip","myInfo","newBetData","winArea","goldData","winAreaRate","allWinUsers","lastBet","cancelBetData","memberBet","tips","events","start","initState","bindEvent","on","EVENT_HIDE","EVENT_SHOW","EventType","TOUCH_END","myBet","BLUE_QIU","BLUE_TWIN","BLUE","RED_QIU","RED_TWIN","RED","GREEN_QIU","GREEN_SIX_TWINS","GREEN_DRAW","useProps","key","value","cur","memberId","flyChip","cancelBet","undefined","Object","keys","length","areaNode","getNodeByBetType","getNodeToBetType","Number","getComponent","string","active","STOP_BET","isUnMount","joinqQueue","done","window","setTimeout","playWinAnimation","flyToHeGuan","flyChipToWinArea","WAIT","clear","clearAllBetAreaGold","BET","clearBetWinAreaAni","forEach","item","flyWinAreaToUser","index","comp","copyWinAnimation","playAddGold","palyAddUp","isBetStatus","console","log","betType","hallDispatch","content","write","k","palyingModule","RechangeGlod","placeStr","betData","isMyBet","sendBet","roomId","memberName","betAmount","isMe","betId","sendSktMessage","BET_ALL","isFly","chipTypes","find","v","betArea","getChildByName","viewModel","createChip","radom","Math","random","chipNode","node","endPosition","randomBetEndPosition","addBetInfo","updateAllBet","uiTransform","startPosition","getBetStartPosition","setWorldPosition","convertToWorldSpaceAR","to","position","angle","easing","gameOption","winRateMaxIndex","betTypeIndex","indexOf","splice","flyStar","updateBetAreaGold","parent","clearBetAreaGold","hideAllWinRate","hideWinSprite","removeAllChildren","totalBetAmount","meTotalBetAmount","hideBetMine","isValid","children","filter","name","startsWith","opacity","stop","winAreaNode","uiOpacity","t","repeatForever","push","chipValue","mountView","getFile","MAIN_CHIP","source","appendTo","connect","setProps","myHeadPosition","x","y","seatNumber","onlineNumberPosition","headLocations","getFlyToHeadEndPosition","betInfo","width","height","chips","concat","FlyLossAreaToHe","chip","endPositon","dealerPosition","worldPosition","scale","call","unMount","flyWinChip","betInfos","get","winBetData","odds","getNodeToBetRateType","copyBetInfo","bb","userId","arr","Array","fill","map","set","showWinRate","getStar","winRate","parentNode","starIcon","getPropertyNode","props_spr_icon","starNode","addChild","setPosition","playWinRateTween","scheduleOnce","destroy","tweenNode","endPos","playTime","callBack","startPos","startAngle","eulerAngles","fruitTween","mixY","maxY","mixX","maxX","progressX","end","current","progressY","parallel","progress","onUpdate","z","NORMAL","QIU","TWIN","destroyCallBack","destoryQueue","stopQueue","removeComma","str","newStr","replace","getMyHeadPosition","chipFlyToHead","i","formatAmountWithCommas","formatAmountWithLetter","MIDDLE","InitGameModule","BetFaild","format","bindUI","update","deltaTime"],"mappings":"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","sourcesContent":["import { _decorator, Component, Game, game, instantiate, Label, bezier,Node, Tween, tween, UIOpacity, UITransform, Vec3 } from 'cc';\r\nimport { BaseComponent } from '../../../base/BaseComponent';\r\nimport { BetData, BetType, CardStatus, gameCacheData, GameStatus, HeadType, SendBet, TipsVo } from '../type';\r\nimport { setNewBetDataAction, WinUser } from '../store/actions/bet';\r\nimport ChipViewModel from '../viewModel/BandarQiuQiuChipViewModel';\r\nimport TaskScheduler, { Task } from '../../../utils/TaskScheduler';\r\nimport { formatNumber, getNodeByNameDeep, getNodePositionInCanvas } from '../../../utils/tool';\r\nimport config, { initBetData } from '../config';\r\nimport { SKT_MAG_TYPE, sktInstance } from '../socketConnect';\r\nimport { mainGameViewModel, playChip, playGetCoin, sourceManageSelector } from '../index';\r\nimport { PrefabPathDefine } from '../sourceDefine/prefabDefine';\r\nimport { footerViewModel, usersViewModel } from '../viewModel/BandarQiuQiuGameBoardViewModel';\r\nimport { global, lang } from '../../../hall';\r\nimport { ToastPosition, addToastAction } from '../../../hall/store/actions/baseBoard';\r\nconst { ccclass, property } = _decorator;\r\n\r\n\r\ntype BetInfo = {\r\n\tindex: number,\r\n\tuserId: string,\r\n\tisMe: boolean,\r\n\tchips: ChipViewModel[]\r\n}\r\n\r\n\r\nexport interface IState {\r\n\r\n}\r\n\r\nexport interface IProps {\r\n\tgameStatus:GameStatus,\r\n\tgold:number,\r\n\t/**选择的筹码 */\r\n\tselectChip: number,\r\n\tmyInfo: HeadType,\r\n\tnewBetData:BetData,\r\n\twinArea: number[],\r\n\tgoldData: object,\r\n\t/**赢的区域 计算出倍率 */\r\n\twinAreaRate:number[],\r\n\tallWinUsers:WinUser[],\r\n\tlastBet: SendBet[],\r\n\tcancelBetData:BetData,\r\n\tmemberBet: object,\r\n\ttips: TipsVo[],\r\n}\r\n\r\nexport interface IEvent {\r\n\r\n}\r\n\r\n@ccclass('BandarQiuQiu_betArea')\r\nexport class BandarQiuQiu_betArea extends BaseComponent<IState, IProps, IEvent> {\r\n\tprivate betLoading = false;\r\n\tprivate betAreaInfo: Map<BetType, BetInfo[]> = new Map();\r\n\t// 是否锁定下注\r\n\tprivate isLockBet: boolean = false;\r\n\tprivate tweens: Tween<UIOpacity>[] = [];\r\n\tprivate isShowGame: boolean = true;\r\n\tprivate isFlyStar: boolean = false;\r\n\tprivate areaInfo :BetType[] = [1,2,3,4,5,6,7,8,9];\r\n\tpublic lastArr:SendBet[] = [];\r\n\tpublic amountArr:SendBet[] = [];\r\n\tprivate taskScheduler = new TaskScheduler()\r\n\tstart() {\r\n      \r\n\t}\r\n\r\n\tprotected propertyNode = {\r\n\t\tprops_btn_blue_win: new Node(),\r\n\t\tprops_btn_blue_twin: new Node(),\r\n\t\tprops_btn_blue_qiu: new Node(),\r\n\t\tprops_btn_red_win: new Node(),\r\n\t\tprops_btn_red_twin: new Node(),\r\n\t\tprops_btn_red_qiu: new Node(),\r\n\t\tprops_btn_green_win: new Node(),\r\n\t\tprops_btn_green_twins: new Node(),\r\n\t\tprops_btn_green_qiuqiu:new Node(),\r\n\t}\r\n\r\n\tpublic props: IProps = {\r\n\t\tgameStatus:null,\r\n\t\tgold:0,\r\n\t\tselectChip:1000,\r\n\t\tmyInfo:null,\r\n\t\tnewBetData:null,\r\n\t\twinArea:null,\r\n\t\tgoldData:null,\r\n\t\twinAreaRate:null,\r\n\t\tallWinUsers:null,\r\n\t\tlastBet: [],\r\n\t\tcancelBetData:null,\r\n\t\tmemberBet: null,\r\n\t\ttips:null,\r\n\t}\r\n\r\n\tpublic events: IEvent = {\r\n\r\n\t}\r\n\r\n\tprotected initState() {\r\n\t\treturn {\r\n\r\n\t\t}\r\n\t}\r\n\r\n\tprotected bindEvent(): void {\r\n\t\tgame.on(Game.EVENT_HIDE,()=>{//游戏切入后台\r\n\t\t\tthis.isShowGame = false\r\n\t\t})\r\n\t\tgame.on(Game.EVENT_SHOW,()=>{//游戏进入\r\n\t\t\tthis.isShowGame = true;\r\n\t\t})\r\n\t\tthis.propertyNode.props_btn_blue_qiu.on(Node.EventType.TOUCH_END, () => { this.myBet(BetType.BLUE_QIU) });\r\n\t\tthis.propertyNode.props_btn_blue_twin.on(Node.EventType.TOUCH_END, () => { this.myBet(BetType.BLUE_TWIN) });\r\n\t\tthis.propertyNode.props_btn_blue_win.on(Node.EventType.TOUCH_END, () => { this.myBet(BetType.BLUE) });\r\n\t\tthis.propertyNode.props_btn_red_qiu.on(Node.EventType.TOUCH_END, () => { this.myBet(BetType.RED_QIU) });\r\n\t\tthis.propertyNode.props_btn_red_twin.on(Node.EventType.TOUCH_END, () => { this.myBet(BetType.RED_TWIN) });\r\n\t\tthis.propertyNode.props_btn_red_win.on(Node.EventType.TOUCH_END, () => { this.myBet(BetType.RED) });\r\n\t\tthis.propertyNode.props_btn_green_qiuqiu.on(Node.EventType.TOUCH_END, () => { this.myBet(BetType.GREEN_QIU) });\r\n\t\tthis.propertyNode.props_btn_green_twins.on(Node.EventType.TOUCH_END, () => { this.myBet(BetType.GREEN_SIX_TWINS) });\r\n\t\tthis.propertyNode.props_btn_green_win.on(Node.EventType.TOUCH_END, () => { this.myBet(BetType.GREEN_DRAW) });\r\n \r\n\t}\r\n\r\n\tprotected useProps(key: keyof IProps, value: { pre: any, cur: any }) {\r\n\t\tif (key === \"newBetData\" && value.cur) {\r\n\t\t\tif (!value.cur) { return }\r\n\t\t\tif (value.cur.memberId === gameCacheData.memberId) { return };\r\n\t\t\tthis.flyChip(value.cur)\r\n\t\t}\r\n\t\tif (key === 'cancelBetData') {\t\t\t\r\n\t\t\tthis.cancelBet(value.cur);\r\n\t\t}\r\n\t\tif (key === \"goldData\") {\r\n\t\t\tif (!value.cur || value.cur === undefined) { return };\r\n\t\t\tif(value.cur && Object.keys(value.cur).length != 0){   \r\n\t\t\t\tfor (let key in value.cur) {\r\n\t\t\t\t\tlet areaNode = this.getNodeByBetType(this.getNodeToBetType(Number(key)))\r\n\t\t\t\t\t\tgetNodeByNameDeep(\"label_bet_all\", areaNode).getComponent(Label).string = formatNumber(value.cur[key]);\r\n\t\t\t\t}\r\n\t\t\t  }   \r\n\t\t}\r\n\t\tif (key === \"memberBet\") {\r\n\t\t\tif (!value.cur || value.cur === undefined) { return };\r\n\t\t\tif (Object.keys(value.cur).length != 0) { \r\n\t\t\t  for(let key in value.cur){\r\n\t\t\t\tlet areaNode = this.getNodeByBetType(this.getNodeToBetType(Number(key)))\r\n\t\t\t\t\tif(value.cur[key] === 0){\r\n\t\t\t\t\t\tgetNodeByNameDeep(\"label_bet_mine\", areaNode).getComponent(Label).string = \"\"\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tgetNodeByNameDeep(\"spr_bet_bg\", areaNode).active = true;\r\n\t\t\t\t\t\tgetNodeByNameDeep(\"label_bet_mine\", areaNode).getComponent(Label).string = formatNumber(value.cur[key]);\r\n\t\t\t\t\t}\r\n\t\t\t  }\r\n\t\t\t}\r\n\t    }\r\n\t\tif (key === \"gameStatus\") {  \r\n\t\t\tif (value.cur === GameStatus.STOP_BET) {\r\n\t\t\t\tif (mainGameViewModel.isUnMount) { return }\r\n\t\t\t\tthis.lastArr=[...this.amountArr];\r\n\t\t\t\tthis.taskScheduler.joinqQueue(new Task((done) => {\r\n\t\t\t\t\twindow.setTimeout(() => {\r\n\t\t\t\t\t\tif (mainGameViewModel.isUnMount) { return }\r\n\t\t\t\t\t\tif (value.cur === GameStatus.STOP_BET && this.props) {\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\tthis.playWinAnimation(this.props.winAreaRate);\r\n\t\t\t\t\t\t\tthis.flyToHeGuan();\r\n\t\t\t\t\t\t}\t\r\n\t\t\t\t\t},6000)\r\n\t\t\t\t\t\r\n\t\t\t\t\twindow.setTimeout(() => done(), 1000)\r\n\t\t\t\t}),false).joinqQueue(new Task((done) => {\r\n\t\t\t\t\twindow.setTimeout(() => {\r\n\t\t\t\t\t\tif(mainGameViewModel.isUnMount){ return }\r\n\t\t\t\t\t\tthis.flyChipToWinArea();\r\n\t\t\t\t\t},6000)\r\n\r\n\t\t\t\t\twindow.setTimeout(() => done(), 1000)\r\n\t\t\t\t}),false)\r\n\t\t\t\r\n\t\t\t}else if(value.cur === GameStatus.WAIT){\r\n\t\t\t\tthis.betAreaInfo.clear();\r\n\t\t\t\tthis.clearAllBetAreaGold();\r\n\t\t\t} else if (value.cur === GameStatus.BET) {\r\n\t\t\t\tthis.betLoading = false;\r\n\t\t\t\tthis.clearBetWinAreaAni(this.areaInfo)\r\n\t\t\t}\r\n\r\n\t\t\r\n\t\t}\r\n\t\t\r\n\t\tif(key === \"allWinUsers\"){\r\n\t\t\t// console.log(\"allWinUsers\",value.cur);\r\n\t\t\tif(!value.cur){ return }\r\n\t\t\tthis.taskScheduler.joinqQueue(new Task((done)=>{\r\n\t\t\t\twindow.setTimeout(() => {\r\n\t\t\t\t\tif(mainGameViewModel.isUnMount){ return }\r\n\t\t\t\t\tif(value.cur){\r\n\t\t\t\t\t\tvalue.cur.forEach(item=>{\t\t \r\n\t\t\t\t\t\t\tthis.flyWinAreaToUser(item)\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t}, 2000)\r\n\t\t\t\t\r\n\t\t\t\twindow.setTimeout(() => done(), 1000)\r\n\t\t\t}),false).joinqQueue(new Task((done)=>{\r\n\t\t\t\twindow.setTimeout(() => {\r\n\t\t\t\t\tif(mainGameViewModel.isUnMount){ return }\r\n\t\t\t\t\tif(!value.cur){\r\n\t\t\t\t\t\treturn\r\n\t\t\t\t\t}\r\n\t\t\t\t\tvalue.cur.forEach(item=>{\r\n\t\t\t\t\t\tif(item.memberId !== gameCacheData.memberId){\r\n\t\t\t\t\t\t\tif(item.index < 6 && item.index >= 0){\r\n\t\t\t\t\t\t\t\tusersViewModel.comp.copyWinAnimation(item.index);\r\n\t\t\t\t\t\t\t\tusersViewModel.comp.playAddGold(item ,item.gold)\r\n\t\t\t\t\t\t\t}else if(item.index > 6 ){\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t//   onlineViewModel.comp.playWinAni()\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}else{\r\n\t\t\t\t\t\t\tfooterViewModel.comp.palyAddUp(item)\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t})\r\n\t\t\t\t},2000)\r\n\t\t\t\r\n\t\t\t\twindow.setTimeout(()=>done(),1000)\r\n\t\t\t}),false).joinqQueue(new Task((done)=>{\r\n\t\t\t\twindow.setTimeout(() => {\r\n\t\t\t\t\tif(mainGameViewModel.isUnMount){ return }\r\n\t\t\t\t\t// 清理下注区域数据\r\n\t\t\t\t\tthis.betAreaInfo.clear();\r\n\t\t\t\t\tthis.clearBetWinAreaAni([1,2,3,4])\r\n\t\t\t\t}, 3000)\r\n\t\t\t\t\t\t\r\n\t\t\t\twindow.setTimeout(() => done(), 1000)\r\n\t\t\t}))\r\n\t\t  \r\n\t\t}\r\n\t}\r\n\r\n\tprivate isBetStatus(): boolean {\r\n\t\tconsole.log(this.props.gameStatus);\r\n\t\t\r\n\t\treturn this.props.gameStatus === GameStatus.BET;\r\n\t}\r\n\t\r\n\t/**\r\n\t * 自己下注\r\n\t * @param betType \r\n\t * @returns \r\n\t */\r\n\tprivate myBet(betType: BetType): void {\r\n\t\tif (!this.isBetStatus()) {//下注阶段才能下注\r\n\t\t\treturn;\r\n\t\t}\r\n\t\t// 等待下注返回后才能进行下一次下注\r\n\t\tif (this.betLoading) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tif (this.props.tips && this.props.tips.length > 0) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tif (this.isLockBet = this.props.gold <= 5000) {\r\n\t\t\t// 提示用户余额不足\r\n\t\t\tglobal.hallDispatch(addToastAction({ content: lang.write(k => k.palyingModule.RechangeGlod, {}, { placeStr: \"对不起，您的金币不足，请充值!\" }) }));\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tconst betData = initBetData(this.props.myInfo.index, this.props.myInfo.memberId, betType, this.props.selectChip);\r\n\t\tbetData.isMyBet = true;//当前用户是否下注\r\n\t\tthis.betLoading = true;\r\n\t\tconst sendBet:SendBet = {\r\n\t\t\troomId: gameCacheData.roomId,\r\n            memberId: this.props.myInfo.memberId,\r\n            memberName: this.props.myInfo.memberName,\r\n            gold: betData.betAmount,\r\n            betType: betData.betType,\r\n\t\t\tisMe: betData.isMyBet,\r\n\t\t\tbetId:betData.betId\r\n\r\n\t\t}\r\n\t   // 下注信息发送给服务器\r\n\t   sktInstance.sendSktMessage(SKT_MAG_TYPE.BET_ALL, sendBet);\r\n\t   this.flyChip(betData);\r\n\t  \r\n\t//    this.amountArr.push(sendBet);\r\n\t}\r\n\r\n\t/**\r\n\t * 飞筹码\r\n\t * @param betData \r\n\t * @param isFly 是否飞筹码的动画，false用于刚进入初始化筹码\r\n\t */\r\n\tpublic flyChip(betData: BetData, isFly: boolean = true): void {\r\n\t\tif (betData.isMyBet) {\r\n\t\t\tthis.betLoading = false;\r\n\t\t}\r\n\t\t// 下注筹码不存在，不处理\r\n\t\tif (!config.chipTypes.find(v => v.value === betData.betAmount)) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tisFly = betData.isFly;\r\n\t\tisFly = this.isShowGame;\r\n\t\tconst betArea = this.getNodeByBetType(betData.betType).getChildByName(\"Layout_bet\");\r\n\t\tconst viewModel = this.createChip(betData.betAmount, betArea);\r\n\t\tlet radom = Math.random()*90-90;//旋转角度\r\n\t\tconst chipNode = viewModel.comp.node;\r\n\t\tconst endPosition = this.randomBetEndPosition(betArea);\r\n\t\tthis.addBetInfo(betData,viewModel);\r\n\t\tthis.updateAllBet();\r\n\t\tif (isFly) {\r\n\t\t\tplayChip()\r\n\t\t\tconst uiTransform = this.node.getComponent(UITransform);\r\n\t\t\tconst startPosition = this.getBetStartPosition(betData);\r\n\t\t\tchipNode.setWorldPosition(uiTransform.convertToWorldSpaceAR(startPosition));\r\n\t\t\t// chipNode.setPosition(startPosition)\r\n\t\t\ttween(chipNode).to(0.3, { position: endPosition , angle:-radom,},{easing: 'quintOut'}).start();\r\n\t\t\t// if (!isWinRateBet && betData.index === config.gameOption.winRateMaxIndex) {\r\n\t\t\tif (betData.index === config.gameOption.winRateMaxIndex) {\r\n\t\t\t\t//判定是否是未展示星星的区域数组 若未展示，返回区域下标 否（即已展示） 返回-1\r\n\t\t\t\tlet betTypeIndex = this.areaInfo.indexOf(betData.betType);\r\n\t\t\t\tif(betTypeIndex >= 0){\r\n\t\t\t\t\tthis.areaInfo.splice(betTypeIndex,1);//移除展示了的区域\r\n\t\t\t\t\t// 飞星星\r\n                    this.flyStar(this.getNodeByBetType(betData.betType), betData.betType);\t\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tthis.updateBetAreaGold(betData, betArea.parent);\r\n\t}\r\n\r\n\t/**下注总筹码 */\r\n\tprivate updateAllBet(){\r\n\t\t// for(let key in gameCacheData.goldData){\r\n\t\t// \tlet areaNode = this.getNodeByBetType(this.getNodeToBetType(Number(key)))\r\n\t\t// \t// if(gameCacheData.goldData[key] === 0){\r\n\t\t// \t// \tgetNodeByNameDeep(\"label_bet_all\", areaNode).getComponent(Label).string = \"\"\r\n\t\t// \t// }else{\r\n\t\t// \t\tgetNodeByNameDeep(\"label_bet_all\", areaNode).getComponent(Label).string = formatNumber(gameCacheData.goldData[key]);\r\n\t\t// \t// }\r\n\t\t// }\r\n\t}\r\n\r\n    /**清除所有下注区域的金币 */\r\n\tpublic clearAllBetAreaGold() {\r\n\t\t// this.dispatch(changeGoldDataAction({}))\r\n\t\tthis.clearBetAreaGold(this.propertyNode.props_btn_blue_qiu);\r\n\t\tthis.clearBetAreaGold(this.propertyNode.props_btn_blue_twin);\r\n\t\tthis.clearBetAreaGold(this.propertyNode.props_btn_blue_win);\r\n\t\tthis.clearBetAreaGold(this.propertyNode.props_btn_green_qiuqiu);\r\n\t\tthis.clearBetAreaGold(this.propertyNode.props_btn_green_twins);\r\n\t\tthis.clearBetAreaGold(this.propertyNode.props_btn_green_win);\r\n\t\tthis.clearBetAreaGold(this.propertyNode.props_btn_red_qiu);\r\n\t\tthis.clearBetAreaGold(this.propertyNode.props_btn_red_twin);\r\n\t\tthis.clearBetAreaGold(this.propertyNode.props_btn_red_win);\r\n\t\tthis.hideAllWinRate();\r\n\t\tthis.areaInfo = [1, 2, 3, 4, 5, 6, 7, 8, 9];\r\n\t\tthis.clearBetWinAreaAni(this.areaInfo)\r\n\t\tthis.hideWinSprite();\r\n\t\tthis.amountArr = [];\t\r\n\t}\r\n\r\n\tprivate clearBetAreaGold(betArea: Node) {\r\n\t\tbetArea.getChildByName(\"Layout_bet\").removeAllChildren();\r\n\t\t\r\n\t\tthis.updateBetAreaGold({\r\n\t\t\tindex: 0, memberId: \"\", betAmount: 0, betType: null, totalBetAmount: 0, meTotalBetAmount: 0\r\n\t\t}, betArea);\r\n\t}\r\n\r\n\t/** 隐藏当前玩家下注金币值 */\r\n\tprivate hideBetMine() {\r\n\t\tif (!this.node || !this.node.isValid) return;\r\n\t\tthis.node.children.filter(v => v.name.startsWith(\"props_btn_\")).forEach(v => {\r\n\t\t\tv.getChildByName(\"spr_bet_bg\").active = false;\r\n\t\t})\r\n\t}\r\n\r\n\t/**\r\n\t * 隐藏下注区域的高亮\r\n\t */\r\n\tprivate hideWinSprite() {\r\n\t\tthis.node.children.filter(v => v.name.startsWith(\"props_btn_\")).forEach(v => {\r\n\t\t\tv.getChildByName(\"sprite_animation_Win\").getComponent(UIOpacity).opacity = 0;\r\n\t\t})\r\n\r\n\t\tif (this.tweens) {\r\n\t\t\tthis.tweens.forEach(v => v.stop());\r\n\t\t\tthis.tweens = [];\r\n\t\t}\r\n\t}\r\n\r\n\t/**清除赢的区域动画 */\r\n\tprivate clearBetWinAreaAni(winArea){\r\n\t\twinArea.forEach(item=>{\r\n\t\t\tlet winAreaNode = this.getNodeByBetType(item);\r\n\t\t\tgetNodeByNameDeep(\"sprite_animation_Win\",winAreaNode).active = false;\r\n\t\t})\r\n\t}\r\n\t\r\n\t/** 播放赢的区域动画效果 */\r\n\tpublic playWinAnimation(winArea) {\t\r\n\r\n\t\tif (!winArea|| winArea.length === 0  ) {\r\n\t\t\treturn\r\n\t\t}\r\n\t\twinArea.forEach((item,index)=>{\r\n             let winAreaNode = this.getNodeByBetType(item);\r\n\t\t\t getNodeByNameDeep(\"sprite_animation_Win\",winAreaNode).active = true;\r\n\t\t \tconst uiOpacity = this.getNodeByBetType(item).getChildByName(\"sprite_animation_Win\").getComponent(UIOpacity) as UIOpacity;\r\n\t\t\tconst t = tween(uiOpacity).repeatForever(tween().to(0.5, { opacity: 255 }).to(0.5, { opacity: 0 }));\r\n\t\t\tt.start();\r\n\t\t\tthis.tweens.push(t);\r\n\t\t })\r\n\t}\r\n\r\n\t/** 下注总值 用户下注值 */\r\n\tprivate updateBetAreaGold(betData: BetData, betArea: Node): void {\r\n\t\tif (betData.totalBetAmount === 0) {\t\t\t\r\n\t\t\tgetNodeByNameDeep(\"label_bet_all\", betArea).getComponent(Label).string = \"0\"; \r\n\t\t\tgetNodeByNameDeep(\"label_bet_mine\", betArea).getComponent(Label).string = \"\";\r\n\t\t\tgetNodeByNameDeep(\"label_bet_mine\", betArea).parent.active = betData.meTotalBetAmount > 0;\r\n\t\t} else {\r\n\t\t\t// getNodeByNameDeep(\"label_bet_all\", betArea).getComponent(Label).string = formatNumber(this.props.goldData);\r\n\t\t}\r\n\r\n\t}\r\n\r\n    /** 创造对应选取的金币  */\r\n\tprivate createChip(chipValue: number, parent: Node): ChipViewModel {\r\n\t\treturn new ChipViewModel().mountView(sourceManageSelector().getFile(PrefabPathDefine.MAIN_CHIP).source).appendTo(parent).connect().setProps({ value: chipValue });\r\n\t}\r\n\r\n\t/** 获得下注筹码飞的开始坐标 */\r\n\tprivate getBetStartPosition(betData: BetData): Vec3 {\r\n\t\tif (betData.isMyBet) {\r\n\t\t\treturn new Vec3(config.gameOption.myHeadPosition.x, config.gameOption.myHeadPosition.y);\r\n\t\t}\r\n\r\n\t\tif (betData.index >= config.gameOption.seatNumber) {\r\n\t\t\treturn new Vec3(config.gameOption.onlineNumberPosition.x, config.gameOption.onlineNumberPosition.y);\r\n\t\t}\r\n\r\n\t\treturn new Vec3(config.headLocations[betData.index].x, config.headLocations[betData.index].y);\r\n\t}\r\n\t\r\n\t/**筹码飞向头像的结束坐标 */\r\n\tprivate getFlyToHeadEndPosition(betInfo: BetInfo) {\r\n\t\tif (betInfo.isMe) {\r\n\t\t\t// 播放获得金币的音效\r\n\t\t\tplayGetCoin();\r\n\t\t\treturn new Vec3(config.gameOption.myHeadPosition.x, config.gameOption.myHeadPosition.y);\r\n\t\t}\r\n\r\n\t\tif (betInfo.index >= config.gameOption.seatNumber) {\r\n\t\t\treturn new Vec3(config.gameOption.onlineNumberPosition.x, config.gameOption.onlineNumberPosition.y);\r\n\t\t}\r\n\r\n\t\treturn new Vec3(config.headLocations[betInfo.index].x, config.headLocations[betInfo.index].y);\r\n\t}\r\n\r\n\t/** 获得下注筹码飞的结束坐标 */\r\n\tprivate randomBetEndPosition(betArea: Node): Vec3 {\r\n\t\tconst uiTransform: UITransform = betArea.getComponent(UITransform);\r\n\t\tconst width = uiTransform.width * 0.8;\r\n\t\tconst height = uiTransform.height * 0.6;\r\n\t\tlet x = width / 2 - Math.random() * width;\r\n\t\tlet y = height / 2 - Math.random() * height;\r\n\r\n\t\treturn new Vec3(x, y);\r\n\t}\r\n\r\n\t/** 金币飞向荷官 */\r\n\tprivate flyToHeGuan(){//this.betAreaInfo 的chip存储了金币节点，可遍历它进行位置移动\r\n\t\t// playGetCoin()\r\n\t\tlet chips: ChipViewModel[] = [];\r\n\t\tthis.betAreaInfo.forEach((v, k) => {\r\n\t\t\tif(!this.props.winAreaRate){//没有中奖区域\r\n\t\t\t\tv.forEach(betInfo => {\r\n\t\t\t\t\tchips = chips.concat(betInfo.chips);\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t\t// 找出未中奖的区域\r\n\t\t\tif(this.props.winAreaRate){\r\n\t\t\t\t// playGetCoin()\r\n\t\t\t\tif (!this.props.winAreaRate.find(betType => betType === k)) {\r\n\t\t\t\t\tv.forEach(betInfo => {\r\n\t\t\t\t\t\tchips = chips.concat(betInfo.chips);\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t\r\n\t\t})\r\n\t\t\r\n\t\t//未中奖区域\r\n\t\tthis.FlyLossAreaToHe(chips)\r\n\t}\r\n\r\n\t/** 未中奖区域飞金币到荷官位置 */\r\n\tprivate FlyLossAreaToHe(chips: ChipViewModel[]) {\r\n\t\tif (chips.length != 0) {\r\n\t\t\tplayGetCoin()\r\n\t\t}\r\n\t\tchips.forEach(chip => {\r\n\t\t\tconst chipNode = chip.comp.node;\r\n\t\t\tconst endPositon = new Vec3 (config.gameOption.dealerPosition.x,config.gameOption.dealerPosition.y);\r\n\t\t\tconst uiTransform = this.node.getComponent(UITransform);\r\n\r\n\t\t\ttween(chipNode).to(0.8, { worldPosition: uiTransform.convertToWorldSpaceAR(endPositon),scale:new Vec3(0.1,0.1) }, {easing: 'quintOut'})\r\n\t\t\t\t.call(() => {\r\n\t\t\t\t\t// this.lossAnimationEnd();\r\n\t\t\t\t\tchip.unMount();\r\n\t\t\t\t})\r\n\t\t\t\t.start();\r\n\t\t})\r\n\t}\r\n\r\n\t/** 荷官飞金币到赢的区域 */\r\n\tprivate flyChipToWinArea(){//需要当前赢的区域 获得赔率，添加对应翻倍金币移动到对应赢的区域\r\n\t\tif( mainGameViewModel.isUnMount ){ return }\r\n\t\tif(!this.props || !this.props.goldData || !this.props.winAreaRate ){//没有任何下注 没有赢的区域\r\n\t\t\treturn\r\n\t\t}else{\r\n\t\t\tplayGetCoin()\r\n\t\t}\r\n\t\tthis.props.winAreaRate.forEach((item,index)=>{\r\n\t\t\tconst betData = { betType:item, betAmount:this.props.goldData[item]};\r\n\t\t\tthis.flyWinChip(betData,index)\r\n\t\t})\r\n\t}\r\n\r\n\t/** 赢的区域飞金币到用户头像 */\r\n\tprivate flyWinAreaToUser(betInfo,isFly: boolean = true): void{\r\n\t\tif(!this.props.winAreaRate ){ return}\r\n\t\tthis.props.winAreaRate.forEach(v => {\r\n\t\t\tconst betInfos = this.betAreaInfo.get(v);\r\n\t\t\t\t\tconsole.log(\"betInfos\",betInfos);\r\n\t\t\tif (betInfos) {\r\n\t\t\t\tbetInfos.forEach(betInfo => {\r\n\t\t\t\t\tbetInfo.chips.forEach(chip => {\r\n\t\t\t\t\t\tconst chipNode = chip.comp.node;\r\n\t\t\t\t\t\tconst endPositon = this.getFlyToHeadEndPosition(betInfo);\r\n\t\t\t\t\t\tconst uiTransform = this.node.getComponent(UITransform);\r\n\r\n\t\t\t\t\t\ttween(chipNode).to(0.8, { worldPosition: uiTransform.convertToWorldSpaceAR(endPositon) ,scale:new Vec3(0.1,0.1)},{easing: 'quintOut'})\r\n\t\t\t\t\t\t\t.call(() => {\r\n\t\t\t\t\t\t\t\tchip.unMount();\r\n\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t.start();\r\n\t\t\t\t\t})\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t})\r\n\t}\r\n\r\n    /** 飞向赢 区域*/\r\n\tprivate flyWinChip(winBetData,index:number , isFly: boolean = true){\r\n\t\tconst betInfos = this.betAreaInfo.get(winBetData.betType);\r\n\t\tif (!betInfos) {\r\n\t\t\treturn 0;\r\n\t\t}\r\n\t\tisFly = this.isShowGame;\r\n\t\tlet odds=this.getNodeToBetRateType(this.props.winAreaRate[index])\r\n\t\tconst betArea = this.getNodeByBetType(winBetData.betType).getChildByName(\"Layout_bet\");\r\n\t\tconst copyBetInfo = this.copyBetInfo(betInfos, betArea, odds);\r\n\t\tlet chips: ChipViewModel[] = [];\r\n\t\tcopyBetInfo.forEach(v => chips = chips.concat(v.chips));\r\n\t\tconst uiTransform = this.node.getComponent(UITransform);\r\n\t\tchips.forEach(v => {\r\n\t\t\tconst startPosition = new Vec3 (config.gameOption.dealerPosition.x,config.gameOption.dealerPosition.y);\r\n\t\t\tconst endPositon = this.randomBetEndPosition(betArea);\r\n\r\n\t\t\tconst chipNode = v.comp.node;\r\n\t\t\tchipNode.setWorldPosition(uiTransform.convertToWorldSpaceAR(startPosition));\r\n\r\n\t\t\ttween(chipNode).to(1, { position: endPositon },{easing: 'quintOut'})\r\n\t\t\t.start();\r\n\t\t})\r\n\r\n\t\t// 把荷官赔付的筹码加入到用户下注的数组中去\r\n\t\tcopyBetInfo.forEach(v => {\r\n\t\t\tconst betInfo = betInfos.find(bb => bb.userId === v.userId);\r\n\t\t\tbetInfo.chips = betInfo.chips.concat(v.chips);\r\n\t\t})\r\n\t\t\r\n\t}\r\n\r\n\tprivate  copyBetInfo(betInfos: BetInfo[], parent: Node, odds: number): BetInfo[] {\r\n\t\tconst arr: BetInfo[] = [];\r\n\r\n\t\tnew Array(odds).fill(0).forEach(v => {\r\n\t\t\tbetInfos.forEach(betInfo => {\r\n\t\t\t\tarr.push({\r\n\t\t\t\t\tindex: betInfo.index,\r\n\t\t\t\t\tuserId: betInfo.userId,\r\n\t\t\t\t\tisMe: betInfo.isMe,\r\n\t\t\t\t\tchips: betInfo.chips.filter(chip => chip.comp.props).map(chip => this.createChip(chip.comp.props.value, parent))\r\n\t\t\t\t})\r\n\t\t\t})\r\n\t\t})\r\n\r\n\t\treturn arr;\r\n\t}\r\n\r\n\t/**\r\n\t * 添加下注信息\r\n\t * @param betData \r\n\t * @param viewModel \r\n\t */\r\n\tprivate addBetInfo(betData: BetData, viewModel: ChipViewModel) {\r\n\t\tlet betInfos = this.betAreaInfo.get(betData.betType);\r\n\t\tif (!betInfos) {\r\n\t\t\tbetInfos = [];\r\n\t\t\tthis.betAreaInfo.set(betData.betType, betInfos);\r\n\t\t}\r\n      \r\n\t\t\r\n\t\tlet betInfo = betInfos.find(v => v.userId === betData.memberId);\r\n\t\tif (betInfo) {\r\n\t\t\tbetInfo.chips.push(viewModel);\r\n\t\t} else {\r\n\t\t\tbetInfos.push({\r\n\t\t\t\tindex: betData.index,\r\n\t\t\t\tuserId: betData.memberId,\r\n\t\t\t\tisMe: betData.isMyBet,\r\n\t\t\t\tchips: [viewModel]\r\n\t\t\t})\r\n\t\t}\r\n\r\n\t}\r\n\t\r\n\t/**显示星星在下注区域 */\r\n\tprivate showWinRate(betType: BetType) {\r\n\t\tif (!this.node || !this.node.isValid) return;\r\n\t\tthis.getStar( betType ).active  =  true;\r\n\t}\r\n\r\n\t/**获得星星 */\r\n\tprivate getStar(betType: BetType) {\r\n\t\treturn this.node.children.find(winRate => winRate.name.startsWith(\"props_win_rate_max_\" + betType));\r\n\t}\r\n\r\n\t/** 隐藏星星 */\r\n\tprivate hideAllWinRate() {\r\n\t\tif (!this.node || !this.node.isValid) return;\r\n\t\tthis.node.children.filter(winRate => winRate.name.startsWith(\"props_win_rate_max\")).forEach(v => v.active = false);\r\n\t}\r\n\t\r\n\t/**飞星星 */\r\n\tprivate flyStar(parentNode:Node, betType: BetType) {\r\n\t\tconst endPosition = getNodePositionInCanvas(this.getStar(  betType ));\r\n\t\tlet starIcon = usersViewModel.comp.getPropertyNode().props_spr_icon as Node\r\n\t\t// let starIcon = getNodeByNameDeep(\"props_spr_icon\",this.node.parent.getChildByName(\"prefabs_bandar_users\"));\r\n\t\tconst starNode  =  instantiate(starIcon);\r\n\t\tconst startPosition = getNodePositionInCanvas(starIcon)\r\n\t\tstarNode.active = true;\r\n\t\tthis.node.addChild(starNode);\r\n\t\tstarNode.setPosition(startPosition);\r\n        tween(starNode).to(1,{scale:new Vec3(1.2,1.2)}).start();\r\n\t\tthis.playWinRateTween(starNode, endPosition, 1, () => {\r\n\t\t\t\r\n\t\t\tthis.scheduleOnce(() => {\r\n\t\t\t\tthis.showWinRate(betType);\r\n\t\t\t\tstarNode.destroy();\r\n\t\t\t\tif(this.isFlyStar){this.isFlyStar = false}\r\n\t\t\t}, 0.5);\r\n\t\t});\r\n\t\t\r\n\t}\r\n\r\n\t/**飞星星抛物线动画 */\r\n\tprivate playWinRateTween(tweenNode: Node, endPos: Vec3, playTime: number, callBack: Function) {\r\n\t\tconst startPos  =  tweenNode.position;\r\n\t\tconst startAngle = tweenNode.eulerAngles;\r\n\t\tconst fruitTween = tween(startPos);\r\n\r\n\t\tconst x = (startPos.x + endPos.x) / 2;\r\n\t\tconst y = (startPos.y + endPos.y) / 2;\r\n\r\n\t\tconst mixY = y + y * 0.6;\r\n\t\tconst maxY = y + y * 0.6;\r\n\t\tconst mixX = x;\r\n\t\tconst maxX = x;\r\n\t\tvar progressX = function (start, end, current, t) {\r\n\t\t\t//@ts-ignore\r\n\t\t\tcurrent = bezier(start, mixX, maxX, end, t);\r\n\t\t\treturn current;\r\n\t\t}\r\n\t\tvar progressY = function (start, end, current, t) {\r\n\t\t\t//@ts-ignore\r\n\t\t\tcurrent = bezier(start, mixY, maxY, end, t);\r\n\t\t\treturn current;\r\n\t\t}\r\n\r\n\t\tfruitTween.parallel(\r\n\t\t\ttween().to(playTime, { x: endPos.x }, {\r\n\t\t\t\tprogress: progressX, onUpdate: () => {\r\n\t\t\t\t\ttweenNode.isValid && tweenNode.setPosition(startPos);\r\n\t\t\t\t}\r\n\t\t\t}),\r\n\t\t\ttween().to(playTime, { y: endPos.y }, {\r\n\t\t\t\tprogress: progressY, onUpdate: () => {\r\n\t\t\t\t\ttweenNode.isValid && tweenNode.setPosition(startPos);\r\n\t\t\t\t}\r\n\t\t\t}),\r\n\t\t).start();\r\n\t\ttween(startAngle).to(playTime, { z: 360 }, {\r\n\t\t\tonUpdate: () => {\r\n\t\t\t\tif (tweenNode.isValid) {\r\n\t\t\t\t\ttweenNode.eulerAngles = startAngle;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}).call(() => callBack()).start();\r\n\t}\r\n\r\n\t/** 获取点击区域的节点 */\r\n\tprivate getNodeByBetType(betType: BetType) {\r\n\t\tif (BetType.BLUE === betType) {\r\n\t\t\treturn this.propertyNode.props_btn_blue_win;\r\n\t\t} else if (BetType.BLUE_QIU === betType) {\r\n\t\t\treturn this.propertyNode.props_btn_blue_qiu;\r\n\t\t} else if (BetType.BLUE_TWIN === betType) {\r\n\t\t\treturn this.propertyNode.props_btn_blue_twin;\r\n\t\t} else if (BetType.GREEN_DRAW === betType) {\r\n\t\t\treturn this.propertyNode.props_btn_green_win;\r\n\t\t} else if (BetType.GREEN_QIU === betType) {\r\n\t\t\treturn this.propertyNode.props_btn_green_qiuqiu\r\n\t\t} else if (BetType.GREEN_SIX_TWINS === betType) {\r\n\t\t\treturn this.propertyNode.props_btn_green_twins;\r\n\t\t} else if (BetType.RED === betType) {\r\n\t\t\treturn this.propertyNode.props_btn_red_win;\r\n\t\t} else if (BetType.RED_QIU === betType) {\r\n\t\t\treturn this.propertyNode.props_btn_red_qiu;\r\n\t\t} else if (BetType.RED_TWIN === betType) {\r\n\t\t\treturn this.propertyNode.props_btn_red_twin;\r\n\t\t} \r\n\t}\r\n\r\n\tprivate getNodeToBetType(betType: number) {\r\n\t\tif (1 === betType) {\r\n\t\t\treturn BetType.BLUE\r\n\t\t} else if (2 === betType) {\r\n\t\t\treturn BetType.BLUE_QIU;\r\n\t\t}else if (3 === betType) {\r\n\t\t\treturn BetType.BLUE_TWIN;\r\n\t\t}  else if (4 === betType) {\r\n\t\t\treturn BetType.RED;\r\n\t\t} else if (5 === betType) {\r\n\t\t\treturn BetType.RED_QIU;\r\n\t\t} else if (6 === betType) {\r\n\t\t\treturn BetType.RED_TWIN;\r\n\t\t} else if (7 === betType) {\r\n\t\t\treturn BetType.GREEN_DRAW;\r\n\t\t} else if (8 === betType) {\r\n\t\t\treturn BetType.GREEN_QIU;\r\n\t\t} else if (9 === betType) {\r\n\t\t\treturn BetType.GREEN_SIX_TWINS;\r\n\t\t}\r\n\t}\r\n\tprivate getNodeToBetRateType(winArea: number) {\r\n\t\tif (1 === winArea || winArea === 4) {\r\n\t\t\treturn CardStatus.NORMAL\r\n\t\t} else if (2 === winArea || winArea === 5) {\r\n\t\t\treturn CardStatus.QIU;\r\n\t\t}else if (3 === winArea || winArea === 6) {\r\n\t\t\treturn CardStatus.TWIN;\r\n\t\t} else if (7 === winArea) {\r\n\t\t\treturn CardStatus.GREEN_DRAW;\r\n\t\t} else if (8 === winArea) {\r\n\t\t\treturn CardStatus.GREEN_QIU;\r\n\t\t} else if (9 === winArea) {\r\n\t\t\treturn CardStatus.GREEN_SIX_TWINS;\r\n\t\t}\r\n\t}\r\n\tprotected destroyCallBack(): void {\r\n\t\tthis.taskScheduler.destoryQueue();\r\n        this.taskScheduler.stopQueue(false)\r\n\t}\r\n\tprotected removeComma(str){\r\n\t\tconst newStr = str.replace(/,/g,\"\")\r\n\t\treturn newStr\r\n\t}\r\n\t/**\r\n\t * 获得自己的头像位置\r\n\t * @returns \r\n\t */\r\n\tprivate getMyHeadPosition() {\r\n\t\treturn new Vec3(config.gameOption.myHeadPosition.x, config.gameOption.myHeadPosition.y);\r\n\t}\r\n\t/**筹码飞向用户头像 */\r\n\tprivate chipFlyToHead(chip: ChipViewModel, betInfo: BetInfo) {\r\n\t\tconst chipNode = chip.comp.node;\r\n\t\tconst endPositon = betInfo ? this.getFlyToHeadEndPosition(betInfo) : this.getMyHeadPosition();\r\n\t\tconst uiTransform = this.node.getComponent(UITransform);\r\n\t\ttween(chipNode).to(0.3, { worldPosition: uiTransform.convertToWorldSpaceAR(endPositon) })\r\n\t\t\t.call(() => {\r\n\t\t\t\tchip.unMount();\r\n\t\t\t})\r\n\t\t\t.start();\r\n\t}\r\n\r\n\tprivate cancelBet(cancelBetData: BetData) {\r\n\t\tconsole.log(\"cancelBetData\",cancelBetData);\r\n\t\t\r\n\t\tif (cancelBetData) {\r\n\t\t\tconst betInfos = this.betAreaInfo.get(cancelBetData.betType);\r\n\t\t\tconsole.log(\"betInfos\",betInfos);\r\n\t\t\tif (betInfos === undefined) return;\r\n\t\t\tif (betInfos && betInfos.length > 0) {\r\n\t\t\t\tconst chips = betInfos.find(v => v.userId === gameCacheData.memberId || v.isMe).chips;\r\n\t\t\t\tconsole.log(\"chips\",chips);\r\n\t\t\t\t\r\n\t\t\t\tfor (let i = 0; i < chips.length; i++) {\r\n\t\t\t\t\tconst chip = chips[i];\r\n\t\t\t\t\tif (chip.comp.props.value === cancelBetData.betAmount) {\r\n\t\t\t\t\t\tchips.splice(i, 1);\r\n\t\t\t\t\t\tthis.chipFlyToHead(chip, undefined);\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tconst betArea = this.getNodeByBetType(cancelBetData.betType).getChildByName(\"Layout_bet\");\r\n\t\t\tthis.updateBetAreaGold(cancelBetData, betArea.parent);\r\n\r\n\t\t\tconst betAmount = cancelBetData.betAmount < 10000 ? cancelBetData.betAmount.formatAmountWithCommas() : cancelBetData.betAmount.formatAmountWithLetter();\r\n\r\n\t\t\tglobal.hallDispatch(\r\n\t\t\t\taddToastAction({\r\n\t\t\t\t\tposition: ToastPosition.MIDDLE,\r\n\t\t\t\t\tcontent:\r\n\t\t\t\t\t\tlang.write(k => k.InitGameModule.BetFaild, {}, { placeStr: \"{0} 筹码下注失败\" }).format(betAmount)\r\n\t\t\t\t})\r\n\t\t\t)\r\n\t\t}\r\n\t}\r\n\tprotected bindUI(): void {\r\n\t\tthis.hideAllWinRate();\r\n\t\tthis.hideWinSprite();\r\n\t\tthis.hideBetMine();\r\n\t}\r\n\r\n\tupdate(deltaTime: number) {\r\n\r\n\t}\r\n}\r\n\r\n"]}