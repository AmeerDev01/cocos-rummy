{"version":3,"sources":["file:///Users/geliang/web/dibai/hall/assets/script/subGame/yxx/components/Yxx_HistoryMin.ts"],"names":["_decorator","Button","instantiate","Node","Sprite","tween","UITransform","Vec3","BaseComponent","sourceManageSeletor","playBtnClick","SpriteFramePathDefine","AnimationStatus","BetType","GameStatus","ccclass","property","Yxx_HistoryMin","init","propertyNode","props_btn_history","props_history_group","props_spr_result","props_history_list","props_temp_history_list","props","newResult","gameStatus","animationStatus","results","events","openHistoryMax","start","initState","bindEvent","node","on","EventType","TOUCH_END","useProps","key","value","cur","KAI_GAI","createResult","BET","length","removeAllChildren","i","element","moveHistory","isTween","children","offset","index","by","position","setPosition","x","y","result","groupNode","active","betTypes","forEach","v","addChild","getComponent","spriteFrame","getSpriteFrame","scale","call","updateHistoryListWidth","width","betType","fileName","SHRIMP","HISTORY_MIN_1","GOURD","HISTORY_MIN_2","DEER","HISTORY_MIN_3","CHOOK","HISTORY_MIN_4","CRAB","HISTORY_MIN_5","FISH","HISTORY_MIN_6","getFile","source","bindUI","update","deltaTime"],"mappings":"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","sourcesContent":["import { _decorator, Button, Game, instantiate, log, Node, Sprite, SpriteFrame, Tween, tween, UITransform, Vec3 } from 'cc';\r\nimport { BaseComponent } from '../../../base/BaseComponent';\r\nimport { sourceManageSeletor } from '../index';\r\nimport { playBtnClick } from '../index';\r\nimport { SpriteFramePathDefine } from '../sourceDefine/spriteDefine';\r\nimport { AnimationStatus, BetType, GameStatus, Result } from '../type';\r\nconst { ccclass, property } = _decorator;\r\n\r\nexport interface IState {\r\n\r\n}\r\n\r\nexport interface IProps {\r\n\t/**最新结果 */\r\n\tnewResult: Result,\r\n\tgameStatus: GameStatus,\r\n\t/**动画状态 */\r\n\tanimationStatus: AnimationStatus,\r\n\tresults: Result[]\r\n}\r\nexport interface IEvent {\r\n\topenHistoryMax: () => void\r\n}\r\n\r\n@ccclass('Yxx_HistoryMin')\r\nexport class Yxx_HistoryMin extends BaseComponent<IState, IProps, IEvent> {\r\n\tstart() {\r\n\r\n\t}\r\n\r\n\tprivate init = false;\r\n\r\n\tprotected propertyNode = {\r\n\t\tprops_btn_history: new Button(),\r\n\t\tprops_history_group: new Node(),\r\n\t\tprops_spr_result: new Node(),\r\n\t\tprops_history_list: new Node(),\r\n\t\tprops_temp_history_list: new Node(),\r\n\t}\r\n\r\n\tpublic props: IProps = {\r\n\t\tnewResult: null,\r\n\t\tgameStatus: null,\r\n\t\tanimationStatus: null,\r\n\t\tresults: [],\r\n\t}\r\n\r\n\tpublic events: IEvent = {\r\n\t\topenHistoryMax: () => { }\r\n\t}\r\n\r\n\tprotected initState() {\r\n\t\treturn {\r\n\r\n\t\t}\r\n\t}\r\n\r\n\tprotected bindEvent(): void {\r\n\t\tthis.propertyNode.props_btn_history.node.on(Node.EventType.TOUCH_END, () => {\r\n\t\t\tplayBtnClick();\r\n\t\t\tthis.events.openHistoryMax();\r\n\t\t})\r\n\t}\r\n\r\n\tprotected useProps(key: keyof IProps, value: { pre: any, cur: any }) {\r\n\t\t// log(\"history min ==================== \", key, value);\r\n\t\tif (key === 'animationStatus') {\r\n\t\t\tif (value.cur === AnimationStatus.KAI_GAI) {\r\n\t\t\t\tthis.createResult(this.props.newResult);\r\n\t\t\t}\r\n\t\t} else if (key === 'gameStatus' && value.cur === GameStatus.BET && this.props.results.length) {\r\n\t\t\t// 为了防止通过动画添加历史记录时，由于动画播放的原因没有添加，所以在每次开始游戏的时候，处理一次历史记录\r\n\t\t\tthis.propertyNode.props_history_list.removeAllChildren();\r\n\t\t\tfor (let i = 0; i < this.props.results.length; i++) {\r\n\t\t\t\tconst element = this.props.results[i];\r\n\t\t\t\tthis.createResult(element, false);\r\n\t\t\t}\r\n\t\t} else if (key === 'results' && !this.init) { //游戏初始化时调用\r\n\t\t\tthis.init = true;\r\n\t\t\tthis.propertyNode.props_history_list.removeAllChildren();\r\n\r\n\t\t\tconst length = this.props.gameStatus === GameStatus.BET ? this.props.results.length : this.props.results.length - 1;\r\n\t\t\tfor (let i = 0; i < length; i++) {\r\n\t\t\t\tconst element = this.props.results[i];\r\n\t\t\t\tthis.createResult(element, false);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tprivate moveHistory(isTween: boolean = true) {\r\n\t\tconst children = this.propertyNode.props_history_list.children;\r\n\t\tconst offset = 37;\r\n\t\tfor (let index = 0; index < children.length; index++) {\r\n\t\t\tconst element = children[index];\r\n\t\t\tif (isTween) {\r\n\t\t\t\ttween(element).by(0.7, { position: new Vec3(offset, 0) }).start();\r\n\t\t\t} else {\r\n\t\t\t\telement.setPosition(new Vec3(element.position.x + offset, element.position.y));\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tpublic createResult(result: Result, isTween: boolean = true): void {\r\n\t\tthis.moveHistory(isTween);\r\n\t\tconst groupNode = instantiate(this.propertyNode.props_history_group);\r\n\t\tgroupNode.active = true;\r\n\t\tgroupNode.removeAllChildren();\r\n\r\n\t\tresult.betTypes.forEach((v, index) => {\r\n\t\t\tconst node = instantiate(this.propertyNode.props_spr_result);\r\n\t\t\tgroupNode.addChild(node);\r\n\t\t\tnode.getComponent(Sprite).spriteFrame = this.getSpriteFrame(v);\r\n\t\t\tnode.scale = new Vec3(1.0, 1.0);\r\n\t\t})\r\n\r\n\t\tif (isTween) {\r\n\t\t\tthis.propertyNode.props_temp_history_list.addChild(groupNode);\r\n\t\t\ttween(groupNode).by(0.5, { scale: new Vec3(0.2, 0.2) }).by(0.2, { scale: new Vec3(-0.2, -0.2) }).call(() => {\r\n\t\t\t\tthis.propertyNode.props_history_list.addChild(groupNode);\r\n\t\t\t\tthis.updateHistoryListWidth();\r\n\t\t\t\tthis.propertyNode.props_temp_history_list.removeAllChildren();\r\n\t\t\t}).start();\r\n\t\t} else {\r\n\t\t\tthis.propertyNode.props_history_list.addChild(groupNode);\r\n\t\t\tthis.updateHistoryListWidth();\r\n\t\t}\r\n\t}\r\n\r\n\tprivate updateHistoryListWidth() {\r\n\t\tthis.propertyNode.props_history_list.getComponent(UITransform).width = this.propertyNode.props_history_list.children.length * 37;\r\n\t}\r\n\r\n\tprivate getSpriteFrame(betType: BetType): SpriteFrame {\r\n\t\tlet fileName = '';\r\n\t\tif (betType === BetType.SHRIMP) {\r\n\t\t\tfileName = SpriteFramePathDefine.HISTORY_MIN_1;\r\n\t\t} else if (betType === BetType.GOURD) {\r\n\t\t\tfileName = SpriteFramePathDefine.HISTORY_MIN_2;\r\n\t\t} else if (betType === BetType.DEER) {\r\n\t\t\tfileName = SpriteFramePathDefine.HISTORY_MIN_3;\r\n\t\t} else if (betType === BetType.CHOOK) {\r\n\t\t\tfileName = SpriteFramePathDefine.HISTORY_MIN_4;\r\n\t\t} else if (betType === BetType.CRAB) {\r\n\t\t\tfileName = SpriteFramePathDefine.HISTORY_MIN_5;\r\n\t\t} else if (betType === BetType.FISH) {\r\n\t\t\tfileName = SpriteFramePathDefine.HISTORY_MIN_6;\r\n\t\t}\r\n\t\treturn sourceManageSeletor().getFile(fileName).source;\r\n\t}\r\n\r\n\tprotected bindUI(): void {\r\n\r\n\t}\r\n\r\n\tupdate(deltaTime: number) {\r\n\r\n\t}\r\n}\r\n\r\n"]}