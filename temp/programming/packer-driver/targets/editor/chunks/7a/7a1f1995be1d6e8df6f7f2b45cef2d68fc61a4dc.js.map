{"version":3,"sources":["file:///Users/geliang/web/dibai/hall/assets/script/common/fish/FishNet.ts"],"names":["FishNet","Node","sp","createSkeleton","toNodeSpaceAR","fishNetZOrder","FishNetCreate","create","info","constructor","fishNetConfig","sourceManage","fshn_cfg","object_id","is_alive","end_call","net_obj","uiRoot","rootNode","init","fnConfig","id","obj_id","src","setPosition","addChild","active","setSiblingIndex","getDataId","getObjectId","setUseState","buse","getUseState","setPlayEndCall","call","play","pos","sk","getComponent","Skeleton","setAnimation","ani","setCompleteListener"],"mappings":"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","sourcesContent":["import { Component, Node, Vec3, sp } from \"cc\";\r\nimport { createSkeleton, toNodeSpaceAR } from \"./FishTool\";\r\nimport SourceManage from \"../../base/SourceManage\";\r\nimport { ICreateObj } from \"./ObjectPool\";\r\n\r\n\r\n/**\r\n  鱼网\r\n */\r\nconst fishNetZOrder = 900000\r\n\r\nexport const FishNetCreate: ICreateObj = {\r\n  create: (info) => {\r\n    return new FishNet();\r\n  }\r\n}\r\n\r\n//////////////////////////////////////////////-\r\n\r\nexport class FishNet {\r\n  private fishNetConfig;\r\n  private sourceManage: SourceManage;\r\n  private fshn_cfg;\r\n  private object_id;\r\n  private is_alive: boolean;\r\n  private end_call;\r\n  private net_obj: Node;\r\n  public uiRoot: Node;\r\n  private rootNode: Node;\r\n\r\n  constructor() {\r\n    this.uiRoot = new Node();\r\n  }\r\n\r\n  public init(info, fnConfig, sourceManage: SourceManage, rootNode: Node) {\r\n    this.rootNode = rootNode\r\n    this.fishNetConfig = fnConfig\r\n    this.sourceManage = sourceManage;\r\n    this.fshn_cfg = this.fishNetConfig[info.id]\r\n    this.object_id = info.obj_id\r\n    this.is_alive = false\r\n    this.end_call = null\r\n\r\n    this.net_obj = createSkeleton(this.sourceManage, this.uiRoot, this.fshn_cfg.src);\r\n    this.net_obj.setPosition(0, 0)\r\n    this.uiRoot.addChild(this.net_obj)\r\n    this.net_obj.active = (true)\r\n\r\n    this.uiRoot.setPosition(0, 0)\r\n    this.uiRoot.active = (false)\r\n\r\n    this.uiRoot.setSiblingIndex(fishNetZOrder)\r\n  }\r\n\r\n  public getDataId() {\r\n    return this.fshn_cfg.id\r\n  }\r\n\r\n  public getObjectId() {\r\n    return this.object_id\r\n  }\r\n\r\n  public setUseState(buse) {\r\n    this.is_alive = buse\r\n  }\r\n\r\n  public getUseState() {\r\n    return this.is_alive\r\n  }\r\n\r\n  //call(obj)\r\n  public setPlayEndCall(call) {\r\n    this.end_call = call\r\n  }\r\n\r\n  public play(pos) {\r\n    // this.uiRoot.setWorldPosition(new Vec3(pos.x, pos.y))\r\n    this.uiRoot.setPosition(toNodeSpaceAR(this.rootNode, pos))\r\n    this.uiRoot.active = true\r\n\r\n    const sk = this.net_obj.getComponent(sp.Skeleton)\r\n    sk.setAnimation(0, this.fshn_cfg.ani, false)\r\n    sk.setCompleteListener(() => {\r\n      this.end_call && this.end_call(this);\r\n    })\r\n  }\r\n}\r\n\r\n\r\n// /**\r\n// \tinfo = [obj_id, id,]\r\n//  */\r\n// public create(info) {\r\n//   let obj = FishNet.new()\r\n//   if (obj) {\r\n//     obj.init(info)\r\n//   }\r\n\r\n//   return obj\r\n// }\r\n\r\n"]}