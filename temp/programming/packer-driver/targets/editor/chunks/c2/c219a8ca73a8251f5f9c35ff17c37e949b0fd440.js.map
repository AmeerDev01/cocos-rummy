{"version":3,"sources":["file:///Users/geliang/web/dibai/hall/assets/script/utils/NodeIOEffect.ts"],"names":["UIOpacity","Vec3","tween","EffectType","getEffectByType","effectType","EFFECT1","effect1","EFFECT2","effect2","EFFECT_FADE","effectFade","target","enter","option","Promise","resolve","_option","Object","assign","tweenDuration","scaleOrigin","x","y","opacityUI","getComponent","addComponent","opacity","setScale","to","start","scale","easing","call","e","out","isDestroy","destroy"],"mappings":"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","sourcesContent":["import { Node, UIOpacity, Vec3, tween } from \"cc\"\r\n\r\nexport enum EffectType {\r\n  EFFECT1,\r\n  EFFECT2,\r\n  EFFECT_FADE\r\n}\r\n\r\nexport type EnterOption = {\r\n  tweenDuration?: number,\r\n  scaleOrigin?: { x: number, y: number }\r\n}\r\n\r\ntype EffectItem = (target: Node) => {\r\n  /**\r\n     * 入场效果\r\n     * @param tweenDuration 执行时间,默认0.2s\r\n     * @returns 新加入的节点Promise\r\n     */\r\n  enter: (option?: EnterOption) => Promise<Node>\r\n  /**\r\n     * 出场\r\n     * @param isDestroy 是否要自动销毁,默认为true\r\n     * @param tweenDuration 执行时间,默认0.2s\r\n     * @returns 返回出场的节点Promise（注意：如果传入自动销毁，这里返回的是空）\r\n     */\r\n  out: (isDestroy?: boolean, tweenDuration?: number) => Promise<Node>\r\n}\r\n\r\nexport const getEffectByType = (effectType: EffectType) => {\r\n  switch (effectType) {\r\n    case EffectType.EFFECT1:\r\n      return effect1;\r\n    case EffectType.EFFECT2:\r\n      return effect2;\r\n    case EffectType.EFFECT_FADE:\r\n      return effectFade;\r\n  }\r\n}\r\n\r\n/**缩放0.9，并渐变 */\r\nexport const effect1: EffectItem = (target: Node) => {\r\n  return {\r\n    enter: (option?: EnterOption): Promise<Node | undefined> => {\r\n      return new Promise((resolve) => {\r\n        const _option = Object.assign({\r\n          tweenDuration: 0.3,\r\n          scaleOrigin: { x: 1, y: 1 }\r\n        }, option || {})\r\n        try {\r\n          let opacityUI = target.getComponent(UIOpacity)\r\n          !target.getComponent(UIOpacity) && (opacityUI = target.addComponent(UIOpacity))\r\n          opacityUI.opacity = 0\r\n          target.setScale(_option.scaleOrigin.x * 0.9, _option.scaleOrigin.y * 0.9)\r\n          tween(opacityUI).to(_option.tweenDuration, { opacity: 255 }).start();\r\n          tween(target).to(_option.tweenDuration, { scale: new Vec3(_option.scaleOrigin.x * 1, _option.scaleOrigin.x * 1, 1) }, {\r\n            easing: \"backOut\"//\"elasticOut\"\r\n          }).call(() => {\r\n            resolve(target)\r\n          }).start();\r\n        } catch (e) {\r\n          resolve(target)\r\n        }\r\n      })\r\n    },\r\n    out: (isDestroy: boolean = true, tweenDuration: number = 0.2): Promise<Node | undefined> => {\r\n      return new Promise((resolve) => {\r\n        try {\r\n          let opacityUI = target.getComponent(UIOpacity)\r\n          !target.getComponent(UIOpacity) && (opacityUI = target.addComponent(UIOpacity))\r\n          tween(opacityUI).to(tweenDuration, { opacity: 0 }).start();\r\n          tween(target).to(tweenDuration, { scale: new Vec3(0.9, 0.9, 1) }).call(() => {\r\n            isDestroy && target.destroy()\r\n            resolve(target)\r\n          }).start();\r\n        } catch (e) {\r\n          resolve(target)\r\n        }\r\n      })\r\n    }\r\n  }\r\n}\r\n\r\n/**放大0.9，并渐变 */\r\nexport const effect2: EffectItem = (target: Node) => {\r\n  return {\r\n    enter: (option?: EnterOption): Promise<Node | undefined> => {\r\n      return new Promise((resolve) => {\r\n        const _option = Object.assign({\r\n          tweenDuration: 0.2,\r\n          scaleOrigin: { x: 1, y: 1 }\r\n        }, option || {})\r\n        try {\r\n          let opacityUI = target.getComponent(UIOpacity)\r\n          !target.getComponent(UIOpacity) && (opacityUI = target.addComponent(UIOpacity))\r\n          opacityUI.opacity = 0\r\n          target.setScale(_option.scaleOrigin.x * 1.1, _option.scaleOrigin.y * 1.1)\r\n          tween(opacityUI).to(_option.tweenDuration, { opacity: 255 }).start();\r\n          tween(target).to(_option.tweenDuration, { scale: new Vec3(_option.scaleOrigin.x * 1, _option.scaleOrigin.y * 1, 1) }).call(() => {\r\n            resolve(target)\r\n          }).start();\r\n        } catch (e) {\r\n          resolve(target)\r\n        }\r\n      })\r\n    },\r\n    out: (isDestroy: boolean = true, tweenDuration: number = 0.2): Promise<Node | undefined> => {\r\n      return new Promise((resolve) => {\r\n        try {\r\n          let opacityUI = target.getComponent(UIOpacity)\r\n          !target.getComponent(UIOpacity) && (opacityUI = target.addComponent(UIOpacity))\r\n          tween(opacityUI).to(tweenDuration, { opacity: 0 }).start();\r\n          tween(target).to(tweenDuration, { scale: new Vec3(1.1, 1.1, 1) }).call(() => {\r\n            isDestroy && target.destroy()\r\n            resolve(target)\r\n          }).start();\r\n        } catch (e) {\r\n          resolve(target)\r\n        }\r\n      })\r\n    }\r\n  }\r\n}\r\n\r\nexport const effectFade: EffectItem = (target: Node) => {\r\n  return {\r\n    enter: (option?: EnterOption): Promise<Node | undefined> => {\r\n      return new Promise((resolve) => {\r\n        try {\r\n          const _option = Object.assign({ tweenDuration: 0.3 }, option || {})\r\n          let opacityUI = target.getComponent(UIOpacity)\r\n          !target.getComponent(UIOpacity) && (opacityUI = target.addComponent(UIOpacity))\r\n          opacityUI.opacity = 0\r\n          tween(opacityUI).to(_option.tweenDuration, { opacity: 255 }).call(() => {\r\n            resolve(target)\r\n          }).start()\r\n        } catch (e) {\r\n          resolve(target)\r\n        }\r\n      })\r\n    },\r\n    out: (isDestroy: boolean = true, tweenDuration: number = 0.3): Promise<Node | undefined> => {\r\n      return new Promise((resolve) => {\r\n        try {\r\n          let opacityUI = target.getComponent(UIOpacity)\r\n          !target.getComponent(UIOpacity) && (opacityUI = target.addComponent(UIOpacity))\r\n          tween(opacityUI).to(tweenDuration, { opacity: 0 }).call(() => {\r\n            isDestroy && target.destroy()\r\n            resolve(target)\r\n          }).start()\r\n        } catch (e) {\r\n          resolve(target)\r\n        }\r\n      })\r\n    }\r\n  }\r\n}"]}