{"version":3,"sources":["file:///Users/geliang/web/dibai/hall/assets/script/subGame/egyptV2/components/EgyptV2_Icon.ts"],"names":["EgyptV2Icon","UITransform","Vec3","instantiate","sp","Sprite","Label","sourceManageSeletor","PrefabPathDefine","getNodeByNameDeep","IconId","config","constructor","iconConfig","isPoolObject","node","faceNode","faceAnimationNode","skeleton","sprite","use","iconIndex","borderNode","amountNode","amount","callback","getFile","ICON","source","getComponent","width","normalRollOption","singleRollerWidth","height","singleRollerHeight","Skeleton","active","removeFromParent","isBeetleIcon","isSunGod","string","listenerSkeletonEvent","buildIcon","id","BEETLE","SUN_GOD","setCompleteListener","isValid","hideWin","resetIcon","parentNode","addChild","setScale","scale","getId","restore","destory","getNode","getHeight","getIconIndex","setPosition","value","offset","distance","setWorldPosition","worldPosition","clone","add","getPosition","skeletonData","skeletonName","setAnimation","animationArr","spriteFrame","fileName","playWin","isBorder","loop","parent","playBeetleAnimation","done","setSiblingIndex","children","length","pauseWin","isUse","setAmount","amountStr","formatAmountWithLetter","formatAmountWithCommas","showBg","getChildByName","hideBg","showAmount","hideAmount","getAmountNode","getAmount","destroy"],"mappings":";;;4MAOaA,W;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAPEC,MAAAA,W,OAAAA,W;AAAaC,MAAAA,I,OAAAA,I;AAAMC,MAAAA,W,OAAAA,W;AAAaC,MAAAA,E,OAAAA,E;AAAIC,MAAAA,M,OAAAA,M;AAAQC,MAAAA,K,OAAAA,K;;AAClDC,MAAAA,mB,iBAAAA,mB;;AACAC,MAAAA,gB,iBAAAA,gB;;AACAC,MAAAA,iB,iBAAAA,iB;;AACAC,MAAAA,M,iBAAAA,M;;AACFC,MAAAA,M;;;;;;;;;6BAEMX,W,GAAN,MAAMA,WAAN,CAAkB;AAkBvBY,QAAAA,WAAW,CAACC,UAAD,EAAaC,YAAqB,GAAG,IAArC,EAA2C;AAAA,eAjB9CC,IAiB8C;AAAA,eAhB9CC,QAgB8C;AAAA,eAf9CC,iBAe8C;AAAA,eAd9CJ,UAc8C;AAAA,eAb9CK,QAa8C;AAAA,eAZ9CC,MAY8C;AAAA,eAX9CC,GAW8C,GAXxC,KAWwC;AAAA,eAV9CC,SAU8C,GAVlC,CAUkC;AAAA,eAR9CC,UAQ8C;AAAA,eAP9CC,UAO8C;AAAA,eAL9CC,MAK8C,GAL7B,CAK6B;AAAA,eAH9CV,YAG8C,GAH/B,IAG+B;AAAA,eAF9CW,QAE8C;AACpD,eAAKZ,UAAL,GAAkBA,UAAlB;AACA,eAAKC,YAAL,GAAoBA,YAApB;AACA,eAAKC,IAAL,GAAYZ,WAAW,CAAC;AAAA;AAAA,4DAAsBuB,OAAtB,CAA8B;AAAA;AAAA,oDAAiBC,IAA/C,EAAqDC,MAAtD,CAAvB;AACA,eAAKb,IAAL,CAAUc,YAAV,CAAuB5B,WAAvB,EAAoC6B,KAApC,GAA4C;AAAA;AAAA,gCAAOC,gBAAP,CAAwBC,iBAApE;AACA,eAAKjB,IAAL,CAAUc,YAAV,CAAuB5B,WAAvB,EAAoCgC,MAApC,GAA6C;AAAA;AAAA,gCAAOF,gBAAP,CAAwBG,kBAArE;AAEA,eAAKlB,QAAL,GAAgB;AAAA;AAAA,sDAAkB,MAAlB,EAA0B,KAAKD,IAA/B,CAAhB;AACA,eAAKE,iBAAL,GAAyB;AAAA;AAAA,sDAAkB,gBAAlB,EAAoC,KAAKF,IAAzC,CAAzB;AAEA,eAAKI,MAAL,GAAc,KAAKH,QAAL,CAAca,YAAd,CAA2BxB,MAA3B,CAAd;AACA,eAAKa,QAAL,GAAgB,KAAKD,iBAAL,CAAuBY,YAAvB,CAAoCzB,EAAE,CAAC+B,QAAvC,CAAhB;AAEA,eAAKb,UAAL,GAAkB;AAAA;AAAA,sDAAkB,aAAlB,EAAiC,KAAKP,IAAtC,CAAlB;AACA,eAAKO,UAAL,CAAgBc,MAAhB,GAAyB,IAAzB;AACA,eAAKd,UAAL,CAAgBe,gBAAhB;;AAEA,cAAI,KAAKC,YAAL,MAAuB,KAAKC,QAAL,EAA3B,EAA4C;AAC1C,iBAAKhB,UAAL,GAAkB;AAAA;AAAA,wDAAkB,QAAlB,EAA4B,KAAKR,IAAjC,CAAlB;AACA,iBAAKQ,UAAL,CAAgBa,MAAhB,GAAyB,IAAzB;AACA,iBAAKb,UAAL,CAAgBM,YAAhB,CAA6BvB,KAA7B,EAAoCkC,MAApC,GAA6C,KAAKF,YAAL,KAAsB,GAAtB,GAA4B,EAAzE;AACA,iBAAKG,qBAAL;AACA,iBAAKjB,MAAL,GAAc,CAAd;AACD;;AAED,eAAKkB,SAAL;AACD;;AAEMJ,QAAAA,YAAY,GAAG;AACpB,iBAAO,KAAKzB,UAAL,CAAgB8B,EAAhB,KAAuB;AAAA;AAAA,gCAAOC,MAArC;AACD;;AAEML,QAAAA,QAAQ,GAAG;AAChB,iBAAO,KAAK1B,UAAL,CAAgB8B,EAAhB,KAAuB;AAAA;AAAA,gCAAOE,OAArC;AACD;;AAEOJ,QAAAA,qBAAqB,GAAG;AAC9B,eAAKvB,QAAL,CAAc4B,mBAAd,CAAkC,MAAM;AACtC,gBAAI,KAAK/B,IAAL,CAAUgC,OAAV,IAAqB,KAAKtB,QAA9B,EAAwC;AACtC,mBAAKA,QAAL,IAAiB,KAAKA,QAAL,EAAjB;AACA,mBAAKA,QAAL,GAAgB,IAAhB;AACA,mBAAKuB,OAAL;AACD;AACF,WAND;AAOD;AAED;;;AACOC,QAAAA,SAAS,CAACpC,UAAD,EAAaqC,UAAb,EAAgC7B,SAAhC,EAAoD;AAClE,eAAKD,GAAL,GAAW,IAAX;AACA,eAAKP,UAAL,GAAkBA,UAAlB;AACA,eAAKQ,SAAL,GAAiBA,SAAjB;AACA6B,UAAAA,UAAU,IAAIA,UAAU,CAACC,QAAX,CAAoB,KAAKpC,IAAzB,CAAd;AACA,eAAKA,IAAL,CAAUqC,QAAV,CAAmBvC,UAAU,CAACwC,KAAX,CAAiB,CAAjB,CAAnB,EAAwCxC,UAAU,CAACwC,KAAX,CAAiB,CAAjB,CAAxC;AACA,eAAKpC,iBAAL,CAAuBmC,QAAvB,CAAgCvC,UAAU,CAACwC,KAAX,CAAiB,CAAjB,CAAhC,EAAqDxC,UAAU,CAACwC,KAAX,CAAiB,CAAjB,CAArD;AACD;;AAEMC,QAAAA,KAAK,GAAG;AACb,iBAAO,KAAKzC,UAAL,CAAgB8B,EAAvB;AACD;AAED;;;AACOY,QAAAA,OAAO,GAAG;AACf,cAAI,KAAKxC,IAAL,IAAa,KAAKA,IAAL,CAAUgC,OAA3B,EAAoC;AAClC,iBAAK3B,GAAL,GAAW,KAAX;AACA,iBAAKC,SAAL,GAAiB,CAAC,CAAlB;AACA,iBAAKN,IAAL,CAAUqB,MAAV,GAAmB,IAAnB;AACA,iBAAKrB,IAAL,CAAUsB,gBAAV;;AACA,gBAAI,KAAKd,UAAT,EAAqB;AACnB,mBAAKC,MAAL,GAAc,CAAd;AACA,mBAAKD,UAAL,CAAgBM,YAAhB,CAA6BvB,KAA7B,EAAoCkC,MAApC,GAA6C,KAAKF,YAAL,KAAsB,GAAtB,GAA4B,EAAzE;AACD;;AACD,aAAC,KAAKxB,YAAN,IAAsB,KAAK0C,OAAL,EAAtB;AACD;AACF;;AAEMC,QAAAA,OAAO,GAAG;AACf,iBAAO,KAAK1C,IAAZ;AACD;;AAEM2C,QAAAA,SAAS,GAAG;AACjB,iBAAO,KAAK3C,IAAL,CAAUc,YAAV,CAAuB5B,WAAvB,EAAoCgC,MAA3C;AACD;;AAEM0B,QAAAA,YAAY,GAAG;AACpB,iBAAO,KAAKtC,SAAZ;AACD;;AAEMuC,QAAAA,WAAW,CAACC,KAAD,EAAc;AAC9B,cAAI,KAAK9C,IAAT,EAAe;AACb,iBAAKA,IAAL,CAAU6C,WAAV,CAAsBC,KAAtB;AACA,kBAAMC,MAAM,GAAG,IAAI5D,IAAJ,CAAS,KAAKW,UAAL,CAAgBkD,QAAhB,CAAyB,CAAzB,CAAT,EAAsC,KAAKlD,UAAL,CAAgBkD,QAAhB,CAAyB,CAAzB,CAAtC,CAAf;AACA,iBAAK9C,iBAAL,CAAuB+C,gBAAvB,CAAwC,KAAKjD,IAAL,CAAUkD,aAAV,CAAwBC,KAAxB,GAAgCC,GAAhC,CAAoCL,MAApC,CAAxC;AACA,iBAAKxC,UAAL,CAAgB0C,gBAAhB,CAAiC,KAAKjD,IAAL,CAAUkD,aAA3C;AACD;AACF;;AAEMG,QAAAA,WAAW,GAAG;AACnB,iBAAO,KAAKrD,IAAL,CAAUqD,WAAV,EAAP;AACD;;AAEO1B,QAAAA,SAAS,GAAG;AAClB,eAAKzB,iBAAL,CAAuBmB,MAAvB,GAAgC,KAAhC;AACA,eAAKnB,iBAAL,CAAuBoB,gBAAvB;AAEA,gBAAMgC,YAAY,GAAG;AAAA;AAAA,4DAAsB3C,OAAtB,CAA8B,KAAKb,UAAL,CAAgByD,YAA9C,EAA4D1C,MAAjF;AACA,eAAKV,QAAL,CAAcmD,YAAd,GAA6BA,YAA7B;AACA,eAAKnD,QAAL,CAAcqD,YAAd,CAA2B,CAA3B,EAA8B,KAAK1D,UAAL,CAAgB2D,YAAhB,CAA6B,CAA7B,CAA9B,EAA+D,KAA/D;AACA,eAAKrD,MAAL,CAAYsD,WAAZ,GAA0B;AAAA;AAAA,4DAAsB/C,OAAtB,CAA8B,KAAKb,UAAL,CAAgB6D,QAA9C,EAAwD9C,MAAlF;AAED;AAED;;;AACO+C,QAAAA,OAAO,CAACzB,UAAD,EAAmB0B,QAAiB,GAAG,IAAvC,EAA6CC,IAAa,GAAG,IAA7D,EAAmE;AAC/E,gBAAMf,MAAM,GAAG,IAAI5D,IAAJ,CAAS,KAAKW,UAAL,CAAgBkD,QAAhB,CAAyB,CAAzB,CAAT,EAAsC,KAAKlD,UAAL,CAAgBkD,QAAhB,CAAyB,CAAzB,CAAtC,CAAf;;AACA,cAAI,CAAC,KAAK9C,iBAAL,CAAuBmB,MAA5B,EAAoC;AAClC,iBAAKnB,iBAAL,CAAuBmB,MAAvB,GAAgC,IAAhC,CADkC,CAElC;;AACA,gBAAI,CAAC,KAAKnB,iBAAL,CAAuB6D,MAA5B,EAAoC;AAClC5B,cAAAA,UAAU,CAACC,QAAX,CAAoB,KAAKlC,iBAAzB;AACA,mBAAKA,iBAAL,CAAuB+C,gBAAvB,CAAwC,KAAKjD,IAAL,CAAUkD,aAAV,CAAwBC,KAAxB,GAAgCC,GAAhC,CAAoCL,MAApC,CAAxC;AACD;AACF;;AAED,cAAIc,QAAQ,IAAI,CAAC,KAAKtD,UAAL,CAAgBc,MAAjC,EAAyC;AACvC,iBAAKd,UAAL,CAAgBc,MAAhB,GAAyB,IAAzB;;AACA,gBAAI,CAAC,KAAKd,UAAL,CAAgBwD,MAArB,EAA6B;AAC3B5B,cAAAA,UAAU,CAACC,QAAX,CAAoB,KAAK7B,UAAzB;AACA,mBAAKA,UAAL,CAAgB0C,gBAAhB,CAAiC,KAAKjD,IAAL,CAAUkD,aAA3C;AACD;AACF;;AAED,eAAKjD,QAAL,CAAcoB,MAAd,GAAuB,KAAvB;AACA,eAAKlB,QAAL,CAAcqD,YAAd,CAA2B,CAA3B,EAA8B,KAAK1D,UAAL,CAAgB2D,YAAhB,CAA6B,CAA7B,CAA9B,EAA+DK,IAA/D;AACD;AAED;;;AACOE,QAAAA,mBAAmB,CAACC,IAAD,EAAO;AAC/B;AACA;AACA;AACA;AACA,eAAKvD,QAAL,GAAgBuD,IAAhB;AACA,eAAK/D,iBAAL,CAAuBmB,MAAvB,GAAgC,IAAhC;AACA,eAAKrB,IAAL,CAAUoC,QAAV,CAAmB,KAAKlC,iBAAxB;AACA,eAAKA,iBAAL,CAAuB+C,gBAAvB,CAAwC,KAAKjD,IAAL,CAAUkD,aAAlD;AACA,eAAKjD,QAAL,CAAcoB,MAAd,GAAuB,KAAvB;AAEA,eAAKb,UAAL,CAAgB0D,eAAhB,CAAgC,KAAKlE,IAAL,CAAUmE,QAAV,CAAmBC,MAAnD;AACA,eAAKjE,QAAL,CAAcqD,YAAd,CAA2B,CAA3B,EAA8B,KAAK1D,UAAL,CAAgB2D,YAAhB,CAA6B,CAA7B,CAA9B,EAA+D,IAA/D;AACD;AAED;;;AACOxB,QAAAA,OAAO,GAAG;AACf,eAAK/B,iBAAL,CAAuBmB,MAAvB,GAAgC,KAAhC;AACA,eAAKnB,iBAAL,CAAuBoB,gBAAvB;AACA,eAAKf,UAAL,CAAgBc,MAAhB,GAAyB,KAAzB;AACA,eAAKd,UAAL,CAAgBe,gBAAhB;AAEA,eAAKrB,QAAL,CAAcoB,MAAd,GAAuB,IAAvB;AACA,eAAKlB,QAAL,CAAcqD,YAAd,CAA2B,CAA3B,EAA8B,KAAK1D,UAAL,CAAgB2D,YAAhB,CAA6B,CAA7B,CAA9B,EAA+D,KAA/D;AACD;;AAEMY,QAAAA,QAAQ,GAAG;AAChB,eAAK9D,UAAL,CAAgBc,MAAhB,GAAyB,KAAzB;AACA,eAAKlB,QAAL,CAAcqD,YAAd,CAA2B,CAA3B,EAA8B,KAAK1D,UAAL,CAAgB2D,YAAhB,CAA6B,CAA7B,CAA9B,EAA+D,KAA/D;AACD;AAED;;;AACOa,QAAAA,KAAK,GAAG;AACb,iBAAO,KAAKjE,GAAZ;AACD;;AAEMkE,QAAAA,SAAS,CAAC9D,MAAD,EAAS;AACvB,eAAKA,MAAL,GAAcA,MAAd;;AACA,cAAIA,MAAM,GAAG,CAAb,EAAgB;AACd,iBAAKD,UAAL,CAAgBa,MAAhB,GAAyB,IAAzB;AACD;;AACD,gBAAMmD,SAAS,GAAG/D,MAAM,IAAI,KAAV,GAAkBA,MAAM,CAACgE,sBAAP,EAAlB,GAAoDhE,MAAM,CAACiE,sBAAP,EAAtE;AACA,eAAKlE,UAAL,CAAgBM,YAAhB,CAA6BvB,KAA7B,EAAoCkC,MAApC,GAA6C+C,SAA7C;AACD;;AAEMG,QAAAA,MAAM,GAAG;AACd,eAAK3E,IAAL,CAAU4E,cAAV,CAAyB,IAAzB,EAA+BvD,MAA/B,GAAwC,IAAxC;AACD;;AAEMwD,QAAAA,MAAM,GAAG;AACd,eAAK7E,IAAL,CAAU4E,cAAV,CAAyB,IAAzB,EAA+BvD,MAA/B,GAAwC,KAAxC;AACD;;AAEMyD,QAAAA,UAAU,GAAG;AAClB,eAAKvD,YAAL,OAAwB,KAAKf,UAAL,CAAgBa,MAAhB,GAAyB,KAAjD;AACD;;AACM0D,QAAAA,UAAU,GAAG;AAClB,eAAKvE,UAAL,CAAgBa,MAAhB,GAAyB,KAAzB;AACA,eAAKZ,MAAL,GAAc,CAAd;AACD;;AAEMuE,QAAAA,aAAa,GAAG;AACrB,iBAAO,KAAKxE,UAAZ;AACD;;AAEMyE,QAAAA,SAAS,GAAG;AACjB,iBAAO,KAAKxE,MAAZ;AACD;;AAEMgC,QAAAA,OAAO,GAAG;AACf,eAAKzC,IAAL,CAAUgC,OAAV,IAAqB,KAAKhC,IAAL,CAAUkF,OAAV,EAArB;AACA,eAAKhF,iBAAL,CAAuBgF,OAAvB;AACA,eAAK3E,UAAL,CAAgB2E,OAAhB;AACA,eAAKlF,IAAL,GAAY,IAAZ;AACA,eAAKF,UAAL,GAAkB,IAAlB;AACA,eAAKK,QAAL,GAAgB,IAAhB;AACD;;AAtOsB,O","sourcesContent":["import { Node, UITransform, Vec3, instantiate, sp, Sprite, Label, Mask, Graphics } from \"cc\";\r\nimport { sourceManageSeletor } from \"../index\";\r\nimport { PrefabPathDefine } from \"../sourceDefine/prefabDefine\";\r\nimport { getNodeByNameDeep } from \"../../../utils/tool\";\r\nimport { IconId } from \"../type\";\r\nimport config from \"../config\";\r\n\r\nexport class EgyptV2Icon {\r\n  private node: Node;\r\n  private faceNode: Node;\r\n  private faceAnimationNode: Node;\r\n  private iconConfig;\r\n  private skeleton: sp.Skeleton;\r\n  private sprite: Sprite\r\n  private use = false;\r\n  private iconIndex = 0;\r\n\r\n  private borderNode: Node;\r\n  private amountNode: Node;\r\n\r\n  private amount: number = 0;\r\n\r\n  private isPoolObject = true;\r\n  private callback;\r\n\r\n  constructor(iconConfig, isPoolObject: boolean = true) {\r\n    this.iconConfig = iconConfig;\r\n    this.isPoolObject = isPoolObject;\r\n    this.node = instantiate(sourceManageSeletor().getFile(PrefabPathDefine.ICON).source);\r\n    this.node.getComponent(UITransform).width = config.normalRollOption.singleRollerWidth;\r\n    this.node.getComponent(UITransform).height = config.normalRollOption.singleRollerHeight;\r\n\r\n    this.faceNode = getNodeByNameDeep(\"face\", this.node);\r\n    this.faceAnimationNode = getNodeByNameDeep(\"face-animation\", this.node);\r\n\r\n    this.sprite = this.faceNode.getComponent(Sprite);\r\n    this.skeleton = this.faceAnimationNode.getComponent(sp.Skeleton);\r\n\r\n    this.borderNode = getNodeByNameDeep(\"focusBorder\", this.node);\r\n    this.borderNode.active = true;\r\n    this.borderNode.removeFromParent();\r\n\r\n    if (this.isBeetleIcon() || this.isSunGod()) {\r\n      this.amountNode = getNodeByNameDeep(\"amount\", this.node);\r\n      this.amountNode.active = true;\r\n      this.amountNode.getComponent(Label).string = this.isBeetleIcon() ? \"0\" : \"\";\r\n      this.listenerSkeletonEvent();\r\n      this.amount = 0;\r\n    }\r\n\r\n    this.buildIcon();\r\n  }\r\n\r\n  public isBeetleIcon() {\r\n    return this.iconConfig.id === IconId.BEETLE\r\n  }\r\n\r\n  public isSunGod() {\r\n    return this.iconConfig.id === IconId.SUN_GOD\r\n  }\r\n\r\n  private listenerSkeletonEvent() {\r\n    this.skeleton.setCompleteListener(() => {\r\n      if (this.node.isValid && this.callback) {\r\n        this.callback && this.callback();\r\n        this.callback = null;\r\n        this.hideWin();\r\n      }\r\n    })\r\n  }\r\n\r\n  /**获得图标 */\r\n  public resetIcon(iconConfig, parentNode?: Node, iconIndex?: number) {\r\n    this.use = true;\r\n    this.iconConfig = iconConfig;\r\n    this.iconIndex = iconIndex;\r\n    parentNode && parentNode.addChild(this.node);\r\n    this.node.setScale(iconConfig.scale[0], iconConfig.scale[1]);\r\n    this.faceAnimationNode.setScale(iconConfig.scale[0], iconConfig.scale[1]);\r\n  }\r\n\r\n  public getId() {\r\n    return this.iconConfig.id;\r\n  }\r\n\r\n  /**归还到缓存池 */\r\n  public restore() {\r\n    if (this.node && this.node.isValid) {\r\n      this.use = false;\r\n      this.iconIndex = -1;\r\n      this.node.active = true;\r\n      this.node.removeFromParent();\r\n      if (this.amountNode) {\r\n        this.amount = 0;\r\n        this.amountNode.getComponent(Label).string = this.isBeetleIcon() ? '0' : '';\r\n      }\r\n      !this.isPoolObject && this.destory();\r\n    }\r\n  }\r\n\r\n  public getNode() {\r\n    return this.node;\r\n  }\r\n\r\n  public getHeight() {\r\n    return this.node.getComponent(UITransform).height;\r\n  }\r\n\r\n  public getIconIndex() {\r\n    return this.iconIndex;\r\n  }\r\n\r\n  public setPosition(value: Vec3) {\r\n    if (this.node) {\r\n      this.node.setPosition(value);\r\n      const offset = new Vec3(this.iconConfig.distance[0], this.iconConfig.distance[1]);\r\n      this.faceAnimationNode.setWorldPosition(this.node.worldPosition.clone().add(offset));\r\n      this.borderNode.setWorldPosition(this.node.worldPosition);\r\n    }\r\n  }\r\n\r\n  public getPosition() {\r\n    return this.node.getPosition();\r\n  }\r\n\r\n  private buildIcon() {\r\n    this.faceAnimationNode.active = false;\r\n    this.faceAnimationNode.removeFromParent();\r\n\r\n    const skeletonData = sourceManageSeletor().getFile(this.iconConfig.skeletonName).source;\r\n    this.skeleton.skeletonData = skeletonData;\r\n    this.skeleton.setAnimation(0, this.iconConfig.animationArr[0], false);\r\n    this.sprite.spriteFrame = sourceManageSeletor().getFile(this.iconConfig.fileName).source;\r\n\r\n  }\r\n\r\n  /**播放普通中奖 */\r\n  public playWin(parentNode: Node, isBorder: boolean = true, loop: boolean = true) {\r\n    const offset = new Vec3(this.iconConfig.distance[0], this.iconConfig.distance[1]);\r\n    if (!this.faceAnimationNode.active) {\r\n      this.faceAnimationNode.active = true;\r\n      // console.log(\"playWin \", this.iconConfig.id, \" parent \" + this.faceAnimationNode.parent);\r\n      if (!this.faceAnimationNode.parent) {\r\n        parentNode.addChild(this.faceAnimationNode)\r\n        this.faceAnimationNode.setWorldPosition(this.node.worldPosition.clone().add(offset));\r\n      }\r\n    }\r\n\r\n    if (isBorder && !this.borderNode.active) {\r\n      this.borderNode.active = true;\r\n      if (!this.borderNode.parent) {\r\n        parentNode.addChild(this.borderNode)\r\n        this.borderNode.setWorldPosition(this.node.worldPosition);\r\n      }\r\n    }\r\n\r\n    this.faceNode.active = false;\r\n    this.skeleton.setAnimation(0, this.iconConfig.animationArr[1], loop);\r\n  }\r\n\r\n  /**播放甲壳虫动画 */\r\n  public playBeetleAnimation(done) {\r\n    // if (!this.isBeetleIcon()) {\r\n    //   done && done();\r\n    //   return;\r\n    // }\r\n    this.callback = done;\r\n    this.faceAnimationNode.active = true;\r\n    this.node.addChild(this.faceAnimationNode);\r\n    this.faceAnimationNode.setWorldPosition(this.node.worldPosition);\r\n    this.faceNode.active = false;\r\n\r\n    this.amountNode.setSiblingIndex(this.node.children.length);\r\n    this.skeleton.setAnimation(0, this.iconConfig.animationArr[1], true);\r\n  }\r\n\r\n  /**隐藏普通中奖 */\r\n  public hideWin() {\r\n    this.faceAnimationNode.active = false;\r\n    this.faceAnimationNode.removeFromParent();\r\n    this.borderNode.active = false;\r\n    this.borderNode.removeFromParent();\r\n\r\n    this.faceNode.active = true;\r\n    this.skeleton.setAnimation(0, this.iconConfig.animationArr[0], false);\r\n  }\r\n\r\n  public pauseWin() {\r\n    this.borderNode.active = false;\r\n    this.skeleton.setAnimation(0, this.iconConfig.animationArr[0], false);\r\n  }\r\n\r\n  /**是否使用 */\r\n  public isUse() {\r\n    return this.use;\r\n  }\r\n\r\n  public setAmount(amount) {\r\n    this.amount = amount;\r\n    if (amount > 0) {\r\n      this.amountNode.active = true;\r\n    }\r\n    const amountStr = amount >= 10000 ? amount.formatAmountWithLetter() : amount.formatAmountWithCommas()\r\n    this.amountNode.getComponent(Label).string = amountStr;\r\n  }\r\n\r\n  public showBg() {\r\n    this.node.getChildByName(\"bg\").active = true;\r\n  }\r\n\r\n  public hideBg() {\r\n    this.node.getChildByName(\"bg\").active = false;\r\n  }\r\n\r\n  public showAmount() {\r\n    this.isBeetleIcon() && (this.amountNode.active = false);\r\n  }\r\n  public hideAmount() {\r\n    this.amountNode.active = false;\r\n    this.amount = 0;\r\n  }\r\n\r\n  public getAmountNode() {\r\n    return this.amountNode;\r\n  }\r\n\r\n  public getAmount() {\r\n    return this.amount;\r\n  }\r\n\r\n  public destory() {\r\n    this.node.isValid && this.node.destroy();\r\n    this.faceAnimationNode.destroy();\r\n    this.borderNode.destroy();\r\n    this.node = null;\r\n    this.iconConfig = null;\r\n    this.skeleton = null;\r\n  }\r\n}"]}