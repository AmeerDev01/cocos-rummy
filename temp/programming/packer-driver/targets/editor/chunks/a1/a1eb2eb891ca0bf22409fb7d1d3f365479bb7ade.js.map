{"version":3,"sources":["file:///Users/geliang/web/dibai/hall/assets/script/subGame/dragonTiger/components/DragonTiger_lose.ts"],"names":["updateWinUsers","node","winChild","children","filter","v","name","startsWith","forEach","active","getChildByName","getComponent","Label","string","load","SpriteFrame","err","sp","Sprite","spriteFrame","winList","item","index","i","goldNum","gold","memberName","icon","_decorator","Node","BaseComponent","omitStr","bundleCommon","bundleDragonTiger","formatNumber","gameCacheData","ccclass","property","DragonTiger_lose","propertyNode","props_spr_win_bg","props_label_lose_num","props_spr_user_bg1","props_spr_user_bg2","props_spr_user_bg3","props_spr_user_bg4","props","winGold","roomWinInfo","events","onClosePanel","start","initState","bindEvent","useProps","key","value","cur","Math","abs","formatAmountWithCommas","toggleCallback","event","customEventData","bindUI","update","deltaTime"],"mappings":"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","sourcesContent":["import { _decorator,Label,Node, Sprite, SpriteFrame } from 'cc';\r\nimport { BaseComponent } from '../../../base/BaseComponent';\r\nimport { initToggle, omitStr } from '../../../utils/tool';\r\nimport { bundleCommon, bundleDragonTiger } from '../index';\r\nimport {formatNumber} from './DragonTiger_win';\r\nimport { WinInfo } from '../store/actions/history';\r\nimport { playBtnClick } from '../index';\r\nimport { gameCacheData } from '../type';\r\nconst { ccclass, property } = _decorator;\r\n\r\nexport function updateWinUsers(node){\r\n\tlet winChild=node.children.filter(v=>v.name.startsWith('props_spr_user_bg'))\r\n\twinChild.forEach(v=>{\r\n\t\t\tv.active=false;\r\n\t\t\tv.getChildByName(\"Label_user_name\").getComponent(Label).string=\"\";\r\n\t\t\tv.getChildByName(\"Label_user_gold\").getComponent(Label).string=\"\"\r\n\t\t\tbundleDragonTiger.load(`img/head1/spriteFrame`, SpriteFrame, (err, sp) => {\r\n\t\t\t\tif (!err) {\r\n\t\t\t\t\tv.getChildByName(`spr_user_head`).getComponent(Sprite).spriteFrame = sp\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t});\r\n   gameCacheData.winList.forEach((item,index)=>{\r\n\t winChild.forEach((v,i)=>{\r\n\t\tif(index===i){\r\n\t\t\tlet goldNum: string = formatNumber(item.gold);\r\n\t\t\tv.active=true;\r\n\t\t\tv.getChildByName(\"Label_user_name\").getComponent(Label).string=omitStr(item.memberName,12);\r\n\t\t\tv.getChildByName(\"Label_user_gold\").getComponent(Label).string=\"+\"+goldNum;\r\n\t\t\tbundleCommon.load(`resource/head/head_circle_${item.icon}/spriteFrame`, SpriteFrame, (err, sp) => {\r\n\t\t\t\tif (!err) {\r\n\t\t\t\t\tv.getChildByName(`spr_user_head`).getComponent(Sprite).spriteFrame = sp\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t}\r\n\t })\r\n   })\r\n}\r\n\r\nexport interface IState {\r\n  \r\n}\r\n\r\nexport interface IProps {\r\n\twinGold:number,\r\n\troomWinInfo:WinInfo[],\r\n\t\r\n}\r\nexport interface IEvent {\r\n\tonClosePanel:()=>void\r\n}\r\n\r\n\r\n@ccclass('DragonTiger_lose')\r\nexport class DragonTiger_lose extends BaseComponent<IState, IProps, IEvent> {\r\n\tstart() {\r\n\t   \r\n\t }\r\n\r\n\tprotected propertyNode = {\r\n      props_spr_win_bg:new Node(),\r\n      props_label_lose_num:new Node(),\r\n\t  props_spr_user_bg1:new Node(),\r\n\t  props_spr_user_bg2:new Node(),\r\n\t  props_spr_user_bg3:new Node(),\r\n\t  props_spr_user_bg4:new Node(),\r\n\t}\r\n\r\n\tpublic props: IProps = {\r\n\t\twinGold:0,\r\n\t\troomWinInfo:[],\r\n\t\t\r\n\t}\r\n\r\n\tpublic events: IEvent = {\r\n\t\tonClosePanel:()=>{}\r\n\t}\r\n\r\n\tprotected initState() {\r\n\t\treturn {\r\n\t\t\t\r\n\t\t}\r\n\t}\r\n\r\n\tprotected bindEvent(): void {\r\n\t//   this.propertyNode.props_spr_win_bg.on(Node.EventType.TOUCH_END,()=>{\r\n\t// \tplayBtnClick();\r\n\t// \tthis.events.onClosePanel()\r\n\t//   })\r\n\r\n\t}\r\n\r\n\tprotected useProps(key: keyof IProps, value: { pre: any, cur: any }) {\r\n\t\tif (key === \"winGold\") {\r\n\t\t\t// console.log(\"winGold\",value.cur);\r\n\t\t\t// console.log(Math.abs(value.cur));\r\n\t\t\t\r\n\t\t\tif(value.cur === 0){\r\n\t\t\t\tthis.propertyNode.props_label_lose_num.getComponent(Label).string = value.cur + \"\";\r\n\t\t\t}else{\r\n\t\t\t\tlet goldNum: string = Math.abs(value.cur).formatAmountWithCommas();\r\n\t\t\t\tthis.propertyNode.props_label_lose_num.getComponent(Label).string = \"-\" + goldNum;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t}\r\n\t\tif (key === \"roomWinInfo\") {\r\n\t\t\tupdateWinUsers(this.node)\r\n\t\t\t// let headNode:Node[]=[this.propertyNode.props_spr_user_bg1,this.propertyNode.props_spr_user_bg2,this.propertyNode.props_spr_user_bg3,this.propertyNode.props_spr_user_bg4]\t\r\n\t\t\t//     for(let i=0;i<headNode.length;i++){\r\n\t\t\t// \t\theadNode[i].active=false;\r\n\t\t\t// \t\theadNode[i].getChildByName(\"Label_user_name\").getComponent(Label).string=\"\";\r\n\t\t\t// \t\theadNode[i].getChildByName(\"Label_user_gold\").getComponent(Label).string=\"\"\r\n\t\t\t// \t\tbundleDragonTiger.load(`img/head1/spriteFrame`, SpriteFrame, (err, sp) => {\r\n\t\t\t// \t\t\tif (!err) {\r\n\t\t\t// \t\t\t\theadNode[i].getChildByName(`spr_user_head`).getComponent(Sprite).spriteFrame = sp\r\n\t\t\t// \t\t\t}\r\n\t\t\t// \t\t})\r\n\t\t\t\t\t\r\n\t\t\t// \t}\r\n\r\n\t\t\t// \tfor(let i=0;i<value.cur.length;i++){\r\n\t\t\t// \t\tfor(let j=0;j<headNode.length;j++){\r\n\t\t\t// \t\t\tif(i===j){\r\n\t\t\t// \t\t\t\tlet goldNum:string=formatNumber(value.cur[i].gold)\r\n\t\t\t// \t\t\t\theadNode[j].active=true;\r\n\t\t\t// \t\t\t\theadNode[j].getChildByName(\"Label_user_name\").getComponent(Label).string=omitStr(value.cur[i].memberName,20);\r\n\t\t\t// \t\t\t\theadNode[j].getChildByName(\"Label_user_gold\").getComponent(Label).string=\"+\"+goldNum;\r\n\t\t\t// \t\t\t\tbundleCommon.load(`resource/head/head_circle_${value.cur[i].icon}/spriteFrame`, SpriteFrame, (err, sp) => {\r\n\t\t\t// \t\t\t\t\tif (!err) {\r\n\t\t\t// \t\t\t\t\t\theadNode[j].getChildByName(`spr_user_head`).getComponent(Sprite).spriteFrame = sp\r\n\t\t\t// \t\t\t\t\t}\r\n\t\t\t// \t\t\t\t})\r\n\t\t\t// \t\t\t}\r\n\t\t\t// \t    }\r\n\t\t\t//     }\r\n\t\t\r\n\t\t}\t\r\n\r\n\r\n\t}\r\n\r\n\r\n\r\n\ttoggleCallback(event: Event, customEventData: string) {\r\n\r\n\t}\r\n\r\n\tprotected bindUI(): void {\r\n\r\n\t\t\t\t\r\n\t}\r\n\r\n\tupdate(deltaTime: number) {\r\n\r\n\t}\r\n}\r\n\r\n"]}