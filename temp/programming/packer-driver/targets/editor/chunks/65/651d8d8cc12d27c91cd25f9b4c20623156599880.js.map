{"version":3,"sources":["file:///Users/geliang/web/dibai/hall/assets/script/subGame/bandarQiuQiu/components/BandarQiuQiu_maxHistory.ts"],"names":["_decorator","Color","Graphics","instantiate","Label","Node","Sprite","Vec3","BaseComponent","getNodeByNameDeep","SpriteFramePathDefine","playBtnClick","sourceManageSelector","GameStatus","ccclass","property","BandarQiuQiu_maxHistory","line","propertyNode","props_layout_history_item","props_history_content","props_line_content","props_history_bg_off","props","maxHistory","gameStatus","events","onClosePanel","start","initState","bindEvent","on","EventType","TOUCH_END","clearTheCacheData","useProps","key","value","cur","length","createHistory","WAIT","startPosition","removeAllChildren","reverse","forEach","item","i","win","push","nextP","historyContent","blue","red","green","getComponent","spriteFrame","getSpriteFrame","string","blueNum","redNum","active","blueType","getSpecialCard","redType","addChild","nextPosition","compareCoordinates","window","setTimeout","drawLine","x","y","clear","lineWidth","strokeColor","YELLOW","moveTo","lineTo","stroke","result","fileName","S","T","Q","getFile","source","BANDARQIUQIU_HISTORY_BLUE_WIN","BANDARQIUQIU_HISTORY_RED_WIN","BANDARQIUQIU_HISTORY_LV_WIN","BANDARQIUQIU_HISTORY_LOSE","bindUI","update","deltaTime"],"mappings":"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","sourcesContent":["import { _decorator,Color,Graphics,instantiate,Label,Node, Sprite, SpriteFrame, Vec2, Vec3 } from 'cc';\r\nimport { BaseComponent } from '../../../base/BaseComponent';\r\nimport { getNodeByNameDeep, getNodePositionInCanvas, initToggle } from '../../../utils/tool';\r\nimport { SpriteFramePathDefine } from '../sourceDefine/spriteDefine';\r\nimport { playBtnClick, sourceManageSelector } from '../index';\r\nimport { GameStatus, History } from \"../type\"\r\nconst { ccclass, property } = _decorator;\r\n\r\n\r\n\r\nexport interface IState {\r\n\r\n}\r\n\r\nexport interface IProps {\r\n\tmaxHistory: History[],\r\n\tgameStatus: GameStatus,\r\n\t\r\n\t\r\n}\r\nexport interface IEvent {\r\n\tonClosePanel:()=>void\r\n}\r\n\r\n\r\n@ccclass('BandarQiuQiu_maxHistory')\r\nexport class BandarQiuQiu_maxHistory extends BaseComponent<IState, IProps, IEvent> {\r\n\tprivate line = [];\r\n\t\r\n\tstart() {\r\n    \r\n\t }\r\n\r\n    protected propertyNode = {\r\n        props_layout_history_item:new Node(),\r\n\t\tprops_history_content: new Node(),\r\n\t\tprops_line_content:new Graphics(),\r\n\t\tprops_history_bg_off:new Node(),\r\n\t}\r\n\r\n\tpublic props: IProps = {\r\n\t\tmaxHistory: null,\r\n\t\tgameStatus: null,\r\n\t}\r\n\r\n\tpublic events: IEvent = {\r\n\t\tonClosePanel:()=>{}\r\n\t}\r\n\r\n\tprotected initState() {\r\n\t\treturn {\r\n\t\t\t\r\n\t\t}\r\n\t}\r\n\r\n\tprotected bindEvent(): void {\r\n\r\n\t\tthis.propertyNode.props_history_bg_off.on(Node.EventType.TOUCH_END, () => {\r\n\t\t\tplayBtnClick()\r\n\t\t\tthis.clearTheCacheData()\r\n\t\t\tthis.events.onClosePanel();\r\n\t\t\t\r\n\t   })\r\n\t}\r\n\r\n\tprotected useProps(key: keyof IProps, value: { pre: any, cur: any }) {\r\n\t\tif (key === \"maxHistory\") {\r\n\t\t\tif (value.cur && value.cur.length > 0) {\r\n\t\t\t\tthis.createHistory(value.cur)\r\n\t\t\t}\r\n\t\t\t\r\n\t\t}\r\n\r\n\t\tif (key === \"gameStatus\") {\r\n\t\t\tif (value.cur === GameStatus.WAIT) {\r\n\t\t\t\t// this.line=[]\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\t/**创建历史记录 */\r\n\tprivate createHistory(maxHistory) {\r\n\t\tthis.line = [];\r\n\t\tlet startPosition=new Vec3(0,10)\r\n\t\tthis.propertyNode.props_layout_history_item.removeAllChildren();\r\n\t\tmaxHistory.reverse().forEach((item, i) => {\r\n\t\t\tif (i === 0) {\r\n\t\t\t\tif (item.win === 1) {\r\n\t\t\t\t\tstartPosition=new Vec3(-64,10)\r\n\t\t\t\t} else if (item.win === 2) {\r\n\t\t\t\t\tstartPosition=new Vec3(64,10)\r\n\t\t\t\t}else if (item.win === 3) {\r\n\t\t\t\t\tstartPosition=new Vec3(0,10)\r\n\t\t\t\t}\r\n\t\t\t\tthis.line.push(startPosition)\r\n\t\t\t}\r\n\t\t\tlet nextP;\r\n\t\t\tif (i != maxHistory.length - 1) {\r\n\t\t\t\tnextP = maxHistory[i + 1].win;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tlet historyContent = instantiate(this.propertyNode.props_history_content);\r\n\t\t\tlet blue = 4; let red = 4; let green = 4;// 4代表输 1为蓝方赢  2为红方赢  3为绿方赢\r\n\t\t\tif (item.win === 1) {\r\n\t\t\t\tblue = 1;\r\n\t\t\t} else if (item.win === 2) {\r\n\t\t\t\tred = 2;\r\n\t\t\t}else if (item.win === 3) {\r\n\t\t\t\tgreen = 3;\r\n\t\t\t}\r\n\t\t\tgetNodeByNameDeep(\"props_spr_icon_blue\", historyContent).getComponent(Sprite).spriteFrame = this.getSpriteFrame(blue);\r\n\t\t\tgetNodeByNameDeep(\"label_blue_cardNum\", historyContent).getComponent(Label).string = item.blueNum + \"\";\r\n\t\t\tgetNodeByNameDeep(\"props_spr_icon_red\", historyContent).getComponent(Sprite).spriteFrame = this.getSpriteFrame(red);\r\n\t\t\tgetNodeByNameDeep(\"label_red_cardNum\", historyContent).getComponent(Label).string = item.redNum + \"\";\r\n\t\t\tgetNodeByNameDeep(\"props_spr_icon_green\", historyContent).active = green === 3;\r\n\t\t\tgetNodeByNameDeep(\"props_spr_blue_cardType\", historyContent).getComponent(Sprite).spriteFrame = item.blueType > 1 ? this.getSpecialCard(item.blueType) : this.getSpecialCard(2);\r\n\t\t\tgetNodeByNameDeep(\"props_spr_blue_cardType\", historyContent).active = item.blueType > 1;\r\n\t\t\tgetNodeByNameDeep(\"props_spr_red_cardType\", historyContent).getComponent(Sprite).spriteFrame = item.redType > 1 ? this.getSpecialCard(item.redType) : this.getSpecialCard(2);\r\n\t\t\tgetNodeByNameDeep(\"props_spr_red_cardType\", historyContent).active = item.redType > 1;\r\n\r\n\t\t\tthis.propertyNode.props_layout_history_item.addChild(historyContent);\r\n\t\t\tif (i != maxHistory.length - 1) {\r\n\t\t\t\tlet nextPosition=this.compareCoordinates(startPosition,nextP,i+1)\r\n\t\t\t\tthis.line.push(nextPosition)\r\n\t\t\t}\r\n            \r\n\t\t\t\r\n\t\t})\r\n       \r\n\t\tif (this.line && this.line.length > 0) {\r\n\t\t\t\r\n\t\t\twindow.setTimeout(() => {\t\r\n\t\t\t\tthis.drawLine(this.line);\r\n\t\t\t},200)\r\n\t\t}\r\n\t}\r\n\r\n\tprivate compareCoordinates(startPosition, nextP, i) {\r\n\t\t    let nextPosition;\r\n\t\t\tif (startPosition.x > 0) {\r\n\t\t\t\tif (nextP === 1) {\r\n\t\t\t\t\tnextPosition=new Vec3(startPosition.x-128,startPosition.y-(i*60)) \r\n\t\t\t\t} else if (nextP === 2) {\r\n\t\t\t\t\tnextPosition=new Vec3(startPosition.x,startPosition.y-(i*60)) \r\n\t\t\t\t}else if (nextP === 3) {\r\n\t\t\t\t\tnextPosition=new Vec3(startPosition.x-64,startPosition.y-(i*60))\r\n\t\t\t\t}\r\n\t\t\t} else if (startPosition.x < 0) {\r\n\t\t\t\tif (nextP === 1) {\r\n\t\t\t\t\tnextPosition=new Vec3(startPosition.x,startPosition.y-(i*60)) \r\n\t\t\t\t} else if (nextP === 2) {\r\n\t\t\t\t\tnextPosition=new Vec3(startPosition.x+128,startPosition.y-(i*60)) \r\n\t\t\t\t}else if (nextP === 3) {\r\n\t\t\t\t\tnextPosition=new Vec3(startPosition.x+64,startPosition.y-(i*60))\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tif (nextP === 1) {\r\n\t\t\t\t\tnextPosition=new Vec3(startPosition.x-64,startPosition.y-(i*60)) \r\n\t\t\t\t} else if (nextP === 2) {\r\n\t\t\t\t\tnextPosition=new Vec3(startPosition.x+64,startPosition.y-(i*60)) \r\n\t\t\t\t}else if (nextP === 3) {\r\n\t\t\t\t\tnextPosition=new Vec3(startPosition.x,startPosition.y-(i*60))\r\n\t\t\t\t}\r\n\t\t    }\r\n\r\n\t\treturn nextPosition\r\n\t}\r\n\r\n\t/**画线 */\r\n\tprivate drawLine(line) {\r\n\t\tthis.propertyNode.props_line_content.clear();\r\n\t\t// 设置线条宽度和颜色\r\n\t\tthis.propertyNode.props_line_content.lineWidth = 5;\r\n\t\tthis.propertyNode.props_line_content.strokeColor = Color.YELLOW;\r\n\t\tfor (let i = 0; i < line.length; i++){\r\n\t\t\tthis.propertyNode.props_line_content.moveTo(line[i].x, line[i].y)\r\n\t\t\tif (i != line.length - 1) {\r\n\t\t\t\tthis.propertyNode.props_line_content.lineTo(line[i+1].x, line[i+1].y);\r\n\t\t\t}\r\n\t\t\t\r\n\t\t}\r\n\t\tthis.propertyNode.props_line_content.stroke()\r\n\t}\r\n\r\n\t/**清除缓存数据 */\r\n\tprivate clearTheCacheData() {\r\n\t\tthis.line=[]\r\n\t}\r\n\r\n\t/**获取特殊牌资源 */\r\n\tprivate getSpecialCard(result) {\r\n\t\tlet fileName = '';\r\n\t\tif (result === 4) {\r\n\t\t\tfileName = SpriteFramePathDefine.S;\r\n\t\t}else if (result === 3) {\r\n\t\t\tfileName = SpriteFramePathDefine.T;\r\n\t\t} else if (result === 2) {\r\n\t\t\tfileName = SpriteFramePathDefine.Q;\r\n\t\t} \r\n\t\treturn sourceManageSelector().getFile(fileName).source;\r\n\t}\r\n\r\n    private getSpriteFrame(result:number): SpriteFrame {\r\n        let fileName = '';\r\n        if (result === 1) {\r\n            fileName = SpriteFramePathDefine.BANDARQIUQIU_HISTORY_BLUE_WIN;\r\n        } else if (result === 2) {\r\n            fileName = SpriteFramePathDefine.BANDARQIUQIU_HISTORY_RED_WIN;\r\n        }  else if (result === 3) {\r\n            fileName = SpriteFramePathDefine.BANDARQIUQIU_HISTORY_LV_WIN;\r\n        } else if (result === 4) {\r\n            fileName = SpriteFramePathDefine.BANDARQIUQIU_HISTORY_LOSE;\r\n        } \r\n        return sourceManageSelector().getFile(fileName).source;\r\n    }\r\n\r\n\tprotected bindUI(): void {\r\n\r\n\t}\r\n\r\n\tupdate(deltaTime: number) {\r\n\r\n\t}\r\n}\r\n\r\n"]}