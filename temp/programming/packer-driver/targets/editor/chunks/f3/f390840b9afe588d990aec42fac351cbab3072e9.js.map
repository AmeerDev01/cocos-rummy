{"version":3,"sources":["file:///Users/geliang/web/dibai/hall/assets/script/hall/components/Hall_BindPhonePanel.ts"],"names":["_decorator","EditBox","Node","BaseComponent","InputValidator","ccclass","property","Hall_BindPhonePanel","propertyNode","props_btn_tips_close","props_intput_phone_phoneNum","props_intput_phone_captcha","props_btn_send","props_btn_sure","props","phone","events","onClosePanel","sendSmsCode","phoneNumber","Promise","reslove","modifyPhoneDone","verificationCode","start","initState","bindEvent","on","EventType","TOUCH_END","getComponent","string","begin","isPhoneNumber","done","then","code","isSmsCode","useProps","key","value","cur","bindUI","update","deltaTime"],"mappings":"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","sourcesContent":["import { _decorator, Component, EditBox, Label, Node } from 'cc';\r\nimport { BaseComponent } from '../../base/BaseComponent';\r\nimport InputValidator from '../../utils/InputValidator';\r\nimport { addToastAction } from '../store/actions/baseBoard';\r\nconst { ccclass, property } = _decorator;\r\n\r\nexport interface IState {\r\n\r\n}\r\n\r\nexport interface IProps {\r\n\tphone: string\r\n}\r\nexport interface IEvent {\r\n\tonClosePanel?: () => void\r\n\tsendSmsCode?: (phoneNumber: string) => Promise<string>\r\n\tmodifyPhoneDone: (phoneNumber: string, verificationCode: string) => void\r\n}\r\n\r\n@ccclass('Hall_BindPhonePanel')\r\nexport class Hall_BindPhonePanel extends BaseComponent<IState, IProps, IEvent> {\r\n\tstart() {\r\n\r\n\t}\r\n\r\n\tprotected propertyNode = {\r\n\t\t/**关闭 */\r\n\t\tprops_btn_tips_close: new Node(),\r\n\t\t/**手机号码 */\r\n\t\tprops_intput_phone_phoneNum: new Node(),\r\n\t\t/**验证码框 */\r\n\t\tprops_intput_phone_captcha: new Node(),\r\n\t\t/**发送验证码 */\r\n\t\tprops_btn_send: new Node(),\r\n\t\t/**确认 */\r\n\t\tprops_btn_sure: new Node()\r\n\t}\r\n\r\n\tpublic props: IProps = {\r\n\t\tphone: \"\"\r\n\t}\r\n\r\n\tpublic events: IEvent = {\r\n\t\tonClosePanel: () => { },\r\n\t\tsendSmsCode: (phoneNumber: string) => new Promise((reslove) => reslove(\"\")),\r\n\t\tmodifyPhoneDone: (phoneNumber: string, verificationCode: string) => { }\r\n\t}\r\n\r\n\tprotected initState() {\r\n\t\treturn {\r\n\r\n\t\t}\r\n\t}\r\n\r\n\tprotected bindEvent(): void {\r\n\t\t/**发送验证码 */\r\n\t\tthis.propertyNode.props_btn_send.on(Node.EventType.TOUCH_END, () => {\r\n\t\t\tconst phoneNumber = this.propertyNode.props_intput_phone_phoneNum.getComponent(EditBox).string\r\n\t\t\tnew InputValidator().begin().isPhoneNumber(phoneNumber).done(() => {\r\n\t\t\t\tthis.events.sendSmsCode(phoneNumber).then(code => {\r\n\t\t\t\t\tthis.propertyNode.props_intput_phone_captcha.getComponent(EditBox).string = code\r\n\t\t\t\t})\r\n\t\t\t})\r\n\t\t})\r\n\t\t/**确认修改 */\r\n\t\tthis.propertyNode.props_btn_sure.on(Node.EventType.TOUCH_END, () => {\r\n\t\t\tconst phoneNumber = this.propertyNode.props_intput_phone_phoneNum.getComponent(EditBox).string\r\n\t\t\tconst verificationCode = this.propertyNode.props_intput_phone_captcha.getComponent(EditBox).string\r\n\t\t\tnew InputValidator().begin().isPhoneNumber(phoneNumber).isSmsCode(verificationCode).done(() => {\r\n\t\t\t\tthis.events.modifyPhoneDone(phoneNumber, verificationCode)\r\n\t\t\t})\r\n\t\t})\r\n\t\tthis.propertyNode.props_btn_tips_close.on(Node.EventType.TOUCH_END, () => {\r\n\t\t\tthis.events.onClosePanel()\r\n\t\t})\r\n\t}\r\n\r\n\tprotected useProps(key: keyof IProps, value: { pre: any, cur: any }) {\r\n\t\tif (key === \"phone\") {\r\n\t\t\tthis.propertyNode.props_intput_phone_phoneNum.getComponent(EditBox).string = value.cur || \"\"\r\n\t\t}\r\n\t}\r\n\r\n\tprotected bindUI(): void {\r\n\r\n\t}\r\n\r\n\tupdate(deltaTime: number) {\r\n\r\n\t}\r\n}\r\n\r\n"]}