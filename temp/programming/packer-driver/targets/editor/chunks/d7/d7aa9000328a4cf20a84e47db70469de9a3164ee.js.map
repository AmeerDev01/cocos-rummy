{"version":3,"sources":["file:///Users/geliang/web/dibai/hall/assets/script/subGame/dragonTiger/components/DragonTiger_users.ts"],"names":["divideNumber","num","result","push","_decorator","Label","Node","Sprite","SpriteFrame","tween","Vec3","Animation","bezier","game","Game","BaseComponent","omitStr","bundleDragonTiger","getNodeByNameDeep","mainGameViewModel","gameCacheData","global","config","GameType","ccclass","property","DragonTiger_users","leftHeadNode","rightHeadNode","isIcon1","isIcon2","isIcon3","isShowGame","propertyNode","props_spr_icon","props","roomLeftInfoVos","roomRightInfoVos","memberId","memberData","gold","type","memberName","usersInfo","newBetData","events","giveGift","value","start","initState","goldData","bindEvent","on","EVENT_HIDE","EVENT_SHOW","useProps","key","cur","playFlyChipWinAnimation","isUnMount","initUsers","forEach","item","index","initBSUsers","number","node","usersNode","children","find","name","startsWith","userHead","active","loadHeadSprite","icon","getComponent","string","formatAmountWithLetter","betInfo","u","users","play","playAddGold","winGold","startPosition","position","x","y","by","call","scheduleOnce","setPosition","getStar","parentNode","betType","playWinRateTween","tweenNode","endPos","playTime","callBack","startPos","startAngle","eulerAngles","fruitTween","mixY","maxY","mixX","maxX","progressX","end","current","t","progressY","parallel","to","progress","onUpdate","isValid","z","i","load","err","sp","spriteFrame","splitChip","totalBetAmount","chips","chipTypes","length","element","bindUI","initHeadClick","filter","v","userIndex","getHeadNodeIndex","EventType","TOUCH_END","userInfo","showGiftWindow","DRAGON_TIGER","head","userNode","parseInt","replace","update","deltaTime"],"mappings":"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","sourcesContent":["import { _decorator,instantiate,Label,Node, Sprite, SpriteFrame, tween, Vec3, Animation, UIOpacity,bezier, Skeleton, sp, game, Game} from 'cc';\r\nimport { BaseComponent } from '../../../base/BaseComponent';\r\nimport { initToggle, omitStr } from '../../../utils/tool';\r\nimport { SKT_MAG_TYPE, sktMsgListener } from '../socketConnect';\r\nimport { sourceManageSeletor,bundleDragonTiger ,bundleCommon} from \"../index\";\r\nimport {getNodePositionInCanvas,getNodeByNameDeep} from '../../../utils/tool';\r\nimport {mainGameViewModel} from '../index';\r\nimport { PrefabPathDefine } from '../sourceDefine/prefabDefine';\r\nimport {MyInfo} from '../store/actions/userInfo';\r\nimport {formatNumber} from './DragonTiger_win';\r\nimport { MemberData, setRoomLeftInfosAction, setRoomRightInfosAction } from '../store/actions/history';\r\nimport { bundlePkgName } from '../sourceDefine';\r\nimport { playChip, playGetCoin } from '../index';\r\nimport { BetData, BetType, MemberInfoVo, gameCacheData } from '../type';\r\nimport { global } from '../../../hall';\r\nimport config from '../config';\r\nimport { GameType } from '../../../common/viewModel/GiftUserViewModel';\r\nconst { ccclass, property } = _decorator;\r\n\r\nexport interface SettlementGold{\r\n\t():MyInfo[]\r\n}\r\n\r\nexport interface IState {\r\n\tgoldData:object\r\n}\r\n\r\nexport interface IProps {\r\n\troomLeftInfoVos:MyInfo[],\r\n    roomRightInfoVos:MyInfo[],\r\n\tmemberId:string,\r\n\tmemberData:MemberData,\r\n\tmemberName: string,\r\n\tusersInfo: MemberInfoVo[];\r\n\tnewBetData:BetData\r\n\t\r\n}\r\nexport interface IEvent {\r\n\tgiveGift: (value: number, memberId: string, num: number) => void\r\n}\r\nexport function divideNumber(num: number): number[] {\r\n\tlet result: number[] = [];\r\n\tif (num < 1000) {\r\n\t  return result;\r\n\t}\r\n  \r\n\twhile (num >= 1000) {\r\n\t  if (num >= 1000000) {\r\n\t\tresult.push(1000000);\r\n\t\tnum -= 1000000;\r\n\t  }else if (num >= 500000) {\r\n\t\tresult.push(500000);\r\n\t\tnum -= 500000;\r\n\t  }else if (num >= 100000) {\r\n\t\tresult.push(100000);\r\n\t\tnum -= 100000;\r\n\t  } else if (num >= 10000) {\r\n\t\tresult.push(10000);\r\n\t\tnum -= 10000;\r\n\t  } else if (num >= 5000) {\r\n\t\tresult.push(5000);\r\n\t\tnum -= 5000;\r\n\t  } else if (num >= 1000) {\r\n\t\tresult.push(1000);\r\n\t\tnum -= 1000;\r\n\t  }\r\n\t}\r\n  \r\n\treturn result;\r\n}\r\n\r\n\r\n\r\n\r\n@ccclass('DragonTiger_users')\r\nexport class DragonTiger_users extends BaseComponent<IState, IProps, IEvent> {\r\n\tprivate leftHeadNode:Node[]=[]\r\n\tprivate rightHeadNode:Node[]=[]\r\n\tprivate isIcon1:boolean=false;\r\n\tprivate isIcon2:boolean=false;\r\n\tprivate isIcon3:boolean=false;\r\n\tprivate isShowGame:boolean=true;\r\n\tstart() {\r\n\r\n\t}\r\n\r\n\tprotected propertyNode = {\r\n\r\n\t\tprops_spr_icon:new Node(),\r\n\t}\r\n\r\n\tpublic props: IProps = {\r\n\t\troomLeftInfoVos:[],\r\n        roomRightInfoVos:[],\r\n\t\tmemberId:\"\",\r\n\t\tmemberData:{\r\n\t\t\tgold: 0,\r\n\t\t\tmemberId: \"\",\r\n\t\t\ttype:0,\r\n\t\t\tmemberName:'',\r\n\t\t},\r\n\t\tmemberName: \"\",\r\n\t\tusersInfo: null,\r\n\t\tnewBetData:null,\r\n\t\t\r\n\t}\r\n\r\n\tpublic events: IEvent = {\r\n\t\tgiveGift: (value: number, memberId: string, num: number) => {}\r\n\t}\r\n\r\n\tprotected initState() {\r\n\t\treturn {\r\n\t\t  goldData:{}\r\n\t\t}\r\n\t}\r\n\r\n\tprotected bindEvent(): void {\r\n\t\tgame.on(Game.EVENT_HIDE, () => {//用户切入后台\r\n\t\t\tthis.isShowGame=false;\r\n\t\t });\r\n\t\tgame.on(Game.EVENT_SHOW, () => {\r\n\t\t   this.isShowGame=true\r\n\t\t})\r\n\t\t\r\n\r\n\t}\r\n\r\n\tprotected useProps(key: keyof IProps, value: { pre: any, cur: any }) {\r\n\t\tif (key === \"newBetData\") {\r\n\t\t\t// console.log(\"newBetData\",value.cur);\r\n\t\t\t\r\n\t\t\tif(!value.cur){ return }\r\n\t\t\tthis.playFlyChipWinAnimation(value.cur);\r\n \r\n\t\t}\r\n\t\tif (key === \"usersInfo\") {\r\n\t\t\t// console.log(\"usersInfo\",value.cur);\r\n\t\t\t\r\n\t\t\t// window.setTimeout(() => {\r\n\t\t\t\tif(mainGameViewModel.isUnMount || !value.cur){ return }\r\n\t\t\t\tthis.initUsers();\r\n\t\t\t\t\r\n\t\t\t   value.cur.forEach((item,index)=>{\r\n\t\t\t\t   this.initBSUsers(item,item.index)\r\n\t\t\t   })\r\n\t\t  //  },5000)\r\n\t\t   \r\n\t\t}\r\n        if (key===\"roomLeftInfoVos\") {\r\n\r\n\t\t\t \r\n\t\t}\r\n\t\t\r\n\t\tif(key===\"roomRightInfoVos\"){\r\n\r\n\t\t\t\r\n\t\t}\r\n\t\r\n}\r\n\r\n\r\n\r\n\t/** 初始化榜上用户信息 */\r\n\tpublic initBSUsers(usersInfo:MemberInfoVo,number){\r\n\t\tif (!this.node) { return };\r\n\t\tlet num = number + 1;\r\n\t\tconst usersNode = this.node.children.find(item => item.name.startsWith(\"props_btn_users\" + num));\r\n\t\tconst userHead = this.node.children.find(item => item.name.startsWith(\"spr_user\" + num));\r\n\t\tif (!usersNode || !userHead) { return }\r\n\t\tuserHead.active = true;\r\n\t\tglobal.loadHeadSprite(usersInfo.icon,userHead.getComponent(Sprite));//加载头像\r\n\t\tgetNodeByNameDeep(\"Label_gold\",usersNode).getComponent(Label).string=usersInfo.gold.formatAmountWithLetter();\r\n\t\tgetNodeByNameDeep(\"Label_name\",usersNode).getComponent(Label).string=omitStr(usersInfo.memberName,12);\r\n\t}\r\n\r\n\r\n\r\n\t/**飞金币的动画 */\r\n\tprivate playFlyChipWinAnimation(betInfo){\r\n\r\n\t\tif(betInfo.index > 6 || betInfo.memberId === gameCacheData.memberId){\r\n\t\t\treturn\r\n\t\t}\r\n\t\tlet num = betInfo.index+1;\r\n\t\tconst usersNode = this.node.children.find( u => u.name.startsWith(\"props_btn_users\"+num) );\r\n\t\tconst users = this.node.children.find( u => u.name.startsWith(\"spr_user\"+num) );\r\n\t\tusersNode.getComponent(Animation).play();\r\n\t\tusers.getComponent(Animation).play();\r\n\t}\r\n\t\r\n\r\n\t/** 赢钱的动画 +1K */\r\n\tpublic playAddGold(betInfo, winGold:number){\r\n\r\n\t\tlet num = betInfo.index + 1;\r\n\t\tconst usersNode = this.node.children.find( u => u.name.startsWith(\"props_btn_users\"+num) )\r\n\t\tconst node = getNodeByNameDeep(\"Label_gold_up\", usersNode);\r\n\t\tnode.getComponent(Label).string=\"+\" + betInfo.gold.formatAmountWithLetter()\r\n\t\tif(winGold <= 0) return;\r\n\t\tconst startPosition = new Vec3(node.position.x, node.position.y);\r\n\t\tnode.active = true;\r\n\r\n\t\ttween(node).by(1, { position: new Vec3(0, 30) }).call(() => {\r\n\t\t\tthis.scheduleOnce(() => {\r\n\t\t\t\tnode.active = false;\r\n\t\t\t\tnode.setPosition(startPosition);\r\n\t\t\t}, 0.5);\r\n\t\t}).start();\r\n\t}\r\n\r\n\r\n\t/**获得星星 */\r\n\tprivate getStar(parentNode:Node, betType: BetType) {\r\n\t\treturn this.propertyNode.props_spr_icon\r\n\t}\r\n\r\n\r\n\r\n\r\n\r\n\t/**飞星星抛物线动画 */\r\n\tpublic playWinRateTween(tweenNode: Node, endPos: Vec3, playTime: number, callBack: Function) {\r\n\t\tconst startPos = tweenNode.position;\r\n\t\tconst startAngle = tweenNode.eulerAngles;\r\n\t\tconst fruitTween = tween(startPos);\r\n\r\n\t\tconst x = (startPos.x + endPos.x) / 2;\r\n\t\tconst y = (startPos.y + endPos.y) / 2;\r\n\r\n\t\tconst mixY = y + y * 0.6;\r\n\t\tconst maxY = y + y * 0.6;\r\n\t\tconst mixX = x;\r\n\t\tconst maxX = x;\r\n\t\tvar progressX = function (start, end, current, t) {\r\n\t\t\t//@ts-ignore\r\n\t\t\tcurrent = bezier(start, mixX, maxX, end, t);\r\n\t\t\treturn current;\r\n\t\t}\r\n\t\tvar progressY = function (start, end, current, t) {\r\n\t\t\t//@ts-ignore\r\n\t\t\tcurrent = bezier(start, mixY, maxY, end, t);\r\n\t\t\treturn current;\r\n\t\t}\r\n\r\n\t\tfruitTween.parallel(\r\n\t\t\ttween().to(playTime, { x: endPos.x }, {\r\n\t\t\t\tprogress: progressX, onUpdate: () => {\r\n\t\t\t\t\ttweenNode.isValid && tweenNode.setPosition(startPos);\r\n\t\t\t\t}\r\n\t\t\t}),\r\n\t\t\ttween().to(playTime, { y: endPos.y }, {\r\n\t\t\t\tprogress: progressY, onUpdate: () => {\r\n\t\t\t\t\ttweenNode.isValid && tweenNode.setPosition(startPos);\r\n\t\t\t\t}\r\n\t\t\t}),\r\n\t\t).start();\r\n\t\ttween(startAngle).to(playTime, { z: 360 }, {\r\n\t\t\tonUpdate: () => {\r\n\t\t\t\tif (tweenNode.isValid) {\r\n\t\t\t\t\ttweenNode.eulerAngles = startAngle;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}).call(() => callBack()).start();\r\n\t}\r\n\tprivate initUsers() {\r\n\t\tfor (let i = 0; i < 6; i++){\r\n\t\t\tif (this.node) {\r\n\t\t\t   let num=i+1\r\n\t\t\t   const usersNode=this.node.children.find( item => item.name.startsWith(\"props_btn_users\"+num));\r\n\t\t\t\tconst userHead = this.node.children.find(item => item.name.startsWith(\"spr_user\" + num));\r\n\t\t\t\tuserHead.active = false;\r\n\t\t\t   // global.loadHeadSprite(usersInfo.icon,userHead.getComponent(Sprite));//加载头像\r\n\t\t\t   getNodeByNameDeep(\"Label_gold\",usersNode).getComponent(Label).string=\"\";\r\n\t\t\t   getNodeByNameDeep(\"Label_name\",usersNode).getComponent(Label).string=\"\";\r\n\t\t\t   bundleDragonTiger.load(`img/head1/spriteFrame`, SpriteFrame, (err, sp) => {\r\n\t\t\t\t   if (!err) {\r\n\t\t\t\t\t   userHead.getComponent(Sprite).spriteFrame = sp;\r\n\t\t\t\t   }\r\n\t\t\t   })\r\n\t\t   }\r\n\t\t   \r\n\t   }\r\n\t}\r\n\r\n\t\t/**\r\n   * 根据下注拆分筹码\r\n   * @param totalBetAmount \r\n   */\r\n\tpublic splitChip(totalBetAmount: number, chips: number[]) {\r\n\t\tif (totalBetAmount < config.chipTypes[0].value) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tfor (let i = config.chipTypes.length - 2; i >= 0; i--) {\r\n\t\t\tconst element = config.chipTypes[i];\r\n\r\n\t\t\tif (totalBetAmount >= element.value) {\r\n\r\n\t\t\tchips.push(element.value);\r\n\t\t\ttotalBetAmount -= element.value;\r\n\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\t\tthis.splitChip(totalBetAmount, chips);\r\n\t}\r\n\r\n\tprotected bindUI(): void {\r\n\t\tthis.initUsers();\r\n\r\n\t\tthis.initHeadClick();\r\n\t}\r\n\r\n\tprivate initHeadClick(){\r\n\t\tthis.node.children.filter(v=>v.name.startsWith(\"props_btn_users\")).forEach(v=>{\r\n\t\t\tconst userIndex = this.getHeadNodeIndex(v);\r\n\t\t\tv.on(Node.EventType.TOUCH_END, ()=>{\r\n\t\t\t\tconst userInfo = this.props.usersInfo.find(v=>v.index === userIndex - 1);\r\n\t\t\t\tuserInfo && userInfo.memberId !== gameCacheData.memberId && global.showGiftWindow(GameType.DRAGON_TIGER, {\r\n\t\t\t\t\tmemberId: userInfo.memberId,\r\n\t\t\t\t\thead: userInfo.icon,\r\n\t\t\t\t\tgold: userInfo.gold,\r\n\t\t\t\t\tname: userInfo.memberName,\r\n\t\t\t\t}, (value: number, memberId: string) => {\r\n\t\t\t\t\tthis.events.giveGift(value, memberId, 0);\r\n\t\t\t\t})\r\n\t\t\t});\r\n\t\t})\r\n\t}\r\n\r\n\tprivate getHeadNodeIndex(userNode:Node){\r\n\t\treturn parseInt(userNode.name.replace(\"props_btn_users\", \"\"));\r\n\t}\r\n\r\n\tupdate(deltaTime: number) {\r\n\r\n\t}\r\n}\r\n\r\n"]}