{"version":3,"sources":["file:///Users/geliang/web/dibai/hall/assets/script/subGame/gxfc/Slot/Command/LoaderCommand.ts"],"names":["LoaderCommand","global","lang","CommandDefine","MediatorDefine","ProxyDefine","BgMediatorConst","LoaderViewType","SocketProxy","BaseCommand","BgCommandConst","listExecute","type","INIT_LOADER_PANEL","handler","notification","sourceList","facade","retrieveMediator","BG","sourceMap","ROLLER_PANEL","data","done","retrieveProxy","WEBSOCKET","initSocket","sendNotification","INIT_MAIN_PANEL","AUTH","closeSubGame","confirmContent","write","k","WebSocketModule","ConfigGameFaild","console","error","execute","registerProxy"],"mappings":";;;mKAeaA,a;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAfJC,MAAAA,M,iBAAAA,M;AAAQC,MAAAA,I,iBAAAA,I;;AAIRC,MAAAA,a,iBAAAA,a;;AACAC,MAAAA,c,iBAAAA,c;;AACAC,MAAAA,W,iBAAAA,W;;AAEYC,MAAAA,e,iBAAAA,e;;AACZC,MAAAA,c,iBAAAA,c;;AAEaC,MAAAA,W,iBAAAA,W;;AACbC,MAAAA,W,iBAAAA,W;;AACWC,MAAAA,c,kBAAAA,c;;;;;;;+BAEPV,a,GAAN,MAAMA,aAAN;AAAA;AAAA,sCAAwC;AAAA;AAAA;AAAA,eACpCW,WADoC,GACc,CAC3D;AACCC,YAAAA,IAAI,EAAE;AAAA;AAAA,kDAAeC,iBADtB;;AAECC,YAAAA,OAAO,CAACC,YAAD,EAA8B;AACpC;AACA,oBAAMC,UAAU,GAAG,CAClB,GAAkB,KAAKC,MAAL,CAAYC,gBAAZ,CAA6B;AAAA;AAAA,oDAAeC,EAA5C,CAAf,CAAgEC,SADjD,EAElB,GAAkB,KAAKH,MAAL,CAAYC,gBAAZ,CAA6B;AAAA;AAAA,oDAAeG,YAA5C,CAAf,CAA0ED,SAF3D,CAAnB;AAIA,qBAAO;AACNE,gBAAAA,IAAI,EAAEN,UADA;AAENO,gBAAAA,IAAI,EAAE,MAAM;AACG,uBAAKN,MAAL,CAAYO,aAAZ,CAA0B;AAAA;AAAA,kDAAYC,SAAtC,CAAd,CAAgEC,UAAhE,CAA2E,MAAM;AAChF,yBAAKC,gBAAL,CAAsB;AAAA;AAAA,wDAAcR,EAApC,EAAwC,EAAxC,EAA4C;AAAA;AAAA,4DAAgBS,eAA5D;AACA,yBAAKD,gBAAL,CAAsB;AAAA;AAAA,wDAAcR,EAApC,EAAwC,EAAxC,EAA4C;AAAA;AAAA,0DAAeU,IAA3D,EAFgF,CAGhF;AACA;AACA,mBALD,EAKG,MAAM;AACR;AAAA;AAAA,0CAAOC,YAAP,CAAoB;AAACC,sBAAAA,cAAc,EAAE;AAAA;AAAA,wCAAKC,KAAL,CAAWC,CAAC,IAAKA,CAAC,CAACC,eAAF,CAAkBC,eAAnC;AAAjB,qBAApB;AACAC,oBAAAA,OAAO,CAACC,KAAR,CAAc,YAAd;AACA,mBARD;AASA;AAZK,eAAP;AAcA;;AAtBF,WAD2D,CADd;AAAA;;AA2BvCC,QAAAA,OAAO,CAACvB,YAAD,EAAoC;AACjD,eAAKE,MAAL,CAAYsB,aAAZ,CAA0B;AAAA;AAAA,0CAAgB;AAAA;AAAA,0CAAYd,SAA5B,CAA1B;AACA,gBAAMa,OAAN,CAAcvB,YAAd;AACA;;AA9B6C,O","sourcesContent":["import { global, lang } from \"../../../../hall\";\r\nimport Facade from \"../../Framework/care/Facade\"\r\nimport { INotification } from \"../../Framework/interfaces/INotification\"\r\nimport Mediator from \"../../Framework/patterns/mediator/Mediator\";\r\nimport { CommandDefine } from \"../Const/CommandDefine\";\r\nimport { MediatorDefine } from \"../Const/MediatorDefine\";\r\nimport { ProxyDefine } from \"../Const/ProxyDefine\";\r\nimport BaseMediator from \"../Mediator/BaseMediator\";\r\nimport BgMediator, { BgMediatorConst } from \"../Mediator/BgMediator\";\r\nimport { LoaderViewType } from \"../Mediator/LoaderMediator\";\r\nimport { RollerMediatorConst } from \"../Mediator/RollerMediator\";\r\nimport { SubGameType, SocketProxy } from \"../Proxy/SocketProxy\";\r\nimport { BaseCommand, IListExecute } from './BaseCommand'\r\nimport { BgCommand, BgCommandConst } from \"./BgCommand\";\r\n\r\nexport class LoaderCommand extends BaseCommand {\r\n\tprotected listExecute: Array<IListExecute<LoaderCommand>> = [\r\n\t\t{\r\n\t\t\ttype: LoaderViewType.INIT_LOADER_PANEL,\r\n\t\t\thandler(notification: INotification) {\r\n\t\t\t\t//获取所有的mediator的资源传过去\r\n\t\t\t\tconst sourceList = [\r\n\t\t\t\t\t...(<BaseMediator>this.facade.retrieveMediator(MediatorDefine.BG)).sourceMap,\r\n\t\t\t\t\t...(<BaseMediator>this.facade.retrieveMediator(MediatorDefine.ROLLER_PANEL)).sourceMap,\r\n\t\t\t\t]\r\n\t\t\t\treturn {\r\n\t\t\t\t\tdata: sourceList,\r\n\t\t\t\t\tdone: () => {\r\n\t\t\t\t\t\t(<SocketProxy>this.facade.retrieveProxy(ProxyDefine.WEBSOCKET)).initSocket(() => {\r\n\t\t\t\t\t\t\tthis.sendNotification(CommandDefine.BG, {}, BgMediatorConst.INIT_MAIN_PANEL)\r\n\t\t\t\t\t\t\tthis.sendNotification(CommandDefine.BG, {}, BgCommandConst.AUTH)\r\n\t\t\t\t\t\t\t// this.sendNotification(CommandDefine.ROLLER, { gameType: SubGameType.MAIN }, RollerMediatorConst.INIT_ROLLER_PANEL)\r\n\t\t\t\t\t\t\t// this.sendNotification(CommandDefine.SUB_GAME, {}, SubGameMediatorConst.INIT_SUB_GAME_PANEL)\r\n\t\t\t\t\t\t}, () => {\r\n\t\t\t\t\t\t\tglobal.closeSubGame({confirmContent: lang.write(k =>  k.WebSocketModule.ConfigGameFaild)})\r\n\t\t\t\t\t\t\tconsole.error(\"socket连接错误\")\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t]\r\n\tpublic execute(notification: INotification): void {\r\n\t\tthis.facade.registerProxy(new SocketProxy(ProxyDefine.WEBSOCKET))\r\n\t\tsuper.execute(notification)\r\n\t}\r\n}"]}