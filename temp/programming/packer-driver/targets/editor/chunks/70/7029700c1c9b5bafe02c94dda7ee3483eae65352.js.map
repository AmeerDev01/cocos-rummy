{"version":3,"sources":["file:///Users/geliang/web/dibai/hall/assets/script/subGame/fruit777/viewModel/AutoLauncherViewModel.ts"],"names":["ViewModel","StoreInject","getStore","AutoLauncherType","GameType","changeAutoLauncherType","setAutoLaunchedTimes","setShowAuthLaunch","dataTransfer","DataKeyType","setRollSpeed","autoLauncherTypeWithTimes","NONE","TIME_10","TIME_20","TIME_50","TIME_100","TIME_500","LAMIT_FAST","LIMIT","AutoLauncherViewModel","constructor","isWaiting","isRollEnd","autoLaunchedTimes","autoLauncherType","lanuchEvent","begin","window","clearInterval","setInterval","GAME_TYPE","MAIN","dispatch","undefined","setLaunchEvent","connect","inject","state","game","isShowAutoLaunch"],"mappings":"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","sourcesContent":["import { Node } from \"cc\"\r\nimport ViewModel, { StoreInject } from \"../../../base/ViewModel\"\r\nimport { Fruit777_AuthLauncher, IProps, IEvent } from \"../components/Fruit777_AuthLauncher\"\r\nimport { StateType } from \"../store/reducer\"\r\nimport { getStore } from \"../store\"\r\nimport { AutoLauncherType, GameType } from \"../type\"\r\nimport { footerViewModel } from \"../index\"\r\nimport { changeAutoLauncherType, setAutoLaunchedTimes, setShowAuthLaunch } from \"../store/actions/game\"\r\nimport dataTransfer, { DataKeyType } from \"../dataTransfer\"\r\nimport { setRollSpeed } from \"../store/actions/roller\"\r\n\r\nexport const autoLauncherTypeWithTimes = {\r\n  [AutoLauncherType.NONE]: 0,\r\n  [AutoLauncherType.TIME_10]: 10,\r\n  [AutoLauncherType.TIME_20]: 20,\r\n  [AutoLauncherType.TIME_50]: 50,\r\n  [AutoLauncherType.TIME_100]: 100,\r\n  [AutoLauncherType.TIME_500]: 500,\r\n  [AutoLauncherType.LAMIT_FAST]: 10000,\r\n  [AutoLauncherType.LIMIT]: 20000,\r\n}\r\n@StoreInject(getStore())\r\nclass AutoLauncherViewModel extends ViewModel<Fruit777_AuthLauncher, IProps, IEvent> {\r\n  constructor() {\r\n    super('Fruit777_AuthLauncher')\r\n  }\r\n  private isWaiting: boolean = true\r\n  private isRollEnd: boolean = true\r\n  private autoLaunchedTimes: number = 0\r\n  private autoLauncherType: AutoLauncherType = AutoLauncherType.NONE\r\n\r\n  private lanuchEvent: () => void\r\n  protected begin() {\r\n    window['fruit777_authLauncher_timer'] && window.clearInterval(window['fruit777_authLauncher_timer'])\r\n    window['fruit777_authLauncher_timer'] = window.setInterval(() => {\r\n      if (this.isWaiting && this.autoLauncherType !== AutoLauncherType.NONE) {\r\n        if (this.autoLaunchedTimes < autoLauncherTypeWithTimes[this.autoLauncherType]) {\r\n          // console.log('自动启动', this.autoLaunchedTimes, autoLauncherTypeWithTimes[this.autoLauncherType])\r\n          this.lanuchEvent && this.lanuchEvent()\r\n          if (dataTransfer(DataKeyType.GAME_TYPE) === GameType.MAIN) {\r\n            this.dispatch(setAutoLaunchedTimes(undefined))\r\n          }\r\n        } else {\r\n          this.dispatch(setShowAuthLaunch(false))\r\n          this.dispatch(changeAutoLauncherType(AutoLauncherType.NONE))\r\n          this.dispatch(setAutoLaunchedTimes(0))\r\n          this.dispatch(setRollSpeed(1))\r\n        }\r\n      }\r\n    }, 300)\r\n  }\r\n\r\n  /**设置自动运行器要自动运行的函数 */\r\n  public setLaunchEvent(lanuchEvent: () => void) {\r\n    this.lanuchEvent = lanuchEvent\r\n  }\r\n  public connect() {\r\n    this.inject({}, (state: StateType) => {\r\n      this.isWaiting = state.game.isWaiting\r\n      this.autoLauncherType = state.game.autoLauncherType\r\n      this.autoLaunchedTimes = state.game.autoLaunchedTimes\r\n      return {\r\n        isShowAutoLaunch: state.game.isShowAutoLaunch,\r\n        isWaiting: state.game.isWaiting,\r\n        autoLauncherType: state.game.autoLauncherType\r\n      }\r\n    })\r\n    return this\r\n  }\r\n\r\n\r\n}\r\n\r\nexport default AutoLauncherViewModel"]}