{"version":3,"sources":["file:///Users/geliang/web/dibai/hall/assets/script/subGame/thorV2/components/ThorV2_Icon.ts"],"names":["ThorV2Icon","UITransform","Vec3","instantiate","sp","Sprite","Label","Animation","sourceManageSeletor","thorv2_Audio","PrefabPathDefine","getNodeByNameDeep","IconId","config","SoundPathDefine","constructor","iconConfig","isPoolObject","node","faceNode","faceAnimationNode","skeleton","sprite","use","iconIndex","props_skeleton_bomb","props_win_number","props_iconWrap","props_iconId","props_label_rate_num","props_label_rate_num_origin_pos","faceAnimationNodeOriginPos","borderNode","callback","roundIndex","playLightning","getFile","ICON","source","getComponent","width","normalRollOption","singleRollerWidth","height","singleRollerHeight","position","clone","Skeleton","getChildByName","isScatterIcon","setPosition","distance","active","listenerSkeletonEvent","listenerBombSkeletonEvent","listenerAmountEvent","buildIcon","setCompleteListener","isValid","isOddsIcon","resetFaceAnimationNodeOrOdds","hideWin","playBomb","restore","on","EventType","FINISHED","resetIcon","parentNode","addChild","setScale","scale","insertChild","offset","getId","id","removeFromParent","clearTracks","destory","getNode","getHeight","getIconIndex","setIconIndex","value","setWorldPosition","worldPosition","add","getPosition","skeletonData","skeletonName","setAnimation","animationArr","spriteFrame","fileName","playWin","timeScale","isBorder","loop","undefined","showFaceAnimationNode","playWinSound","soundStr","WIN1","WIN2","WIN3","WIN4","WIN5","WIN6","WIN7","WIN8","WIN9","WIN10","playOneShot","pauseWin","isUse","showBg","hideBg","playAmount","amount","str","formatAmountWithCommas","setSiblingIndex","children","length","string","play","setOddsIcon","getOddsLabelNode","playOddsIcon","done","playLabelRate","isLightningIcon","setPlayLightning","ODDS_ICON_GREEN","ODDS_ICON_RED","SCATTER","setWidth","destroy"],"mappings":"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","sourcesContent":["import { Node, UITransform, Vec3, instantiate, sp, Sprite, Label, Mask, Graphics, Animation } from \"cc\";\r\nimport { sourceManageSeletor, thorv2_Audio } from \"../index\";\r\nimport { PrefabPathDefine } from \"../sourceDefine/prefabDefine\";\r\nimport { getNodeByNameDeep } from \"../../../utils/tool\";\r\nimport { IconId } from \"../type\";\r\nimport config from \"../config\";\r\nimport { SoundPathDefine } from \"../sourceDefine/soundDefine\";\r\n\r\nexport class ThorV2Icon {\r\n  private node: Node;\r\n  private faceNode: Node;\r\n  private faceAnimationNode: Node;\r\n  private iconConfig;\r\n  private skeleton: sp.Skeleton;\r\n  private sprite: Sprite\r\n  private use = false;\r\n  private iconIndex = 0;\r\n\r\n  private props_skeleton_bomb: sp.Skeleton\r\n  private props_win_number: Node;\r\n  private props_iconWrap: Node;\r\n  private props_iconId: Node;\r\n  private props_label_rate_num: Node;\r\n  private props_label_rate_num_origin_pos: Vec3;\r\n  private faceAnimationNodeOriginPos: Vec3;\r\n\r\n  private borderNode: Node;\r\n\r\n  private isPoolObject = true;\r\n  private callback;\r\n  private roundIndex: number = 0;\r\n\r\n  /**是否播放闪电 */\r\n  private playLightning = false;\r\n\r\n  constructor(iconConfig, isPoolObject: boolean = true) {\r\n    this.iconConfig = iconConfig;\r\n    this.isPoolObject = isPoolObject;\r\n    this.node = instantiate(sourceManageSeletor().getFile(PrefabPathDefine.ICON).source);\r\n    this.node.getComponent(UITransform).width = config.normalRollOption.singleRollerWidth;\r\n    this.node.getComponent(UITransform).height = config.normalRollOption.singleRollerHeight;\r\n\r\n    this.props_iconWrap = getNodeByNameDeep(\"props_iconWrap\", this.node);\r\n    this.faceNode = getNodeByNameDeep(\"iconNode_sprite\", this.node);\r\n    this.faceAnimationNode = getNodeByNameDeep(\"iconNode_skeleton\", this.node);\r\n    this.faceAnimationNodeOriginPos = this.faceAnimationNode.position.clone();\r\n\r\n    this.props_skeleton_bomb = getNodeByNameDeep(\"props_skeleton_bomb\", this.node).getComponent(sp.Skeleton);\r\n    this.props_win_number = getNodeByNameDeep(\"props_win_number\", this.node);\r\n    this.props_iconId = this.props_win_number.getChildByName(\"props_iconId\");\r\n    this.props_label_rate_num = getNodeByNameDeep(\"props_label_rate_num\", this.node);\r\n    this.props_label_rate_num_origin_pos = this.props_label_rate_num.position.clone();\r\n\r\n    if (this.isScatterIcon()) {\r\n      this.faceNode.setPosition(new Vec3(this.iconConfig.distance[0], this.iconConfig.distance[1]));\r\n    }\r\n\r\n    this.sprite = this.faceNode.getComponent(Sprite);\r\n    this.skeleton = this.faceAnimationNode.getComponent(sp.Skeleton);\r\n    // this.skeleton.timeScale = 3;\r\n\r\n    this.borderNode = getNodeByNameDeep(\"props_focusBorder\", this.node);\r\n    this.borderNode.active = false;\r\n\r\n    this.props_label_rate_num.active = false;\r\n\r\n    this.listenerSkeletonEvent();\r\n    this.listenerBombSkeletonEvent();\r\n    this.listenerAmountEvent();\r\n    this.buildIcon();\r\n  }\r\n\r\n  private listenerSkeletonEvent() {\r\n    this.skeleton.setCompleteListener(() => {\r\n      if (this.node.isValid) {\r\n        if (this.isOddsIcon() || this.isScatterIcon()) {\r\n          this.resetFaceAnimationNodeOrOdds();\r\n          this.callback && this.callback();\r\n          this.callback = null;\r\n        } else {\r\n          this.hideWin();\r\n          this.playBomb();\r\n        }\r\n      }\r\n    })\r\n  }\r\n\r\n  private listenerBombSkeletonEvent() {\r\n    this.props_skeleton_bomb.setCompleteListener(() => {\r\n      if (this.node.isValid) {\r\n        this.restore();\r\n        this.callback && this.callback();\r\n        this.callback = null;\r\n      }\r\n    })\r\n  }\r\n\r\n  private listenerAmountEvent() {\r\n    this.props_iconId.getComponent(Animation).on(Animation.EventType.FINISHED, () => {\r\n      this.props_win_number.active = false;\r\n    })\r\n  }\r\n\r\n  /**获得图标 */\r\n  public resetIcon(iconConfig, parentNode?: Node, iconIndex?: number) {\r\n    this.use = true;\r\n    this.iconConfig = iconConfig;\r\n    this.iconIndex = iconIndex;\r\n    parentNode && parentNode.addChild(this.node);\r\n    this.faceAnimationNode.setScale(iconConfig.scale[0], iconConfig.scale[1]);\r\n    this.faceNode.setScale(iconConfig.scale[0], iconConfig.scale[1]);\r\n  }\r\n\r\n  public resetFaceAnimationNodeOrOdds() {\r\n    if (this.isOddsIcon() || this.isScatterIcon()) {\r\n      this.props_iconWrap.insertChild(this.faceAnimationNode, 0);\r\n      const offset = new Vec3(this.iconConfig.distance[0], this.iconConfig.distance[1]);\r\n      this.faceAnimationNode.setPosition(offset);\r\n\r\n      this.props_iconWrap.addChild(this.props_label_rate_num);\r\n      this.props_label_rate_num.setPosition(this.props_label_rate_num_origin_pos)\r\n    }\r\n  }\r\n\r\n  public getId() {\r\n    return this.iconConfig.id;\r\n  }\r\n\r\n  /**归还到缓存池 */\r\n  public restore() {\r\n    if (this.node && this.node.isValid) {\r\n      this.playLightning = false;\r\n      this.use = false;\r\n      this.iconIndex = -1;\r\n      this.node.active = true;\r\n      this.node.removeFromParent();\r\n      this.faceNode.active = true;\r\n      this.skeleton.clearTracks()\r\n      this.props_skeleton_bomb.node.active = false;\r\n      this.props_skeleton_bomb.clearTracks();\r\n      this.hideWin();\r\n\r\n      !this.isPoolObject && this.destory();\r\n    }\r\n  }\r\n\r\n  public getNode() {\r\n    return this.node;\r\n  }\r\n\r\n  public getHeight() {\r\n    return this.node.getComponent(UITransform).height;\r\n  }\r\n\r\n  public getIconIndex() {\r\n    return this.iconIndex;\r\n  }\r\n\r\n  public setIconIndex(iconIndex: number) {\r\n    this.iconIndex = iconIndex;\r\n  }\r\n\r\n  public setPosition(value: Vec3) {\r\n    if (this.node) {\r\n      this.node.setPosition(value);\r\n      const offset = new Vec3(this.iconConfig.distance[0], this.iconConfig.distance[1]);\r\n      this.faceAnimationNode.setWorldPosition(this.node.worldPosition.clone().add(offset));\r\n      this.borderNode.setWorldPosition(this.node.worldPosition);\r\n    }\r\n  }\r\n\r\n  public getPosition() {\r\n    return this.node.getPosition();\r\n  }\r\n\r\n  private buildIcon() {\r\n    this.faceAnimationNode.active = false;\r\n    // this.faceAnimationNode.removeFromParent();\r\n\r\n    const skeletonData = sourceManageSeletor().getFile(this.iconConfig.skeletonName).source;\r\n    this.skeleton.skeletonData = skeletonData;\r\n    this.skeleton.setAnimation(0, this.iconConfig.animationArr[0], false);\r\n    this.sprite.spriteFrame = sourceManageSeletor().getFile(this.iconConfig.fileName).source;\r\n\r\n  }\r\n\r\n  /**播放普通中奖 */\r\n  public playWin(parentNode: Node, roundIndex: number = 0, timeScale: number = 1, isBorder: boolean = true, loop: boolean = false, callback = undefined) {\r\n    this.callback = callback;\r\n    this.roundIndex = roundIndex;\r\n    this.showFaceAnimationNode(parentNode);\r\n\r\n    if (isBorder && !this.borderNode.active) {\r\n      this.borderNode.active = true;\r\n      parentNode.addChild(this.borderNode)\r\n      this.borderNode.setWorldPosition(this.node.worldPosition);\r\n    }\r\n\r\n    this.faceNode.active = false;\r\n    // this.skeleton.paused = false;\r\n    this.skeleton.timeScale = timeScale;\r\n    this.skeleton.setAnimation(0, this.iconConfig.animationArr[0], loop);\r\n  }\r\n\r\n  public playBomb() {\r\n    this.faceNode.active = false;\r\n    this.props_skeleton_bomb.node.active = true;\r\n    this.props_skeleton_bomb.setAnimation(0, 'animation', false);\r\n\r\n    this.playWinSound();\r\n  }\r\n\r\n  private playWinSound() {\r\n    let soundStr = SoundPathDefine.WIN1;\r\n    if (this.roundIndex === 0) {\r\n      soundStr = SoundPathDefine.WIN1;\r\n    } else if (this.roundIndex === 1) {\r\n      soundStr = SoundPathDefine.WIN2;\r\n    } else if (this.roundIndex === 2) {\r\n      soundStr = SoundPathDefine.WIN3;\r\n    } else if (this.roundIndex === 3) {\r\n      soundStr = SoundPathDefine.WIN4;\r\n    } else if (this.roundIndex === 4) {\r\n      soundStr = SoundPathDefine.WIN5;\r\n    } else if (this.roundIndex === 5) {\r\n      soundStr = SoundPathDefine.WIN6;\r\n    } else if (this.roundIndex === 6) {\r\n      soundStr = SoundPathDefine.WIN7;\r\n    } else if (this.roundIndex === 7) {\r\n      soundStr = SoundPathDefine.WIN8;\r\n    } else if (this.roundIndex === 8) {\r\n      soundStr = SoundPathDefine.WIN9;\r\n    } else if (this.roundIndex === 9) {\r\n      soundStr = SoundPathDefine.WIN10;\r\n    }\r\n    thorv2_Audio.playOneShot(soundStr)\r\n  }\r\n\r\n  /**隐藏普通中奖 */\r\n  public hideWin() {\r\n    this.faceAnimationNode.active = false;\r\n    this.borderNode.active = false;\r\n\r\n    this.faceNode.active = true;\r\n    this.skeleton.clearTracks();\r\n\r\n    this.props_label_rate_num.active = false;\r\n  }\r\n\r\n  public pauseWin() {\r\n    this.borderNode.active = false;\r\n  }\r\n\r\n  /**是否使用 */\r\n  public isUse() {\r\n    return this.use;\r\n  }\r\n\r\n  public showBg() {\r\n    this.node.getChildByName(\"bg\").active = true;\r\n  }\r\n\r\n  public hideBg() {\r\n    this.node.getChildByName(\"bg\").active = false;\r\n  }\r\n\r\n  /**播放数字 */\r\n  public playAmount(parentNode: Node, amount: number) {\r\n    // const str = amount > 10000 ? amount.formatAmountWithLetter() : amount + '';\r\n    const str = amount.formatAmountWithCommas();\r\n    // this.props_win_number.removeFromParent();\r\n    parentNode.addChild(this.props_win_number);\r\n    this.props_win_number.setWorldPosition(this.node.worldPosition)\r\n    this.props_win_number.active = true;\r\n    this.props_win_number.setSiblingIndex(parentNode.children.length);\r\n    this.props_iconId.getComponent(Label).string = str;\r\n    this.props_iconId.getComponent(Animation).play();\r\n\r\n    // console.log(`playAmount ${str}, id ${this.iconConfig.id}, props_win_number: ${this.props_win_number.worldPosition}`);\r\n  }\r\n\r\n  public setOddsIcon(value: string) {\r\n    if (!this.isOddsIcon()) {\r\n      return;\r\n    }\r\n    this.props_label_rate_num.active = true;\r\n    this.props_label_rate_num.getComponent(Label).string = value;\r\n  }\r\n\r\n  /**获得倍率的label节点 */\r\n  public getOddsLabelNode() {\r\n    return this.props_label_rate_num;\r\n  }\r\n\r\n  /**播放倍率的图标动画，准备进行飞倍率 */\r\n  public playOddsIcon(parentNode: Node, done) {\r\n    this.callback = done;\r\n\r\n    this.showFaceAnimationNode(parentNode);\r\n    this.skeleton.setAnimation(0, this.iconConfig.animationArr[1], false);\r\n\r\n    this.playLabelRate(parentNode);\r\n  }\r\n\r\n  /**播放倍率label数字，提升上层节点 */\r\n  public playLabelRate(parentNode: Node) {\r\n    if (!this.isOddsIcon()) {\r\n      return;\r\n    }\r\n    parentNode.addChild(this.props_label_rate_num);\r\n    this.props_label_rate_num.setWorldPosition(this.node.worldPosition.clone().add(this.props_label_rate_num_origin_pos))\r\n  }\r\n\r\n  private showFaceAnimationNode(parentNode: Node) {\r\n    const offset = new Vec3(this.iconConfig.distance[0], this.iconConfig.distance[1]);\r\n    this.faceAnimationNode.active = true;\r\n    parentNode.addChild(this.faceAnimationNode)\r\n    this.faceAnimationNode.setWorldPosition(this.node.worldPosition.clone().add(offset));\r\n  }\r\n\r\n  public isLightningIcon() {\r\n    return this.playLightning;\r\n  }\r\n\r\n  public setPlayLightning(playLightning) {\r\n    this.playLightning = playLightning;\r\n  }\r\n\r\n  public isOddsIcon() {\r\n    return this.iconConfig.id >= IconId.ODDS_ICON_GREEN && this.iconConfig.id <= IconId.ODDS_ICON_RED;\r\n  }\r\n\r\n  public isScatterIcon() {\r\n    return this.iconConfig.id === IconId.SCATTER;\r\n  }\r\n\r\n  public setWidth(width: number) {\r\n    this.node.getComponent(UITransform).width = width;\r\n  }\r\n\r\n  public destory() {\r\n    this.node.isValid && this.node.destroy();\r\n    this.faceAnimationNode.destroy();\r\n    this.borderNode.destroy();\r\n    this.node = null;\r\n    this.iconConfig = null;\r\n    this.skeleton = null;\r\n  }\r\n}"]}