{"version":3,"sources":["file:///Users/geliang/web/dibai/hall/assets/script/subGame/godWealth111/components/GodWealth_rollerPanel.ts"],"names":["_decorator","Label","Node","BaseComponent","GameType","IconEffectType","RollerViewModel","footerViewModel","godWealth_Audio","jackPotViewModel","sourceManageSeletor","PrefabPathDefine","dataTransfer","DataKeyType","SoundPathDefine","TaskScheduler","Task","StepNumber","rollerPanelViewModel","ccclass","property","GodWealth_rollerPanel","rollerViewModelMap","taskScheduler","stepNumber","propertyNode","props_spr_roller_list","props_spr_roller_list2","props_grand_number","props_major_number","props_mini_number","props_God_tk_center","props","rollerMap","iconEffectData","iconEffect","NONE","coord","iconBaoHeEffectData","iconFreeGameEffectData","jackpotAmount","isSortStop","stopMode","freeGameRate","viewGameType","currGameType","events","allRollStop","panelRollEnd","rollerIndex","start","initState","bindEvent","on","EventType","TOUCH_END","viewNode","active","useProps","key","value","console","log","cur","length","initRollerList","SUBGAME2","scheduleOnce","showBaoHeAmount","forEach","roller","index","iconEffectArr","filter","i","map","setProps","baseBetAmountTarget","comp","getPositionData","grandNode","getGrandNode","startNumberGrand","parseInt","string","replace","joinqQueue","done","stop","pre","num","getComponent","toFixed","formatAmountWithCommas","baoheIconNum","FIXED_CHESSBOARD_ICON","getMajorNode","getMiniNode","dataItem","rollerViewModel","mountView","getFile","ROLLER","source","appendTo","rollerType","setEvent","rollEnd","isAllStop","some","item","getRoundEnd","connect","push","gameType","GAME_TYPE","play","MAIN","MAIN_BG","SUBGAME1","GAME1_BG","GAME2_BG","destroyCallBack","destoryQueue","bindUI","update","deltaTime"],"mappings":"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","sourcesContent":["import { _decorator, Component, Label, Layout, Node } from 'cc';\r\nimport { BaseComponent } from '../../../base/BaseComponent';\r\nconst { ccclass, property } = _decorator;\r\nimport { DirectionType, GameType, IconEffectType, RollerType } from '../type';\r\nimport RollerViewModel from '../viewModel/RollerViewModel';\r\nimport { footerViewModel, godWealth_Audio,  jackPotViewModel,  sourceManageSeletor } from '../index';\r\nimport { PrefabPathDefine } from '../sourceDefine/prefabDefine';\r\nimport { setRollRoundEnd } from '../store/actions/roller';\r\nimport { sktInstance } from '../socketConnect';\r\nimport dataTransfer, { DataKeyType } from '../dataTransfer';\r\nimport { SoundPathDefine } from '../sourceDefine/soundDefine';\r\nimport TaskScheduler, { Task } from '../../../utils/TaskScheduler';\r\nimport StepNumber from '../../../utils/StepNumber';\r\nimport { rollerPanelViewModel } from '../viewModel/GameBoardViewModel';\r\nexport interface IState {\r\n\r\n}\r\n\r\nexport interface IProps {\r\n\trollerMap: RollerType[]\r\n\ticonEffectData?: {\r\n\t\ticonEffect: IconEffectType,\r\n\t\tcoord: number[][]\r\n\t},\r\n\ticonBaoHeEffectData?: {\r\n\t\ticonEffect: IconEffectType,\r\n\t\tcoord: number[][]\r\n\t},\r\n\ticonFreeGameEffectData: {\r\n\t\ticonEffect: IconEffectType,\r\n\t\tcoord: number[][]\r\n\t}\r\n\tjackpotAmount?: number,\r\n\tstopMode: 'index' | 'jump',\r\n\t/**是否步停（顺序停止） */\r\n\tisSortStop: boolean,\r\n\tfreeGameRate: number,\r\n\tviewGameType: GameType,\r\n\tcurrGameType:GameType,\r\n}\r\nexport interface IEvent {\r\n\t/**全部滚动已经停止 */\r\n\tallRollStop: () => void,\r\n\tpanelRollEnd: (rollerIndex: number) => void\r\n}\r\n\r\n@ccclass('GodWealth_rollerPanel')\r\nexport class GodWealth_rollerPanel extends BaseComponent<IState, IProps, IEvent> {\r\n\tstart() { }\r\n\r\n\tpublic rollerViewModelMap: RollerViewModel[] = []\r\n\tprivate taskScheduler: TaskScheduler = new TaskScheduler()\r\n\tprivate stepNumber: StepNumber\r\n\tprotected propertyNode = {\r\n\t\t/**滑槽主板 */\r\n\t\tprops_spr_roller_list: new Node(),\r\n\t\tprops_spr_roller_list2: new Node(),\r\n\t\tprops_grand_number:new Label(),\t\t\r\n\t\tprops_major_number:new Label(),\t\t\r\n\t\tprops_mini_number: new Label(),\t\t\r\n\t\tprops_God_tk_center: new Node(),\r\n\t\t\r\n\t}\r\n\r\n\tpublic props: IProps = {\r\n\t\trollerMap: [],\r\n\t\ticonEffectData: {\r\n\t\t\ticonEffect: IconEffectType.NONE,\r\n\t\t\tcoord: []\r\n\t\t},\r\n\t\ticonBaoHeEffectData: {\r\n\t\t\ticonEffect: IconEffectType.NONE,\r\n\t\t\tcoord: []\r\n\t\t},\r\n\t\ticonFreeGameEffectData: {\r\n\t\t\ticonEffect: IconEffectType.NONE,\r\n\t\t\tcoord: []\r\n\t\t},\r\n\t\tjackpotAmount: 0,\r\n\t\tisSortStop: false,\r\n\t\tstopMode: 'index',\r\n\t\tfreeGameRate: 0,\r\n\t\tviewGameType: GameType.NONE,\r\n\t\tcurrGameType: GameType.NONE\r\n\t}\r\n\r\n\tpublic events: IEvent = {\r\n\t\tallRollStop: () => { },\r\n\t\tpanelRollEnd: (rollerIndex: number) => { }\r\n\t}\r\n\r\n\tprotected initState() {\r\n\t\treturn {\r\n\r\n\t\t}\r\n\t}\r\n\r\n\tprotected bindEvent(): void {\r\n\t\tthis.propertyNode.props_God_tk_center.on(Node.EventType.TOUCH_END, () => {\r\n\t\t\tjackPotViewModel.viewNode.active = !jackPotViewModel.viewNode.active;\r\n\t\t})\r\n\t}\r\n\r\n\tprotected useProps(key: keyof IProps, value: { pre: any, cur: any }) {\r\n\t\tif (key === \"rollerMap\") {\r\n\t\t\tconsole.log(\"rollerMap\",value.cur);\r\n\t\t\t\r\n\t\t\tif (!this.rollerViewModelMap.length) {\r\n\t\t\t\tthis.initRollerList();\r\n\t\t\t\t//初始进入游戏时 为宝盒游戏\r\n\t\t\t\tif (this.props.viewGameType === GameType.SUBGAME2) {\r\n\t\t\t\t\t//渲染宝盒 异步\r\n\t\t\t\t\tthis.scheduleOnce(() => {\r\n\t\t\t\t\t\tthis.showBaoHeAmount()\r\n\t\t\t\t\t})\r\n\t\t\t\t\t// window.setTimeout(() => {\r\n\t\t\t\t\t// \tthis.showBaoHeAmount()\r\n\t\t\t\t\t// })\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\t// roller组件自己去订阅store的数据，就不从这里更新了\r\n\t\t\t\t// this.rollerViewModelMap.forEach((roller, index) => {\r\n\t\t\t\t// \troller.setProps({ rollerType: this.props.rollerMap[index] })\r\n\t\t\t\t// })\r\n\t\t\t}\r\n\r\n\t\t}\r\n\t\tif (key === \"iconEffectData\") {\r\n\t\t\tthis.rollerViewModelMap.forEach((roller, index) => {\r\n\t\t\t\t//index=0情况下=>[0,0][0,2],...=> 获取到一个这种数组:[0,2],描述第几条数组要闪动的图标序号\r\n\t\t\t\tconst iconEffectArr = this.props.iconEffectData.coord.filter(i => i[0] === index).map(i => i[1])\r\n\t\t\t\tif (iconEffectArr.length) {\r\n\t\t\t\t\t//分配到各个滑槽\r\n\t\t\t\t\troller.setProps({\r\n\t\t\t\t\t\ticonEffectData: {\r\n\t\t\t\t\t\t\ticonEffectArr,\r\n\t\t\t\t\t\t\ticonEffect: this.props.iconEffectData.iconEffect\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t})\r\n\t\t\t\t} else {\r\n\t\t\t\t\troller.setProps({\r\n\t\t\t\t\t\ticonEffectData: {\r\n\t\t\t\t\t\t\ticonEffectArr: [],\r\n\t\t\t\t\t\t\ticonEffect: IconEffectType.NONE\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t})\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t}\r\n\t\tif (key === \"iconBaoHeEffectData\") {\r\n\t\t\tthis.showBaoHeAmount()\r\n\r\n\t\t}\r\n\t\tif (key === \"iconFreeGameEffectData\") {\r\n\t\t\tthis.rollerViewModelMap.forEach((roller, index) => {\r\n\t\t\t\t//index=0情况下=>[0,0][0,2],...=> 获取到一个这种数组:[0,2],描述第几条数组要闪动的图标序号\r\n\t\t\t\tconst iconEffectArr = this.props.iconFreeGameEffectData.coord.filter(i => i[0] === index).map(i => i[1])\r\n\t\t\t\t\r\n\t\t\t\tif (iconEffectArr.length) {\r\n\t\t\t\t\t//分配到各个滑槽\r\n\t\t\t\t\troller.setProps({\r\n\t\t\t\t\t\ticonFreeGameEffectData: {\r\n\t\t\t\t\t\t\ticonEffectArr,\r\n\t\t\t\t\t\t\ticonEffect: this.props.iconFreeGameEffectData.iconEffect\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t})\r\n\t\t\t\t} else {\r\n\t\t\t\t\troller.setProps({\r\n\t\t\t\t\t\ticonFreeGameEffectData: {\r\n\t\t\t\t\t\t\ticonEffectArr: [],\r\n\t\t\t\t\t\t\ticonEffect: IconEffectType.NONE\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t})\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t}\r\n\t\tif (key === \"jackpotAmount\") {\r\n\t\t\tlet baseBetAmountTarget = footerViewModel.comp.getPositionData();\r\n\t\t\tif (baseBetAmountTarget.value >= 20) {\t\t\r\n\t\t\t\tlet grandNode = rollerPanelViewModel.comp.getGrandNode();\r\n\t\t\t\tlet startNumberGrand = parseInt(grandNode.string.replace(/,/g, \"\"));\r\n\t\t\t\tthis.taskScheduler.joinqQueue(new Task((done) => {\r\n\t\t\t\t\tthis.stepNumber && this.stepNumber.stop()\r\n\t\t\t\t\tthis.stepNumber = new StepNumber(value.pre, value.cur, (num) => {\r\n\t\t\t\t\t\t// this.propertyNode && this.propertyNode.props_Label_up_goldNum && (this.propertyNode.props_Label_up_goldNum.string = (+num.toFixed(0)).formatAmountWithCommas())\r\n\t\t\t\t\t\tgrandNode &&  (grandNode.getComponent(Label).string = (+num.toFixed(0)).formatAmountWithCommas())\r\n\t\t\t\t\t}, () => done())\r\n\t\t\t\t\tthis.stepNumber.start()\r\n\t\t\t\t}))\r\n\t\t\t}\r\n\r\n\t\t\r\n\t\t}\r\n\t\t// if (key === \"viewGameType\") {\r\n\t\t// \tthis.propertyNode.props_spr_roller_list2.active = value.cur === GameType.SUBGAME2;\r\n\t\t// }\r\n\t}\r\n\r\n\tprivate showBaoHeAmount() {\r\n\t\tthis.rollerViewModelMap.forEach((roller, index) => {\r\n\t\t\t//index=0情况下=>[0,0][0,2],...=> 获取到一个这种数组:[0,2],描述第几条数组要闪动的图标序号\r\n\t\t\tconst baoheIconNum = dataTransfer(DataKeyType.FIXED_CHESSBOARD_ICON).filter(i => i[0] === index).map(i => i[2]);//宝盒的金币值\r\n\t\t\tconst iconEffectArr = this.props.iconBaoHeEffectData.coord.filter(i => i[0] === index).map(i => i[1])\r\n\t\t\tif (iconEffectArr.length) {\r\n\t\t\t\t//分配到各个滑槽\r\n\t\t\t\troller.setProps({\r\n\t\t\t\t\ticonBaoHeEffectData: {\r\n\t\t\t\t\t\ticonEffectArr,\r\n\t\t\t\t\t\tbaoheIconNum,\r\n\t\t\t\t\t\ticonEffect: this.props.iconBaoHeEffectData.iconEffect\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t} else {\r\n\t\t\t\troller.setProps({\r\n\t\t\t\t\ticonBaoHeEffectData: {\r\n\t\t\t\t\t\ticonEffectArr: [],\r\n\t\t\t\t\t\tbaoheIconNum:[],\r\n\t\t\t\t\t\ticonEffect: IconEffectType.NONE\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t}\r\n\t\t})\r\n\t}\r\n\r\n\tpublic getGrandNode() {\r\n\t\treturn this.propertyNode.props_grand_number;\r\n\t}\r\n\tpublic getMajorNode() {\r\n\t\treturn this.propertyNode.props_major_number;\t\r\n\t}\r\n\tpublic getMiniNode() {\r\n\t\treturn this.propertyNode.props_mini_number;\t\t\r\n\t}\r\n\r\n\tprivate initRollerList() {\r\n\t\tthis.props.rollerMap.forEach((dataItem) => {\r\n\t\t\tconst rollerViewModel = new RollerViewModel().mountView(sourceManageSeletor().getFile(PrefabPathDefine.ROLLER).source).appendTo(this.propertyNode.props_spr_roller_list).setProps({\r\n\t\t\t\trollerType: dataItem\r\n\t\t\t}).setEvent({\r\n\t\t\t\trollEnd: (rollerIndex) => {\r\n\t\t\t\t\tthis.events.panelRollEnd(rollerIndex)\r\n\t\t\t\t\tlet isAllStop = !this.rollerViewModelMap.some(item => !item.comp.getRoundEnd())\r\n\t\t\t\t\tisAllStop && this.events.allRollStop()\r\n\t\t\t\t},\r\n\t\t\t}).connect()\r\n\t\t\tthis.rollerViewModelMap.push(rollerViewModel)\r\n\t\t})\r\n\t\tconst gameType = dataTransfer(DataKeyType.GAME_TYPE)\r\n\t\tgodWealth_Audio.stop()\r\n\t\tgodWealth_Audio.play(gameType === GameType.MAIN ? SoundPathDefine.MAIN_BG: gameType === GameType.SUBGAME1 ? SoundPathDefine.GAME1_BG : SoundPathDefine.GAME2_BG, true)\r\n\t}\r\n\r\n\tprotected destroyCallBack(): void {\r\n\t\tthis.taskScheduler.destoryQueue()\r\n\t}\r\n\r\n\tprotected bindUI(): void {\r\n\t\t\r\n\t}\r\n\r\n\tupdate(deltaTime: number) {\r\n\r\n\t}\r\n}\r\n"]}