{"version":3,"sources":["file:///Users/geliang/web/dibai/hall/assets/script/subGame/fruit777/store/reducer/roller.ts"],"names":["instantiate","ActionTypes","initState","reduxAct","default","config","copy","createReducer","FRUIT777_BEGIN_ROLL","state","payload","_state","rollerIndex","rollData","rollerMap","rolling","direction","LargeRoller","largeRollOption","normalRollOption","speed","stopIconIndex","forEach","item","roundAllEnd","FRUIT777_INIT_ROLL","FRUIT777_SET_STOP_ROLL","rollerMapItem","FRUIT777_END_ROLLING","FRUIT777_SET_FLICKER","iconEffectData","iconEffect","coord","flickerCoord","FRUIT777_SET_ROUNT_END","FRUIT777_SET_ROLL_SPEED","speedBackUp","speedMultiple","i"],"mappings":"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","sourcesContent":["import { instantiate } from \"cc\";\r\nimport { ActionTypes, ActionPayLoad, InitStateType, initState } from \"../actions/roller\";\r\nimport { default as reduxAct } from 'redux-act'\r\nimport config from \"../../config\";\r\nimport { copy } from \"../../../../utils/tool\";\r\n\r\nexport default reduxAct.createReducer<InitStateType>({\r\n  [ActionTypes.FRUIT777_BEGIN_ROLL]: (state, payload: ActionPayLoad<ActionTypes.FRUIT777_BEGIN_ROLL>): InitStateType => {\r\n    const _state = instantiate(state)\r\n    if (payload.rollerIndex !== -1) {\r\n      const rollData = _state.rollerMap[payload.rollerIndex]\r\n      _state.rollerMap[payload.rollerIndex].rolling = true\r\n      _state.rollerMap[payload.rollerIndex].direction = payload.direction || (rollData.LargeRoller ? config.largeRollOption.direction : config.normalRollOption.direction)\r\n      payload.speed && (_state.rollerMap[payload.rollerIndex].speed = payload.speed)\r\n      // _state.rollerMap[payload.rollerIndex].speed = payload.speed || (rollData.LargeRoller ? config.largeRollOption.rollerSpeed : config.normalRollOption.rollerSpeed)\r\n      // _state.rollerMap[payload.rollerIndex].speedBackUp = payload.speed || (rollData.LargeRoller ? config.largeRollOption.rollerSpeed : config.normalRollOption.rollerSpeed)\r\n      _state.rollerMap[payload.rollerIndex].stopIconIndex = -1\r\n    } else {\r\n      _state.rollerMap.forEach(item => {\r\n        item.rolling = true\r\n        item.direction = payload.direction || (item.LargeRoller ? config.largeRollOption.direction : config.normalRollOption.direction)\r\n        payload.speed && (item.speed = payload.speed)\r\n        // item.speed = payload.speed || (item.LargeRoller ? config.largeRollOption.rollerSpeed : config.normalRollOption.rollerSpeed)\r\n        // item.speedBackUp = payload.speed || (item.LargeRoller ? config.largeRollOption.rollerSpeed : config.normalRollOption.rollerSpeed)\r\n        item.stopIconIndex = -1\r\n      })\r\n    }\r\n    _state.roundAllEnd = false\r\n    return {\r\n      ..._state\r\n    }\r\n  },\r\n  [ActionTypes.FRUIT777_INIT_ROLL]: (state, payload: ActionPayLoad<ActionTypes.FRUIT777_INIT_ROLL>): InitStateType => {\r\n    // const _state = instantiate(state)\r\n    // _state.rollerMap = payload.rollerMap\r\n    // return {\r\n    //   ..._state\r\n    // }\r\n    return {\r\n      ...state,\r\n      rollerMap: copy(payload.rollerMap)\r\n    }\r\n  },\r\n  [ActionTypes.FRUIT777_SET_STOP_ROLL]: (state, payload: ActionPayLoad<ActionTypes.FRUIT777_SET_STOP_ROLL>): InitStateType => {\r\n    const rollerMapItem = instantiate(state.rollerMap[payload.rollerIndex])\r\n    rollerMapItem.stopIconIndex = payload.stopIconIndex\r\n    state.rollerMap[payload.rollerIndex] = rollerMapItem\r\n    // const _state = instantiate(state)\r\n    // _state.rollerMap[payload.rollerIndex].stopIconIndex = payload.stopIconIndex\r\n    return {\r\n      ...state,\r\n    }\r\n  },\r\n  [ActionTypes.FRUIT777_END_ROLLING]: (state, payload: ActionPayLoad<ActionTypes.FRUIT777_END_ROLLING>): InitStateType => {\r\n    // const _state = instantiate(state)\r\n    state.rollerMap[payload.rollerIndex].rolling = payload.rolling\r\n    return {\r\n      ...state\r\n    }\r\n  },\r\n  [ActionTypes.FRUIT777_SET_FLICKER]: (state, payload: ActionPayLoad<ActionTypes.FRUIT777_SET_FLICKER>): InitStateType => {\r\n    return {\r\n      ...state,\r\n      iconEffectData: {\r\n        iconEffect: payload.iconEffect,\r\n        coord: payload.flickerCoord\r\n      }\r\n    }\r\n  },\r\n  [ActionTypes.FRUIT777_SET_ROUNT_END]: (state, payload: ActionPayLoad<ActionTypes.FRUIT777_SET_ROUNT_END>): InitStateType => {\r\n    return {\r\n      ...state,\r\n      roundAllEnd: payload.roundAllEnd\r\n    }\r\n  },\r\n  [ActionTypes.FRUIT777_SET_ROLL_SPEED]: (state, payload: ActionPayLoad<ActionTypes.FRUIT777_SET_ROLL_SPEED>): InitStateType => {\r\n    const _state = instantiate(state)\r\n    if (payload.rollerIndex) {\r\n      _state.rollerMap[payload.rollerIndex].speed = _state.rollerMap[payload.rollerIndex].speedBackUp * payload.speedMultiple\r\n    } else {\r\n      _state.rollerMap.forEach(i => i.speed = i.speedBackUp * payload.speedMultiple)\r\n    }\r\n    return {\r\n      ..._state\r\n    }\r\n  }\r\n}, initState);\r\n"]}