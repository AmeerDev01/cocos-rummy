{"version":3,"sources":["file:///Users/geliang/web/dibai/hall/assets/script/subGame/egyptV2/components/EgyptV2_Header.ts"],"names":["_decorator","Animation","Label","Node","BaseComponent","global","BuyType","StepNumber","SoundPathDefine","egyptv2_Audio","mainViewModel","StepNumberV2","ccclass","property","EgyptV2_Header","init","stepNumberV2","isShowMenu","propertyNode","props_Back_Home","props_Moeny_Top","props_Left_Bg","props_Right_Bg","props_Up_Settings","props_Moeny_Label","props_number2","props_btn_vip","props_btn_up_menu","props_menu_panel","props_spr_menu_bg","props_btn_info","props","gold","events","quitGame","start","initState","bindEvent","on","EventType","TOUCH_END","playOneShot","btn_click","openPersonCenter","openShop","node","getChildByName","TAS","openRule","openVipMain","active","getComponent","stop","play","e","preventSwallow","scheduleOnce","TOUCH_START","TOUCH_MOVE","TOUCH_CANCEL","useProps","key","value","isValid","string","Number","cur","formatAmountWithCommas","formatAmountWithLetter","pre","num","toFixed","diff","bindUI","update","deltaTime"],"mappings":"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","sourcesContent":["import { _decorator, Animation, EventTouch, Label, Node } from 'cc';\r\nimport { BaseComponent } from '../../../base/BaseComponent';\r\nimport { global } from '../../../hall';\r\nimport { BuyType } from '../../../hall/components/Hall_ShopPanel';\r\nimport StepNumber from '../../../utils/StepNumber';\r\nimport { SoundPathDefine } from '../sourceDefine/soundDefine';\r\nimport { egyptv2_Audio, mainViewModel } from '../index';\r\nimport StepNumberV2 from '../../../utils/StepNumberV2';\r\nconst { ccclass, property } = _decorator;\r\n\r\nexport interface IState {\r\n\r\n}\r\n\r\nexport interface IProps {\r\n\tgold: number\r\n}\r\nexport interface IEvent {\r\n\tquitGame: () => void,\r\n}\r\n\r\n@ccclass('EgyptV2_Header')\r\nexport class EgyptV2_Header extends BaseComponent<IState, IProps, IEvent> {\r\n\tstart() {\r\n\r\n\t}\r\n\r\n\tprivate init = true;\r\n\tprivate stepNumberV2: StepNumberV2 = new StepNumberV2(this);\r\n\tprivate isShowMenu = false;\r\n\tprotected propertyNode = {\r\n\t\tprops_Back_Home: new Node(),\r\n\t\tprops_Moeny_Top: new Node(),\r\n\t\tprops_Left_Bg: new Node(),\r\n\t\tprops_Right_Bg: new Node(),\r\n\t\tprops_Up_Settings: new Node(),\r\n\t\tprops_Moeny_Label: new Label(),\r\n\t\tprops_number2: new Node(),\r\n\t\tprops_btn_vip: new Node(),\r\n\t\tprops_btn_up_menu: new Node(),\r\n\t\tprops_menu_panel: new Node(),\r\n\t\tprops_spr_menu_bg: new Node(),\r\n\t\tprops_btn_info: new Node(),\r\n\t}\r\n\r\n\tpublic props: IProps = {\r\n\t\tgold: 0\r\n\t}\r\n\r\n\tpublic events: IEvent = {\r\n\t\tquitGame: () => { }\r\n\t}\r\n\r\n\tprotected initState() {\r\n\t\treturn {}\r\n\t}\r\n\r\n\tprotected bindEvent(): void {\r\n\t\tthis.propertyNode.props_Back_Home.on(Node.EventType.TOUCH_END, () => {\r\n\t\t\tegyptv2_Audio.playOneShot(SoundPathDefine.btn_click)\r\n\t\t\tthis.events.quitGame();\r\n\t\t})\r\n\t\tthis.propertyNode.props_Up_Settings.on(Node.EventType.TOUCH_END, () => {\r\n\t\t\tegyptv2_Audio.playOneShot(SoundPathDefine.btn_click)\r\n\t\t\tglobal.openPersonCenter(2)\r\n\t\t})\r\n\t\tthis.propertyNode.props_Left_Bg.on(Node.EventType.TOUCH_END, () => {\r\n\t\t\tegyptv2_Audio.playOneShot(SoundPathDefine.btn_click)\r\n\t\t\tglobal.openShop()\r\n\t\t})\r\n\t\tthis.node.getChildByName('Up_Left').on(Node.EventType.TOUCH_END, () => {\r\n\t\t\tegyptv2_Audio.playOneShot(SoundPathDefine.btn_click)\r\n\t\t\tglobal.openShop()\r\n\t\t})\r\n\t\tthis.propertyNode.props_Right_Bg.on(Node.EventType.TOUCH_END, () => {\r\n\t\t\tegyptv2_Audio.playOneShot(SoundPathDefine.btn_click)\r\n\t\t\tglobal.openShop(BuyType.TAS)\r\n\t\t})\r\n\t\tthis.propertyNode.props_Moeny_Top.on(Node.EventType.TOUCH_END, () => {\r\n\t\t\tegyptv2_Audio.playOneShot(SoundPathDefine.btn_click)\r\n\t\t\tglobal.openShop()\r\n\t\t})\r\n\t\tthis.propertyNode.props_btn_info.on(Node.EventType.TOUCH_END, () => {\r\n\t\t\tegyptv2_Audio.playOneShot(SoundPathDefine.btn_click)\r\n\t\t\tmainViewModel.openRule()\r\n\t\t})\r\n\t\tthis.propertyNode.props_btn_vip.on(Node.EventType.TOUCH_END, () => {\r\n\t\t\tegyptv2_Audio.playOneShot(SoundPathDefine.btn_click)\r\n\t\t\tglobal.openVipMain()\r\n\t\t})\r\n\t\tthis.propertyNode.props_btn_up_menu.on(Node.EventType.TOUCH_END, () => {\r\n\t\t\tegyptv2_Audio.playOneShot(SoundPathDefine.btn_click)\r\n\t\t\tif (!this.isShowMenu) {\r\n\t\t\t\tthis.isShowMenu = true;\r\n\t\t\t\tthis.propertyNode.props_menu_panel.active=!this.propertyNode.props_menu_panel.active\r\n\t\t\t\tthis.propertyNode.props_spr_menu_bg.getComponent(Animation).stop();\r\n\t\t\t\tthis.propertyNode.props_spr_menu_bg.getComponent(Animation).play();\r\n\t\t\t}\r\n\t\t})\r\n\t\tthis.propertyNode.props_menu_panel.on(Node.EventType.TOUCH_END, (e: EventTouch) => {\r\n\t\t\te.preventSwallow = true;\r\n\t\t\tthis.propertyNode.props_menu_panel.active = false;\r\n\t\t\tthis.scheduleOnce(() => {\r\n\t\t\t\tthis.isShowMenu = false;\r\n\t\t\t}, 0.2)\r\n\t\t})\r\n\t\tthis.propertyNode.props_menu_panel.on(Node.EventType.TOUCH_START, (e: EventTouch) => {\r\n\t\t\te.preventSwallow = true;\r\n\t\t})\r\n\t\tthis.propertyNode.props_menu_panel.on(Node.EventType.TOUCH_MOVE, (e: EventTouch) => {\r\n\t\t\te.preventSwallow = true;\r\n\t\t})\r\n\t\tthis.propertyNode.props_menu_panel.on(Node.EventType.TOUCH_CANCEL, (e: EventTouch) => {\r\n\t\t\te.preventSwallow = true;\r\n\t\t})\r\n\t}\r\n\r\n\tprotected useProps(key: keyof IProps, value: { pre: any, cur: any }) {\r\n\t\tif (this.node && this.node.isValid) {\r\n\t\t\tif (key === 'gold') {\r\n\t\t\t\tif (this.init) {\r\n\t\t\t\t\tthis.propertyNode.props_Moeny_Label.string = Number(value.cur) < 1000000 ? Number(value.cur).formatAmountWithCommas() : Number(value.cur).formatAmountWithLetter();\r\n\t\t\t\t\tthis.init = false;\r\n\t\t\t\t} else {\r\n\t\t\t\t\t// this.stepNumberV2.start(value.pre, value.cur, (num) => {\r\n\t\t\t\t\t// \tif (this.node && this.node.isValid) {\r\n\t\t\t\t\t// \t\tthis.propertyNode.props_Moeny_Label.string = Number(num.toFixed(0)).formatAmountWithCommas();\r\n\t\t\t\t\t// \t}\r\n\t\t\t\t\t// });\r\n\t\t\t\t\tnew StepNumber(value.pre, value.cur, (num) => {\r\n\t\t\t\t\t\tif (this.node && this.node.isValid) {\r\n\t\t\t\t\t\t\tthis.propertyNode.props_Moeny_Label.string = (+num.toFixed(0)) < 1000000 ? Number(value.cur).formatAmountWithCommas() : Number(value.cur).formatAmountWithLetter();;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}).start();\r\n\t\t\t\t\tconst diff = value.cur - value.pre;\r\n\t\t\t\t\tthis.propertyNode.props_number2.getComponent(Label).string = diff > 0 ? '+' + diff : diff + '';\r\n\t\t\t\t\tthis.propertyNode.props_number2.active = true;\r\n\t\t\t\t\tthis.propertyNode.props_number2.getComponent(Animation).play();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tprotected bindUI(): void {\r\n\t}\r\n\r\n\tupdate(deltaTime: number) {\r\n\r\n\t}\r\n}\r\n\r\n"]}