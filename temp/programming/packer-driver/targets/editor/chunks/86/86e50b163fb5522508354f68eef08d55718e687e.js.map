{"version":3,"sources":["file:///Users/geliang/web/dibai/hall/assets/script/subGame/dragonV2/viewModel/DragonV2MainViewModel.ts"],"names":["Dragonv2_Audio","sourceManageSeletor","ViewModel","StoreInject","ModalBox","global","lang","addToastAction","config","cacheData","clearCacheData","SKT_MAG_TYPE","sktInstance","sktMsgListener","bundlePkgName","PrefabPathDefine","getStore","changeGame","quitGame","setAutoLauncherInfo","updateChange","updateGold","updateJackpotAmount","updateJackpotDatas","updatePositionId","updateWinloss","updateRollerStatus","AutoLauncherType","GameType","RollerStatus","calBetAmount","isAuto","isSubGameToSubGame","verifyBetResultData","DragonV2DialogWinViewModel","DragonV2FoolerViewModel","DragonV2HeaderViewModel","DragonV2RollerPanelViewModel","DragonV2topValueViewModel","UseSetOption","DragonV2RulePanelViewModel","EffectType","SoundPathDefine","DragonV2MainViewModel","constructor","initCallback","headerViewModel","footerViewModel","rollerPanelViewModel","dragonV2topValueViewModel","isAuthDone","isBetResult","goodLuckPos","positionId","betCallbackFun","begin","mountViewNode","comp","getHeader","connect","setEvent","onQuitGame","getFooter","getRoller","get_top_value","onSendBet","sendBet","onOpenRule","openRule","subnoteOperation","props","hidePyrosphere","renderTheRingOfFire","key","flashbox","add","AUTH","data","error","closeSubGame","confirmContent","write","k","InitGameModule","FetcherFaild","gameType","SUBGAME2","fixedChessboardIcon","authData","dispatch","bl","lastGameType","viewGameType","currGameType","leftCount","freeGameCount","freeGameAmount","playBgMusic","SUBGAME1","initSlot","scheduleOnce","viewNode","isValid","autoLauncherInfo","gameTypeInfo","sendSktMessage","token","localStorage","getItem","gameId","LAUNCH","unschedule","undefined","result","playOneShot","ding","content","Instance","show","type","rollerLaunchResult","si","dl","fireRingSwitch","joinTheRingOfFire","change","theDragonSpitsFire","spitOut","Object","keys","length","rollerId","i","console","log","localLeftCount","freeCount","nextLeftCount","isDelay","NONE","REFRESHCOINS","JACKPOT","JACKPOT_TOTAL","option","gameSet","dragonV2","betTarget","betAmount","MAIN","gold","hallDispatch","palyingModule","RechangeGlod","placeStr","autoLauncherType","totalCount","RUNNING","betListenerTimeHandle","bind","schedule","tableId","oldFireCircle","rulePanelViewMode","mountView","getFile","RULEPANEL","source","appendTo","effectType","EFFECT1","WebSocketModule","WebSocketError","unMountCallBack","removeById","unMount","showDialogWin","dialogInfo","done","dragonV2DialogWinViewModel","DIALOG_WIN","setProps","onWindowCloseHandler","showTheNumberOfDragonBalls","num","setTamako","initOfDragonBalls","initTamako","getGoodLuckPos","setGoodLuckPos","pos","stop","play","bgMain","bgMusic","bgFree","inject","state","betDropDownlist","game","subGameAnimationPlayInfo","jackpotDatas","jackpotTotalAmount"],"mappings":"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","sourcesContent":["import { Dragonv2_Audio, sourceManageSeletor } from \"../index\"\r\nimport ViewModel, { StoreInject } from \"../../../base/ViewModel\"\r\nimport ModalBox from \"../../../common/ModalBox\"\r\nimport { global, lang } from \"../../../hall\"\r\nimport { addToastAction } from \"../../../hall/store/actions/baseBoard\"\r\nimport { Dragon_Main, IEvent, IProps } from \"../components/Dragon_Main\"\r\nimport config from \"../config\"\r\nimport { cacheData, clearCacheData } from \"../dataTransfer\"\r\nimport { SKT_MAG_TYPE, sktInstance, sktMsgListener } from \"../socketConnect\"\r\nimport { bundlePkgName } from \"../sourceDefine\"\r\nimport { PrefabPathDefine } from \"../sourceDefine/prefabDefine\"\r\nimport { getStore } from \"../store\"\r\nimport { changeGame, quitGame, setAutoLauncherInfo, updateChange, updateGold, updateJackpotAmount, updateJackpotDatas, updatePositionId, updateWinloss } from \"../store/actions/game\"\r\nimport { updateRollerStatus } from \"../store/actions/roller\"\r\nimport { StateType } from \"../store/reducer\"\r\nimport { AuthDataVo, AutoLauncherType, DialogInfo, GameType, JackpotData, RollerLaunchResult, RollerStatus, calBetAmount, isAuto, isSubGameToSubGame, verifyBetResultData } from \"../type\"\r\nimport DragonV2DialogWinViewModel from \"./DragonV2DialogWinViewModel\"\r\nimport DragonV2FoolerViewModel from \"./DragonV2FoolerViewModel\"\r\nimport DragonV2HeaderViewModel from \"./DragonV2HeaderViewModel\"\r\nimport DragonV2RollerPanelViewModel from \"./DragonV2RollerPanelViewModel\"\r\nimport DragonV2RollerViewModel from \"./DragonV2RollerViewModel\"\r\nimport { Vec3 } from \"cc\"\r\nimport DragonV2topValueViewModel from \"./DragonV2topValueViewModel\"\r\nimport UseSetOption from \"../../../utils/UseSetOption\"\r\nimport DragonV2RulePanelViewModel from \"./DragonV2RulePanelViewModel\"\r\nimport { EffectType } from \"../../../utils/NodeIOEffect\"\r\nimport { SoundPathDefine } from \"../sourceDefine/soundDefine\"\r\n\r\n@StoreInject(getStore())\r\nclass DragonV2MainViewModel extends ViewModel<Dragon_Main, IProps, IEvent> {\r\n  private initCallback;\r\n  constructor(initCallback) {\r\n    super('Dragon_Main')\r\n    this.initCallback = initCallback;\r\n  }\r\n\r\n  private headerViewModel: DragonV2HeaderViewModel;\r\n  private footerViewModel: DragonV2FoolerViewModel;\r\n  private rollerPanelViewModel: DragonV2RollerPanelViewModel;\r\n  public dragonV2topValueViewModel: DragonV2topValueViewModel;\r\n  public isAuthDone: boolean = false\r\n  private isBetResult = true;\r\n\r\n  /**奖励的坐标 */\r\n  private goodLuckPos: Vec3;\r\n  private positionId: number\r\n  private betCallbackFun;\r\n  protected begin() {\r\n    this.headerViewModel = new DragonV2HeaderViewModel().mountViewNode(this.comp.getHeader()).connect();\r\n    this.headerViewModel.setEvent({\r\n      quitGame: () => {\r\n        this.onQuitGame();\r\n      }\r\n    })\r\n    this.footerViewModel = new DragonV2FoolerViewModel().mountViewNode(this.comp.getFooter()).connect();\r\n    this.rollerPanelViewModel = new DragonV2RollerPanelViewModel().mountViewNode(this.comp.getRoller()).connect();\r\n    this.dragonV2topValueViewModel = new DragonV2topValueViewModel().mountViewNode(this.comp.get_top_value()).connect()\r\n    this.footerViewModel.setEvent({\r\n      onSendBet: () => {\r\n        this.sendBet();\r\n      },\r\n      onOpenRule: () => {\r\n        this.openRule();\r\n      },\r\n      subnoteOperation: () => {\r\n        if (this.positionId && this.comp.props.positionId !== this.positionId) {\r\n          this.rollerPanelViewModel.comp.hidePyrosphere(1)\r\n        } else {\r\n          this.rollerPanelViewModel.comp.hidePyrosphere(2)\r\n        }\r\n      }\r\n    })\r\n    this.setEvent({\r\n      onSendBet: () => {\r\n        this.sendBet();\r\n      },\r\n      renderTheRingOfFire: (key) => {\r\n        this.dragonV2topValueViewModel.comp.flashbox()\r\n      }\r\n    })\r\n\r\n    sktMsgListener.add(SKT_MAG_TYPE.AUTH, bundlePkgName, (data: AuthDataVo, error) => {\r\n      if (error) {\r\n        return;\r\n      }\r\n\r\n      if (!data) {\r\n        global.closeSubGame({\r\n          confirmContent: lang.write(k => k.InitGameModule.FetcherFaild) + '-' + SKT_MAG_TYPE.AUTH\r\n        });\r\n        return;\r\n      }\r\n      this.isAuthDone = true\r\n      if (data.gameType === GameType.SUBGAME2) {\r\n        // 锁定的图标\r\n        cacheData.fixedChessboardIcon = data.fixedChessboardIcon;\r\n      }\r\n      cacheData.authData = data;\r\n      this.dispatch(updateGold(data.bl));\r\n\r\n      this.dispatch(changeGame({\r\n        lastGameType: data.gameType,\r\n        viewGameType: data.gameType,\r\n        currGameType: data.gameType,\r\n        leftCount: data.freeGameCount,\r\n        freeGameAmount: data.freeGameAmount,\r\n      }))\r\n\r\n      this.playBgMusic();\r\n\r\n      if (data.freeGameAmount > 0 && data.gameType === GameType.SUBGAME1) {\r\n        this.dispatch(updateWinloss(data.freeGameAmount));\r\n      }\r\n\r\n      // 这里初始化插槽\r\n      this.rollerPanelViewModel.comp.initSlot();\r\n      // 延时一点时间才卸载laoding界面\r\n      this.comp.scheduleOnce(() => {\r\n        this.viewNode.isValid && this.initCallback && this.initCallback();\r\n\r\n        // 进入游戏之后如果是自动游戏，就发送下注\r\n        if (isAuto(this.comp.props.autoLauncherInfo, this.comp.props.gameTypeInfo)) {\r\n          this.sendBet();\r\n        }\r\n\r\n      }, 0.1)\r\n    })\r\n    sktInstance.sendSktMessage(SKT_MAG_TYPE.AUTH, {\r\n      token: localStorage.getItem(\"token\"),\r\n      gameId: config.gameId\r\n    });\r\n    sktMsgListener.add(SKT_MAG_TYPE.LAUNCH, bundlePkgName, (data: RollerLaunchResult, error) => {\r\n      this.comp.unschedule(this.betCallbackFun);\r\n      this.betCallbackFun = undefined;\r\n      this.isBetResult = true;\r\n      const result = verifyBetResultData(data)\r\n      if (!error && result > 0) {\r\n        Dragonv2_Audio.playOneShot(SoundPathDefine.ding)\r\n        const content = lang.write(k => k.InitGameModule.FetcherFaild) + '-ERROR(' + result + ')';\r\n        ModalBox.Instance().show({\r\n          content: content, type: 'Prompt'\r\n        }, () => {\r\n          return true\r\n        })\r\n        return;\r\n      }\r\n      cacheData.rollerLaunchResult = data;\r\n\r\n      const si = cacheData.rollerLaunchResult.dl.si[0];\r\n      if (si.gameType === GameType.SUBGAME2 || this.comp.props.gameTypeInfo.viewGameType === GameType.SUBGAME2) {\r\n        //每局的锁定图标\r\n        cacheData.fixedChessboardIcon = si.fixedChessboardIcon;\r\n      }\r\n      if (si.fireRingSwitch) { // 龙喷火\r\n        this.comp.scheduleOnce(() => {\r\n          this.rollerPanelViewModel.comp.joinTheRingOfFire(si.change)\r\n        }, 1.8)\r\n        this.comp.theDragonSpitsFire(() => {\r\n          Dragonv2_Audio.playOneShot(SoundPathDefine.spitOut)\r\n          if (si.change !== undefined) {\r\n            if (Object.keys(si.change).length > 0) {\r\n              this.dispatch(updateChange(si.change))\r\n            }\r\n          }\r\n        })\r\n      }\r\n      // 服务器的索引是从1开始的\r\n      const rollerId = si.rollerId\r\n      for (let i = 0; i < rollerId.length; i++) {\r\n        rollerId[i]--;\r\n      }\r\n      console.log(\"rollerId \", si.rollerId)\r\n\r\n      const localLeftCount = this.comp.props.gameTypeInfo.leftCount;\r\n      let leftCount = si.freeCount;\r\n      let nextLeftCount = undefined;\r\n      let isDelay = false;\r\n      // 小游戏切到小游戏时，暂不改变切换状态\r\n      // 为了让玩家延时看到剩余的次数，特殊处理\r\n      if (isSubGameToSubGame(this.comp.props.gameTypeInfo.viewGameType, si.gameType)) {\r\n\r\n      }\r\n\r\n      if (isSubGameToSubGame(this.comp.props.gameTypeInfo.viewGameType, si.gameType)\r\n        || (si.freeCount >= localLeftCount && this.comp.props.gameTypeInfo.viewGameType === GameType.SUBGAME2) // 如果服务器给的次数比本地的次数大了，说明次数发生变化，延迟显示\r\n        || (localLeftCount - si.freeCount > 1 && this.comp.props.gameTypeInfo.viewGameType === GameType.SUBGAME2)) { //如果服务器给的次数小于本地的次数超过了1次，说明次数发生变化，延迟显示\r\n        leftCount = localLeftCount - 1;\r\n        leftCount = leftCount < 0 ? 0 : leftCount;\r\n        nextLeftCount = si.freeCount;\r\n      }\r\n\r\n      if (isDelay) {\r\n        leftCount = localLeftCount - 1;\r\n        leftCount = leftCount < 0 ? 0 : leftCount;\r\n        nextLeftCount = si.freeCount;\r\n      }\r\n      this.dispatch(changeGame({\r\n        lastGameType: GameType.NONE,\r\n        viewGameType: this.comp.props.gameTypeInfo.viewGameType,\r\n        currGameType: si.gameType,\r\n        leftCount: leftCount,\r\n        freeGameAmount: si.freeGameAmount,\r\n        nextLeftCount: nextLeftCount\r\n      }))\r\n    })\r\n\r\n    // 更新金额\r\n    sktMsgListener.add(SKT_MAG_TYPE.REFRESHCOINS, bundlePkgName, (data, error) => {\r\n      this.dispatch(updateGold(data));\r\n    })\r\n    sktMsgListener.add(SKT_MAG_TYPE.JACKPOT, bundlePkgName, (data: JackpotData[], error) => {\r\n      this.dispatch(updateJackpotDatas(data))\r\n    })\r\n    /* 更新jackpot */\r\n    sktMsgListener.add(SKT_MAG_TYPE.JACKPOT_TOTAL, bundlePkgName, (data: number, error) => {\r\n      if (this.comp.props.positionId >= 6) {\r\n        this.dispatch(updateJackpotAmount(data))\r\n      }\r\n    })\r\n    if (UseSetOption.Instance().option.gameSet.dragonV2 && UseSetOption.Instance().option.gameSet.dragonV2.betTarget) {\r\n      this.dispatch(updatePositionId(UseSetOption.Instance().option.gameSet.dragonV2.betTarget))\r\n    } else {\r\n      this.dispatch(updatePositionId(1))\r\n    }\r\n  }\r\n  private sendBet() {\r\n    if (!this.isAuthDone) return\r\n    if (!this.isBetResult) {\r\n      console.log(\"已经发送过了下注，不能重复发送，等待服务器返回\")\r\n      return;\r\n    }\r\n\r\n    const betAmount = calBetAmount(this.comp.props.positionId)\r\n    // 在主游戏中才提示余额不足\r\n    if (this.comp.props.gameTypeInfo.viewGameType === GameType.MAIN && this.comp.props.gold < betAmount) {\r\n      global.hallDispatch(addToastAction({ content: lang.write(k => k.palyingModule.RechangeGlod, {}, { placeStr: \"对不起，您的金币不足，请充值！\" }) }))\r\n\r\n      // 如果余额不足，并且是自动状态，就取消自动\r\n      if (isAuto(this.comp.props.autoLauncherInfo, this.comp.props.gameTypeInfo)) {\r\n        this.dispatch(setAutoLauncherInfo({\r\n          autoLauncherType: AutoLauncherType.NONE,\r\n          totalCount: 0,\r\n          leftCount: 0\r\n        }))\r\n      }\r\n\r\n      return;\r\n    }\r\n\r\n    if (this.comp.props.gameTypeInfo.viewGameType === GameType.MAIN) {\r\n      this.dispatch(updateGold(this.comp.props.gold - betAmount));\r\n    }\r\n\r\n    cacheData.rollerLaunchResult = null;\r\n    cacheData.fixedChessboardIcon = null;\r\n    this.dispatch(updateRollerStatus(RollerStatus.RUNNING));\r\n    this.isBetResult = false;\r\n    this.betCallbackFun = this.betListenerTimeHandle.bind(this);\r\n    this.comp.schedule(this.betCallbackFun, 10);\r\n    if (this.positionId && this.comp.props.positionId !== this.positionId) {\r\n      this.rollerPanelViewModel.comp.hidePyrosphere(3)\r\n    } else {\r\n      this.positionId = this.comp.props.positionId\r\n    }\r\n    sktInstance.sendSktMessage(SKT_MAG_TYPE.LAUNCH, {\r\n      \"positionId\": this.comp.props.positionId,\r\n      \"tableId\": cacheData.authData.tableId,\r\n    });\r\n    this.rollerPanelViewModel.comp.oldFireCircle()\r\n  }\r\n\r\n\r\n  public openRule() {\r\n    const rulePanelViewMode = new DragonV2RulePanelViewModel()\r\n      .mountView(sourceManageSeletor().getFile(PrefabPathDefine.RULEPANEL).source)\r\n      .appendTo(this.viewNode, { effectType: EffectType.EFFECT1 });\r\n  }\r\n  private betListenerTimeHandle() {\r\n    if (!this.isBetResult) {\r\n      this.isBetResult = true;\r\n      const content = lang.write(k => k.WebSocketModule.WebSocketError) + '-' + SKT_MAG_TYPE.LAUNCH;\r\n      ModalBox.Instance().show({\r\n        content: content, type: 'Prompt'\r\n      }, () => {\r\n        this.onQuitGame();\r\n        return true\r\n      })\r\n    }\r\n  }\r\n\r\n  protected unMountCallBack(): void {\r\n    sktMsgListener.removeById(bundlePkgName)\r\n    this.footerViewModel.unMount();\r\n    this.headerViewModel.unMount();\r\n    this.rollerPanelViewModel.unMount();\r\n    clearCacheData();\r\n  }\r\n\r\n  private onQuitGame() {\r\n    global.closeSubGame();\r\n    this.dispatch(quitGame(0))\r\n  }\r\n\r\n  /**显示大奖 */\r\n  public showDialogWin(dialogInfo: DialogInfo, done) {\r\n    let dragonV2DialogWinViewModel = new DragonV2DialogWinViewModel().mountView(sourceManageSeletor().getFile(PrefabPathDefine.DIALOG_WIN).source)\r\n      .appendTo(this.viewNode).connect();\r\n    dragonV2DialogWinViewModel.setProps({\r\n      dialogInfo: dialogInfo,\r\n      gameTypeInfo: this.comp.props.gameTypeInfo,\r\n      autoLauncherInfo: this.comp.props.autoLauncherInfo,\r\n    })\r\n    dragonV2DialogWinViewModel.setEvent({\r\n      onWindowCloseHandler: () => {\r\n        done && done();\r\n      }\r\n    })\r\n  }\r\n  /* 显示龙珠 */\r\n  public showTheNumberOfDragonBalls(num: number) {\r\n    this.dragonV2topValueViewModel.comp.setTamako(num)\r\n  }\r\n  /* 初始化龙珠 */\r\n  public initOfDragonBalls() {\r\n    this.dragonV2topValueViewModel.comp.initTamako()\r\n  }\r\n\r\n  public getGoodLuckPos() {\r\n    return this.goodLuckPos;\r\n  }\r\n\r\n  public setGoodLuckPos(pos: Vec3) {\r\n    this.goodLuckPos = pos;\r\n  }\r\n  public playBgMusic() {\r\n    Dragonv2_Audio.stop();\r\n    if (this.comp.props.gameTypeInfo.viewGameType === GameType.MAIN) {\r\n      Dragonv2_Audio.play(SoundPathDefine.bgMain, true)\r\n    } else if (this.comp.props.gameTypeInfo.viewGameType === GameType.SUBGAME2) {\r\n      Dragonv2_Audio.play(SoundPathDefine.bgMusic, true)\r\n    } else {\r\n      Dragonv2_Audio.play(SoundPathDefine.bgFree, true)\r\n    }\r\n  }\r\n  public connect() {\r\n    this.inject({}, (state: StateType) => {\r\n      return {\r\n        betDropDownlist: state.game.betDropDownlist,\r\n        positionId: state.game.positionId,\r\n        gold: state.game.gold,\r\n        gameTypeInfo: state.game.gameTypeInfo,\r\n        subGameAnimationPlayInfo: state.game.subGameAnimationPlayInfo,\r\n        jackpotDatas: state.game.jackpotDatas,\r\n        autoLauncherInfo: state.game.autoLauncherInfo,\r\n        theDragonSpitsFire: state.game.theDragonSpitsFire,\r\n        jackpotTotalAmount: state.game.jackpotTotalAmount\r\n      }\r\n    })\r\n    return this\r\n  }\r\n\r\n\r\n}\r\n\r\nexport default DragonV2MainViewModel"]}