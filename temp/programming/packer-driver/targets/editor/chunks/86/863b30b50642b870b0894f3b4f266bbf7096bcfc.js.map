{"version":3,"sources":["file:///Users/geliang/web/dibai/hall/assets/script/subGame/gxfc/Slot/Component/gxfc_Icon.ts"],"names":["_decorator","Node","sp","Sprite","SpriteFrame","UITransform","Widget","BaseComponent","iconConfig","getSocketProxy","ccclass","property","gxfc_Icon","SkeletonData","type","displayName","iconId","iconDir","iconSize","bindUI","rootUi","root","getComponent","anchorY","setFace","icon","find","item","id","node","getChildByName","active","face","Skeleton","skeletonData","name","premultipliedAlpha","animation","animationArr","left","distance","top","setScale","scale","destroy","gameType","getTransferGameInfo","setBg","bgNameIndex","spriteFrame","bg_1","setEffect","animationIndex","length","iseff","effectBorder","layout2setEffect","aniKEY","isLoop","animationNameArr","Animation","clearTracks","setAnimation","monitorAnimations","onEndCall","Ani","setCompleteListener","entry","onAnimationEnd","console","log","bindEvent","start","update","deltaTime"],"mappings":"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","sourcesContent":["import { _decorator, Component, instantiate, Node, Animation, Skeleton, sp, Sprite, SpriteAtlas, SpriteFrame, UITransform, Vec3, Widget } from 'cc';\r\nimport BaseComponent from './BaseComponent';\r\nimport iconConfig from '../config'\r\nimport {getSocketProxy } from \"../utils\";\r\nconst { ccclass, property } = _decorator;\r\n\r\ntype ConfigType = {\r\n\tid: number\r\n\tname: string\r\n\tfileName: string\r\n\tanimationArr?: string[]\r\n\tdistance: number[]\r\n\tscale: number[]\r\n}\r\n\r\n@ccclass('gxfc_Icon')\r\nexport class gxfc_Icon extends BaseComponent {\r\n\t@property(Node)\r\n\tface: Node = null\r\n\r\n\t@property(sp.SkeletonData)\r\n\ttongqian: sp.SkeletonData = null\r\n\r\n\t@property(sp.SkeletonData)\r\n\tbianpao: sp.SkeletonData = null\r\n\r\n\t@property(sp.SkeletonData)\r\n\tyupei: sp.SkeletonData = null\r\n\r\n\t@property(sp.SkeletonData)\r\n\tgu: sp.SkeletonData = null\r\n\r\n\t@property(sp.SkeletonData)\r\n\tgirl: sp.SkeletonData = null\r\n\r\n\t@property(sp.SkeletonData)\r\n\tboy: sp.SkeletonData = null\r\n\r\n\t@property(sp.SkeletonData)\r\n\tbaihuzi: sp.SkeletonData = null\r\n\r\n\t@property(sp.SkeletonData)\r\n\theihuzi: sp.SkeletonData = null\r\n\r\n\t@property(sp.SkeletonData)\r\n\twild1: sp.SkeletonData = null\r\n\r\n\t@property(sp.SkeletonData)\r\n\twild2: sp.SkeletonData = null\r\n\r\n\t@property(sp.SkeletonData)\r\n\tscatter: sp.SkeletonData = null\r\n\r\n\t@property(Node)\r\n\teffectBorder: Node = null\r\n    @property({ type: [SpriteFrame], displayName: 'BG' })\r\n    bg_1: Array<SpriteFrame> = [];\r\n\r\n\tpublic iconId: number = 0\r\n\r\n\tprivate iconDir: ConfigType[]\r\n\tprivate iconSize: 'normal' | 'large' = 'normal'\r\n\tprivate iconConfig: ConfigType\r\n\r\n\tprotected bindUI(): void {\r\n\t\tconst rootUi = this.root.getComponent(UITransform) as UITransform\r\n\t\trootUi.anchorY = 1\r\n\r\n\t\t// rootUi.anchorX = 0\r\n\t}\r\n\t/**传入图标的ID */\r\n\tpublic setFace(iconId: number) {\r\n\t\tthis.iconId = iconId\r\n\t\tthis.iconDir = iconConfig.icon\r\n\t\tthis.iconConfig = this.iconDir.find(item => item.id === iconId)\r\n\t\tthis.node.getChildByName(\"face\").active = true\r\n\t\tthis.face.getComponent(sp.Skeleton).skeletonData = this[this.iconConfig.name]\r\n\t\tthis.face.getComponent(sp.Skeleton).premultipliedAlpha = false\r\n\t\tthis.node.getChildByName(\"face\").getComponent(sp.Skeleton).animation = this.iconConfig.animationArr[0]\r\n\t\tthis.node.getChildByName(\"face\").getComponent(Widget).left = this.iconConfig.distance[0]\r\n\t\tthis.node.getChildByName(\"face\").getComponent(Widget).top = this.iconConfig.distance[1]\r\n\t\tthis.face.setScale(this.iconConfig.scale[0], this.iconConfig.scale[1])\r\n        if (this.iconConfig.name === 'scatter') { //|| this.iconConfig.name === 'wild'\r\n            this.node.getChildByName('focusBorder').destroy()\r\n        }\r\n        let gameType= getSocketProxy().getTransferGameInfo().gameType()\r\n        this.setBg(gameType===1?3:1)\r\n\t}\r\n    /**设置背景图片 */\r\n    public setBg(bgNameIndex) {\r\n        this.node.getChildByName('bg').getComponent(Sprite).spriteFrame = this.bg_1[bgNameIndex!==3?0:1]\r\n    }\r\n\t/**启动或停止效果\r\n\t * animationIndex设置为0，或不设置的话，就停止效果\r\n\t */\r\n\tpublic setEffect(animationIndex: number = 0) {\r\n\t\t// this.face.getComponent(sp.Skeleton).setAnimation(1, this.iconConfig.animationArr[animationIndex], true)\r\n\t\tif (this.iconSize === 'large') return\r\n\t\tif (animationIndex > this.iconConfig.animationArr.length - 1) {\r\n\t\t\tanimationIndex = this.iconConfig.animationArr.length - 1\r\n\t\t}\r\n\t\tthis.node.getChildByName(\"face\").getComponent(sp.Skeleton).animation = this.iconConfig.animationArr[animationIndex]\r\n\t\tconst iseff = animationIndex === 0 ? false : true\r\n\t\tthis.effectBorder.active = iseff\r\n\t}\r\n    public layout2setEffect(aniKEY:number,isLoop=true){\r\n        const animationNameArr=['animation','animation3','animation4','dynamic','static']\r\n        let Animation=this.node.getChildByName(\"face\").getComponent(sp.Skeleton)\r\n        Animation.clearTracks()\r\n        Animation.setAnimation(0, animationNameArr[aniKEY], isLoop)\r\n    }\r\n    public  monitorAnimations(onEndCall?: (entry: sp.spine.TrackEntry) => void, ){\r\n        let Ani=this.node.getChildByName(\"face\").getComponent(sp.Skeleton)\r\n        // 监听动画播放完成事件\r\n        Ani.setCompleteListener((entry: sp.spine.TrackEntry) => {\r\n            onEndCall(entry)\r\n        })\r\n    }\r\n    onAnimationEnd() {\r\n        console.log(\"\");\r\n        // 在这里可以执行你需要的逻辑\r\n    }\r\n\tprotected bindEvent(): void {\r\n\r\n\t}\r\n\r\n\tstart() {\r\n\r\n\t}\r\n\r\n\tupdate(deltaTime: number) {\r\n\r\n\t}\r\n}\r\n\r\n"]}