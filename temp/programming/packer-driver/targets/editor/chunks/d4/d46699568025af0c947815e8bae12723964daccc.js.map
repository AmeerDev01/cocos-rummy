{"version":3,"sources":["file:///Users/geliang/web/dibai/hall/assets/script/subGame/thor/components/Thor_SmallGame_caculate.ts"],"names":["_decorator","Label","Node","sp","BaseComponent","StepNumber","AutoLauncherType","ccclass","property","Thor_SmallGame_caculate","propertyNode","props_node_start","props_node_end","props_label_goldNum","props_label_sgNum","props_calcuate_box","props","type","total","autoLaunchType","NONE","events","killSelfHandler","start","initState","bindEvent","on","EventType","TOUCH_END","e","string","formatAmountWithCommas","scheduleOnce","useProps","key","value","active","getComponent","Skeleton","setAnimation","cur","num","toFixed","startFalling","clearTheDrop","bindUI","update","deltaTime"],"mappings":"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","sourcesContent":["import { _decorator, instantiate, Component, Label, Layout, Node, ScrollView, tween, Vec3, log, Sprite, sp } from 'cc';\r\nimport { BaseComponent } from '../../../base/BaseComponent';\r\nimport StepNumber from '../../../utils/StepNumber';\r\nimport { AutoLauncherType } from '../type';\r\nconst { ccclass, property } = _decorator;\r\n\r\nexport interface IState {\r\n\r\n}\r\n\r\nexport interface IProps {\r\n\ttype?:Number,\r\n\ttotal?: number,\r\n\tautoLaunchType?: AutoLauncherType,\r\n}\r\nexport interface IEvent {\r\n\t/**自灭弹窗 */\r\n\tkillSelfHandler: () => void\r\n}\r\n\r\n@ccclass('Thor_SmallGame_caculate')\r\nexport class Thor_SmallGame_caculate extends BaseComponent<IState, IProps, IEvent> {\r\n\tstart() {\r\n\r\n\t}\r\n\r\n\tprotected propertyNode = {\r\n\t\tprops_node_start: new Node(),\r\n\t\tprops_node_end: new Node(),\r\n\t\tprops_label_goldNum: new Label(),\r\n\t\tprops_label_sgNum: new Label(),\r\n\t\tprops_calcuate_box: new Node(),\r\n\t}\r\n\r\n\tpublic props: IProps = {\r\n\t\ttype:1,\r\n\t\ttotal:0,\r\n\t\tautoLaunchType:AutoLauncherType.NONE\r\n\t}\r\n\r\n\tpublic events: IEvent = {\r\n\t\tkillSelfHandler: () => { }\r\n\t}\r\n\r\n\tprotected initState() {\r\n\t\treturn {\r\n\r\n\t\t}\r\n\t}\r\n\r\n\tprotected bindEvent(): void {\r\n\t\tthis.propertyNode.props_calcuate_box.on(Node.EventType.TOUCH_END, (e => {\r\n\t\t\tif(this.props.type===1){\r\n\t\t\t\tthis.propertyNode.props_label_sgNum&&(this.propertyNode.props_label_goldNum.string=this.props.total.formatAmountWithCommas())\r\n\t\t\t}else{\r\n\t\t\t\tthis.propertyNode.props_label_goldNum&&(this.propertyNode.props_label_goldNum.string=this.props.total.formatAmountWithCommas())\r\n\t\t\t}\r\n\t\t\tthis.scheduleOnce(()=>{\r\n\t\t\t\tthis.events && this.events.killSelfHandler()\r\n\t\t\t},1)\r\n\t\t}))\r\n\t}\r\n\r\n\tprotected useProps(key: keyof IProps, value: { pre: any, cur: any }) {\r\n\t\tif(key === \"type\" || key===\"total\" ){\r\n\t\t\tif(this.props.type===1){\r\n\t\t\t\tthis.propertyNode.props_node_start.active=true\r\n\t\t\t\tthis.propertyNode.props_node_end.active=false\r\n\t\t\t\tthis.propertyNode.props_calcuate_box.getComponent(sp.Skeleton).setAnimation(0, \"keep\", true);\r\n\t\t\t\t(new StepNumber(0, value.cur, (num) => {\r\n\t\t\t\t\tthis.propertyNode && this.propertyNode.props_label_sgNum && (this.propertyNode.props_label_sgNum.string = (+num.toFixed(0)).formatAmountWithCommas())\r\n\t\t\t\t}, () => {\r\n\t\t\t\t\tif(this.props.autoLaunchType!==AutoLauncherType.NONE){\r\n\t\t\t\t\t\tthis.scheduleOnce(()=>{\r\n\t\t\t\t\t\t\tthis.events && this.events.killSelfHandler()\r\n\t\t\t\t\t\t},2)\r\n\t\t\t\t\t}\r\n\t\t\t\t})).start()\r\n\t\t\t}\r\n\t\t\tif(this.props.type===2){\r\n\t\t\t\tthis.propertyNode.props_node_start.active=false\r\n\t\t\t\tthis.propertyNode.props_node_end.active=true\r\n\t\t\t\tthis.propertyNode.props_calcuate_box.getComponent(sp.Skeleton).setAnimation(0, \"keep2\", true);\r\n\t\t\t\t(new StepNumber(0, value.cur, (num) => {\r\n\t\t\t\t\tthis.propertyNode && this.propertyNode.props_label_goldNum && (this.propertyNode.props_label_goldNum.string = (+num.toFixed(0)).formatAmountWithCommas())\r\n\t\t\t\t}, () => {\r\n\t\t\t\t\tif(this.props.autoLaunchType!==AutoLauncherType.NONE){\r\n\t\t\t\t\t\tthis.scheduleOnce(()=>{\r\n\t\t\t\t\t\t\tthis.events && this.events.killSelfHandler()\r\n\t\t\t\t\t\t},2)\r\n\t\t\t\t\t}\r\n\t\t\t\t})).start()\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\tprivate startFalling() {\r\n\r\n\t}\r\n\tprivate clearTheDrop() {\r\n\r\n\t}\r\n\tprotected bindUI(): void {\r\n\r\n\t}\r\n\r\n\tupdate(deltaTime: number) {\r\n\r\n\t}\r\n}\r\n\r\n"]}