{"version":3,"sources":["file:///Users/geliang/web/dibai/hall/assets/script/subGame/dfdc/components/BlessedWealthy_dialogWin.ts"],"names":["_decorator","Label","Node","sp","BaseComponent","Task","TaskSchedulerDefault","StepNumber","ccclass","property","BlessedWealthy_dialogWin","winnerConfig","propertyNode","props_caishen_bw","props_cs_bw","props_slots_goldNum","props_sk_yowin","props_btn_back","props_label_shuzi","props_label_shuzi2","props","winning","glodAmount","keepTime","events","killSelfHandler","start","initState","bindEvent","useProps","key","value","cur","titleSkeleton","getComponent","Skeleton","name","node","active","window","setTimeout","joinqQueue","done","pre","num","string","toFixed","formatAmountWithCommas","bindUI","update","deltaTime"],"mappings":"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","sourcesContent":["import { _decorator, Button, Component, Label, Node, Skeleton, sp, Vec3 } from 'cc';\r\nimport { BaseComponent } from '../../../base/BaseComponent';\r\nimport { DialogType } from '../type';\r\nimport { sourceManageSeletor } from '../index';\r\nimport TaskScheduler, { Task, TaskSchedulerDefault } from '../../../utils/TaskScheduler';\r\nimport StepNumber from '../../../utils/StepNumber';\r\nconst { ccclass, property } = _decorator;\r\n\r\nexport interface IState {\r\n\r\n}\r\n\r\nexport interface IProps {\r\n\twinning?: {\r\n\t\tid: number;\r\n\t\tname: string;\r\n\t\tfileName: string[];\r\n\t\tminRate: number;\r\n\t\tmaxRate: number;\r\n\t},\r\n\tglodAmount?: number,\r\n\tkeepTime?: number\r\n}\r\nexport interface IEvent {\r\n\t/**自灭弹窗 */\r\n\tkillSelfHandler: () => void\r\n}\r\n\r\n@ccclass('BlessedWealthy_dialogWin')\r\nexport class BlessedWealthy_dialogWin extends BaseComponent<IState, IProps, IEvent> {\r\n\tstart() { }\r\n\tprivate winnerConfig: {\r\n\t\tid: number;\r\n\t\tname: string;\r\n\t\tfileName: string[];\r\n\t\tminRate: number;\r\n\t\tmaxRate: number;\r\n\t}[] = []\r\n\r\n\tprotected propertyNode = {\r\n\t\t// props_sb_lbjs_BIGWIN: new Node(),\r\n\t\t// props_slots_common_game_bw_gold: new Node(),\r\n\t\t// props_slots_goldNum: new Label(),\r\n\t\tprops_caishen_bw: new Node(),\r\n\t\tprops_cs_bw:new Node(),\r\n\t\tprops_slots_goldNum: new Label(),\r\n\r\n\t\tprops_sk_yowin:new Node(),\r\n\t\tprops_btn_back: new Node(),\r\n\t\tprops_label_shuzi: new Label(),\r\n\t\tprops_label_shuzi2:new Label(),\r\n\t\t\r\n\t}\r\n\r\n\tpublic props: IProps = {\r\n\t\twinning: null,\r\n\t\tglodAmount: 0,\r\n\t\tkeepTime: 3000\r\n\t}\r\n\r\n\tpublic events: IEvent = {\r\n\t\tkillSelfHandler: () => { }\r\n\t}\r\n\r\n\tprotected initState() {\r\n\t\treturn {}\r\n\t}\r\n\r\n\tprotected bindEvent(): void {\r\n\r\n\t}\r\n\r\n\tprotected useProps(key: keyof IProps, value: { pre: any, cur: any }) {\r\n\t\tif (key === \"winning\") {\r\n\t\t\tthis.winnerConfig = value.cur\r\n\t\t\tif (value.cur) {\r\n\t\t\t\tconst titleSkeleton = this.propertyNode.props_sk_yowin.getComponent(sp.Skeleton)\t\t\t\t\r\n\t\t\t\t// titleSkeleton.skeletonData = sourceManageSeletor().getFile(this.props.winning.fileName[0]).source\r\n\t\t\r\n\t\t\t\t// if (this.props.winning.fileName[1]) {\r\n\t\t\t\t// \tthis.propertyNode.props_slots_common_game_bw_gold.active = true\r\n\t\t\t\t// \tconst glodSkeleton = this.propertyNode.props_slots_common_game_bw_gold.getComponent(sp.Skeleton)\r\n\t\t\t\t// \tglodSkeleton.skeletonData = sourceManageSeletor().getFile(this.props.winning.fileName[1]).source\r\n\t\t\t\t// \tglodSkeleton.animation = \"loop\"\r\n\t\t\t\t// } else {\r\n\t\t\t\t// \tthis.propertyNode.props_slots_common_game_bw_gold.active = false\r\n\t\t\t\t// }\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (key === \"glodAmount\") {\r\n\t\t\tif (this.props.winning.name === \"watermelon\") {\r\n\t\t\t\tthis.propertyNode.props_label_shuzi.node.active = false\r\n\t\t\t\twindow.setTimeout(() => {\r\n\t\t\t\t\tthis.propertyNode.props_label_shuzi.node.active = true\r\n\t\t\t\t\tTaskSchedulerDefault().joinqQueue(new Task((done) => {\r\n\t\t\t\t\t\t(new StepNumber(value.pre, value.cur, (num) => {\r\n\t\t\t\t\t\t\tthis.propertyNode && this.propertyNode.props_label_shuzi && (this.propertyNode.props_label_shuzi.string = (+num.toFixed(0)).formatAmountWithCommas())\r\n\t\t\t\t\t\t}, () => {\r\n\t\t\t\t\t\t\twindow.setTimeout(() => {\r\n\t\t\t\t\t\t\t\tthis.events && this.events.killSelfHandler()\r\n\t\t\t\t\t\t\t\t//数字展示完了之后，再停留1秒钟\r\n\t\t\t\t\t\t\t\tdone()\r\n\t\t\t\t\t\t\t}, 2000)\r\n\t\t\t\t\t\t})).start()\r\n\t\t\t\t\t}))\r\n\t\t\t\t}, 1000)\r\n\t\t\t} else {\r\n\t\t\t\tTaskSchedulerDefault().joinqQueue(new Task((done) => {\r\n\t\t\t\t\t(new StepNumber(value.pre, value.cur, (num) => {\r\n\t\t\t\t\t\tthis.propertyNode && this.propertyNode.props_label_shuzi && (this.propertyNode.props_label_shuzi.string = (+num.toFixed(0)).formatAmountWithCommas())\r\n\t\t\t\t\t}, () => {\r\n\t\t\t\t\t\twindow.setTimeout(() => {\r\n\t\t\t\t\t\t\tthis.events && this.events.killSelfHandler()\r\n\t\t\t\t\t\t\t//数字展示完了之后，再停留1秒钟\r\n\t\t\t\t\t\t\tdone()\r\n\t\t\t\t\t\t}, 2000)\r\n\t\t\t\t\t})).start()\r\n\t\t\t\t}), true)\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tprotected bindUI(): void {\r\n\r\n\t}\r\n\r\n\tupdate(deltaTime: number) {\r\n\r\n\t}\r\n}\r\n\r\n\r\n\r\n\r\n"]}