{"version":3,"sources":["file:///Users/geliang/web/dibai/hall/assets/script/subGame/dragon/Slot/Component/dragon_Loader.ts"],"names":["_decorator","Component","Label","ProgressBar","Node","global","lang","ccclass","property","dragon_Loader","loaderState","onLoad","getCloseBtn","active","node","getChildByName","start","on","EventType","TOUCH_END","closeSubGame","getLoaderState","setLoadingProgress","fileName","total","remain","isValid","progressBar","getComponent","str","progress","loaderTxt","string","toFixed","write","k","WebSocketModule","GameInit","placeStr","update","deltaTime"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;AAASA,MAAAA,U,OAAAA,U;AAAYC,MAAAA,S,OAAAA,S;AAAWC,MAAAA,K,OAAAA,K;AAAOC,MAAAA,W,OAAAA,W;AAAaC,MAAAA,I,OAAAA,I;;AAC3CC,MAAAA,M,iBAAAA,M;AAAQC,MAAAA,I,iBAAAA,I;;;;;;;;;OACX;AAAEC,QAAAA,OAAF;AAAWC,QAAAA;AAAX,O,GAAwBR,U;;+BAGjBS,a,WADZF,OAAO,CAAC,eAAD,C,UAEHC,QAAQ,CAACN,KAAD,C,2BAFb,MACaO,aADb,SACmCR,SADnC,CAC6C;AAAA;AAAA;;AAAA;;AAAA,eAGlCS,WAHkC,GAGpB,IAHoB;AAAA;;AAI/BC,QAAAA,MAAM,GAAS;AACrB,eAAKC,WAAL,GAAmBC,MAAnB,GAA4B,KAA5B;AACH;;AACOD,QAAAA,WAAW,GAAG;AAClB,iBAAO,KAAKE,IAAL,CAAUC,cAAV,CAAyB,kBAAzB,CAAP;AACH;;AACDC,QAAAA,KAAK,GAAG;AACJ,eAAKJ,WAAL,GAAmBK,EAAnB,CAAsBb,IAAI,CAACc,SAAL,CAAeC,SAArC,EAAgD,MAAM;AAClD,iBAAKT,WAAL,GAAmB,KAAnB;AACA;AAAA;AAAA,kCAAOU,YAAP;AACH,WAHD;AAIH;;AACDC,QAAAA,cAAc,GAAG;AACb,iBAAO,KAAKX,WAAZ;AACH;AACD;AACJ;AACA;AACA;AACA;AACA;;;AACIY,QAAAA,kBAAkB,CAACC,QAAD,EAAmBC,KAAnB,EAAkCC,MAAlC,EAAkD;AAChE,cAAI,CAAC,KAAKX,IAAN,IAAc,CAAC,KAAKA,IAAL,CAAUY,OAA7B,EAAsC;AACtC,cAAIC,WAAW,GAAG,KAAKb,IAAL,CAAUC,cAAV,CAAyB,oBAAzB,EAA+Ca,YAA/C,CAA4DzB,WAA5D,CAAlB;AACA,cAAI0B,GAAG,GAAG,CAACL,KAAK,GAAGC,MAAR,GAAiB,CAAlB,IAAuB,GAAvB,GAA6B,IAAvC;AACAE,UAAAA,WAAW,CAACG,QAAZ,GAAuB,IAAID,GAA3B;AACA,eAAKE,SAAL,CAAeC,MAAf,GAAyB,GAAE,CAAC,CAACR,KAAK,GAAGC,MAAT,IAAmBD,KAAnB,GAA2B,GAA5B,EAAiCS,OAAjC,CAAyC,CAAzC,CAA4C,GAAvE,CALgE,CAMhE;AACA;;AAEA,cAAIJ,GAAG,IAAI,CAAX,EAAc;AACV,iBAAKE,SAAL,CAAeC,MAAf,GAAwB;AAAA;AAAA,8BAAKE,KAAL,CAAWC,CAAC,IAAIA,CAAC,CAACC,eAAF,CAAkBC,QAAlC,EAA4C,EAA5C,EAAgD;AAAEC,cAAAA,QAAQ,EAAE;AAAZ,aAAhD,CAAxB;AACH;AACJ;;AAEDC,QAAAA,MAAM,CAACC,SAAD,EAAoB,CAEzB;;AAzCwC,O;;;;;iBAEtB,I","sourcesContent":["import { _decorator, Component, Label, ProgressBar, Node } from 'cc';\r\nimport { global, lang } from \"../../../../hall\";\r\nconst { ccclass, property } = _decorator;\r\n\r\n@ccclass('dragon_Loader')\r\nexport class dragon_Loader extends Component {\r\n    @property(Label)\r\n    loaderTxt: Label = null\r\n    public loaderState = true;\r\n    protected onLoad(): void {\r\n        this.getCloseBtn().active = false;\r\n    }\r\n    private getCloseBtn() {\r\n        return this.node.getChildByName('props_btn_return');\r\n    }\r\n    start() {\r\n        this.getCloseBtn().on(Node.EventType.TOUCH_END, () => {\r\n            this.loaderState = false\r\n            global.closeSubGame()\r\n        })\r\n    }\r\n    getLoaderState() {\r\n        return this.loaderState\r\n    }\r\n    /**\r\n     *\r\n     * @param fileName 资源名称\r\n     * @param total 全部文件数量\r\n     * @param remain 剩余的数量\r\n     */\r\n    setLoadingProgress(fileName: string, total: number, remain: number) {\r\n        if (!this.node || !this.node.isValid) return;\r\n        let progressBar = this.node.getChildByName('ProgressBar_updata').getComponent(ProgressBar)\r\n        let str = (total - remain + 3) * 100 / 1000\r\n        progressBar.progress = 1 - str;\r\n        this.loaderTxt.string = `${((total - remain) / total * 100).toFixed(0)}%`\r\n        //this.node.getChildByName('props_btn_return').active = remain !== 0;\r\n        // console.log(str);\r\n\r\n        if (str >= 1) {\r\n            this.loaderTxt.string = lang.write(k => k.WebSocketModule.GameInit, {}, { placeStr: \"Game init...\" })\r\n        }\r\n    }\r\n\r\n    update(deltaTime: number) {\r\n\r\n    }\r\n}\r\n\r\n"]}