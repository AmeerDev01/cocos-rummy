{"version":3,"sources":["file:///Users/geliang/web/dibai/hall/assets/script/subGame/qiuqiu/components/Qiuqiu_Opponent.ts"],"names":["Animation","Label","Node","Sprite","Vec3","_decorator","instantiate","tween","BaseComponent","config","DeskStatus","OperationType","genCardItem","CardType","global","getOptimalCardGroup","CardViewModel","playAllin","playFangqi","playGuoPai","sourceManageSeletor","PrefabPathDefine","ccclass","property","Qiuqiu_Opponent","propertyNode","props_spr_head","props_label_name","props_label_gold","props_label_gold_add","props_label_left_num","props_label_right_num","props_label_countDown_time","props_spr_banker","props_spr_cek","props_spr_allin","props_spr_naik","props_spr_balik","props_spr_ikut","props_btn_gift","props_quiqui_ending","props_layout_result_card","props_Layout_cards_handCards","props_layout_cardnum","props_card_results","props_cards","props","deskStatus","uid","nickName","gold","icon","isDealer","isReady","results","winloss","opType","operationCountdown","currActiveSeatIndex","seatIndex","dealCardCount","balanceInfo","cardType","DISERSE","events","getHealerPosition","start","initState","bindEvent","useProps","key","value","node","active","updateDeskStatus","string","loadHeadSprite","formatAmountWithLetter","updateCountdown","updateDealCard","updateOperationType","playAddGoldAnime","updateCards","updateCardType","bindUI","removeAllChildren","getComponent","destroy","PASS","SHOW_HAND","FILL","GIVE_UP","CALL","grayscale","isReconnect","cardFlyHealer","countdown","children","forEach","v","i","endPos","concat","filter","flyNode","addChild","to","worldPosition","removeSelf","getHandCardPosition","index","getChildByName","getWorldPosition","getFlyChipStartPosition","WAITING","clearData","playAddGold","goldNode","setPosition","getPosition","position","x","y","show","delay","hide","length","showCardNum","cardItems","map","groups","addCards","sum","rightNum","cardnumNode","setScale","scale","cardGroup","cardsNode","createCardView","cardItem","parentNode","view","mountView","getFile","prefabs_quiqui_bigCard","source","appendTo","setProps","upFace","downFace","connect","comp","openCard","cardTypes","find","spriteFrame","update","deltaTime"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAASA,MAAAA,S,OAAAA,S;AAAWC,MAAAA,K,OAAAA,K;AAAOC,MAAAA,I,OAAAA,I;AAAMC,MAAAA,M,OAAAA,M;AAA2BC,MAAAA,I,OAAAA,I;AAAMC,MAAAA,U,OAAAA,U;AAAYC,MAAAA,W,OAAAA,W;AAAaC,MAAAA,K,OAAAA,K;;AAClFC,MAAAA,a,iBAAAA,a;;AACFC,MAAAA,M;;AACEC,MAAAA,U,iBAAAA,U;AAAuBC,MAAAA,a,iBAAAA,a;AAAoCC,MAAAA,W,iBAAAA,W;AAAkCC,MAAAA,Q,iBAAAA,Q;;AAC7FC,MAAAA,M,iBAAAA,M;;AACAC,MAAAA,mB,iBAAAA,mB;;AACFC,MAAAA,a;;AACEC,MAAAA,S,iBAAAA,S;AAAWC,MAAAA,U,iBAAAA,U;AAAYC,MAAAA,U,iBAAAA,U;AAA0BC,MAAAA,mB,iBAAAA,mB;;AACjDC,MAAAA,gB,iBAAAA,gB;;;;;;;;;OACH;AAAEC,QAAAA,OAAF;AAAWC,QAAAA;AAAX,O,GAAwBlB,U;;iCAiCjBmB,e,WADZF,OAAO,CAAC,iBAAD,C,gBAAR,MACaE,eADb;AAAA;AAAA,0CAC2E;AAAA;AAAA;AAAA,eAKhEC,YALgE,GAKjD;AACxBC,YAAAA,cAAc,EAAE,IAAIvB,MAAJ,EADQ;AAExBwB,YAAAA,gBAAgB,EAAE,IAAI1B,KAAJ,EAFM;AAGxB2B,YAAAA,gBAAgB,EAAE,IAAI3B,KAAJ,EAHM;AAIxB4B,YAAAA,oBAAoB,EAAE,IAAI5B,KAAJ,EAJE;AAKxB6B,YAAAA,oBAAoB,EAAE,IAAI7B,KAAJ,EALE;AAMxB8B,YAAAA,qBAAqB,EAAE,IAAI9B,KAAJ,EANC;AAOxB+B,YAAAA,0BAA0B,EAAE,IAAI/B,KAAJ,EAPJ;AAQxBgC,YAAAA,gBAAgB,EAAE,IAAI/B,IAAJ,EARM;AASxBgC,YAAAA,aAAa,EAAE,IAAIhC,IAAJ,EATS;AAUxBiC,YAAAA,eAAe,EAAE,IAAIjC,IAAJ,EAVO;AAWxBkC,YAAAA,cAAc,EAAE,IAAIlC,IAAJ,EAXQ;AAYxBmC,YAAAA,eAAe,EAAE,IAAInC,IAAJ,EAZO;AAaxBoC,YAAAA,cAAc,EAAE,IAAIpC,IAAJ,EAbQ;AAcxBqC,YAAAA,cAAc,EAAE,IAAIrC,IAAJ,EAdQ;AAexBsC,YAAAA,mBAAmB,EAAE,IAAItC,IAAJ,EAfG;AAgBxBuC,YAAAA,wBAAwB,EAAE,IAAIvC,IAAJ,EAhBF;AAiBxBwC,YAAAA,4BAA4B,EAAE,IAAIxC,IAAJ,EAjBN;AAkBxByC,YAAAA,oBAAoB,EAAE,IAAIzC,IAAJ,EAlBE;AAmBxB0C,YAAAA,kBAAkB,EAAE,IAAI1C,IAAJ,EAnBI;AAoBxB2C,YAAAA,WAAW,EAAE,IAAI3C,IAAJ;AApBW,WALiD;AAAA,eA4BnE4C,KA5BmE,GA4BnD;AACtBC,YAAAA,UAAU,EAAE,IADU;AAEtBC,YAAAA,GAAG,EAAE,IAFiB;AAGtBC,YAAAA,QAAQ,EAAE,IAHY;AAItBC,YAAAA,IAAI,EAAE,CAJgB;AAKtBC,YAAAA,IAAI,EAAE,CAAC,CALe;AAMtBC,YAAAA,QAAQ,EAAE,IANY;AAOtBC,YAAAA,OAAO,EAAE,IAPa;AAQtBC,YAAAA,OAAO,EAAE,EARa;AAStBC,YAAAA,OAAO,EAAE,CATa;AAUtBC,YAAAA,MAAM,EAAE,IAVc;AAWtBC,YAAAA,kBAAkB,EAAE,IAXE;;AAYtB;AACAC,YAAAA,mBAAmB,EAAE,CAAC,CAbA;AActBC,YAAAA,SAAS,EAAE,CAAC,CAdU;AAetBC,YAAAA,aAAa,EAAE,CAfO;AAgBtBC,YAAAA,WAAW,EAAE,IAhBS;AAiBtBC,YAAAA,QAAQ,EAAE;AAAA;AAAA,sCAASC;AAjBG,WA5BmD;AAAA,eAgDnEC,MAhDmE,GAgDlD;AACvBC,YAAAA,iBAAiB,EAAE,MAAM;AAAE,qBAAO,IAAP;AAAa;AADjB,WAhDkD;AAAA;;AAC1EC,QAAAA,KAAK,GAAG,CAEP;;AAiDSC,QAAAA,SAAS,GAAG;AACrB,iBAAO,EAAP;AAGA;;AAESC,QAAAA,SAAS,GAAS,CAC3B;;AAESC,QAAAA,QAAQ,CAACC,GAAD,EAAoBC,KAApB,EAAmD;AACpE,kBAAQD,GAAR;AACC,iBAAK,KAAL;AACC,mBAAKE,IAAL,CAAUC,MAAV,GAAmB,KAAK3B,KAAL,CAAWE,GAAX,KAAmB,EAAtC;AACA;;AACD,iBAAK,YAAL;AACC,mBAAK0B,gBAAL;AACA;;AACD,iBAAK,UAAL;AACC,mBAAKjD,YAAL,CAAkBE,gBAAlB,CAAmCgD,MAAnC,GAA4C,KAAK7B,KAAL,CAAWG,QAAvD;AACA;;AACD,iBAAK,MAAL;AACC;AAAA;AAAA,oCAAO2B,cAAP,CAAsB,KAAK9B,KAAL,CAAWK,IAAjC,EAAuC,KAAK1B,YAAL,CAAkBC,cAAzD;AACA;;AACD,iBAAK,MAAL;AACC,mBAAKD,YAAL,CAAkBG,gBAAlB,CAAmC+C,MAAnC,GAA4C,KAAK7B,KAAL,CAAWI,IAAX,CAAgB2B,sBAAhB,CAAuC,IAAvC,CAA5C;AACA;;AACD,iBAAK,UAAL;AACC,mBAAKpD,YAAL,CAAkBQ,gBAAlB,CAAmCwC,MAAnC,GAA4C,KAAK3B,KAAL,CAAWM,QAAvD;AACA;;AACD,iBAAK,oBAAL;AACC,mBAAK0B,eAAL;AACA;;AACD,iBAAK,eAAL;AACC,mBAAKC,cAAL;AACA;;AACD,iBAAK,QAAL;AACC,mBAAKC,mBAAL;AACA;;AACD,iBAAK,aAAL;AACC,mBAAKC,gBAAL;AACA;;AACD,iBAAK,SAAL;AACC,mBAAKC,WAAL;AACA;;AACD,iBAAK,UAAL;AACC,mBAAKC,cAAL;AACA;AApCF;AAsCA;;AAESC,QAAAA,MAAM,GAAS;AACxB,eAAK3D,YAAL,CAAkBS,aAAlB,CAAgCuC,MAAhC,GAAyC,KAAzC;AACA,eAAKhD,YAAL,CAAkBU,eAAlB,CAAkCsC,MAAlC,GAA2C,KAA3C;AACA,eAAKhD,YAAL,CAAkBW,cAAlB,CAAiCqC,MAAjC,GAA0C,KAA1C;AACA,eAAKhD,YAAL,CAAkBY,eAAlB,CAAkCoC,MAAlC,GAA2C,KAA3C;AACA,eAAKhD,YAAL,CAAkBa,cAAlB,CAAiCmC,MAAjC,GAA0C,KAA1C;AACA,eAAKhD,YAAL,CAAkBO,0BAAlB,CAA6CwC,IAA7C,CAAkDC,MAAlD,GAA2D,KAA3D;AACA,eAAKhD,YAAL,CAAkBI,oBAAlB,CAAuC2C,IAAvC,CAA4CC,MAA5C,GAAqD,KAArD;AACA,eAAKhD,YAAL,CAAkBkB,oBAAlB,CAAuC8B,MAAvC,GAAgD,KAAhD;AACA,eAAKhD,YAAL,CAAkBe,mBAAlB,CAAsCiC,MAAtC,GAA+C,KAA/C;AACA,eAAKhD,YAAL,CAAkBc,cAAlB,CAAiCkC,MAAjC,GAA0C,KAA1C;AAEA,eAAKhD,YAAL,CAAkBmB,kBAAlB,CAAqC6B,MAArC,GAA8C,KAA9C;AACA,eAAKhD,YAAL,CAAkBmB,kBAAlB,CAAqCyC,iBAArC;AAEA,eAAK5D,YAAL,CAAkBI,oBAAlB,CAAuC2C,IAAvC,CAA4Cc,YAA5C,CAAyDtF,SAAzD,EAAoEuF,OAApE;AAEA,eAAKR,cAAL;AACA;;AAEOC,QAAAA,mBAAmB,GAAG;AAC7B,eAAKvD,YAAL,CAAkBS,aAAlB,CAAgCuC,MAAhC,GAAyC,KAAK3B,KAAL,CAAWU,MAAX,KAAsB;AAAA;AAAA,8CAAcgC,IAA7E;AACA,eAAK/D,YAAL,CAAkBU,eAAlB,CAAkCsC,MAAlC,GAA2C,KAAK3B,KAAL,CAAWU,MAAX,KAAsB;AAAA;AAAA,8CAAciC,SAA/E;AACA,eAAKhE,YAAL,CAAkBW,cAAlB,CAAiCqC,MAAjC,GAA0C,KAAK3B,KAAL,CAAWU,MAAX,KAAsB;AAAA;AAAA,8CAAckC,IAA9E;AACA,eAAKjE,YAAL,CAAkBY,eAAlB,CAAkCoC,MAAlC,GAA2C,KAAK3B,KAAL,CAAWU,MAAX,KAAsB;AAAA;AAAA,8CAAcmC,OAA/E;AACA,eAAKlE,YAAL,CAAkBa,cAAlB,CAAiCmC,MAAjC,GAA0C,KAAK3B,KAAL,CAAWU,MAAX,KAAsB;AAAA;AAAA,8CAAcoC,IAA9E,CAL6B,CAO7B;;AACA,eAAKnE,YAAL,CAAkBC,cAAlB,CAAiCmE,SAAjC,GAA6C,KAAK/C,KAAL,CAAWU,MAAX,KAAsB;AAAA;AAAA,8CAAcmC,OAAjF;;AAEA,cAAI,KAAK7C,KAAL,CAAWU,MAAX,KAAsB;AAAA;AAAA,8CAAcmC,OAAxC,EAAiD;AAChD,aAAC;AAAA;AAAA,kCAAOG,WAAR,IAAuB,KAAKC,aAAL,EAAvB;AACA,aAAC;AAAA;AAAA,kCAAOD,WAAR,IAAuB;AAAA;AAAA,2CAAvB;AACA,WAHD,MAGO,IAAI,KAAKhD,KAAL,CAAWU,MAAX,KAAsB;AAAA;AAAA,8CAAciC,SAAxC,EAAmD;AACzD,aAAC;AAAA;AAAA,kCAAOK,WAAR,IAAuB;AAAA;AAAA,yCAAvB;AACA,WAFM,MAEA,IAAI,KAAKhD,KAAL,CAAWU,MAAX,KAAsB;AAAA;AAAA,8CAAcgC,IAAxC,EAA8C;AACpD,aAAC;AAAA;AAAA,kCAAOM,WAAR,IAAuB;AAAA;AAAA,2CAAvB;AACA;AACD;;AAEOhB,QAAAA,eAAe,GAAG;AACzB,gBAAMrB,kBAAkB,GAAG,KAAKX,KAAL,CAAWW,kBAAtC;;AACA,cAAIA,kBAAkB,IAAIA,kBAAkB,CAACE,SAAnB,KAAiC,KAAKb,KAAL,CAAWa,SAAlE,IAA+EF,kBAAkB,CAACuC,SAAnB,GAA+B,CAAlH,EAAqH;AACpH,iBAAKvE,YAAL,CAAkBO,0BAAlB,CAA6CwC,IAA7C,CAAkDC,MAAlD,GAA2D,IAA3D;AACA,iBAAKhD,YAAL,CAAkBO,0BAAlB,CAA6C2C,MAA7C,GAAsDlB,kBAAkB,CAACuC,SAAnB,GAA+B,EAA/B,GAAoC,MAAMvC,kBAAkB,CAACuC,SAA7D,GAAyEvC,kBAAkB,CAACuC,SAAnB,GAA+B,EAA9J;AACA,WAHD,MAGO;AACN,iBAAKvE,YAAL,CAAkBO,0BAAlB,CAA6CwC,IAA7C,CAAkDC,MAAlD,GAA2D,KAA3D;AACA;AACD;;AAEOM,QAAAA,cAAc,GAAG;AACxB,gBAAMnB,aAAa,GAAG,KAAKd,KAAL,CAAWU,MAAX,KAAsB;AAAA;AAAA,8CAAcmC,OAApC,GAA8C,KAAK7C,KAAL,CAAWc,aAAzD,GAAyE,CAA/F;AACA,eAAKnC,YAAL,CAAkBiB,4BAAlB,CAA+CuD,QAA/C,CAAwDC,OAAxD,CAAgE,CAACC,CAAD,EAAIC,CAAJ,KAAU;AACzE,gBAAIxC,aAAa,GAAG,CAApB,EAAuB;AACtBuC,cAAAA,CAAC,CAAC1B,MAAF,GAAW2B,CAAC,GAAG,CAAJ,IAASxC,aAApB;AACA,aAFD,MAEO;AACNuC,cAAAA,CAAC,CAAC1B,MAAF,GAAW,KAAX;AACA;AACD,WAND;AAOA;AAED;;;AACQsB,QAAAA,aAAa,GAAG;AACvB,gBAAMM,MAAM,GAAG,KAAKrC,MAAL,CAAYC,iBAAZ,EAAf;AACA,eAAKxC,YAAL,CAAkBiB,4BAAlB,CAA+CuD,QAA/C,CAAwDK,MAAxD,GAAiEC,MAAjE,CAAwEJ,CAAC,IAAIA,CAAC,CAAC1B,MAA/E,EAAuFyB,OAAvF,CAA+FC,CAAC,IAAI;AACnG,kBAAMK,OAAO,GAAGlG,WAAW,CAAC6F,CAAD,CAA3B;AACA,iBAAK1E,YAAL,CAAkBiB,4BAAlB,CAA+C+D,QAA/C,CAAwDD,OAAxD;AACAL,YAAAA,CAAC,CAAC1B,MAAF,GAAW,KAAX;AACAlE,YAAAA,KAAK,CAACiG,OAAD,CAAL,CAAeE,EAAf,CAAkB,GAAlB,EAAuB;AAAEC,cAAAA,aAAa,EAAEN;AAAjB,aAAvB,EAAkDO,UAAlD,GAA+D1C,KAA/D;AACA,WALD;AAMA;AAED;AACD;AACA;AACA;AACA;;;AACQ2C,QAAAA,mBAAmB,CAACC,KAAD,EAAgB;AACzC,iBAAO,KAAKrF,YAAL,CAAkBiB,4BAAlB,CAA+CqE,cAA/C,CAA8D,qBAAqBD,KAAnF,EAA0FE,gBAA1F,EAAP;AACA;AAED;;;AACOC,QAAAA,uBAAuB,GAAG;AAChC,iBAAO,KAAKxF,YAAL,CAAkBC,cAAlB,CAAiC8C,IAAjC,CAAsCwC,gBAAtC,EAAP;AACA;;AAEOtC,QAAAA,gBAAgB,GAAG;AAC1B,cAAI;AAAA;AAAA,wCAAWwC,OAAX,KAAuB,KAAKpE,KAAL,CAAWC,UAAtC,EAAkD;AACjD,iBAAKoE,SAAL;AACA;AACD;AAED;;;AACQlC,QAAAA,gBAAgB,GAAG;AAC1B,gBAAMpB,WAAW,GAAG,KAAKf,KAAL,CAAWe,WAA/B;;AACA,cAAIA,WAAW,IAAIA,WAAW,CAACF,SAAZ,KAA0B,KAAKb,KAAL,CAAWa,SAAxD,EAAmE;AAClE,kBAAMJ,OAAO,GAAGM,WAAW,CAACN,OAA5B;AACA,iBAAK9B,YAAL,CAAkBI,oBAAlB,CAAuC2C,IAAvC,CAA4CC,MAA5C,GAAqDlB,OAAO,IAAI,CAAhE;AACA,iBAAK9B,YAAL,CAAkBI,oBAAlB,CAAuC8C,MAAvC,GAAgDpB,OAAO,GAAG,CAAV,GAAc,MAAMA,OAAO,CAACsB,sBAAR,CAA+B,IAA/B,CAApB,GAA2DtB,OAAO,CAACsB,sBAAR,CAA+B,IAA/B,CAA3G;AACA,iBAAKuC,WAAL,CAAiB,KAAK3F,YAAL,CAAkBI,oBAAlB,CAAuC2C,IAAxD;AACA,WALD,MAKO;AACN,iBAAK/C,YAAL,CAAkBI,oBAAlB,CAAuC2C,IAAvC,CAA4CC,MAA5C,GAAqD,KAArD;AACA;AACD;;AAEO2C,QAAAA,WAAW,CAACC,QAAD,EAAiB;AACnCA,UAAAA,QAAQ,CAACC,WAAT,CAAqB,KAAK7F,YAAL,CAAkBG,gBAAlB,CAAmC4C,IAAnC,CAAwC+C,WAAxC,EAArB;AACA,gBAAMlB,MAAM,GAAG,IAAIjG,IAAJ,CAASiH,QAAQ,CAACG,QAAT,CAAkBC,CAA3B,EAA8BJ,QAAQ,CAACG,QAAT,CAAkBE,CAAlB,GAAsB,EAApD,CAAf;AACAnH,UAAAA,KAAK,CAAC8G,QAAD,CAAL,CAAgBM,IAAhB,GAAuBjB,EAAvB,CAA0B,CAA1B,EAA6B;AAAEc,YAAAA,QAAQ,EAAEnB;AAAZ,WAA7B,EAAmDuB,KAAnD,CAAyD,GAAzD,EAA8DC,IAA9D,GAAqE3D,KAArE;AACA;;AAEOgB,QAAAA,WAAW,GAAG;AACrB,eAAKzD,YAAL,CAAkBmB,kBAAlB,CAAqCyC,iBAArC;;AACA,cAAI,KAAKvC,KAAL,CAAWQ,OAAX,CAAmBwE,MAAnB,KAA8B,CAAlC,EAAqC;AACpC,iBAAKrG,YAAL,CAAkBkB,oBAAlB,CAAuC8B,MAAvC,GAAgD,KAAhD;AACA,iBAAKhD,YAAL,CAAkBmB,kBAAlB,CAAqC6B,MAArC,GAA8C,KAA9C;AACA,WAHD,MAGO;AACN,iBAAKhD,YAAL,CAAkBmB,kBAAlB,CAAqC6B,MAArC,GAA8C,IAA9C;AACA,iBAAKsD,WAAL;AACA,kBAAMC,SAAS,GAAG,KAAKlF,KAAL,CAAWQ,OAAX,CAAmB2E,GAAnB,CAAuB9B,CAAC,IAAI;AAAA;AAAA,4CAAYA,CAAZ,CAA5B,CAAlB;AACA,kBAAM+B,MAAM,GAAG;AAAA;AAAA,4DAAoBF,SAApB,CAAf;AACAE,YAAAA,MAAM,CAAChC,OAAP,CAAe,CAACC,CAAD,EAAIC,CAAJ,KAAU;AACxB,mBAAK+B,QAAL,CAAchC,CAAd;AACAC,cAAAA,CAAC,KAAK,CAAN,KAAY,KAAK3E,YAAL,CAAkBK,oBAAlB,CAAuC6C,MAAvC,GAAgDwB,CAAC,CAACiC,GAAF,GAAQ,EAApE;AACA,oBAAMC,QAAQ,GAAGlC,CAAC,CAAC6B,SAAF,CAAYF,MAAZ,KAAuB,CAAvB,GAA2B,GAA3B,GAAiC3B,CAAC,CAACiC,GAAF,GAAQ,EAA1D;AACAhC,cAAAA,CAAC,KAAK,CAAN,KAAY,KAAK3E,YAAL,CAAkBM,qBAAlB,CAAwC4C,MAAxC,GAAiD0D,QAA7D;AACA,aALD;AAMA;AACD;AAED;;;AACQN,QAAAA,WAAW,GAAG;AACrB,gBAAMO,WAAW,GAAG,KAAK7G,YAAL,CAAkBkB,oBAAtC;AACA2F,UAAAA,WAAW,CAACC,QAAZ,CAAqB,IAAInI,IAAJ,CAAS,CAAT,EAAY,CAAZ,CAArB;AACAkI,UAAAA,WAAW,CAAC7D,MAAZ,GAAqB,IAArB;AACAlE,UAAAA,KAAK,CAAC+H,WAAD,CAAL,CAAmB5B,EAAnB,CAAsB,GAAtB,EAA2B;AAAE8B,YAAAA,KAAK,EAAE,IAAIpI,IAAJ,CAAS,CAAT,EAAY,CAAZ;AAAT,WAA3B,EAAsD8D,KAAtD;AACA;;AAEOiE,QAAAA,QAAQ,CAACM,SAAD,EAAuB;AACtC,gBAAMC,SAAS,GAAGpI,WAAW,CAAC,KAAKmB,YAAL,CAAkBoB,WAAnB,CAA7B;AACA6F,UAAAA,SAAS,CAACjE,MAAV,GAAmB,IAAnB;AACAiE,UAAAA,SAAS,CAACrD,iBAAV;AACA,eAAK5D,YAAL,CAAkBmB,kBAAlB,CAAqC6D,QAArC,CAA8CiC,SAA9C;AACAD,UAAAA,SAAS,CAACT,SAAV,CAAoB9B,OAApB,CAA4BC,CAAC,IAAI,KAAKwC,cAAL,CAAoBxC,CAApB,EAAuBuC,SAAvB,CAAjC;AACA;;AAEOC,QAAAA,cAAc,CAACC,QAAD,EAAqBC,UAArB,EAAuC;AAC5D,gBAAMC,IAAI,GAAG;AAAA;AAAA,gDAAoBC,SAApB,CAA8B;AAAA;AAAA,4DAAsBC,OAAtB,CAA8B;AAAA;AAAA,oDAAiBC,sBAA/C,EAAuEC,MAArG,EAA6GC,QAA7G,CAAsHN,UAAtH,EACXO,QADW,CACF;AACTC,YAAAA,MAAM,EAAET,QAAQ,CAACS,MADR;AAETC,YAAAA,QAAQ,EAAEV,QAAQ,CAACU;AAFV,WADE,EAKXC,OALW,EAAb;AAMAT,UAAAA,IAAI,CAACU,IAAL,CAAUjB,QAAV,CAAmB,GAAnB;AACAO,UAAAA,IAAI,CAACU,IAAL,CAAUC,QAAV,CAAmB,IAAnB;AACA;;AAEOtE,QAAAA,cAAc,GAAG;AACxB,gBAAMZ,KAAK,GAAG;AAAA;AAAA,gCAAOmF,SAAP,CAAiBC,IAAjB,CAAsBxD,CAAC,IAAIA,CAAC,CAACrC,QAAF,KAAe,KAAKhB,KAAL,CAAWgB,QAArD,CAAd;;AAEA,cAAIS,KAAJ,EAAW;AACV,iBAAK9C,YAAL,CAAkBkB,oBAAlB,CAAuC8B,MAAvC,GAAgD,KAAhD;AACA,iBAAKhD,YAAL,CAAkBe,mBAAlB,CAAsCiC,MAAtC,GAA+C,IAA/C;AACA,iBAAKhD,YAAL,CAAkBe,mBAAlB,CAAsC8C,YAAtC,CAAmDnF,MAAnD,EAA2DyJ,WAA3D,GAAyE;AAAA;AAAA,8DAAsBZ,OAAtB,CAA8BzE,KAAK,CAACqF,WAApC,EAAiDV,MAA1H;AACA,WAJD,MAIO;AACN,iBAAKzH,YAAL,CAAkBe,mBAAlB,CAAsCiC,MAAtC,GAA+C,KAA/C;AACA;AACD;;AAEM0C,QAAAA,SAAS,GAAG,CAClB;;AAED0C,QAAAA,MAAM,CAACC,SAAD,EAAoB,CAEzB;;AApRyE,O","sourcesContent":["import { Animation, Label, Node, Sprite, UITransform, Vec2, Vec3, _decorator, instantiate, tween } from 'cc';\r\nimport { BaseComponent } from '../../../base/BaseComponent';\r\nimport config from '../config';\r\nimport { DeskStatus, Countdown, OperationType, Player, BalanceInfo, genCardItem, CardItem, CardGroup, CardType } from '../type';\r\nimport { global } from '../../../hall';\r\nimport { getOptimalCardGroup } from '../qiuqiu_tool';\r\nimport CardViewModel from '../viewModel/CardViewModel';\r\nimport { playAllin, playFangqi, playGuoPai, playTuoAllin, sourceManageSeletor } from '../index';\r\nimport { PrefabPathDefine } from '../sourceDefine/prefabDefine';\r\nconst { ccclass, property } = _decorator;\r\n\r\nexport interface IState {\r\n}\r\n\r\nexport interface IProps {\r\n\tdeskStatus: DeskStatus,\r\n\tuid: string,\r\n\tnickName: string,\r\n\tgold: number,\r\n\ticon: number,\r\n\tisDealer: boolean,\r\n\tisReady: boolean,\r\n\tresults: number[],\r\n\twinloss: number,\r\n\topType: OperationType,\r\n\toperationCountdown: Countdown,\r\n\t/**当前正激活等待的用户 */\r\n\tcurrActiveSeatIndex: number,\r\n\t/**当前座位号 */\r\n\tseatIndex: number\r\n\t/**发牌的数量 */\r\n\tdealCardCount: number,\r\n\t/**结算信息 */\r\n\tbalanceInfo: BalanceInfo,\r\n\t/**牌类型 */\r\n\tcardType: CardType,\r\n}\r\nexport interface IEvent {\r\n\tgetHealerPosition: () => Vec3;\r\n}\r\n\r\n@ccclass('Qiuqiu_Opponent')\r\nexport class Qiuqiu_Opponent extends BaseComponent<IState, IProps, IEvent> {\r\n\tstart() {\r\n\r\n\t}\r\n\r\n\tprotected propertyNode = {\r\n\t\tprops_spr_head: new Sprite(),\r\n\t\tprops_label_name: new Label(),\r\n\t\tprops_label_gold: new Label(),\r\n\t\tprops_label_gold_add: new Label(),\r\n\t\tprops_label_left_num: new Label(),\r\n\t\tprops_label_right_num: new Label(),\r\n\t\tprops_label_countDown_time: new Label(),\r\n\t\tprops_spr_banker: new Node(),\r\n\t\tprops_spr_cek: new Node(),\r\n\t\tprops_spr_allin: new Node(),\r\n\t\tprops_spr_naik: new Node(),\r\n\t\tprops_spr_balik: new Node(),\r\n\t\tprops_spr_ikut: new Node(),\r\n\t\tprops_btn_gift: new Node(),\r\n\t\tprops_quiqui_ending: new Node(),\r\n\t\tprops_layout_result_card: new Node(),\r\n\t\tprops_Layout_cards_handCards: new Node(),\r\n\t\tprops_layout_cardnum: new Node(),\r\n\t\tprops_card_results: new Node(),\r\n\t\tprops_cards: new Node(),\r\n\t}\r\n\r\n\tpublic props: IProps = {\r\n\t\tdeskStatus: null,\r\n\t\tuid: null,\r\n\t\tnickName: null,\r\n\t\tgold: 0,\r\n\t\ticon: -1,\r\n\t\tisDealer: null,\r\n\t\tisReady: null,\r\n\t\tresults: [],\r\n\t\twinloss: 0,\r\n\t\topType: null,\r\n\t\toperationCountdown: null,\r\n\t\t/**当前正激活等待的用户 */\r\n\t\tcurrActiveSeatIndex: -1,\r\n\t\tseatIndex: -1,\r\n\t\tdealCardCount: 0,\r\n\t\tbalanceInfo: null,\r\n\t\tcardType: CardType.DISERSE,\r\n\t}\r\n\r\n\tpublic events: IEvent = {\r\n\t\tgetHealerPosition: () => { return null }\r\n\t}\r\n\r\n\tprotected initState() {\r\n\t\treturn {\r\n\r\n\t\t}\r\n\t}\r\n\r\n\tprotected bindEvent(): void {\r\n\t}\r\n\r\n\tprotected useProps(key: keyof IProps, value: { pre: any, cur: any }) {\r\n\t\tswitch (key) {\r\n\t\t\tcase 'uid':\r\n\t\t\t\tthis.node.active = this.props.uid !== '';\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'deskStatus':\r\n\t\t\t\tthis.updateDeskStatus();\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'nickName':\r\n\t\t\t\tthis.propertyNode.props_label_name.string = this.props.nickName;\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'icon':\r\n\t\t\t\tglobal.loadHeadSprite(this.props.icon, this.propertyNode.props_spr_head);\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'gold':\r\n\t\t\t\tthis.propertyNode.props_label_gold.string = this.props.gold.formatAmountWithLetter(true);\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'isDealer':\r\n\t\t\t\tthis.propertyNode.props_spr_banker.active = this.props.isDealer;\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'operationCountdown':\r\n\t\t\t\tthis.updateCountdown();\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'dealCardCount':\r\n\t\t\t\tthis.updateDealCard();\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'opType':\r\n\t\t\t\tthis.updateOperationType();\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'balanceInfo':\r\n\t\t\t\tthis.playAddGoldAnime();\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'results':\r\n\t\t\t\tthis.updateCards();\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'cardType':\r\n\t\t\t\tthis.updateCardType();\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\t}\r\n\r\n\tprotected bindUI(): void {\r\n\t\tthis.propertyNode.props_spr_cek.active = false;\r\n\t\tthis.propertyNode.props_spr_allin.active = false;\r\n\t\tthis.propertyNode.props_spr_naik.active = false;\r\n\t\tthis.propertyNode.props_spr_balik.active = false;\r\n\t\tthis.propertyNode.props_spr_ikut.active = false;\r\n\t\tthis.propertyNode.props_label_countDown_time.node.active = false;\r\n\t\tthis.propertyNode.props_label_gold_add.node.active = false;\r\n\t\tthis.propertyNode.props_layout_cardnum.active = false;\r\n\t\tthis.propertyNode.props_quiqui_ending.active = false;\r\n\t\tthis.propertyNode.props_btn_gift.active = false;\r\n\r\n\t\tthis.propertyNode.props_card_results.active = false;\r\n\t\tthis.propertyNode.props_card_results.removeAllChildren();\r\n\r\n\t\tthis.propertyNode.props_label_gold_add.node.getComponent(Animation).destroy();\r\n\r\n\t\tthis.updateDealCard();\r\n\t}\r\n\r\n\tprivate updateOperationType() {\r\n\t\tthis.propertyNode.props_spr_cek.active = this.props.opType === OperationType.PASS;\r\n\t\tthis.propertyNode.props_spr_allin.active = this.props.opType === OperationType.SHOW_HAND;\r\n\t\tthis.propertyNode.props_spr_naik.active = this.props.opType === OperationType.FILL;\r\n\t\tthis.propertyNode.props_spr_balik.active = this.props.opType === OperationType.GIVE_UP;\r\n\t\tthis.propertyNode.props_spr_ikut.active = this.props.opType === OperationType.CALL;\r\n\r\n\t\t// 弃牌了头像灰色\r\n\t\tthis.propertyNode.props_spr_head.grayscale = this.props.opType === OperationType.GIVE_UP;\r\n\r\n\t\tif (this.props.opType === OperationType.GIVE_UP) {\r\n\t\t\t!config.isReconnect && this.cardFlyHealer();\r\n\t\t\t!config.isReconnect && playFangqi();\r\n\t\t} else if (this.props.opType === OperationType.SHOW_HAND) {\r\n\t\t\t!config.isReconnect && playAllin();\r\n\t\t} else if (this.props.opType === OperationType.PASS) {\r\n\t\t\t!config.isReconnect && playGuoPai();\r\n\t\t}\r\n\t}\r\n\r\n\tprivate updateCountdown() {\r\n\t\tconst operationCountdown = this.props.operationCountdown;\r\n\t\tif (operationCountdown && operationCountdown.seatIndex === this.props.seatIndex && operationCountdown.countdown > 0) {\r\n\t\t\tthis.propertyNode.props_label_countDown_time.node.active = true;\r\n\t\t\tthis.propertyNode.props_label_countDown_time.string = operationCountdown.countdown < 10 ? '0' + operationCountdown.countdown : operationCountdown.countdown + '';\r\n\t\t} else {\r\n\t\t\tthis.propertyNode.props_label_countDown_time.node.active = false;\r\n\t\t}\r\n\t}\r\n\r\n\tprivate updateDealCard() {\r\n\t\tconst dealCardCount = this.props.opType !== OperationType.GIVE_UP ? this.props.dealCardCount : 0;\r\n\t\tthis.propertyNode.props_Layout_cards_handCards.children.forEach((v, i) => {\r\n\t\t\tif (dealCardCount > 0) {\r\n\t\t\t\tv.active = i + 1 <= dealCardCount;\r\n\t\t\t} else {\r\n\t\t\t\tv.active = false;\r\n\t\t\t}\r\n\t\t})\r\n\t}\r\n\r\n\t/**牌飞向荷官 */\r\n\tprivate cardFlyHealer() {\r\n\t\tconst endPos = this.events.getHealerPosition();\r\n\t\tthis.propertyNode.props_Layout_cards_handCards.children.concat().filter(v => v.active).forEach(v => {\r\n\t\t\tconst flyNode = instantiate(v)\r\n\t\t\tthis.propertyNode.props_Layout_cards_handCards.addChild(flyNode);\r\n\t\t\tv.active = false;\r\n\t\t\ttween(flyNode).to(0.2, { worldPosition: endPos }).removeSelf().start();\r\n\t\t})\r\n\t}\r\n\r\n\t/**\r\n\t * 获得手牌位置\r\n\t * @param index 第几张牌， 从1开始 \r\n\t * @returns \r\n\t */\r\n\tpublic getHandCardPosition(index: number) {\r\n\t\treturn this.propertyNode.props_Layout_cards_handCards.getChildByName('spr_handCards_Bg' + index).getWorldPosition();\r\n\t}\r\n\r\n\t/**获得飞筹码开始位置 */\r\n\tpublic getFlyChipStartPosition() {\r\n\t\treturn this.propertyNode.props_spr_head.node.getWorldPosition();\r\n\t}\r\n\r\n\tprivate updateDeskStatus() {\r\n\t\tif (DeskStatus.WAITING === this.props.deskStatus) {\r\n\t\t\tthis.clearData();\r\n\t\t}\r\n\t}\r\n\r\n\t/**播放添加金币的动画 */\r\n\tprivate playAddGoldAnime() {\r\n\t\tconst balanceInfo = this.props.balanceInfo\r\n\t\tif (balanceInfo && balanceInfo.seatIndex === this.props.seatIndex) {\r\n\t\t\tconst winloss = balanceInfo.winloss;\r\n\t\t\tthis.propertyNode.props_label_gold_add.node.active = winloss != 0;\r\n\t\t\tthis.propertyNode.props_label_gold_add.string = winloss > 0 ? '+' + winloss.formatAmountWithLetter(true) : winloss.formatAmountWithLetter(true);\r\n\t\t\tthis.playAddGold(this.propertyNode.props_label_gold_add.node);\r\n\t\t} else {\r\n\t\t\tthis.propertyNode.props_label_gold_add.node.active = false;\r\n\t\t}\r\n\t}\r\n\r\n\tprivate playAddGold(goldNode: Node) {\r\n\t\tgoldNode.setPosition(this.propertyNode.props_label_gold.node.getPosition());\r\n\t\tconst endPos = new Vec3(goldNode.position.x, goldNode.position.y + 50);\r\n\t\ttween(goldNode).show().to(1, { position: endPos }).delay(0.5).hide().start();\r\n\t}\r\n\r\n\tprivate updateCards() {\r\n\t\tthis.propertyNode.props_card_results.removeAllChildren();\r\n\t\tif (this.props.results.length === 0) {\r\n\t\t\tthis.propertyNode.props_layout_cardnum.active = false;\r\n\t\t\tthis.propertyNode.props_card_results.active = false;\r\n\t\t} else {\r\n\t\t\tthis.propertyNode.props_card_results.active = true;\r\n\t\t\tthis.showCardNum();\r\n\t\t\tconst cardItems = this.props.results.map(v => genCardItem(v));\r\n\t\t\tconst groups = getOptimalCardGroup(cardItems);\r\n\t\t\tgroups.forEach((v, i) => {\r\n\t\t\t\tthis.addCards(v);\r\n\t\t\t\ti === 0 && (this.propertyNode.props_label_left_num.string = v.sum + '');\r\n\t\t\t\tconst rightNum = v.cardItems.length === 1 ? '?' : v.sum + '';\r\n\t\t\t\ti === 1 && (this.propertyNode.props_label_right_num.string = rightNum);\r\n\t\t\t})\r\n\t\t}\r\n\t}\r\n\r\n\t/**显示数字面板 */\r\n\tprivate showCardNum() {\r\n\t\tconst cardnumNode = this.propertyNode.props_layout_cardnum;\r\n\t\tcardnumNode.setScale(new Vec3(0, 0));\r\n\t\tcardnumNode.active = true;\r\n\t\ttween(cardnumNode).to(0.2, { scale: new Vec3(1, 1) }).start();\r\n\t}\r\n\r\n\tprivate addCards(cardGroup: CardGroup) {\r\n\t\tconst cardsNode = instantiate(this.propertyNode.props_cards);\r\n\t\tcardsNode.active = true;\r\n\t\tcardsNode.removeAllChildren();\r\n\t\tthis.propertyNode.props_card_results.addChild(cardsNode);\r\n\t\tcardGroup.cardItems.forEach(v => this.createCardView(v, cardsNode))\r\n\t}\r\n\r\n\tprivate createCardView(cardItem: CardItem, parentNode: Node) {\r\n\t\tconst view = new CardViewModel().mountView(sourceManageSeletor().getFile(PrefabPathDefine.prefabs_quiqui_bigCard).source).appendTo(parentNode)\r\n\t\t\t.setProps({\r\n\t\t\t\tupFace: cardItem.upFace,\r\n\t\t\t\tdownFace: cardItem.downFace\r\n\t\t\t})\r\n\t\t\t.connect();\r\n\t\tview.comp.setScale(0.6)\r\n\t\tview.comp.openCard(true);\r\n\t}\r\n\r\n\tprivate updateCardType() {\r\n\t\tconst value = config.cardTypes.find(v => v.cardType === this.props.cardType);\r\n\r\n\t\tif (value) {\r\n\t\t\tthis.propertyNode.props_layout_cardnum.active = false;\r\n\t\t\tthis.propertyNode.props_quiqui_ending.active = true;\r\n\t\t\tthis.propertyNode.props_quiqui_ending.getComponent(Sprite).spriteFrame = sourceManageSeletor().getFile(value.spriteFrame).source;\r\n\t\t} else {\r\n\t\t\tthis.propertyNode.props_quiqui_ending.active = false;\r\n\t\t}\r\n\t}\r\n\r\n\tpublic clearData() {\r\n\t}\r\n\r\n\tupdate(deltaTime: number) {\r\n\r\n\t}\r\n}\r\n\r\n"]}