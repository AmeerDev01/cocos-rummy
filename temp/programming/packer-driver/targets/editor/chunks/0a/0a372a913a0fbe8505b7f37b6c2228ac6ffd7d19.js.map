{"version":3,"sources":["file:///Users/geliang/web/dibai/hall/assets/script/subGame/PHOENIX111/components/phoenix_rollerIcon.ts"],"names":["_decorator","instantiate","Label","Node","sp","tween","UIOpacity","UITransform","Vec3","BaseComponent","GameType","IconEffectType","footerViewModel","sourceManageSeletor","SkeletalPathDefine","dataTransfer","DataKeyType","changeProfit","SkeletonAnimationPlayer","ccclass","property","phoenix_rollerIcon","isFirstShow","propertyNode","props_iconWrap","props_iconId","props_index","props_focusBorder","props_amount","props_Particle2D","props_yinbi","props_addOne","props","iconData","iconEffect","NONE","iconYuanBaoEffect","iconFreeGameEffect","viewGameType","isRollEnd","events","openTotalPanel","start","initState","bindEvent","useProps","key","value","uiTrasform","node","getComponent","width","height","iconNodeSprite","getChildByName","active","iconNode","Skeleton","skeletonData","getFile","uiData","fileName","source","animation","animationArr","setScale","scale","x","y","z","getPosition","setPosition","distance","string","iconId","queueIndex","id","isActive","cur","NORMAIL","LargeIcon","uiOpacity","t","repeatForever","to","opacity","skeletal","updateRenderer","stopAnimation","YUANBAO","console","log","TUBIAO_YUANBAO","showYinBi","delay","call","setSiblingIndex","FREEEGAMEZ","TUBIAO_SKELETON","playallPurpose","callBack","startWorldPos","worldPosition","targetWorldPos","comp","getPropertyNode","props_btn_down_putar","addChild","uiTransform","startLocalPos","convertToNodeSpaceAR","targetLocalPos","scheduleOnce","position","easing","destroy","props_word_down_winNum","dispatch","FREE_GAME_AMOUNT","bindUI","update","deltaTime"],"mappings":"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","sourcesContent":["import { _decorator, Component, debug, instantiate, Label, Node, bezier, ParticleSystem2D, Skeleton, sp, Sprite, tween, UIOpacity, UITransform, Vec3 } from 'cc';\r\nimport { BaseComponent } from '../../../base/BaseComponent';\r\nimport { GameType, IconEffectType, IconType } from '../type';\r\nimport { footerViewModel, sourceManageSeletor } from '../index';\r\nimport { SkeletalPathDefine } from '../sourceDefine/skeletalDefine';\r\nimport dataTransfer, { DataKeyType } from '../dataTransfer';\r\nimport BaseViewModel from '../../../common/viewModel/BaseViewModel';\r\nimport { PrefabPathDefine } from '../sourceDefine/prefabDefine';\r\nimport { EffectType } from '../../../utils/NodeIOEffect';\r\nimport { rollerPanelViewModel } from '../viewModel/GameBoardViewModel';\r\nimport { getNodePositionInCanvas } from '../../../utils/tool';\r\nimport { changeProfit, updateSubGameTimes } from '../store/actions/game';\r\nimport config from '../config';\r\nimport SkeletonAnimationPlayer from '../SkeletonPlay';\r\nconst { ccclass, property } = _decorator;\r\n\r\nexport interface IState {\r\n\r\n}\r\n\r\nexport interface IProps {\r\n\ticonData?: IconType\r\n\t/**将这个属性单拎出来，节约性能，不然每次都要重新初始化icon的界面 */\r\n\ticonEffect?: IconEffectType,\r\n\ticonYuanBaoEffect?: IconEffectType,\r\n\ticonFreeGameEffect?:IconEffectType,\r\n\tviewGameType: GameType,\r\n\tisRollEnd:boolean,\r\n}\r\nexport interface IEvent {\r\n\topenTotalPanel: () => void,\r\n\t\r\n}\r\n\r\n@ccclass('phoenix_rollerIcon')\r\nexport class phoenix_rollerIcon extends BaseComponent<IState, IProps, IEvent> {\r\n\tprivate isFirstShow: number = 0;\r\n\tstart() { \r\n\t}\r\n\r\n\tprotected propertyNode = {\r\n\t\tprops_iconWrap: new Node(),\r\n\t\tprops_iconId: new Label(),\r\n\t\tprops_index: new Label(),\r\n\t\tprops_focusBorder: new Node(),\r\n\t\tprops_amount: new Node(),\r\n\t\tprops_Particle2D: new Node(),\r\n\t\tprops_yinbi: new Node(),\r\n\t\tprops_addOne:new Node(),\r\n\t}\r\n\r\n\tpublic props: IProps = {\r\n\t\ticonData: null,\r\n\t\ticonEffect: IconEffectType.NONE,\r\n\t\ticonYuanBaoEffect: IconEffectType.NONE,\r\n\t\ticonFreeGameEffect: IconEffectType.NONE,\r\n\t\tviewGameType: GameType.NONE,\r\n\t\tisRollEnd: true,\r\n\t}\r\n\r\n\tpublic events: IEvent = {\r\n\t\topenTotalPanel: () => { },\r\n\t\t\r\n\t}\r\n\r\n\tprotected initState() {\r\n\t\treturn {\r\n\r\n\t\t}\r\n\t}\r\n\r\n\tprotected bindEvent(): void {\r\n\r\n\t}\r\n\r\n\tprotected useProps(key: keyof IProps, value: { pre: any, cur: any }) {\r\n\t\tif (key === \"iconData\") {\r\n\t\t\tconst uiTrasform = this.node.getComponent(UITransform)\r\n\t\t\tuiTrasform.width = this.props.iconData.width\r\n\t\t\tuiTrasform.height = this.props.iconData.height\r\n\t\t\t// const iconNodeSkeleton = this.propertyNode.props_iconWrap.getChildByName(\"iconNode_skeleton\")\r\n\t\t\tconst iconNodeSprite = this.propertyNode.props_iconWrap.getChildByName(\"iconNode_sprite\")\r\n\t\t\t// iconNodeSkeleton.active = false\r\n\t\t\ticonNodeSprite.active = false\r\n\r\n\t\t\tlet iconNode: Node\r\n\t\t\ticonNode = iconNodeSprite\r\n\t\t\ticonNodeSprite.active = true\r\n\t\t\ticonNodeSprite.getComponent(sp.Skeleton).skeletonData = sourceManageSeletor().getFile(this.props.iconData.uiData.fileName).source\r\n\t\t\ticonNodeSprite.getComponent(sp.Skeleton).animation = this.props.iconData.uiData.animationArr[0];\r\n\r\n\t\t\ticonNode.setScale(new Vec3(...this.props.iconData.uiData.scale))\r\n\t\r\n\t\t\tconst { x, y, z } = iconNode.getPosition()\r\n\t\t\ticonNode.setPosition(new Vec3(x + this.props.iconData.uiData.distance[0], y + this.props.iconData.uiData.distance[1], x))\r\n\t\t\tthis.propertyNode.props_iconId.string = this.props.iconData.iconId + \"\"\r\n\t\t\tthis.propertyNode.props_index.string = this.props.iconData.queueIndex + \"\";\r\n\t\t\t\r\n\t\t}\r\n\t\tif (key === \"iconEffect\") {\r\n\t\t\t//闪动框\r\n\t\t\tthis.isFirstShow++\r\n\t\t\t\r\n\t\t\tconst iconNodeSprite = this.propertyNode.props_iconWrap.getChildByName(\"iconNode_sprite\")\r\n\t\t\tif (this.props.iconData.uiData.id === 13) {\r\n\t\t\t\ticonNodeSprite.getComponent(sp.Skeleton).skeletonData = sourceManageSeletor().getFile(this.props.iconData.uiData.fileName).source\r\n\t\t\t}\r\n\t\t\t// if (this.props.iconData.uiData.id === 12 && this.isFirstShow === 1) {//初始展示特效\r\n\t\t\t\t// this.scheduleOnce(() => {\r\n\t\t\t\t// \t// this.propertyNode.props_Particle2D.active = true;\r\n\t\t\t\t// \tthis.propertyNode.props_amount.active = true;\r\n\t\t\t\t// },2.5)\r\n\t\t\t// }\r\n\t\t\tconst isActive = (value.cur === IconEffectType.NORMAIL && !this.props.iconData.LargeIcon )\r\n\t\t\tthis.propertyNode.props_focusBorder.active = isActive\r\n\t\t\tconst uiOpacity = this.propertyNode.props_focusBorder.getComponent(UIOpacity) as UIOpacity;\r\n\t\t\tif (isActive) {\r\n\r\n\t\t\t\t//闪动 repeatForever 重复执行一个动作\r\n\t\t\t\tconst t = tween(uiOpacity).repeatForever(tween().to(0.4, { opacity: 255 }).to(0.4, { opacity: 0 }));\r\n\t\t\t\tt.start();\r\n\t\t\t\t// this.activeAmount()\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tconst skeletal=iconNodeSprite.getComponent(sp.Skeleton)\r\n\t\t\tskeletal.updateRenderer()\r\n\t\t\tskeletal.animation = this.props.iconData.uiData.animationArr[isActive ? 1 : 0];\r\n\t\t\tconst { x, y, z } = iconNodeSprite.getPosition()\r\n\t\t\t// iconNodeSprite.setPosition(new Vec3(x + this.props.iconData.uiData.distance[0], y + this.props.iconData.uiData.distance[1], x))\r\n\t\t\tif (!isActive) {\r\n\t\t\t\tnew SkeletonAnimationPlayer(skeletal,\"animation\",false).stopAnimation()\r\n\t\t\t\t// this.propertyNode.props_amount.active = false;\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (key === \"iconYuanBaoEffect\") {\r\n\t\t\t//元宝闪动框\r\n\t\t\tconst iconNodeSprite = this.propertyNode.props_iconWrap.getChildByName(\"iconNode_sprite\")\r\n\t\t\tconst isActive = (value.cur === IconEffectType.YUANBAO && !this.props.iconData.LargeIcon);\r\n\t\t\tconsole.log(\"yuanbao\",isActive);\r\n\t\t\tconst skeletal=iconNodeSprite.getComponent(sp.Skeleton)\r\n\t\t\t\r\n\t\t\tskeletal.updateRenderer();\r\n\t\t\tskeletal.skeletonData = sourceManageSeletor().getFile(SkeletalPathDefine.TUBIAO_YUANBAO).source;\r\n\t\t\tskeletal.animation = this.props.iconData.uiData.animationArr[isActive ? 1 : 0];\r\n\t\t\tconst { x, y, z } = iconNodeSprite.getPosition();\r\n\t\t\ticonNodeSprite.setPosition(new Vec3(x + this.props.iconData.uiData.distance[0], y + this.props.iconData.uiData.distance[1], x))\r\n\t\t\tif (isActive) {\r\n\t\t\t\tthis.showYinBi()\r\n\t\t\t\ttween(iconNodeSprite).delay(1).call(() => { \r\n\t\t\t\t\t/**展示元宝中奖框 */\r\n\t\t\t\t\tif (!this.node) { return }\r\n\t\t\t\t\tthis.events.openTotalPanel()\r\n\t\t\t\t}).start()\r\n\t\t\t}else{\r\n\t\t\t\tnew SkeletonAnimationPlayer(skeletal,\"animation\",false).stopAnimation()\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (key === \"iconFreeGameEffect\") {\r\n\t\t\tif (!value.cur) { return }\r\n\t\t\t//转轴闪动框\r\n\t\t\tthis.node.setSiblingIndex(10)\r\n\t\t\tconst iconNodeSprite = this.propertyNode.props_iconWrap.getChildByName(\"iconNode_sprite\")\r\n\t\t\tconst isActive = (value.cur === IconEffectType.FREEEGAMEZ && !this.props.iconData.LargeIcon);\r\n\t\t\tconst skeletal=iconNodeSprite.getComponent(sp.Skeleton)\r\n\t\t\tskeletal.updateRenderer();\r\n\t\t\tskeletal.skeletonData = sourceManageSeletor().getFile(SkeletalPathDefine.TUBIAO_SKELETON).source;\r\n\t\t\tskeletal.animation = this.props.iconData.uiData.animationArr[isActive ? 1 : 0];\r\n\t\t\tconst { x, y, z } = iconNodeSprite.getPosition();\r\n\t\t\ticonNodeSprite.setPosition(new Vec3(x + this.props.iconData.uiData.distance[0], y + this.props.iconData.uiData.distance[1], x))\r\n\t\t\tif (!isActive) {\r\n\t\t\t\tnew SkeletonAnimationPlayer(skeletal,\"animation\",false).stopAnimation()\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tpublic playallPurpose(callBack) {\r\n\t\t\r\n\t\t// console.log(\"this.node\", this.node, this.propertyNode.props_Particle2D.active);\r\n\t\t// console.log(\"isFIRst\",this.isFirstShow);\r\n\t\t\r\n\t\tif (this.node && this.isFirstShow <= 0) {\r\n\t\t\tcallBack()\r\n\t\t\treturn\r\n\t\t};\r\n\t\tthis.propertyNode.props_amount.active = true;\r\n\r\n\t\t// 获取起始和目标的世界坐标\r\n\t\tlet startWorldPos = this.propertyNode.props_Particle2D.worldPosition;\r\n\t\t// console.log(footerViewModel.comp.getPropertyNode().props_btn_down_putar as Node);\r\n\t\t\r\n\t\tlet targetWorldPos = (footerViewModel.comp.getPropertyNode().props_btn_down_putar as Node).worldPosition;\r\n\t\t// 创建节点的实例\r\n\t\tlet node = instantiate(this.propertyNode.props_Particle2D);\r\n\t\t// 将节点添加到目标节点所在的父节点\r\n\t\tfooterViewModel.comp.node.addChild(node);\r\n\t\t// 获取父节点的 UITransform 组件\r\n\t\tlet uiTransform = footerViewModel.comp.node.getComponent(UITransform);\r\n\t\t// 将世界坐标转换为新父节点的局部坐标\r\n\t\tlet startLocalPos = uiTransform.convertToNodeSpaceAR(startWorldPos);\r\n\t\tlet targetLocalPos = uiTransform.convertToNodeSpaceAR(targetWorldPos);\r\n\t\t// 设置节点的初始位置\r\n\t\tnode.setPosition(startLocalPos);\r\n\t\tthis.propertyNode.props_Particle2D.active = false;\r\n\t\tthis.scheduleOnce(() => {\r\n\t\t\tthis.propertyNode.props_amount.active = false;\r\n\t\t},1)\r\n\t\t// 执行缓动动画\r\n\t\ttween(node)\r\n\t\t\t.to(1, { position: targetLocalPos }, { easing: 'sineInOut' })\r\n\t\t\t.call(() => {\r\n\t\t\t\tnode.destroy()\r\n\t\t\t\tcallBack()\r\n\t\t\t})\r\n\t\t\t.start();\r\n\r\n\t}\r\n\r\n\tpublic showYinBi() {\r\n\t\tthis.propertyNode.props_yinbi.active = true;\r\n\t\t// 获取起始和目标的世界坐标\r\n\t\tlet startWorldPos = this.propertyNode.props_yinbi.worldPosition;\r\n\t\t// console.log(footerViewModel.comp.getPropertyNode().props_btn_down_putar as Node);\r\n\t\t\r\n\t\tlet targetWorldPos = (footerViewModel.comp.getPropertyNode().props_word_down_winNum as Node).worldPosition;\r\n\t\t// 创建节点的实例\r\n\t\tlet node = instantiate(this.propertyNode.props_yinbi);\r\n\t\t// 将节点添加到目标节点所在的父节点\r\n\t\tfooterViewModel.comp.node.addChild(node);\r\n\t\t// 获取父节点的 UITransform 组件\r\n\t\tlet uiTransform = footerViewModel.comp.node.getComponent(UITransform);\r\n\t\t// 将世界坐标转换为新父节点的局部坐标\r\n\t\tlet startLocalPos = uiTransform.convertToNodeSpaceAR(startWorldPos);\r\n\t\tlet targetLocalPos = uiTransform.convertToNodeSpaceAR(targetWorldPos);\r\n\t\t// 设置节点的初始位置\r\n\t\tnode.setPosition(startLocalPos);\r\n\t\tthis.propertyNode.props_yinbi.active = false;\r\n\t\tthis.scheduleOnce(() => {\r\n\t\t\tthis.propertyNode.props_yinbi.active = false;\r\n\t\t},1)\r\n\t\r\n\t\t// 执行缓动动画\r\n\t\ttween(node)\r\n\t\t\t.to(1, { position: targetLocalPos }, { easing: 'sineInOut' })\r\n\t\t\t.call(() => {\r\n\t\t\t\tthis.dispatch( changeProfit(dataTransfer(DataKeyType.FREE_GAME_AMOUNT)) ); //更新盈亏\r\n\t\t\t\tnode.destroy()\r\n\t\t\t})\r\n\t\t\t.start();\r\n\t}\r\n\r\n\tprotected bindUI(): void {\r\n\t\tthis.propertyNode.props_amount.active = false;\r\n\t}\r\n\r\n\tupdate(deltaTime: number) {\r\n\r\n\t}\r\n}\r\n\r\n"]}