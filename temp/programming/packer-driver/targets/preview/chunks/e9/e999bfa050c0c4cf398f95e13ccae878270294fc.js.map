{"version":3,"sources":["file:///Users/geliang/web/dibai/hall/assets/script/subGame/phoenix/Slot/Repositories/SocketRepository.ts"],"names":["SocketRepository","sys","BaseRepository","initConfig","wsEnv","isTest","online","socketIp","localStorage","getItem","local1","local2","configUrl","constructor","userSwitch","userServerData","memberAssetGoldPieces","memberId","tableId","gameType","lv","rollerLaunchResult","otherGameAttributesVo","yuanBaoPosition","socketConfig","env","Promise","reslove","reject","then","response","item","gameConfig","find","id","gameId","Object","assign","ws","token"],"mappings":"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","sourcesContent":["import {sys} from \"cc\"\r\nimport {BaseRepository} from \"./BaseRepository\"\r\nimport {initConfig} from \"../../../../hall/config\"\r\n\r\nconst wsEnv = {\r\n    isTest: false,\r\n    online: {\r\n        socketIp: \"ws://54.251.66.82:15003/ws\",\r\n        \"token\": sys.localStorage.getItem(\"token\"),\r\n        \"gameId\": 10,\r\n        \"roomId\": \"1672958541691883522\"\r\n    },\r\n    local1: {\r\n        socketIp: \"ws://192.168.110.180:15007/ws\",\r\n        \"token\": \"eyJhbGciOiJIUzI1NiIsInppcCI6IkdaSVAifQ.H4sIAAAAAAAAAE3OSwoCMRBF0b3UOIH8q9I7cOwKKqbECNEgGTSIezftyOnlcXhvaDxhs4mQQnKYFcg-foFCtOYI99lgA19cJI5Fh2txOlhjdUnitKVLYZYaKyMo6NKLvE71INA5JL9goow5RFQwbs-HLM0Yu8azdTlP7uP_QfL58wW0590YlwAAAA.9BQAUrc0Nx-O8_g6jMcCtlCiWmzId9zaxOJoEy6slTs\",\r\n        \"gameId\": 10,\r\n        \"roomId\": \"1673666642699055106\"\r\n    },\r\n    local2: {\r\n        socketIp: \"ws://192.168.110.218:15007/ws\",\r\n        \"token\": \"eyJhbGciOiJIUzI1NiIsInppcCI6IkdaSVAifQ.H4sIAAAAAAAAAE2NQQoDIQwA_5KzQjQxmv1Bz32BuypYEJbioVD69630UuY2h5k39Dxhc5KUyKXoDdTX-RNKIks8ZocNOJSm6VDbqqhlZG_zEclKcw33oFyQwcCoY6_PW1mJqAlDpC-MK04GZh_1PvM4_58ew-cCIHa_h4kAAAA.T8633CWVFeRPedw7EOOzL5tA3fMs-jFcJE_gBwzwG5Q\",\r\n        \"gameId\": 10,\r\n        \"roomId\": \"1674774075278364674\"\r\n    }\r\n}\r\n\r\nconst configUrl = \"http://54.251.66.82:10001/hall/api/game/wsList\"\r\n\r\nexport class SocketRepository extends BaseRepository {\r\n    constructor() {\r\n        super()\r\n    }\r\n\r\n    public socketConfig(): Promise<{ socketIp: string, token: string, gameId: number, roomId: string }> {\r\n        const env = wsEnv.online\r\n        if (wsEnv.isTest) {\r\n            return new Promise((reslove, reject) => {\r\n                reslove(wsEnv.local2)\r\n            })\r\n        } else {\r\n            return new Promise((reslove, reject) => {\r\n                initConfig().then((response) => {\r\n                    const item = response.gameConfig.find(item => item.id === env.gameId)\r\n                    if (item) {\r\n                        reslove(Object.assign(env, {\r\n                            socketIp: item.ws,\r\n                            token: sys.localStorage.getItem(\"token\")\r\n                        }))\r\n                    } else {\r\n                        reject(\"gameID未找到\")\r\n                    }\r\n                })\r\n            })\r\n        }\r\n    }\r\n\r\n    /**用户下注的档位序号 */\r\n    public userSwitch: number = 1\r\n\r\n    public userServerData = {\r\n        memberAssetGoldPieces: 0,//10300000,\r\n        memberId: \"\",//\"1668156680288485378\",\r\n        tableId: \"\",//\"1660486324357214210\"\r\n        gameType: 0, //初始的游戏\r\n        lv: 0\r\n    }\r\n    /**下注之后获取的最后一次结果数据 */\r\n    public rollerLaunchResult = {\r\n        \"dl\": {\r\n            \"si\": [{\r\n                /**\r\n                 * 本轮结算之后的余额\r\n                 */\r\n                \"balanceAfterSettlement\": 0,\r\n                /**\r\n                 * 投注金额\r\n                 */\r\n                \"bettingGoldCoins\": 0,\r\n                /**\r\n                 * 换牌的ID及位置，ID指替换成哪张牌,位置为转轴ID和转轴上的位置。\r\n                 */\r\n                \"change\": {},\r\n                /**\r\n                 * 扣除下注金额之后的余额\r\n                 */\r\n                \"coinsAfterBetting\": 0,\r\n                /**\r\n                 * 转之前的余额\r\n                 */\r\n                \"coinsBeforeBetting\": 0,\r\n                /**\r\n                 * 剩余小游戏次数\r\n                 */\r\n                \"freeCount\": 0,\r\n                /**\r\n                 * 是否有小游戏\r\n                 */\r\n                \"freeGame\": {},\r\n                /**\r\n                 * 免费游戏赚的金币\r\n                 */\r\n                \"freeGameAmount\": 0,\r\n                /**\r\n                 * 当前游戏是什么游戏\r\n                 */\r\n                \"indexGameType\": 0,\r\n                /**\r\n                 * 凤凰图标倍数\r\n                 */\r\n                \"magnification\": 0,\r\n                /**\r\n                 * 下局游戏是什么游戏\r\n                 */\r\n                \"nextGameType\": 0,\r\n                /**\r\n                 *5条滚轴对应的道具ID\r\n                 */\r\n                \"rollerIcon\": [\r\n                    [8, 1, 3],\r\n                    [10,5, 12],\r\n                    [6, 2, 3],\r\n                    [4, 1, 2],\r\n                    [9, 4, 3]\r\n                ],\r\n                /**\r\n                 * 滚轴Id\r\n                 */\r\n                \"rollerId\": [\r\n                    37,\r\n                    49,\r\n                    33,\r\n                    15,\r\n                    2\r\n                ],\r\n                /**\r\n                 * 总奖励\r\n                 */\r\n                \"totalRewards\": 0,\r\n                /**\r\n                 * 是否有小游戏\r\n                 */\r\n                \"whetherFreeGame\": 0,\r\n                /**\r\n                 * 本轮中奖的道具及该道具对应的奖励金额\r\n                 */\r\n                \"winningAmount\": {},\r\n                /**\r\n                 * 中奖的道具ID以及位置，格式为：“中奖图标ID”[[滚轴id,滚轴上的图标ID]]\r\n                 */\r\n                \"winningPosition\": {},\r\n                otherGameAttributesVo: {\r\n                    /**\r\n                     * 小游戏次数\r\n                     */\r\n                    \"phoenixCount\":0,\r\n                    /**\r\n                     * 小游戏右上角次数\r\n                     */\r\n                    \"phoenixMagnification\":0,\r\n                    /**\r\n                     * 小游戏次数\r\n                     */\r\n                    \"totalFreeGameCount\":0,\r\n                    /**\r\n                     * 元宝数量\r\n                     */\r\n                    \"yuanBaoAmount\":0,\r\n                    /**\r\n                     * 元宝位置\r\n                     */\r\n                    yuanBaoPosition:[],\r\n                    /**\r\n                     * 元宝倍数\r\n                     */\r\n                    \"yuanBaoMagnification\":0,\r\n                    /**\r\n                     * 元宝是否展示弹窗\r\n                     */\r\n                    \"yuanBaoSpecialEffect\":false,\r\n                }\r\n            }]\r\n        }\r\n    }\r\n}\r\n"]}