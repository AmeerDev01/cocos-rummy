{"version":3,"sources":["file:///Users/geliang/web/dibai/hall/assets/script/subGame/godWealth/Slot/Component/GodWealth_DynamicNumber.ts"],"names":["_decorator","Font","Label","GodWealth_BaseComponent","ccclass","property","GodWealth_DynamicNumber","currNumber","fromNumber","time","cb","timer","targetNumber","start","window","setTimeout","update","deltaTime","bindEvent","onLoad","slef","labelObj","getComponent","Object","defineProperty","get","label","node","getChildByName","string","set","newValue","value","startEffect","bindUI","setFont","fontCode","fontSize","font","resetNumber","setOption","unitNum","toFixed","formatAmountWithCommas","dynamicNum","setInterval","clearInterval"],"mappings":"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","sourcesContent":["import { _decorator, Component, Font, Label, Node } from 'cc';\r\nimport GodWealth_BaseComponent from './GodWealth_BaseComponent';\r\nconst { ccclass, property } = _decorator;\r\n\r\n@ccclass('GodWealth_DynamicNumber')\r\nexport class GodWealth_DynamicNumber extends GodWealth_BaseComponent {\r\n\t@property(Font)\r\n\tfont1: Font = null\r\n\r\n\t@property(Font)\r\n\tfont2: Font = null\r\n\r\n\tprivate currNumber = 0\r\n\tprivate fromNumber: number = 0\r\n\tprivate time: number = 1000\r\n\tprivate cb: () => void\r\n\tprivate timer: number\r\n\tprivate targetNumber: number = 0\r\n\r\n\tstart() {\r\n\r\n\t\twindow.setTimeout(() => {\r\n\r\n\t\t}, 10)\r\n\t}\r\n\r\n\tupdate(deltaTime: number) {\r\n\r\n\t}\r\n\r\n\tprotected bindEvent(): void {\r\n\r\n\t}\r\n\r\n\tonLoad(): void {\r\n\t\tconst slef = this\r\n\t\tlet labelObj = this.getComponent(Label)\r\n\t\tObject.defineProperty(labelObj, \"string\", {\r\n\t\t\tget: function () {\r\n\t\t\t\tconst label = slef.node.getChildByName(\"number\").getComponent(Label)\r\n\t\t\t\t// return self.currNumber\r\n\t\t\t\treturn label.string\r\n\t\t\t},\r\n\t\t\tset: function (newValue) {\r\n\t\t\t\tif (newValue) {\r\n\t\t\t\t\tthis.value = newValue\r\n\t\t\t\t\t// const label = this.node.getChildByName(\"number\").getComponent(Label)\r\n\t\t\t\t\t// label.string = newValue\r\n\t\t\t\t\tslef.startEffect(+newValue)\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t})\r\n\t}\r\n\r\n\tprotected bindUI(): void {\r\n\r\n\t}\r\n\r\n\tpublic setFont(fontCode: 'font1' | 'font2', fontSize: number) {\r\n\t\tconst label = this.node.getComponent(Label)\r\n\t\tlabel.font = this[fontCode]\r\n\t\tlabel.fontSize = fontSize\r\n\t}\r\n\r\n\tpublic resetNumber() {\r\n\t\tthis.fromNumber = 0\r\n\t}\r\n\r\n\tpublic setOption(fromNumber: number, time: number, cb: () => void) {\r\n\t\tthis.fromNumber = fromNumber\r\n\t\tthis.time = time\r\n\t\tthis.cb = cb\r\n\t}\r\n\t/**数字渐变效果 */\r\n\tprivate startEffect(targetNumber: number) {\r\n\t\tthis.targetNumber = targetNumber\r\n\t\tconst label = this.node.getChildByName(\"number\").getComponent(Label)\r\n\t\t// if (this.timer) {\r\n\t\t// \t// 如果有在进行的动作\r\n\t\t// \tlabel.string = this.targetNumber.formatAmountWithCommas()\r\n\t\t// \tthis.fromNumber = this.targetNumber\r\n\t\t// \twindow.clearInterval(this.timer)\r\n\t\t// \tthis.timer = 0\r\n\t\t// \treturn\r\n\t\t// }\r\n\r\n\t\t//每20毫秒要增加的数字\r\n\t\tconst unitNum = +((this.targetNumber - this.fromNumber) * 20 / this.time).toFixed(0)\r\n\t\tif (unitNum <= 0) {\r\n\t\t\tlabel.string = this.targetNumber.formatAmountWithCommas()\r\n\t\t\tthis.fromNumber = this.targetNumber\r\n\t\t\treturn\r\n\t\t}\r\n\t\tlet dynamicNum = this.fromNumber\r\n\t\t!this.timer && (this.timer = window.setInterval(() => {\r\n\t\t\tdynamicNum += unitNum\r\n\t\t\tif (this.targetNumber - dynamicNum < unitNum) {\r\n\t\t\t\tlabel.string = this.targetNumber.formatAmountWithCommas()\r\n\t\t\t\tthis.currNumber = dynamicNum\r\n\t\t\t\twindow.clearInterval(this.timer)\r\n\t\t\t\tthis.timer = 0\r\n\t\t\t\tthis.cb && this.cb()\r\n\t\t\t\tthis.fromNumber = this.targetNumber\r\n\t\t\t} else {\r\n\t\t\t\tlabel.string = dynamicNum.formatAmountWithCommas()\r\n\t\t\t\tthis.currNumber = dynamicNum\r\n\t\t\t}\r\n\t\t}, 20))\r\n\t\t// this.schedule(() => {\r\n\t\t// \tlabel.string = (fromNumber + unitNum) + ''\r\n\t\t// }, 0.02)\r\n\t}\r\n}\r\n\r\n"]}