{"version":3,"sources":["file:///Users/geliang/web/dibai/hall/assets/script/subGame/egyptV2/components/EgyptV2_Main.ts"],"names":["_decorator","Animation","instantiate","Label","Node","sp","Sprite","Toggle","tween","Vec3","BaseComponent","changeGame","setAutoLauncherInfo","setBetDropDownList","updateWinloss","AutoLauncherType","calBetAmount","GameType","getAutoCount","isLimit","RollerStatus","updateRollerStatus","egyptv2_Audio","mainViewModel","SoundPathDefine","getNodeByNameDeep","global","config","Shake","StepNumberV2","ccclass","property","EgyptV2_Main","portraitSkLeft","portraitSkRight","gateSk","stepNumberV2","props_aiji_kaiguanmenOrigonPos","baseNodeOffectNode","baseNodeOrigonScale","baseNodeScale","propertyNode","props_main_bg","props_mini_game_bg","props_main_slot_bg","props_Up_Feature","props_buttomBar","props_roller","props_bet_dropdownlist","props_autoLauncher","props_aiji_kaiguanmen","props_aiji_zhuanquanding","props_btn_jackPot","props_jackpot_panel","props_btn_scrollView","props_jackpot_user_list","props_jackpot_item","props_skeletonRight","props_skeletonLeft","props_Label_jackpot","props_btn_off","props_btn_confirm","props","betDropDownlist","positionId","gold","gameTypeInfo","lastGameType","MAIN","currGameType","viewGameType","leftCount","subGameAnimationPlayInfo","jackpotDatas","jackpotTotalAmount","autoLauncherInfo","selectedNode","events","onSendBet","start","getHeader","getFooter","getRoller","initState","bindEvent","on","EventType","TOUCH_END","dispatch","playOneShot","btn_click","active","updateBtnScrollView","listenerBetDropDownListEvent","setCompleteListener","x","node","isValid","animation","name","setAnimation","changeGateAnimation","scheduleOnce","isNextMainGame","subGameAnimationEndHandle","children","forEach","toggle","getComponent","onToggleClick","openAoutoPanl","autoLauncherType","count","totalCount","biu","getAutoState","clearAuto","NONE","event","clickedToggle","target","isChecked","useProps","key","value","showOrHideBetDropDownlist","cur","playSubGameAnimation","changeGameType","updateJackpotContent","updateJackpotAmount","gameType","isMainGame","isSubGame2","SUBGAME2","isChangeGame","status","pos","position","play","bindUI","Skeleton","updateKaiGuanMen","isSubGame","SUBGAME1","sgbegin1","param","paused","setScale","setPosition","show","to","normalRollOption","zoomingTime","scale","call","timeScale","shake","scaleNode","type","playBgMusic","END","v","jackpotData","find","jackpot","nickName","destroy","string","winningAmount","formatAmountWithCommas","jackpotNode","item","buildJackpotItem","length","clone","add","addChild","scaleY","isCopy","jackpotItem","headNode","loadHeadSprite","avatarIndex","updatePositionId","begin","pre","end","betAmountLimit","amountInfoBegin","betSwitcher","amount","winning","minRate","amountInfoEnd","undefined","num","Number","toFixed","update","deltaTime"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAASA,MAAAA,U,OAAAA,U;AAAYC,MAAAA,S,OAAAA,S;AAAqCC,MAAAA,W,OAAAA,W;AAAaC,MAAAA,K,OAAAA,K;AAAaC,MAAAA,I,OAAAA,I;AAAMC,MAAAA,E,OAAAA,E;AAAIC,MAAAA,M,OAAAA,M;AAAQC,MAAAA,M,OAAAA,M;AAAQC,MAAAA,K,OAAAA,K;AAAkBC,MAAAA,I,OAAAA,I;;AACvHC,MAAAA,a,iBAAAA,a;;AACAC,MAAAA,U,iBAAAA,U;AAAYC,MAAAA,mB,iBAAAA,mB;AAAqBC,MAAAA,kB,iBAAAA,kB;AAAoBC,MAAAA,a,iBAAAA,a;;AACnCC,MAAAA,gB,iBAAAA,gB;AAAkBC,MAAAA,Y,iBAAAA,Y;AAAcC,MAAAA,Q,iBAAAA,Q;AAAwBC,MAAAA,Y,iBAAAA,Y;AAAcC,MAAAA,O,iBAAAA,O;AAAsBC,MAAAA,Y,iBAAAA,Y;;AAC9GC,MAAAA,kB,iBAAAA,kB;;AACAC,MAAAA,a,iBAAAA,a;AAAeC,MAAAA,a,iBAAAA,a;;AACfC,MAAAA,e,iBAAAA,e;;AACAC,MAAAA,iB,iBAAAA,iB;;AACAC,MAAAA,M,iBAAAA,M;;AAEFC,MAAAA,M;;AACEC,MAAAA,K,kBAAAA,K;;AACFC,MAAAA,Y;;;;;;;;;OACD;AAAEC,QAAAA,OAAF;AAAWC,QAAAA;AAAX,O,GAAwB/B,U;;8BA4BjBgC,Y,WADZF,OAAO,CAAC,cAAD,C,gBAAR,MACaE,YADb;AAAA;AAAA,0CACwE;AAAA;AAAA;AAAA,eAK/DC,cAL+D;AAAA,eAM/DC,eAN+D;AAAA,eAO/DC,MAP+D;AAAA,eAQ/DC,YAR+D,GAQlC;AAAA;AAAA,4CAAiB,IAAjB,CARkC;AAAA,eAU/DC,8BAV+D;AAAA,eAW/DC,kBAX+D;;AAYvE;AAZuE,eAa/DC,mBAb+D,GAanC,IAAI9B,IAAJ,CAAS,CAAT,EAAY,CAAZ,EAAe,CAAf,CAbmC;;AAcvE;AAduE,eAe/D+B,aAf+D,GAezC,IAAI/B,IAAJ,CAAS,CAAT,EAAY,CAAZ,EAAe,CAAf,CAfyC;AAAA,eAiB7DgC,YAjB6D,GAiB9C;AACxBC,YAAAA,aAAa,EAAE,IAAItC,IAAJ,EADS;AAExBuC,YAAAA,kBAAkB,EAAE,IAAIvC,IAAJ,EAFI;AAGxBwC,YAAAA,kBAAkB,EAAE,IAAIxC,IAAJ,EAHI;AAKxByC,YAAAA,gBAAgB,EAAE,IAAIzC,IAAJ,EALM;AAMxB0C,YAAAA,eAAe,EAAE,IAAI1C,IAAJ,EANO;AAOxB2C,YAAAA,YAAY,EAAE,IAAI3C,IAAJ,EAPU;AAQxB4C,YAAAA,sBAAsB,EAAE,IAAI5C,IAAJ,EARA;AASxB6C,YAAAA,kBAAkB,EAAE,IAAI7C,IAAJ,EATI;AAUxB8C,YAAAA,qBAAqB,EAAE,IAAI9C,IAAJ,EAVC;AAWxB+C,YAAAA,wBAAwB,EAAE,IAAI/C,IAAJ,EAXF;AAYxBgD,YAAAA,iBAAiB,EAAE,IAAIhD,IAAJ,EAZK;AAaxBiD,YAAAA,mBAAmB,EAAE,IAAIjD,IAAJ,EAbG;AAcxBkD,YAAAA,oBAAoB,EAAE,IAAIlD,IAAJ,EAdE;AAexBmD,YAAAA,uBAAuB,EAAE,IAAInD,IAAJ,EAfD;AAgBxBoD,YAAAA,kBAAkB,EAAE,IAAIpD,IAAJ,EAhBI;AAiBxBqD,YAAAA,mBAAmB,EAAE,IAAIrD,IAAJ,EAjBG;AAkBxBsD,YAAAA,kBAAkB,EAAE,IAAItD,IAAJ,EAlBI;AAmBxBuD,YAAAA,mBAAmB,EAAE,IAAIxD,KAAJ,EAnBG;AAoBxByD,YAAAA,aAAa,EAAE,IAAIxD,IAAJ,EApBS;AAqBxByD,YAAAA,iBAAiB,EAAE,IAAIzD,IAAJ;AArBK,WAjB8C;AAAA,eAyChE0D,KAzCgE,GAyChD;AACtBC,YAAAA,eAAe,EAAE,KADK;AAEtBC,YAAAA,UAAU,EAAE,CAFU;AAGtBC,YAAAA,IAAI,EAAE,CAHgB;AAItBC,YAAAA,YAAY,EAAE;AACbC,cAAAA,YAAY,EAAE;AAAA;AAAA,wCAASC,IADV;AAEbC,cAAAA,YAAY,EAAE;AAAA;AAAA,wCAASD,IAFV;AAGbE,cAAAA,YAAY,EAAE;AAAA;AAAA,wCAASF,IAHV;AAIbG,cAAAA,SAAS,EAAE;AAJE,aAJQ;AAUtBC,YAAAA,wBAAwB,EAAE,IAVJ;AAWtBC,YAAAA,YAAY,EAAE,EAXQ;AAYtBC,YAAAA,kBAAkB,EAAE,CAZE;AAatBC,YAAAA,gBAAgB,EAAE;AAbI,WAzCgD;AAAA,eAwD/DC,YAxD+D;AAAA,eA0DhEC,MA1DgE,GA0D/C;AACvBC,YAAAA,SAAS,EAAE,MAAM,CAAG;AADG,WA1D+C;AAAA;;AACvEC,QAAAA,KAAK,GAAG,CAEP;;AA2DMC,QAAAA,SAAS,GAAG;AAClB,iBAAO,KAAKvC,YAAL,CAAkBI,gBAAzB;AACA;;AAEMoC,QAAAA,SAAS,GAAG;AAClB,iBAAO,KAAKxC,YAAL,CAAkBK,eAAzB;AACA;;AAEMoC,QAAAA,SAAS,GAAG;AAClB,iBAAO,KAAKzC,YAAL,CAAkBM,YAAzB;AACA;;AAESoC,QAAAA,SAAS,GAAG;AACrB,iBAAO,EAAP;AACA;;AAESC,QAAAA,SAAS,GAAS;AAC3B;AACA;AACA;AACA;AACA;AACA,eAAK3C,YAAL,CAAkBO,sBAAlB,CAAyCqC,EAAzC,CAA4CjF,IAAI,CAACkF,SAAL,CAAeC,SAA3D,EAAsE,MAAM;AAC3E,iBAAKC,QAAL,CAAc;AAAA;AAAA,0DAAmB,KAAnB,CAAd;AACA,WAFD;AAIA,eAAK/C,YAAL,CAAkBW,iBAAlB,CAAoCiC,EAApC,CAAuCjF,IAAI,CAACkF,SAAL,CAAeC,SAAtD,EAAiE,MAAM;AACtE;AAAA;AAAA,gDAAcE,WAAd,CAA0B;AAAA;AAAA,oDAAgBC,SAA1C;AACA,iBAAKjD,YAAL,CAAkBY,mBAAlB,CAAsCsC,MAAtC,GAA+C,CAAC,KAAKlD,YAAL,CAAkBY,mBAAlB,CAAsCsC,MAAtF;AACA,iBAAKC,mBAAL;AACA,WAJD;AAKA,eAAKnD,YAAL,CAAkBY,mBAAlB,CAAsCgC,EAAtC,CAAyCjF,IAAI,CAACkF,SAAL,CAAeC,SAAxD,EAAmE,MAAM;AACxE,iBAAK9C,YAAL,CAAkBY,mBAAlB,CAAsCsC,MAAtC,GAA+C,KAA/C;AACA,iBAAKC,mBAAL;AACA,WAHD;AAKA,eAAKC,4BAAL;AAEA,eAAK5D,cAAL,CAAoB6D,mBAApB,CAAyCC,CAAD,IAA4B;AACnE,gBAAI,KAAKC,IAAL,CAAUC,OAAd,EAAuB;AACtB,kBAAIF,CAAC,CAACG,SAAF,CAAYC,IAAZ,KAAqB,QAAzB,EAAmC;AAClC,qBAAKlE,cAAL,CAAoBmE,YAApB,CAAiC,CAAjC,EAAoC,QAApC,EAA8C,KAA9C;AACA,qBAAKC,mBAAL;AACA;AACD;AACD,WAPD;AAQA,eAAKnE,eAAL,CAAqB4D,mBAArB,CAAyC,MAAM;AAC9C,gBAAI,KAAKE,IAAL,CAAUC,OAAd,EAAuB;AACtB,mBAAK/D,eAAL,CAAqBkE,YAArB,CAAkC,CAAlC,EAAqC,QAArC,EAA+C,KAA/C;AACA;AACD,WAJD;AAMA,eAAKjE,MAAL,CAAY2D,mBAAZ,CAAiCC,CAAD,IAA4B;AAC3D,gBAAI,KAAKC,IAAL,CAAUC,OAAd,EAAuB;AACtB,kBAAIF,CAAC,CAACG,SAAF,CAAYC,IAAZ,KAAqB,eAAzB,EAA0C,CACzC,CADD,MACO,IAAIJ,CAAC,CAACG,SAAF,CAAYC,IAAZ,KAAqB,wBAAzB,EAAmD,CACzD,CADM,MACA,IAAIJ,CAAC,CAACG,SAAF,CAAYC,IAAZ,KAAqB,sBAAzB,EAAiD,CACvD,CADM,MACA,IAAIJ,CAAC,CAACG,SAAF,CAAYC,IAAZ,KAAqB,iBAAzB,EAA4C;AAClD;AACA,qBAAK1D,YAAL,CAAkBU,wBAAlB,CAA2CwC,MAA3C,GAAoD,KAApD;AACA,qBAAKxD,MAAL,CAAYiE,YAAZ,CAAyB,CAAzB,EAA4B,eAA5B,EAA6C,KAA7C,EAHkD,CAIlD;;AACA,qBAAKE,YAAL,CAAkB,MAAM;AACvB;AACA,sBAAI,KAAKC,cAAL,EAAJ,EAA2B;AAC1B,yBAAK9D,YAAL,CAAkBS,qBAAlB,CAAwCyC,MAAxC,GAAiD,KAAjD;AACA,yBAAKa,yBAAL,CAA+B,CAA/B;AACA;AACD,iBAND,EAMG,CANH;AAOA;AACD;AACD,WAnBD;AAoBA;;AAEOX,QAAAA,4BAA4B,GAAG;AACtC,eAAKpD,YAAL,CAAkBQ,kBAAlB,CAAqCwD,QAArC,CAA8CC,OAA9C,CAAuDC,MAAD,IAAY;AACjEA,YAAAA,MAAM,CAACC,YAAP,CAAoBrG,MAApB,EAA4ByF,IAA5B,CAAiCX,EAAjC,CAAoCjF,IAAI,CAACkF,SAAL,CAAeC,SAAnD,EAA8D,KAAKsB,aAAnE,EAAkF,IAAlF;AACA,WAFD;AAGA,eAAKpE,YAAL,CAAkBmB,aAAlB,CAAgCyB,EAAhC,CAAmCjF,IAAI,CAACkF,SAAL,CAAeC,SAAlD,EAA6D,MAAM;AAClE,iBAAKuB,aAAL;AACA,WAFD;AAGA,eAAKrE,YAAL,CAAkBoB,iBAAlB,CAAoCwB,EAApC,CAAuCjF,IAAI,CAACkF,SAAL,CAAeC,SAAtD,EAAiE,MAAM;AACtE,gBAAMwB,gBAAgB,GAAI,KAAKnC,YAAL,GAAoB,KAAKA,YAAL,CAAkBuB,IAAtC,GAA6C,KAAvE,CADsE,CAC6B;;AACnG,gBAAMa,KAAK,GAAG;AAAA;AAAA,8CAAaD,gBAAb,CAAd;AACA,iBAAKvB,QAAL,CAAc;AAAA;AAAA,4DAAoB;AACjCuB,cAAAA,gBAAgB,EAAEA,gBADe;AAEjCE,cAAAA,UAAU,EAAED,KAFqB;AAGjCzC,cAAAA,SAAS,EAAE;AAAA;AAAA,sCAAQwC,gBAAR,IAA4B,CAA5B,GAAgCC,KAAK,GAAG;AAHlB,aAApB,CAAd;AAKA;AAAA;AAAA,gDAAcvB,WAAd,CAA0B;AAAA;AAAA,oDAAgByB,GAA1C;AACA,iBAAK1B,QAAL,CAAc;AAAA;AAAA,0DAAmB,KAAnB,CAAd;AACA,iBAAKX,MAAL,CAAYC,SAAZ;AACA,iBAAKgC,aAAL;AACA,WAZD;AAaA;;AACMA,QAAAA,aAAa,GAAG;AACtB,eAAKrE,YAAL,CAAkBO,sBAAlB,CAAyC2C,MAAzC,GAAkD,CAAC,KAAKlD,YAAL,CAAkBO,sBAAlB,CAAyC2C,MAA5F;AACA;;AACMwB,QAAAA,YAAY,GAAG;AACrB,iBAAO,KAAK1E,YAAL,CAAkBO,sBAAlB,CAAyC2C,MAAhD;AACA;;AACMyB,QAAAA,SAAS,GAAG;AAClB,eAAK5B,QAAL,CAAc;AAAA;AAAA,0DAAoB;AACjCuB,YAAAA,gBAAgB,EAAE;AAAA;AAAA,sDAAiBM,IADF;AAEjCJ,YAAAA,UAAU,EAAE,CAFqB;AAGjC1C,YAAAA,SAAS,EAAE;AAHsB,WAApB,CAAd;AAKA;;AACOsC,QAAAA,aAAa,CAACS,KAAD,EAAQ;AAC5B;AACA,cAAMC,aAAa,GAAGD,KAAK,CAACE,MAAN,CAAaZ,YAAb,CAA0BrG,MAA1B,CAAtB;;AACA,cAAI,CAACgH,aAAa,CAACE,SAAnB,EAA8B;AAC7BF,YAAAA,aAAa,CAACE,SAAd,GAA0B,IAA1B;AACA,iBAAK7C,YAAL,GAAoB0C,KAAK,CAACE,MAA1B;AACA;AACA,WAP2B,CAQ5B;;;AACA,eAAK/E,YAAL,CAAkBQ,kBAAlB,CAAqCwD,QAArC,CAA8CC,OAA9C,CAAuDC,MAAD,IAAY;AACjE,gBAAIA,MAAM,KAAKY,aAAf,EAA8B;AAC7BZ,cAAAA,MAAM,CAACC,YAAP,CAAoBrG,MAApB,EAA4BkH,SAA5B,GAAwC,KAAxC;AACA;AACD,WAJD;AAKA;;AACSC,QAAAA,QAAQ,CAACC,GAAD,EAAoBC,KAApB,EAAmD;AACpE;AACA,cAAI,KAAK5B,IAAL,IAAa,KAAKA,IAAL,CAAUC,OAA3B,EAAoC;AACnC,gBAAI0B,GAAG,KAAK,iBAAZ,EAA+B;AAC9B,mBAAKE,yBAAL,CAA+BD,KAAK,CAACE,GAArC;AACA,aAFD,MAEO,IAAIH,GAAG,KAAK,0BAAZ,EAAwC;AAC9C,kBAAIC,KAAK,CAACE,GAAV,EAAe;AACd,qBAAKC,oBAAL;AACA;AACD,aAJM,MAIA,IAAIJ,GAAG,KAAK,cAAZ,EAA4B;AAClC,mBAAKK,cAAL,CAAoB,KAAKlE,KAAL,CAAWI,YAAX,CAAwBI,YAA5C;AACA,aAFM,MAEA,IAAIqD,GAAG,KAAK,cAAZ,EAA4B;AAClC,mBAAKM,oBAAL;AACA,aAFM,MAEA,IAAIN,GAAG,KAAK,oBAAZ,EAAkC;AACxC,mBAAKO,mBAAL,CAAyB,KAAzB,EAAgCN,KAAhC;AACA,aAFM,MAEA,IAAID,GAAG,KAAK,YAAZ,EAA0B;AAChC,mBAAKO,mBAAL,CAAyB,IAAzB,EAA+BN,KAA/B;AACA;AACD;AACD;;AAEOI,QAAAA,cAAc,CAACG,QAAD,EAAqB;AAC1C,cAAMC,UAAU,GAAGD,QAAQ,KAAK;AAAA;AAAA,oCAAS/D,IAAzC;AACA,cAAMiE,UAAU,GAAGF,QAAQ,KAAK;AAAA;AAAA,oCAASG,QAAzC,CAF0C,CAG1C;;AACA,eAAK7F,YAAL,CAAkBgB,mBAAlB,CAAsCkC,MAAtC,GAA+CyC,UAA/C;AACA,eAAK3F,YAAL,CAAkBiB,kBAAlB,CAAqCiC,MAArC,GAA8CyC,UAA9C;AACA,eAAK3F,YAAL,CAAkBC,aAAlB,CAAgCiD,MAAhC,GAAyCyC,UAAU,IAAIC,UAAvD;AACA,eAAK5F,YAAL,CAAkBG,kBAAlB,CAAqC+C,MAArC,GAA8CyC,UAAU,IAAIC,UAA5D,CAP0C,CAS1C;;AACA,eAAK5F,YAAL,CAAkBE,kBAAlB,CAAqCgD,MAArC,GAA8C,CAACyC,UAAD,IAAe,CAACC,UAA9D;AACA;AAED;;;AACQE,QAAAA,YAAY,GAAG;AACtB,iBAAO,KAAKzE,KAAL,CAAWI,YAAX,IAA2B,KAAKJ,KAAL,CAAWI,YAAX,CAAwBI,YAAxB,KAAyC,KAAKR,KAAL,CAAWI,YAAX,CAAwBG,YAAnG;AACA;;AAEOwD,QAAAA,yBAAyB,CAACW,MAAD,EAAkB;AAClD,cAAMC,GAAG,GAAG,KAAKhG,YAAL,CAAkBQ,kBAAlB,CAAqCyF,QAAjD;;AACA,cAAIF,MAAJ,EAAY;AACX,iBAAK/F,YAAL,CAAkBO,sBAAlB,CAAyC2C,MAAzC,GAAkD,IAAlD;AACA,iBAAKlD,YAAL,CAAkBQ,kBAAlB,CAAqC2D,YAArC,CAAkD3G,SAAlD,EAA6D0I,IAA7D,CAAkE,2BAAlE,EAFW,CAGX;AACA;AACA,WALD,MAKO;AACN,iBAAKlG,YAAL,CAAkBQ,kBAAlB,CAAqC2D,YAArC,CAAkD3G,SAAlD,EAA6D0I,IAA7D,CAAkE,6BAAlE,EADM,CAEN;AACA;AACA;AACA;AACA;AACD;;AAESC,QAAAA,MAAM,GAAS;AACxB;AACA,eAAKvG,8BAAL,GAAsC,IAAI5B,IAAJ,EAAtC;AACA,eAAK6B,kBAAL,GAA0B,IAAI7B,IAAJ,CAAS,CAAC,GAAV,EAAe,CAAC,GAAhB,CAA1B;AAEA,eAAKgC,YAAL,CAAkBO,sBAAlB,CAAyC2C,MAAzC,GAAkD,KAAlD;AAEA,eAAKxD,MAAL,GAAc,KAAKM,YAAL,CAAkBS,qBAAlB,CAAwC0D,YAAxC,CAAqDvG,EAAE,CAACwI,QAAxD,CAAd;AACA,eAAK5G,cAAL,GAAsB,KAAKQ,YAAL,CAAkBiB,kBAAlB,CAAqCkD,YAArC,CAAkDvG,EAAE,CAACwI,QAArD,CAAtB;AACA,eAAK3G,eAAL,GAAuB,KAAKO,YAAL,CAAkBgB,mBAAlB,CAAsCmD,YAAtC,CAAmDvG,EAAE,CAACwI,QAAtD,CAAvB;AAEA,eAAKC,gBAAL;AACA;;AAEOA,QAAAA,gBAAgB,GAAG;AAC1B,eAAKrG,YAAL,CAAkBS,qBAAlB,CAAwCyC,MAAxC,GAAiD,KAAjD;AACA,eAAKlD,YAAL,CAAkBU,wBAAlB,CAA2CwC,MAA3C,GAAoD,KAApD;AACA;;AAEOoD,QAAAA,SAAS,CAACZ,QAAD,EAAqB;AACrC,iBAAOA,QAAQ,KAAK;AAAA;AAAA,oCAASa,QAAtB,IAAkCb,QAAQ,KAAK;AAAA;AAAA,oCAASG,QAA/D;AACA;;AAEO/B,QAAAA,cAAc,GAAG;AACxB,iBAAO,KAAKzC,KAAL,CAAWI,YAAX,CAAwBG,YAAxB,KAAyC;AAAA;AAAA,oCAASD,IAAzD;AACA;;AAEO2D,QAAAA,oBAAoB,GAAG;AAC9B,cAAI,KAAKgB,SAAL,CAAe,KAAKjF,KAAL,CAAWU,wBAAX,CAAoC2D,QAAnD,CAAJ,EAAkE;AACjE;AAAA;AAAA,gDAAc1C,WAAd,CAA0B;AAAA;AAAA,oDAAgBwD,QAA1C,EAAoD,GAApD,EAAyD,KAAzD,EADiE,CAEjE;;AACA,gBAAI,KAAKnF,KAAL,CAAWU,wBAAX,CAAoC0E,KAApC,KAA8C,CAAlD,EAAqD;AACpD;AACA,kBAAI,KAAKzG,YAAL,CAAkBiB,kBAAlB,CAAqCiC,MAAzC,EAAiD;AAChD,qBAAK1D,cAAL,CAAoBmE,YAApB,CAAiC,CAAjC,EAAoC,SAApC,EAA+C,KAA/C;AACA,qBAAKlE,eAAL,CAAqBkE,YAArB,CAAkC,CAAlC,EAAqC,SAArC,EAAgD,KAAhD;AACA,eAHD,MAGO;AACN,qBAAKC,mBAAL;AACA;AACD,aARD,MAQO;AACN;AACA,mBAAKlE,MAAL,CAAYiE,YAAZ,CAAyB,CAAzB,EAA4B,iBAA5B,EAA+C,KAA/C;AACA,mBAAKjE,MAAL,CAAYgH,MAAZ,GAAqB,IAArB;AAEA,mBAAK1G,YAAL,CAAkBS,qBAAlB,CAAwCyC,MAAxC,GAAiD,IAAjD;AACA,mBAAKlD,YAAL,CAAkBU,wBAAlB,CAA2CwC,MAA3C,GAAoD,IAApD;AACA,mBAAKK,IAAL,CAAUoD,QAAV,CAAmB,KAAK5G,aAAxB;AACA,mBAAKwD,IAAL,CAAUqD,WAAV,CAAsB,KAAK/G,kBAA3B;AACA,mBAAK0F,cAAL,CAAoB;AAAA;AAAA,wCAAS5D,IAA7B;AACA5D,cAAAA,KAAK,CAAC,KAAKwF,IAAN,CAAL,CAAiBsD,IAAjB,GACEC,EADF,CACK;AAAA;AAAA,oCAAOC,gBAAP,CAAwBC,WAD7B,EAC0C;AAAEC,gBAAAA,KAAK,EAAE,KAAKnH,mBAAd;AAAmCmG,gBAAAA,QAAQ,EAAE,KAAKrG;AAAlD,eAD1C,EAEEsH,IAFF,CAEO,MAAM;AACX,oBAAI,KAAK3D,IAAL,CAAUC,OAAd,EAAuB;AACtB,uBAAK9D,MAAL,CAAYgH,MAAZ,GAAqB,KAArB;AACA,uBAAKhH,MAAL,CAAYyH,SAAZ,GAAwB,CAAxB;AACA;AACD,eAPF,EAQE7E,KARF;AASA;AACD;AACD;AAED;;;AACQsB,QAAAA,mBAAmB,GAAG;AAC7B,eAAK5D,YAAL,CAAkBS,qBAAlB,CAAwCyC,MAAxC,GAAiD,IAAjD;AACA,eAAKlD,YAAL,CAAkBU,wBAAlB,CAA2CwC,MAA3C,GAAoD,IAApD;;AACA,cAAI,KAAK7B,KAAL,CAAWU,wBAAX,CAAoC0E,KAApC,KAA8C,CAAlD,EAAqD;AACpD,iBAAK/G,MAAL,CAAYyH,SAAZ,GAAwB,CAAxB;AACA,iBAAKzH,MAAL,CAAYiE,YAAZ,CAAyB,CAAzB,EAA4B,iBAA5B,EAA+C,KAA/C,EAFoD,CAGpD;AAEA;;AACA,iBAAKE,YAAL,CAAkB,MAAM;AACvB;AAAA;AAAA,oCAAYuD,KAAZ,CAAkB,KAAK7D,IAAvB,EAA6B,GAA7B,EAAkC,CAAlC,EAAqC,CAArC,EAAwC,IAAxC,EAA8C,MAAM;AACnD;AACA,qBAAKA,IAAL,CAAUC,OAAV,IAAqB,KAAK9D,MAAL,CAAYiE,YAAZ,CAAyB,CAAzB,EAA4B,eAA5B,EAA6C,KAA7C,CAArB;AACA,qBAAK0D,SAAL;AACA,eAJD,EAIG/E,KAJH;AAKA,aAND,EAMG,CANH;AAOA;AACD;;AAEO+E,QAAAA,SAAS,GAAG;AACnB;AACA,eAAKxD,YAAL,CAAkB,MAAM;AACvB;AACA,iBAAKN,IAAL,CAAUC,OAAV,IAAqBzF,KAAK,CAAC,KAAKwF,IAAN,CAAL,CACnBuD,EADmB,CAChB;AAAA;AAAA,kCAAOC,gBAAP,CAAwBC,WADR,EACqB;AAAEC,cAAAA,KAAK,EAAE,KAAKlH,aAAd;AAA6BkG,cAAAA,QAAQ,EAAE,KAAKpG;AAA5C,aADrB,EAEnBqH,IAFmB,CAEd,MAAM;AACX,kBAAI,KAAK3D,IAAL,CAAUC,OAAd,EAAuB;AACtB,qBAAKxD,YAAL,CAAkBS,qBAAlB,CAAwCyC,MAAxC,GAAiD,KAAjD;AACA,qBAAKlD,YAAL,CAAkBU,wBAAlB,CAA2CwC,MAA3C,GAAoD,KAApD;AACA,qBAAKK,IAAL,CAAUoD,QAAV,CAAmB,KAAK7G,mBAAxB;AACA,qBAAKyD,IAAL,CAAUqD,WAAV,CAAsB,KAAKhH,8BAA3B;AACA,qBAAKmE,yBAAL,CAA+B,CAA/B;AACA;AACD,aAVmB,EAWnBzB,KAXmB,EAArB;AAYA,WAdD,EAcG,CAdH;AAeA;AAED;;;AACQyB,QAAAA,yBAAyB,CAACuD,IAAD,EAAe;AAE/C,cAAM7F,YAAY,gBAAQ,KAAKJ,KAAL,CAAWI,YAAnB,CAAlB;;AACAA,UAAAA,YAAY,CAACC,YAAb,GAA4BD,YAAY,CAACI,YAAzC;AACAJ,UAAAA,YAAY,CAACI,YAAb,GAA4BJ,YAAY,CAACG,YAAzC;AACA,eAAKmB,QAAL,CAAc;AAAA;AAAA,wCAAWtB,YAAX,CAAd,EAL+C,CAO/C;;AACA,cAAIA,YAAY,CAACI,YAAb,KAA8B;AAAA;AAAA,oCAAS0E,QAA3C,EAAqD;AACpD,iBAAKxD,QAAL,CAAc;AAAA;AAAA,gDAAc,CAAd,CAAd;AACA;;AAED;AAAA;AAAA,8CAAcwE,WAAd,GAZ+C,CAc/C;;AACA,cAAID,IAAI,KAAK,CAAb,EAAgB;AACf,iBAAKzD,YAAL,CAAkB,MAAM;AACvB,mBAAKd,QAAL,CAAc;AAAA;AAAA,4DAAmB;AAAA;AAAA,gDAAayE,GAAhC,CAAd;AACA,aAFD,EAEG,CAFH;AAGA;AACD;;AAEOhC,QAAAA,oBAAoB,GAAG;AAC9B,cAAI,KAAKxF,YAAL,CAAkBY,mBAAlB,IAAyC,KAAKZ,YAAL,CAAkBY,mBAAlB,CAAsC4C,OAAnF,EAA4F;AAC3F;AAEA;AACA,iBAAKxD,YAAL,CAAkBc,uBAAlB,CAA0CkD,QAA1C,CAAmDC,OAAnD,CAA2DwD,CAAC,IAAI;AAC/D,kBAAMC,WAAW,GAAG,KAAKrG,KAAL,CAAWW,YAAX,CAAwB2F,IAAxB,CAA6BC,OAAO,IAAIA,OAAO,CAACC,QAAR,KAAqBJ,CAAC,CAAC/D,IAA/D,CAApB;;AACA,kBAAI,CAACgE,WAAL,EAAkB;AACjBD,gBAAAA,CAAC,CAACK,OAAF;AACA,eAFD,MAEO;AACN;AAAA;AAAA,4DAAkB,mBAAlB,EAAuCL,CAAvC,EAA0CtD,YAA1C,CAAuDzG,KAAvD,EAA8DqK,MAA9D,GAAuEL,WAAW,CAACM,aAAZ,CAA0BC,sBAA1B,EAAvE;AACA;AACD,aAPD;AASA,iBAAK5G,KAAL,CAAWW,YAAX,CAAwBiC,OAAxB,CAAgCwD,CAAC,IAAI;AACpC,kBAAMzD,QAAQ,GAAG,KAAKhE,YAAL,CAAkBc,uBAAlB,CAA0CkD,QAA3D;AACA,kBAAMkE,WAAW,GAAGlE,QAAQ,CAAC2D,IAAT,CAAcO,WAAW,IAAIA,WAAW,CAACxE,IAAZ,KAAqB+D,CAAC,CAACI,QAApD,CAApB;;AACA,kBAAI,CAACK,WAAL,EAAkB;AACjB,oBAAMC,IAAI,GAAG,KAAKC,gBAAL,CAAsBX,CAAtB,CAAb;AACAU,gBAAAA,IAAI,CAACvB,WAAL,CAAiB,IAAI5I,IAAJ,EAAjB;;AACA,oBAAIgG,QAAQ,CAACqE,MAAT,GAAkB,CAAtB,EAAyB;AACxBF,kBAAAA,IAAI,CAACvB,WAAL,CAAiB5C,QAAQ,CAACA,QAAQ,CAACqE,MAAT,GAAkB,CAAnB,CAAR,CAA8BpC,QAA9B,CAAuCqC,KAAvC,GAA+CC,GAA/C,CAAmD,IAAIvK,IAAJ,CAAS,CAAT,EAAY,CAAC,EAAb,EAAiB,CAAjB,CAAnD,CAAjB;AACA;;AACD,qBAAKgC,YAAL,CAAkBc,uBAAlB,CAA0C0H,QAA1C,CAAmDL,IAAnD;AACA;AACD,aAXD;AAYA;AACD;;AAEOhF,QAAAA,mBAAmB,GAAG;AAC7B,cAAIsF,MAAM,GAAG,KAAKzI,YAAL,CAAkBY,mBAAlB,CAAsCsC,MAAtC,GAA+C,CAA/C,GAAmD,CAAC,CAAjE;AACA,eAAKlD,YAAL,CAAkBa,oBAAlB,CAAuC8F,QAAvC,CAAgD,IAAI3I,IAAJ,CAAS,CAAT,EAAYyK,MAAZ,CAAhD;AACA;;AAEOL,QAAAA,gBAAgB,CAACV,WAAD,EAA2BgB,MAA3B,EAAmD;AAAA,cAAxBA,MAAwB;AAAxBA,YAAAA,MAAwB,GAAN,IAAM;AAAA;;AAC1E,cAAI,CAAChB,WAAL,EAAkB;AACjB;AACA;;AACD,cAAMiB,WAAW,GAAGD,MAAM,GAAGjL,WAAW,CAAC,KAAKuC,YAAL,CAAkBe,kBAAnB,CAAd,GAAuD,KAAKf,YAAL,CAAkBe,kBAAnG;AACA4H,UAAAA,WAAW,CAACzF,MAAZ,GAAqB,IAArB;AACA,cAAM0F,QAAQ,GAAG;AAAA;AAAA,sDAAkB,iBAAlB,EAAqCD,WAArC,EAAkDxE,YAAlD,CAA+DtG,MAA/D,CAAjB;AACA;AAAA;AAAA,sDAAkB,mBAAlB,EAAuC8K,WAAvC,EAAoDxE,YAApD,CAAiEzG,KAAjE,EAAwEqK,MAAxE,GAAiFL,WAAW,CAACM,aAAZ,CAA0BC,sBAA1B,EAAjF;AACA;AAAA;AAAA,sDAAkB,qBAAlB,EAAyCU,WAAzC,EAAsDxE,YAAtD,CAAmEzG,KAAnE,EAA0EqK,MAA1E,GAAmFL,WAAW,CAACG,QAA/F;AACAc,UAAAA,WAAW,CAACjF,IAAZ,GAAmBgE,WAAW,CAACG,QAA/B;AAEA;AAAA;AAAA,gCAAOgB,cAAP,CAAsBnB,WAAW,CAACoB,WAAlC,EAA+CF,QAA/C;AACA,iBAAOD,WAAP;AACA;;AAEOlD,QAAAA,mBAAmB,CAACsD,gBAAD,EAA4B5D,KAA5B,EAA2D;AACrF,cAAI6D,KAAK,GAAG7D,KAAK,CAAC8D,GAAlB;AACA,cAAIC,GAAG,GAAG/D,KAAK,CAACE,GAAhB;;AACA,cAAI;AAAA;AAAA,4CAAa,KAAKhE,KAAL,CAAWE,UAAxB,IAAsC;AAAA;AAAA,gCAAO4H,cAAjD,EAAiE;AAChE,gBAAIJ,gBAAJ,EAAsB;AACrBC,cAAAA,KAAK,GAAG,CAAR;;AACA,kBAAI7D,KAAK,CAAC8D,GAAV,EAAe;AACd,oBAAMG,eAAe,GAAG;AAAA;AAAA,sCAAOC,WAAP,CAAmB,CAAnB,EAAsBC,MAAtB,CAA6B3B,IAA7B,CAAkCF,CAAC,IAAIA,CAAC,CAAClG,UAAF,KAAiB4D,KAAK,CAAC8D,GAA9D,CAAxB;AACAD,gBAAAA,KAAK,GAAG;AAAA;AAAA,sCAAOO,OAAP,CAAe,CAAf,EAAkBC,OAAlB,GAA4BJ,eAAe,CAACjE,KAApD;AACA;;AACD,kBAAMsE,aAAa,GAAG;AAAA;AAAA,oCAAOJ,WAAP,CAAmB,CAAnB,EAAsBC,MAAtB,CAA6B3B,IAA7B,CAAkCF,CAAC,IAAIA,CAAC,CAAClG,UAAF,KAAiB4D,KAAK,CAACE,GAA9D,CAAtB;AACA6D,cAAAA,GAAG,GAAG;AAAA;AAAA,oCAAOK,OAAP,CAAe,CAAf,EAAkBC,OAAlB,GAA4BC,aAAa,CAACtE,KAAhD;AACA,aARD,MAQO;AACN+D,cAAAA,GAAG,GAAGQ,SAAN;;AACA,kBAAMD,cAAa,GAAG;AAAA;AAAA,oCAAOJ,WAAP,CAAmB,CAAnB,EAAsBC,MAAtB,CAA6B3B,IAA7B,CAAkCF,CAAC,IAAIA,CAAC,CAAClG,UAAF,KAAiB,KAAKF,KAAL,CAAWE,UAAnE,CAAtB;;AACA,mBAAKvB,YAAL,CAAkBkB,mBAAlB,CAAsC6G,MAAtC,GAA+C,CAAC;AAAA;AAAA,oCAAOwB,OAAP,CAAe,CAAf,EAAkBC,OAAlB,GAA4BC,cAAa,CAACtE,KAA3C,EAAkD8C,sBAAlD,EAA/C;AACA;AACD,WAdD,MAcO,IAAIc,gBAAJ,EAAsB;AAC5BC,YAAAA,KAAK,GAAG,CAAR;;AACA,gBAAI7D,KAAK,CAAC8D,GAAV,EAAe;AACd,kBAAMG,gBAAe,GAAG;AAAA;AAAA,oCAAOC,WAAP,CAAmB,CAAnB,EAAsBC,MAAtB,CAA6B3B,IAA7B,CAAkCF,CAAC,IAAIA,CAAC,CAAClG,UAAF,KAAiB4D,KAAK,CAAC8D,GAA9D,CAAxB;;AACAD,cAAAA,KAAK,GAAG;AAAA;AAAA,oCAAOO,OAAP,CAAe,CAAf,EAAkBC,OAAlB,GAA4BJ,gBAAe,CAACjE,KAApD;AACA;;AACD+D,YAAAA,GAAG,GAAG,KAAK7H,KAAL,CAAWY,kBAAjB;AACA;;AAED,cAAIiH,GAAG,KAAKQ,SAAZ,EAAuB;AACtB,iBAAK/J,YAAL,CAAkB2C,KAAlB,CAAwB0G,KAAxB,EAA+BE,GAA/B,EAAqCS,GAAD,IAAS;AAC5C,kBAAI,KAAKpG,IAAL,IAAa,KAAKA,IAAL,CAAUC,OAA3B,EAAoC;AACnC,oBAAM2B,MAAK,GAAGyE,MAAM,CAACD,GAAG,CAACE,OAAJ,CAAY,CAAZ,CAAD,CAApB;;AACA,qBAAK7J,YAAL,CAAkBkB,mBAAlB,CAAsC6G,MAAtC,GAA+C5C,MAAK,CAAC8C,sBAAN,EAA/C;AACA;AACD,aALD;AAMA;AACD;;AAED6B,QAAAA,MAAM,CAACC,SAAD,EAAoB,CAEzB;;AAncsE,O","sourcesContent":["import { _decorator, Animation, AnimationState, Graphics, instantiate, Label, Mask, Node, sp, Sprite, Toggle, tween, UIOpacity, Vec3 } from 'cc';\r\nimport { BaseComponent } from '../../../base/BaseComponent';\r\nimport { changeGame, setAutoLauncherInfo, setBetDropDownList, updateWinloss } from '../store/actions/game';\r\nimport { AutoLauncherInfo, AutoLauncherType, calBetAmount, GameType, GameTypeInfo, getAutoCount, isLimit, JackpotData, RollerStatus, SubGameAnimationPlayInfo } from '../type';\r\nimport { updateRollerStatus } from '../store/actions/roller';\r\nimport { egyptv2_Audio, mainViewModel } from '../index';\r\nimport { SoundPathDefine } from '../sourceDefine/soundDefine';\r\nimport { getNodeByNameDeep } from '../../../utils/tool';\r\nimport { global } from '../../../hall';\r\nimport StepNumber from '../../../utils/StepNumber';\r\nimport config from '../config';\r\nimport { Shake } from '../../../utils/Shake';\r\nimport StepNumberV2 from '../../../utils/StepNumberV2';\r\nconst { ccclass, property } = _decorator;\r\n\r\nexport interface IState {\r\n\r\n}\r\n\r\nexport interface IProps {\r\n\tbetDropDownlist: boolean,\r\n\t/** 选择的线id */\r\n\tpositionId: number,\r\n\t/** 余额 */\r\n\tgold: number,\r\n\t/**游戏类型信息 */\r\n\tgameTypeInfo: GameTypeInfo,\r\n\t/** 子游戏过场动画播放信息 */\r\n\tsubGameAnimationPlayInfo: SubGameAnimationPlayInfo,\r\n\t/** jackpot数据 */\r\n\tjackpotDatas: JackpotData[],\r\n\t/** jackpot总金额 */\r\n\tjackpotTotalAmount: number,\r\n\t/** 自动运行信息 */\r\n\tautoLauncherInfo: AutoLauncherInfo\r\n}\r\nexport interface IEvent {\r\n\tonSendBet: () => void\r\n}\r\n\r\n@ccclass('EgyptV2_Main')\r\nexport class EgyptV2_Main extends BaseComponent<IState, IProps, IEvent> {\r\n\tstart() {\r\n\r\n\t}\r\n\r\n\tprivate portraitSkLeft: sp.Skeleton;\r\n\tprivate portraitSkRight: sp.Skeleton;\r\n\tprivate gateSk: sp.Skeleton;\r\n\tprivate stepNumberV2: StepNumberV2 = new StepNumberV2(this);\r\n\r\n\tprivate props_aiji_kaiguanmenOrigonPos: Vec3\r\n\tprivate baseNodeOffectNode: Vec3;\r\n\t/** 原始缩放大小 */\r\n\tprivate baseNodeOrigonScale: Vec3 = new Vec3(1, 1, 1);\r\n\t/** 缩放大小 */\r\n\tprivate baseNodeScale: Vec3 = new Vec3(3, 3, 3);\r\n\r\n\tprotected propertyNode = {\r\n\t\tprops_main_bg: new Node(),\r\n\t\tprops_mini_game_bg: new Node(),\r\n\t\tprops_main_slot_bg: new Node(),\r\n\r\n\t\tprops_Up_Feature: new Node(),\r\n\t\tprops_buttomBar: new Node(),\r\n\t\tprops_roller: new Node(),\r\n\t\tprops_bet_dropdownlist: new Node(),\r\n\t\tprops_autoLauncher: new Node(),\r\n\t\tprops_aiji_kaiguanmen: new Node(),\r\n\t\tprops_aiji_zhuanquanding: new Node(),\r\n\t\tprops_btn_jackPot: new Node(),\r\n\t\tprops_jackpot_panel: new Node(),\r\n\t\tprops_btn_scrollView: new Node(),\r\n\t\tprops_jackpot_user_list: new Node(),\r\n\t\tprops_jackpot_item: new Node(),\r\n\t\tprops_skeletonRight: new Node(),\r\n\t\tprops_skeletonLeft: new Node(),\r\n\t\tprops_Label_jackpot: new Label(),\r\n\t\tprops_btn_off: new Node(),\r\n\t\tprops_btn_confirm: new Node()\r\n\t}\r\n\r\n\tpublic props: IProps = {\r\n\t\tbetDropDownlist: false,\r\n\t\tpositionId: 0,\r\n\t\tgold: 0,\r\n\t\tgameTypeInfo: {\r\n\t\t\tlastGameType: GameType.MAIN,\r\n\t\t\tcurrGameType: GameType.MAIN,\r\n\t\t\tviewGameType: GameType.MAIN,\r\n\t\t\tleftCount: 0\r\n\t\t},\r\n\t\tsubGameAnimationPlayInfo: null,\r\n\t\tjackpotDatas: [],\r\n\t\tjackpotTotalAmount: 0,\r\n\t\tautoLauncherInfo: null,\r\n\t}\r\n\tprivate selectedNode: Node\r\n\r\n\tpublic events: IEvent = {\r\n\t\tonSendBet: () => { }\r\n\t}\r\n\r\n\tpublic getHeader() {\r\n\t\treturn this.propertyNode.props_Up_Feature;\r\n\t}\r\n\r\n\tpublic getFooter() {\r\n\t\treturn this.propertyNode.props_buttomBar;\r\n\t}\r\n\r\n\tpublic getRoller() {\r\n\t\treturn this.propertyNode.props_roller;\r\n\t}\r\n\r\n\tprotected initState() {\r\n\t\treturn {}\r\n\t}\r\n\r\n\tprotected bindEvent(): void {\r\n\t\t// this.propertyNode.props_autoLauncher.getComponent(Animation).on(Animation.EventType.FINISHED, (e, state: AnimationState) => {\r\n\t\t// \tif (state.name === 'animation_autoLauncher_down') {\r\n\t\t// \t\tthis.propertyNode.props_bet_dropdownlist.active = false;\r\n\t\t// \t}\r\n\t\t// });\r\n\t\tthis.propertyNode.props_bet_dropdownlist.on(Node.EventType.TOUCH_END, () => {\r\n\t\t\tthis.dispatch(setBetDropDownList(false));\r\n\t\t})\r\n\r\n\t\tthis.propertyNode.props_btn_jackPot.on(Node.EventType.TOUCH_END, () => {\r\n\t\t\tegyptv2_Audio.playOneShot(SoundPathDefine.btn_click)\r\n\t\t\tthis.propertyNode.props_jackpot_panel.active = !this.propertyNode.props_jackpot_panel.active;\r\n\t\t\tthis.updateBtnScrollView();\r\n\t\t})\r\n\t\tthis.propertyNode.props_jackpot_panel.on(Node.EventType.TOUCH_END, () => {\r\n\t\t\tthis.propertyNode.props_jackpot_panel.active = false;\r\n\t\t\tthis.updateBtnScrollView();\r\n\t\t})\r\n\r\n\t\tthis.listenerBetDropDownListEvent();\r\n\r\n\t\tthis.portraitSkLeft.setCompleteListener((x: sp.spine.TrackEntry) => {\r\n\t\t\tif (this.node.isValid) {\r\n\t\t\t\tif (x.animation.name !== 'static') {\r\n\t\t\t\t\tthis.portraitSkLeft.setAnimation(0, 'static', false)\r\n\t\t\t\t\tthis.changeGateAnimation();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t})\r\n\t\tthis.portraitSkRight.setCompleteListener(() => {\r\n\t\t\tif (this.node.isValid) {\r\n\t\t\t\tthis.portraitSkRight.setAnimation(0, 'static', false)\r\n\t\t\t}\r\n\t\t})\r\n\r\n\t\tthis.gateSk.setCompleteListener((x: sp.spine.TrackEntry) => {\r\n\t\t\tif (this.node.isValid) {\r\n\t\t\t\tif (x.animation.name === 'shimen_kaimen') {\r\n\t\t\t\t} else if (x.animation.name === 'shimen_guanmenhuocheng') {\r\n\t\t\t\t} else if (x.animation.name === 'shimen_zhuanquanding') {\r\n\t\t\t\t} else if (x.animation.name === 'shimen_guangmen') {\r\n\t\t\t\t\t// 关门后隐藏转圈动画\r\n\t\t\t\t\tthis.propertyNode.props_aiji_zhuanquanding.active = false;\r\n\t\t\t\t\tthis.gateSk.setAnimation(0, 'shimen_kaimen', false)\r\n\t\t\t\t\t// 与开门同步进行，关门后开门表示从小游戏切换到主游戏\r\n\t\t\t\t\tthis.scheduleOnce(() => {\r\n\t\t\t\t\t\t// 如果下一个是主游戏，直接就结束动画了\r\n\t\t\t\t\t\tif (this.isNextMainGame()) {\r\n\t\t\t\t\t\t\tthis.propertyNode.props_aiji_kaiguanmen.active = false;\r\n\t\t\t\t\t\t\tthis.subGameAnimationEndHandle(0);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}, 1)\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t})\r\n\t}\r\n\r\n\tprivate listenerBetDropDownListEvent() {\r\n\t\tthis.propertyNode.props_autoLauncher.children.forEach((toggle) => {\r\n\t\t\ttoggle.getComponent(Toggle).node.on(Node.EventType.TOUCH_END, this.onToggleClick, this);\r\n\t\t});\r\n\t\tthis.propertyNode.props_btn_off.on(Node.EventType.TOUCH_END, () => {\r\n\t\t\tthis.openAoutoPanl()\r\n\t\t})\r\n\t\tthis.propertyNode.props_btn_confirm.on(Node.EventType.TOUCH_END, () => {\r\n\t\t\tconst autoLauncherType = (this.selectedNode ? this.selectedNode.name : 't10') as AutoLauncherType; // 默认T10\r\n\t\t\tconst count = getAutoCount(autoLauncherType);\r\n\t\t\tthis.dispatch(setAutoLauncherInfo({\r\n\t\t\t\tautoLauncherType: autoLauncherType,\r\n\t\t\t\ttotalCount: count,\r\n\t\t\t\tleftCount: isLimit(autoLauncherType) ? 1 : count - 1,\r\n\t\t\t}))\r\n\t\t\tegyptv2_Audio.playOneShot(SoundPathDefine.biu)\r\n\t\t\tthis.dispatch(setBetDropDownList(false));\r\n\t\t\tthis.events.onSendBet();\r\n\t\t\tthis.openAoutoPanl()\r\n\t\t})\r\n\t}\r\n\tpublic openAoutoPanl() {\r\n\t\tthis.propertyNode.props_bet_dropdownlist.active = !this.propertyNode.props_bet_dropdownlist.active\r\n\t}\r\n\tpublic getAutoState() {\r\n\t\treturn this.propertyNode.props_bet_dropdownlist.active\r\n\t}\r\n\tpublic clearAuto() {\r\n\t\tthis.dispatch(setAutoLauncherInfo({\r\n\t\t\tautoLauncherType: AutoLauncherType.NONE,\r\n\t\t\ttotalCount: 0,\r\n\t\t\tleftCount: 0\r\n\t\t}))\r\n\t}\r\n\tprivate onToggleClick(event) {\r\n\t\t// 获取点击的 Toggle 按钮\r\n\t\tconst clickedToggle = event.target.getComponent(Toggle);\r\n\t\tif (!clickedToggle.isChecked) {\r\n\t\t\tclickedToggle.isChecked = true;\r\n\t\t\tthis.selectedNode = event.target\r\n\t\t\treturn;\r\n\t\t}\r\n\t\t// 取消其他 Toggle 按钮的选中状态\r\n\t\tthis.propertyNode.props_autoLauncher.children.forEach((toggle) => {\r\n\t\t\tif (toggle !== clickedToggle) {\r\n\t\t\t\ttoggle.getComponent(Toggle).isChecked = false;\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\tprotected useProps(key: keyof IProps, value: { pre: any, cur: any }) {\r\n\t\t// console.log(\"key\", key, \"value\", value);\r\n\t\tif (this.node && this.node.isValid) {\r\n\t\t\tif (key === 'betDropDownlist') {\r\n\t\t\t\tthis.showOrHideBetDropDownlist(value.cur)\r\n\t\t\t} else if (key === 'subGameAnimationPlayInfo') {\r\n\t\t\t\tif (value.cur) {\r\n\t\t\t\t\tthis.playSubGameAnimation();\r\n\t\t\t\t}\r\n\t\t\t} else if (key === 'gameTypeInfo') {\r\n\t\t\t\tthis.changeGameType(this.props.gameTypeInfo.viewGameType);\r\n\t\t\t} else if (key === 'jackpotDatas') {\r\n\t\t\t\tthis.updateJackpotContent();\r\n\t\t\t} else if (key === 'jackpotTotalAmount') {\r\n\t\t\t\tthis.updateJackpotAmount(false, value);\r\n\t\t\t} else if (key === 'positionId') {\r\n\t\t\t\tthis.updateJackpotAmount(true, value);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tprivate changeGameType(gameType: GameType) {\r\n\t\tconst isMainGame = gameType === GameType.MAIN;\r\n\t\tconst isSubGame2 = gameType === GameType.SUBGAME2;\r\n\t\t// 主游戏要显示的界面\r\n\t\tthis.propertyNode.props_skeletonRight.active = isMainGame;\r\n\t\tthis.propertyNode.props_skeletonLeft.active = isMainGame;\r\n\t\tthis.propertyNode.props_main_bg.active = isMainGame || isSubGame2\r\n\t\tthis.propertyNode.props_main_slot_bg.active = isMainGame || isSubGame2\r\n\r\n\t\t// 子游戏要显示的界面\r\n\t\tthis.propertyNode.props_mini_game_bg.active = !isMainGame && !isSubGame2\r\n\t}\r\n\r\n\t/**是否准备切换游戏 */\r\n\tprivate isChangeGame() {\r\n\t\treturn this.props.gameTypeInfo && this.props.gameTypeInfo.viewGameType !== this.props.gameTypeInfo.currGameType;\r\n\t}\r\n\r\n\tprivate showOrHideBetDropDownlist(status: boolean) {\r\n\t\tconst pos = this.propertyNode.props_autoLauncher.position;\r\n\t\tif (status) {\r\n\t\t\tthis.propertyNode.props_bet_dropdownlist.active = true;\r\n\t\t\tthis.propertyNode.props_autoLauncher.getComponent(Animation).play(\"animation_autoLauncher_up\");\r\n\t\t\t// tween(this.propertyNode.props_autoLauncher.getComponent(UIOpacity)).to(0.5, { opacity: 255 }).start();\r\n\t\t\t// tween(this.propertyNode.props_autoLauncher).to(0.2, { position: new Vec3(pos.x, -160) }).start();\r\n\t\t} else {\r\n\t\t\tthis.propertyNode.props_autoLauncher.getComponent(Animation).play(\"animation_autoLauncher_down\");\r\n\t\t\t// tween(this.propertyNode.props_autoLauncher.getComponent(UIOpacity)).to(0.5, { opacity: 0 }).start();\r\n\t\t\t// tween(this.propertyNode.props_autoLauncher).to(0.2, { position: new Vec3(pos.x, -500) }).call(() => {\r\n\t\t\t// \tthis.node.isValid && (this.propertyNode.props_bet_dropdownlist.active = false);\r\n\t\t\t// }).start();\r\n\t\t}\r\n\t}\r\n\r\n\tprotected bindUI(): void {\r\n\t\t// this.props_aiji_kaiguanmenOrigonPos = this.propertyNode.props_aiji_kaiguanmen.position.clone();\r\n\t\tthis.props_aiji_kaiguanmenOrigonPos = new Vec3();\r\n\t\tthis.baseNodeOffectNode = new Vec3(-100, -200);\r\n\r\n\t\tthis.propertyNode.props_bet_dropdownlist.active = false;\r\n\r\n\t\tthis.gateSk = this.propertyNode.props_aiji_kaiguanmen.getComponent(sp.Skeleton)\r\n\t\tthis.portraitSkLeft = this.propertyNode.props_skeletonLeft.getComponent(sp.Skeleton)\r\n\t\tthis.portraitSkRight = this.propertyNode.props_skeletonRight.getComponent(sp.Skeleton)\r\n\r\n\t\tthis.updateKaiGuanMen();\r\n\t}\r\n\r\n\tprivate updateKaiGuanMen() {\r\n\t\tthis.propertyNode.props_aiji_kaiguanmen.active = false;\r\n\t\tthis.propertyNode.props_aiji_zhuanquanding.active = false;\r\n\t}\r\n\r\n\tprivate isSubGame(gameType: GameType) {\r\n\t\treturn gameType === GameType.SUBGAME1 || gameType === GameType.SUBGAME2\r\n\t}\r\n\r\n\tprivate isNextMainGame() {\r\n\t\treturn this.props.gameTypeInfo.currGameType === GameType.MAIN;\r\n\t}\r\n\r\n\tprivate playSubGameAnimation() {\r\n\t\tif (this.isSubGame(this.props.subGameAnimationPlayInfo.gameType)) {\r\n\t\t\tegyptv2_Audio.playOneShot(SoundPathDefine.sgbegin1, 1.0, false);\r\n\t\t\t// param 0表示从主游戏切到子游戏,param 1表示从子游戏切到主游戏\r\n\t\t\tif (this.props.subGameAnimationPlayInfo.param === 0) {\r\n\t\t\t\t// 如果左右两边神像显示了就走动画，否则直接开门动画\r\n\t\t\t\tif (this.propertyNode.props_skeletonLeft.active) {\r\n\t\t\t\t\tthis.portraitSkLeft.setAnimation(0, 'dynamic', false)\r\n\t\t\t\t\tthis.portraitSkRight.setAnimation(0, 'dynamic', false)\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.changeGateAnimation()\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\t// 先切到关门的效果然后暂停，这样动画就停在了门是打开的效果\r\n\t\t\t\tthis.gateSk.setAnimation(0, 'shimen_guangmen', false)\r\n\t\t\t\tthis.gateSk.paused = true;\r\n\r\n\t\t\t\tthis.propertyNode.props_aiji_kaiguanmen.active = true;\r\n\t\t\t\tthis.propertyNode.props_aiji_zhuanquanding.active = true;\r\n\t\t\t\tthis.node.setScale(this.baseNodeScale)\r\n\t\t\t\tthis.node.setPosition(this.baseNodeOffectNode);\r\n\t\t\t\tthis.changeGameType(GameType.MAIN);\r\n\t\t\t\ttween(this.node).show()\r\n\t\t\t\t\t.to(config.normalRollOption.zoomingTime, { scale: this.baseNodeOrigonScale, position: this.props_aiji_kaiguanmenOrigonPos })\r\n\t\t\t\t\t.call(() => {\r\n\t\t\t\t\t\tif (this.node.isValid) {\r\n\t\t\t\t\t\t\tthis.gateSk.paused = false;\r\n\t\t\t\t\t\t\tthis.gateSk.timeScale = 2;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t})\r\n\t\t\t\t\t.start()\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\t/**切换大门动画 */\r\n\tprivate changeGateAnimation() {\r\n\t\tthis.propertyNode.props_aiji_kaiguanmen.active = true;\r\n\t\tthis.propertyNode.props_aiji_zhuanquanding.active = true;\r\n\t\tif (this.props.subGameAnimationPlayInfo.param === 0) {\r\n\t\t\tthis.gateSk.timeScale = 1;\r\n\t\t\tthis.gateSk.setAnimation(0, 'shimen_guangmen', false)\r\n\t\t\t// egyptv2_Audio.playOneShot(SoundPathDefine.guanmen);\r\n\r\n\t\t\t// 关门之后再开门，然后抖动整个画面，抖动完成之后，再开门放大\r\n\t\t\tthis.scheduleOnce(() => {\r\n\t\t\t\tnew Shake().shake(this.node, 0.6, 1, 1, 'xy', () => {\r\n\t\t\t\t\t// 关门后隐藏转圈动画\r\n\t\t\t\t\tthis.node.isValid && this.gateSk.setAnimation(0, 'shimen_kaimen', false)\r\n\t\t\t\t\tthis.scaleNode();\r\n\t\t\t\t}).start();\r\n\t\t\t}, 1)\r\n\t\t}\r\n\t}\r\n\r\n\tprivate scaleNode() {\r\n\t\t// 和开门动画同时进行，开门之后的动画，放大整个游戏，进入到小游戏\r\n\t\tthis.scheduleOnce(() => {\r\n\t\t\t// this.gateSk.setAnimation(0, 'shimen_zhuanquanding', true)\r\n\t\t\tthis.node.isValid && tween(this.node)\r\n\t\t\t\t.to(config.normalRollOption.zoomingTime, { scale: this.baseNodeScale, position: this.baseNodeOffectNode })\r\n\t\t\t\t.call(() => {\r\n\t\t\t\t\tif (this.node.isValid) {\r\n\t\t\t\t\t\tthis.propertyNode.props_aiji_kaiguanmen.active = false;\r\n\t\t\t\t\t\tthis.propertyNode.props_aiji_zhuanquanding.active = false;\r\n\t\t\t\t\t\tthis.node.setScale(this.baseNodeOrigonScale);\r\n\t\t\t\t\t\tthis.node.setPosition(this.props_aiji_kaiguanmenOrigonPos);\r\n\t\t\t\t\t\tthis.subGameAnimationEndHandle(0);\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t\t.start()\r\n\t\t}, 1)\r\n\t}\r\n\r\n\t/**动画结束处理 */\r\n\tprivate subGameAnimationEndHandle(type: number) {\r\n\r\n\t\tconst gameTypeInfo = { ...this.props.gameTypeInfo }\r\n\t\tgameTypeInfo.lastGameType = gameTypeInfo.viewGameType;\r\n\t\tgameTypeInfo.viewGameType = gameTypeInfo.currGameType;\r\n\t\tthis.dispatch(changeGame(gameTypeInfo))\r\n\r\n\t\t// 进入到小游戏1之后，把进入前的这一局的输赢设置为0\r\n\t\tif (gameTypeInfo.viewGameType === GameType.SUBGAME1) {\r\n\t\t\tthis.dispatch(updateWinloss(0));\r\n\t\t}\r\n\r\n\t\tmainViewModel.playBgMusic();\r\n\r\n\t\t// 开门动画结束，准备切换到小游戏后，结束游戏\r\n\t\tif (type === 0) {\r\n\t\t\tthis.scheduleOnce(() => {\r\n\t\t\t\tthis.dispatch(updateRollerStatus(RollerStatus.END))\r\n\t\t\t}, 1)\r\n\t\t}\r\n\t}\r\n\r\n\tprivate updateJackpotContent() {\r\n\t\tif (this.propertyNode.props_jackpot_panel && this.propertyNode.props_jackpot_panel.isValid) {\r\n\t\t\t// this.buildJackpotItem(this.props.jackpotDatas.shift(), false);\r\n\r\n\t\t\t// 找出已经不存在的jackpot，卸载掉\r\n\t\t\tthis.propertyNode.props_jackpot_user_list.children.forEach(v => {\r\n\t\t\t\tconst jackpotData = this.props.jackpotDatas.find(jackpot => jackpot.nickName === v.name)\r\n\t\t\t\tif (!jackpotData) {\r\n\t\t\t\t\tv.destroy();\r\n\t\t\t\t} else {\r\n\t\t\t\t\tgetNodeByNameDeep(\"props_item_amount\", v).getComponent(Label).string = jackpotData.winningAmount.formatAmountWithCommas();\r\n\t\t\t\t}\r\n\t\t\t})\r\n\r\n\t\t\tthis.props.jackpotDatas.forEach(v => {\r\n\t\t\t\tconst children = this.propertyNode.props_jackpot_user_list.children;\r\n\t\t\t\tconst jackpotNode = children.find(jackpotNode => jackpotNode.name === v.nickName)\r\n\t\t\t\tif (!jackpotNode) {\r\n\t\t\t\t\tconst item = this.buildJackpotItem(v);\r\n\t\t\t\t\titem.setPosition(new Vec3());\r\n\t\t\t\t\tif (children.length > 0) {\r\n\t\t\t\t\t\titem.setPosition(children[children.length - 1].position.clone().add(new Vec3(0, -60, 0)));\r\n\t\t\t\t\t}\r\n\t\t\t\t\tthis.propertyNode.props_jackpot_user_list.addChild(item)\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t}\r\n\t}\r\n\r\n\tprivate updateBtnScrollView() {\r\n\t\tlet scaleY = this.propertyNode.props_jackpot_panel.active ? 1 : -1;\r\n\t\tthis.propertyNode.props_btn_scrollView.setScale(new Vec3(1, scaleY));\r\n\t}\r\n\r\n\tprivate buildJackpotItem(jackpotData: JackpotData, isCopy: boolean = true) {\r\n\t\tif (!jackpotData) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tconst jackpotItem = isCopy ? instantiate(this.propertyNode.props_jackpot_item) : this.propertyNode.props_jackpot_item;\r\n\t\tjackpotItem.active = true;\r\n\t\tconst headNode = getNodeByNameDeep(\"props_item_head\", jackpotItem).getComponent(Sprite)\r\n\t\tgetNodeByNameDeep(\"props_item_amount\", jackpotItem).getComponent(Label).string = jackpotData.winningAmount.formatAmountWithCommas();\r\n\t\tgetNodeByNameDeep(\"props_item_nickname\", jackpotItem).getComponent(Label).string = jackpotData.nickName;\r\n\t\tjackpotItem.name = jackpotData.nickName;\r\n\r\n\t\tglobal.loadHeadSprite(jackpotData.avatarIndex, headNode)\r\n\t\treturn jackpotItem\r\n\t}\r\n\r\n\tprivate updateJackpotAmount(updatePositionId: boolean, value: { pre: any, cur: any }) {\r\n\t\tlet begin = value.pre;\r\n\t\tlet end = value.cur;\r\n\t\tif (calBetAmount(this.props.positionId) < config.betAmountLimit) {\r\n\t\t\tif (updatePositionId) {\r\n\t\t\t\tbegin = 0\r\n\t\t\t\tif (value.pre) {\r\n\t\t\t\t\tconst amountInfoBegin = config.betSwitcher[0].amount.find(v => v.positionId === value.pre);\r\n\t\t\t\t\tbegin = config.winning[3].minRate * amountInfoBegin.value\r\n\t\t\t\t}\r\n\t\t\t\tconst amountInfoEnd = config.betSwitcher[0].amount.find(v => v.positionId === value.cur);\r\n\t\t\t\tend = config.winning[3].minRate * amountInfoEnd.value\r\n\t\t\t} else {\r\n\t\t\t\tend = undefined;\r\n\t\t\t\tconst amountInfoEnd = config.betSwitcher[0].amount.find(v => v.positionId === this.props.positionId);\r\n\t\t\t\tthis.propertyNode.props_Label_jackpot.string = (config.winning[3].minRate * amountInfoEnd.value).formatAmountWithCommas();\r\n\t\t\t}\r\n\t\t} else if (updatePositionId) {\r\n\t\t\tbegin = 0\r\n\t\t\tif (value.pre) {\r\n\t\t\t\tconst amountInfoBegin = config.betSwitcher[0].amount.find(v => v.positionId === value.pre);\r\n\t\t\t\tbegin = config.winning[3].minRate * amountInfoBegin.value\r\n\t\t\t}\r\n\t\t\tend = this.props.jackpotTotalAmount;\r\n\t\t}\r\n\r\n\t\tif (end !== undefined) {\r\n\t\t\tthis.stepNumberV2.start(begin, end, (num) => {\r\n\t\t\t\tif (this.node && this.node.isValid) {\r\n\t\t\t\t\tconst value = Number(num.toFixed(0));\r\n\t\t\t\t\tthis.propertyNode.props_Label_jackpot.string = value.formatAmountWithCommas();\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\r\n\tupdate(deltaTime: number) {\r\n\r\n\t}\r\n}\r\n\r\n"]}