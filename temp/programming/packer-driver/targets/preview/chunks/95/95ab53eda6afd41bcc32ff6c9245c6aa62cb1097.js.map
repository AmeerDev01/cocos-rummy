{"version":3,"sources":["file:///Users/geliang/web/dibai/hall/assets/script/subGame/starlight/components/Starlight_SmallGame_caculate.ts"],"names":["_decorator","Label","Node","sp","BaseComponent","StepNumber","SkeletonAnimationPlayer","AutoLauncherType","starlight_Audio","SoundPathDefine","ccclass","property","Starlight_SmallGame_caculate","ani","propertyNode","props_node_start","props_node_end","props_label_goldNum","props_label_sgNum","props_calcuate_box","props","type","total","autoLaunchType","NONE","events","killSelfHandler","start","initState","bindEvent","on","EventType","TOUCH_END","e","string","formatAmountWithCommas","playOneShot","FREE_TRANS","getComponent","Skeleton","scheduleOnce","playAnimation","useProps","key","value","active","cur","num","toFixed","changeAnimation","startFalling","clearTheDrop","bindUI","update","deltaTime"],"mappings":"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","sourcesContent":["import { _decorator, instantiate, Component, Label, Layout, Node, ScrollView, tween, Vec3, log, Sprite, sp } from 'cc';\r\nimport { BaseComponent } from '../../../base/BaseComponent';\r\nimport StepNumber from '../../../utils/StepNumber';\r\nimport SkeletonAnimationPlayer from '../SkeletonPlay';\r\nimport { AutoLauncherType } from '../type';\r\nimport { starlight_Audio } from '../index';\r\nimport { SoundPathDefine } from '../sourceDefine/soundDefine';\r\nconst { ccclass, property } = _decorator;\r\n\r\nexport interface IState {\r\n\r\n}\r\n\r\nexport interface IProps {\r\n\ttype?:Number,\r\n\ttotal?: number,\r\n\tautoLaunchType?: AutoLauncherType,\r\n}\r\nexport interface IEvent {\r\n\t/**自灭弹窗 */\r\n\tkillSelfHandler: () => void\r\n}\r\n\r\n@ccclass('Starlight_SmallGame_caculate')\r\nexport class Starlight_SmallGame_caculate extends BaseComponent<IState, IProps, IEvent> {\r\n\tani=true\r\n\tstart() {\r\n\r\n\t}\r\n\r\n\tprotected propertyNode = {\r\n\t\tprops_node_start: new Node(),\r\n\t\tprops_node_end: new Node(),\r\n\t\tprops_label_goldNum: new Label(),\r\n\t\tprops_label_sgNum: new Label(),\r\n\t\tprops_calcuate_box: new Node(),\r\n\t}\r\n\r\n\tpublic props: IProps = {\r\n\t\ttype:1,\r\n\t\ttotal:0,\r\n\t\tautoLaunchType:AutoLauncherType.NONE\r\n\t}\r\n\r\n\tpublic events: IEvent = {\r\n\t\tkillSelfHandler: () => { }\r\n\t}\r\n\r\n\tprotected initState() {\r\n\t\treturn {\r\n\r\n\t\t}\r\n\t}\r\n\r\n\tprotected bindEvent(): void {\r\n\t\tthis.propertyNode.props_calcuate_box.on(Node.EventType.TOUCH_END, (e => {\r\n\t\t\tif(this.ani){\r\n\t\t\t\tthis.ani=false\r\n\t\t\t\tif(this.props.type===1){\r\n\t\t\t\t\tthis.propertyNode.props_label_sgNum&&(this.propertyNode.props_label_sgNum.string=this.props.total.formatAmountWithCommas())\r\n\t\t\t\t}else{\r\n\t\t\t\t\tthis.propertyNode.props_label_goldNum&&(this.propertyNode.props_label_goldNum.string=this.props.total.formatAmountWithCommas())\r\n\t\t\t\t}\r\n\t\t\t\tstarlight_Audio.playOneShot(SoundPathDefine.FREE_TRANS)\r\n\t\t\t\tnew SkeletonAnimationPlayer(this.propertyNode.props_calcuate_box.getComponent(sp.Skeleton), \"cx3\", false, () => {\r\n\t\t\t\t\tthis.scheduleOnce(()=>{\r\n\t\t\t\t\tthis.ani=true\r\n\t\t\t\t\t\tthis.events && this.events.killSelfHandler()\r\n\t\t\t\t\t},1)\r\n\t\t\t\t}).playAnimation();\r\n\t\t\t}\r\n\t\t}))\r\n\t}\r\n\r\n\tprotected useProps(key: keyof IProps, value: { pre: any, cur: any }) {\r\n\t\tif(key === \"type\" || key===\"total\" ){\r\n\t\t\tif(this.props.type===1){\r\n\t\t\t\tthis.propertyNode.props_node_start.active=true\r\n\t\t\t\tthis.propertyNode.props_node_end.active=false\r\n\t\t\t\tlet ani=new SkeletonAnimationPlayer(this.propertyNode.props_calcuate_box.getComponent(sp.Skeleton), \"cx\", false, () => {\r\n\t\t\t\t\t(new StepNumber(0, value.cur, (num) => {\r\n\t\t\t\t\t\tthis.propertyNode && this.propertyNode.props_label_sgNum && (this.propertyNode.props_label_sgNum.string = (+num.toFixed(0)).formatAmountWithCommas())\r\n\t\t\t\t\t})).start()\r\n\t\t\t\t\tani.changeAnimation('cx2', false, () => {\r\n\t\t\t\t\t\tif(this.props.autoLaunchType!==AutoLauncherType.NONE){\r\n\t\t\t\t\t\t\tthis.scheduleOnce(()=>{\r\n\t\t\t\t\t\t\t\tthis.events && this.events.killSelfHandler()\r\n\t\t\t\t\t\t\t},2)\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t})\r\n\t\t\t\t});\r\n\t\t\t\tani.playAnimation();\r\n\t\t\t}\t\r\n\t\t\tif(this.props.type===2){\r\n\t\t\t\tthis.propertyNode.props_node_start.active=false\r\n\t\t\t\tthis.propertyNode.props_node_end.active=true\r\n\t\t\t\tlet ani=new SkeletonAnimationPlayer(this.propertyNode.props_calcuate_box.getComponent(sp.Skeleton), \"cx\", false, () => {\r\n\t\t\t\t\t(new StepNumber(0, value.cur, (num) => {\r\n\t\t\t\t\t\tthis.propertyNode && this.propertyNode.props_label_goldNum && (this.propertyNode.props_label_goldNum.string = (+num.toFixed(0)).formatAmountWithCommas())\r\n\t\t\t\t\t},()=>{})).start()\r\n\t\t\t\t\tif(this.props.autoLaunchType!==AutoLauncherType.NONE){\r\n\t\t\t\t\t\tthis.scheduleOnce(()=>{\r\n\t\t\t\t\t\t\tthis.events && this.events.killSelfHandler()\r\n\t\t\t\t\t\t},2)\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t\tani.playAnimation();\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\tprivate startFalling() {\r\n\r\n\t}\r\n\tprivate clearTheDrop() {\r\n\r\n\t}\r\n\tprotected bindUI(): void {\r\n\r\n\t}\r\n\r\n\tupdate(deltaTime: number) {\r\n\r\n\t}\r\n}\r\n\r\n"]}