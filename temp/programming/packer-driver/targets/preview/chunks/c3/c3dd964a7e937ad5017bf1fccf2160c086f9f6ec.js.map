{"version":3,"sources":["file:///Users/geliang/web/dibai/hall/assets/script/subGame/starlight/components/Starlight_Header.ts"],"names":["_decorator","Animation","Label","Node","Sprite","BaseComponent","global","lang","TaskScheduler","StepNumber","starlight_Audio","SoundPathDefine","addToastAction","changeAutoLauncherType","setAutoLaunchedTimes","AutoLauncherType","ccclass","property","Starlight_Header","taskScheduler","stepNumber","propertyNode","props_btn_up_home","props_btn_up_set","props_Label_up_goldNum","props_layout_glod","props_btn_up_addGold","props_btn_up_menu","props_spr_menu_bg","props_btn_info","props_btn_vip","props_menu_panel","props","balance","isRollEnd","bettingInformation","events","openHelpPanel","isShowMenu","start","initState","bindEvent","console","log","on","EventType","TOUCH_END","closeGame","closeSubGame","hallDispatch","content","write","k","palyingModule","GameExit","placeStr","playOneShot","BUTTONCLICK","openPersonCenter","openShop","active","getComponent","stop","play","e","preventSwallow","scheduleOnce","TOUCH_START","TOUCH_MOVE","TOUCH_CANCEL","openVipMain","dispatch","NONE","useProps","key","value","pre","cur","num","string","toFixed","Number","formatAmountWithCommas","formatAmountWithLetter","setFlyNode","node","parent","grayscale","destroyCallBack","destoryQueue","bindUI","update","deltaTime"],"mappings":"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","sourcesContent":["import { _decorator, Animation, Button, Component, EventTouch, Label, Node, Sprite } from 'cc';\r\nimport { BaseComponent } from '../../../base/BaseComponent';\r\nimport { global, lang } from '../../../hall';\r\nimport TaskScheduler, { Task } from '../../../utils/TaskScheduler';\r\nimport StepNumber from '../../../utils/StepNumber';\r\nimport { starlight_Audio } from '../index';\r\nimport { SoundPathDefine } from '../sourceDefine/soundDefine';\r\nimport { addToastAction } from '../../../hall/store/actions/baseBoard';\r\nimport { changeAutoLauncherType, setAutoLaunchedTimes } from '../store/actions/game';\r\nimport { AutoLauncherType } from '../type';\r\nimport { setRollRoundEnd } from '../store/actions/roller';\r\nimport { BuyType } from '../../../hall/components/Hall_ShopPanel';\r\nimport { log } from '../../../common/fish/CalculteRule';\r\nconst { ccclass, property } = _decorator;\r\n\r\nexport interface IState {\r\n\r\n}\r\n\r\nexport interface IProps {\r\n\tbalance: number\r\n\tisRollEnd: boolean\r\n\tbettingInformation:any\r\n}\r\nexport interface IEvent {\r\n\topenHelpPanel:()=>void\r\n}\r\n\r\n@ccclass('Starlight_Header')\r\nexport class Starlight_Header extends BaseComponent<IState, IProps, IEvent> {\r\n\tstart() { }\r\n\tprivate taskScheduler: TaskScheduler = new TaskScheduler()\r\n\tprivate stepNumber: StepNumber\r\n\tprotected propertyNode = {\r\n\t\tprops_btn_up_home: new Node(),\r\n\t\tprops_btn_up_set: new Node(),\r\n\t\tprops_Label_up_goldNum: new Label(),\r\n\t\tprops_layout_glod: new Node(),\r\n\t\tprops_btn_up_addGold: new Node(),\r\n\t\tprops_btn_up_menu: new Node(),\r\n\t\tprops_spr_menu_bg: new Node(),\r\n\t\tprops_btn_info: new Node(),\r\n\t\tprops_btn_vip: new Node(),\r\n\t\tprops_menu_panel: new Node()\r\n\t}\r\n\r\n\tpublic props: IProps = {\r\n\t\tbalance: 0,\r\n\t\tisRollEnd: true,\r\n\t\tbettingInformation:null\r\n\t}\r\n\r\n\tpublic events: IEvent = {\r\n\t\topenHelpPanel:()=>{}\r\n\t}\r\n\r\n\tprotected initState() {\r\n\t\treturn {\r\n\r\n\t\t}\r\n\t}\r\n\r\n\tprivate isShowMenu=false\r\n\tprotected bindEvent(): void {\r\n\t\tconsole.log(this.propertyNode.props_btn_up_menu);\r\n\t\tthis.propertyNode.props_btn_up_home.on(Node.EventType.TOUCH_END, () => {\r\n\t\t\tif (this.props.isRollEnd) {\r\n\t\t\t\tthis.closeGame()\r\n\t\t\t\tglobal.closeSubGame()\r\n\t\t\t} else {\r\n\t\t\t\tglobal.hallDispatch(addToastAction({ content: lang.write(k => k.palyingModule.GameExit, {}, { placeStr: \"游戏进行中\" }) }))\r\n\t\t\t}\r\n\t\t})\r\n\t\tthis.propertyNode.props_btn_up_set.on(Node.EventType.TOUCH_END, () => {\r\n\t\t\tstarlight_Audio.playOneShot(SoundPathDefine.BUTTONCLICK)\r\n\t\t\tglobal.openPersonCenter(2)\r\n\t\t})\r\n\t\tthis.propertyNode.props_layout_glod.on(Node.EventType.TOUCH_END, () => {\r\n\t\t\tstarlight_Audio.playOneShot(SoundPathDefine.BUTTONCLICK)\r\n\t\t\tglobal.openShop()\r\n\t\t})\r\n\t\tthis.propertyNode.props_btn_up_addGold.on(Node.EventType.TOUCH_END, () => {\r\n\t\t\tstarlight_Audio.playOneShot(SoundPathDefine.BUTTONCLICK)\r\n\t\t\tglobal.openShop()\r\n\t\t})\r\n\t\tthis.propertyNode.props_btn_info.on(Node.EventType.TOUCH_END, () => {\r\n\t\t\tstarlight_Audio.playOneShot(SoundPathDefine.BUTTONCLICK)\r\n\t\t\tthis.events.openHelpPanel()\r\n\t\t})\r\n\t\tthis.propertyNode.props_btn_up_menu.on(Node.EventType.TOUCH_END, () => {\r\n\t\t\tstarlight_Audio.playOneShot(SoundPathDefine.BUTTONCLICK)\r\n\t\t\tif (!this.isShowMenu) {\r\n\t\t\t\tthis.isShowMenu = true;\r\n\t\t\t\tthis.propertyNode.props_menu_panel.active=!this.propertyNode.props_menu_panel.active\r\n\t\t\t\tthis.propertyNode.props_spr_menu_bg.getComponent(Animation).stop();\r\n\t\t\t\tthis.propertyNode.props_spr_menu_bg.getComponent(Animation).play();\r\n\t\t\t}\r\n\t\t})\r\n\t\tthis.propertyNode.props_menu_panel.on(Node.EventType.TOUCH_END, (e: EventTouch) => {\r\n\t\t\te.preventSwallow = true;\r\n\t\t\tthis.propertyNode.props_menu_panel.active = false;\r\n\t\t\tthis.scheduleOnce(() => {\r\n\t\t\t\tthis.isShowMenu = false;\r\n\t\t\t}, 0.2)\r\n\t\t})\r\n\t\tthis.propertyNode.props_menu_panel.on(Node.EventType.TOUCH_START, (e: EventTouch) => {\r\n\t\t\te.preventSwallow = true;\r\n\t\t})\r\n\t\tthis.propertyNode.props_menu_panel.on(Node.EventType.TOUCH_MOVE, (e: EventTouch) => {\r\n\t\t\te.preventSwallow = true;\r\n\t\t})\r\n\t\tthis.propertyNode.props_menu_panel.on(Node.EventType.TOUCH_CANCEL, (e: EventTouch) => {\r\n\t\t\te.preventSwallow = true;\r\n\t\t})\r\n\t\tthis.propertyNode.props_btn_vip.on(Node.EventType.TOUCH_END, () => {\r\n\t\t\tstarlight_Audio.playOneShot(SoundPathDefine.BUTTONCLICK)\r\n\t\t\tglobal.openVipMain()\r\n\t\t})\r\n\t}\r\n\tpublic closeGame() {\r\n\t\tstarlight_Audio.playOneShot(SoundPathDefine.BUTTONCLICK)\r\n\t\tthis.dispatch(changeAutoLauncherType(AutoLauncherType.NONE))\r\n\t\tthis.dispatch(setAutoLaunchedTimes(0))\r\n\t}\r\n\tprotected useProps(key: keyof IProps, value: { pre: any, cur: any }) {\r\n\t\tif (key === \"balance\") {\r\n\t\t\tthis.stepNumber && this.stepNumber.stop()\r\n\t\t\tthis.stepNumber = new StepNumber(value.pre, value.cur, (num) => {\r\n\t\t\t\tthis.propertyNode && this.propertyNode.props_Label_up_goldNum && (this.propertyNode.props_Label_up_goldNum.string =(+num.toFixed(0)) < 1000000 ? Number(value.cur).formatAmountWithCommas() : Number(value.cur).formatAmountWithLetter())\r\n\t\t\t}, () => { })\r\n\t\t\tthis.stepNumber.setFlyNode(this.propertyNode.props_Label_up_goldNum.node.parent, this.propertyNode.props_Label_up_goldNum.node, 22)\r\n\t\t\tthis.stepNumber.start()\r\n\t\t}\r\n\t\tif(key === 'isRollEnd'){\r\n\t\t\tthis.propertyNode.props_btn_up_home.getComponent(Sprite).grayscale=!value.cur\r\n\t\t}\r\n\t}\r\n\r\n\tprotected destroyCallBack() {\r\n\t\tthis.taskScheduler.destoryQueue()\r\n\t}\r\n\r\n\tprotected bindUI(): void {\r\n\t\tthis.propertyNode.props_menu_panel.active=false\r\n\t}\r\n\r\n\tupdate(deltaTime: number) {\r\n\r\n\t}\r\n}\r\n\r\n"]}