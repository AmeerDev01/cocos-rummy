{"version":3,"sources":["file:///Users/geliang/web/dibai/hall/assets/script/subGame/thor/components/Thor_RollerIcon.ts"],"names":["_decorator","instantiate","Label","Node","sp","Sprite","tween","UITransform","Vec3","BaseComponent","IconEffectType","sourceManageSeletor","winShowViewModel","SkeletonAnimationPlayer","ccclass","property","Thor_RollerIcon","propertyNode","props_iconWrap","props_iconId","props_label_rate_num","props_focusBorder","props_skeleton_bomb","props","iconData","iconEffect","NONE","events","start","initState","bindEvent","useProps","key","value","uiTrasform","node","getComponent","width","height","iconNodeSkeleton","getChildByName","iconNodeSprite","active","iconNode","Skeleton","skeletonData","getFile","uiData","fileName","source","setSkin","skin","animation","animationArr","spriteFrame","iconName","iconId","string","multiple","setScale","scale","x","y","z","getPosition","setPosition","distance","isActive","cur","NORMAIL","scheduleOnce","playAni","callBack","i","ani","playAnimation","playallPurpose","startWorldPos","worldPosition","targetWorldPos","comp","addChild","uiTransform","startLocalPos","convertToNodeSpaceAR","targetLocalPos","to","position","easing","call","destroy","bindUI","update","deltaTime"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAASA,MAAAA,U,OAAAA,U;AAA8BC,MAAAA,W,OAAAA,W;AAAaC,MAAAA,K,OAAAA,K;AAAOC,MAAAA,I,OAAAA,I;AAAMC,MAAAA,E,OAAAA,E;AAAIC,MAAAA,M,OAAAA,M;AAAQC,MAAAA,K,OAAAA,K;AAAOC,MAAAA,W,OAAAA,W;AAAaC,MAAAA,I,OAAAA,I;;AACxFC,MAAAA,a,iBAAAA,a;;AACAC,MAAAA,c,iBAAAA,c;;AACAC,MAAAA,mB,iBAAAA,mB;AAAqBC,MAAAA,gB,iBAAAA,gB;;AAGvBC,MAAAA,uB;;;;;;;;;OACD;AAAEC,QAAAA,OAAF;AAAWC,QAAAA;AAAX,O,GAAwBf,U;;iCAgBjBgB,e,WADZF,OAAO,CAAC,iBAAD,C,gBAAR,MACaE,eADb;AAAA;AAAA,0CAC2E;AAAA;AAAA;AAAA,eAGhEC,YAHgE,GAGjD;AACxBC,YAAAA,cAAc,EAAE,IAAIf,IAAJ,EADQ;AAExBgB,YAAAA,YAAY,EAAE,IAAIjB,KAAJ,EAFU;AAGxBkB,YAAAA,oBAAoB,EAAE,IAAIjB,IAAJ,EAHE;AAIxBkB,YAAAA,iBAAiB,EAAE,IAAIlB,IAAJ,EAJK;AAKxBmB,YAAAA,mBAAmB,EAAE,IAAInB,IAAJ;AALG,WAHiD;AAAA,eAWnEoB,KAXmE,GAWnD;AACtBC,YAAAA,QAAQ,EAAE,IADY;AAEtBC,YAAAA,UAAU,EAAE;AAAA;AAAA,kDAAeC;AAFL,WAXmD;AAAA,eAgBnEC,MAhBmE,GAgBlD,EAhBkD;AAAA;;AAC1EC,QAAAA,KAAK,GAAG,CAAG;;AAmBDC,QAAAA,SAAS,GAAG;AACrB,iBAAO,EAAP;AAGA;;AAESC,QAAAA,SAAS,GAAS,CAE3B;;AAESC,QAAAA,QAAQ,CAACC,GAAD,EAAoBC,KAApB,EAAmD;AACpE,cAAID,GAAG,KAAK,UAAZ,EAAwB;AACvB,gBAAI,KAAKT,KAAL,CAAWC,QAAf,EAAyB;AACxB,kBAAMU,UAAU,GAAG,KAAKC,IAAL,CAAUC,YAAV,CAAuB7B,WAAvB,CAAnB;AACA2B,cAAAA,UAAU,CAACG,KAAX,GAAmB,KAAKd,KAAL,CAAWC,QAAX,CAAoBa,KAAvC;AACAH,cAAAA,UAAU,CAACI,MAAX,GAAoB,KAAKf,KAAL,CAAWC,QAAX,CAAoBc,MAAxC;AACA,kBAAMC,gBAAgB,GAAG,KAAKtB,YAAL,CAAkBC,cAAlB,CAAiCsB,cAAjC,CAAgD,mBAAhD,CAAzB;AACA,kBAAMC,cAAc,GAAG,KAAKxB,YAAL,CAAkBC,cAAlB,CAAiCsB,cAAjC,CAAgD,iBAAhD,CAAvB;AACAD,cAAAA,gBAAgB,CAACG,MAAjB,GAA0B,KAA1B;AACAD,cAAAA,cAAc,CAACC,MAAf,GAAwB,KAAxB;AACA,kBAAIC,QAAJ,CARwB,CASxB;AACA;AACA;AACA;AACA;AAEA;;AACAA,cAAAA,QAAQ,GAAGJ,gBAAX;AACAA,cAAAA,gBAAgB,CAACG,MAAjB,GAA0B,IAA1B;AACAH,cAAAA,gBAAgB,CAACH,YAAjB,CAA8BhC,EAAE,CAACwC,QAAjC,EAA2CC,YAA3C,GAA0D;AAAA;AAAA,gEAAsBC,OAAtB,CAA8B,KAAKvB,KAAL,CAAWC,QAAX,CAAoBuB,MAApB,CAA2BC,QAAzD,EAAmEC,MAA7H;AACAV,cAAAA,gBAAgB,CAACH,YAAjB,CAA8BhC,EAAE,CAACwC,QAAjC,EAA2CM,OAA3C,CAAmD,KAAK3B,KAAL,CAAWC,QAAX,CAAoBuB,MAApB,CAA2BI,IAA3B,GAAkC,KAAK5B,KAAL,CAAWC,QAAX,CAAoBuB,MAApB,CAA2BI,IAA7D,GAAoE,SAAvH;AACAZ,cAAAA,gBAAgB,CAACH,YAAjB,CAA8BhC,EAAE,CAACwC,QAAjC,EAA2CQ,SAA3C,GAAuD,KAAK7B,KAAL,CAAWC,QAAX,CAAoBuB,MAApB,CAA2BM,YAA3B,CAAwC,CAAxC,CAAvD;AACA,mBAAKpC,YAAL,CAAkBC,cAAlB,CAAiCsB,cAAjC,CAAgD,mBAAhD,EAAqEE,MAArE,GAA8E,KAA9E;AACA,mBAAKzB,YAAL,CAAkBC,cAAlB,CAAiCsB,cAAjC,CAAgD,iBAAhD,EAAmEE,MAAnE,GAA4E,IAA5E;AACA,mBAAKzB,YAAL,CAAkBC,cAAlB,CAAiCsB,cAAjC,CAAgD,iBAAhD,EAAmEJ,YAAnE,CAAgF/B,MAAhF,EAAwFiD,WAAxF,GAAsG;AAAA;AAAA,gEAAsBR,OAAtB,CAA8B,KAAKvB,KAAL,CAAWC,QAAX,CAAoBuB,MAApB,CAA2BQ,QAAzD,EAAmEN,MAAzK;;AACA,kBAAI,KAAK1B,KAAL,CAAWC,QAAX,CAAoBgC,MAApB,GAA6B,EAAjC,EAAqC;AACpC,qBAAKvC,YAAL,CAAkBG,oBAAlB,CAAuCsB,MAAvC,GAAgD,IAAhD;AACA,qBAAKzB,YAAL,CAAkBG,oBAAlB,CAAuCgB,YAAvC,CAAoDlC,KAApD,EAA2DuD,MAA3D,GAAoE,KAAKlC,KAAL,CAAWC,QAAX,CAAoBkC,QAApB,GAA+B,GAAnG;AACA;;AACDf,cAAAA,QAAQ,CAACgB,QAAT,CAAkB,IAAInD,IAAJ,CAAS,GAAG,KAAKe,KAAL,CAAWC,QAAX,CAAoBuB,MAApB,CAA2Ba,KAAvC,CAAlB;AACA,kBAAM;AAAEC,gBAAAA,CAAF;AAAKC,gBAAAA,CAAL;AAAQC,gBAAAA;AAAR,kBAAcpB,QAAQ,CAACqB,WAAT,EAApB;AACArB,cAAAA,QAAQ,CAACsB,WAAT,CAAqB,IAAIzD,IAAJ,CAASqD,CAAC,GAAG,KAAKtC,KAAL,CAAWC,QAAX,CAAoBuB,MAApB,CAA2BmB,QAA3B,CAAoC,CAApC,CAAb,EAAqDJ,CAAC,GAAG,KAAKvC,KAAL,CAAWC,QAAX,CAAoBuB,MAApB,CAA2BmB,QAA3B,CAAoC,CAApC,CAAzD,EAAiGL,CAAjG,CAArB,EA9BwB,CA+BxB;AACA;AACD;;AACD,cAAI7B,GAAG,KAAK,YAAZ,EAA0B;AACzB;AACA,gBAAMmC,QAAQ,GAAIlC,KAAK,CAACmC,GAAN,KAAc;AAAA;AAAA,kDAAeC,OAA/C;AACA,iBAAKpD,YAAL,CAAkBI,iBAAlB,CAAoCqB,MAApC,GAA6CyB,QAA7C;AACA,iBAAKlD,YAAL,CAAkBC,cAAlB,CAAiCsB,cAAjC,CAAgD,mBAAhD,EAAqEE,MAArE,GAA8E,IAA9E;AACA,iBAAKzB,YAAL,CAAkBC,cAAlB,CAAiCsB,cAAjC,CAAgD,iBAAhD,EAAmEE,MAAnE,GAA4E,KAA5E;AACA,iBAAKzB,YAAL,CAAkBC,cAAlB,CAAiCsB,cAAjC,CAAgD,mBAAhD,EAAqEJ,YAArE,CAAkFhC,EAAE,CAACwC,QAArF,EAA+FM,OAA/F,CAAuG,KAAK3B,KAAL,CAAWC,QAAX,CAAoBuB,MAApB,CAA2BI,IAA3B,GAAkC,KAAK5B,KAAL,CAAWC,QAAX,CAAoBuB,MAApB,CAA2BI,IAA7D,GAAoE,SAA3K;AACA,iBAAKlC,YAAL,CAAkBC,cAAlB,CAAiCsB,cAAjC,CAAgD,mBAAhD,EAAqEJ,YAArE,CAAkFhC,EAAE,CAACwC,QAArF,EAA+FQ,SAA/F,GAA2G,KAAK7B,KAAL,CAAWC,QAAX,CAAoBuB,MAApB,CAA2BM,YAA3B,CAAwCc,QAAQ,GAAG,CAAH,GAAO,CAAvD,CAA3G;AACA,iBAAKG,YAAL,CAAkB,MAAM;AACvB,mBAAKrD,YAAL,CAAkBC,cAAlB,CAAiCsB,cAAjC,CAAgD,mBAAhD,EAAqEE,MAArE,GAA8E,KAA9E;AACA,mBAAKzB,YAAL,CAAkBK,mBAAlB,CAAsCoB,MAAtC,GAA+C,IAA/C;AACA,aAHD,EAGG,GAHH;AAIA;AACD;;AACO6B,QAAAA,OAAO,CAACJ,QAAD,EAAWK,QAAX,EAAqB;AACnC,eAAKvD,YAAL,CAAkBC,cAAlB,CAAiCsB,cAAjC,CAAgD,mBAAhD,EAAqEE,MAArE,GAA8E,IAA9E;AACA,eAAKzB,YAAL,CAAkBC,cAAlB,CAAiCsB,cAAjC,CAAgD,iBAAhD,EAAmEE,MAAnE,GAA4E,KAA5E;AACA,eAAKzB,YAAL,CAAkBC,cAAlB,CAAiCsB,cAAjC,CAAgD,mBAAhD,EAAqEJ,YAArE,CAAkFhC,EAAE,CAACwC,QAArF,EAA+FM,OAA/F,CAAuG,KAAK3B,KAAL,CAAWC,QAAX,CAAoBuB,MAApB,CAA2BI,IAA3B,GAAkC,KAAK5B,KAAL,CAAWC,QAAX,CAAoBuB,MAApB,CAA2BI,IAA7D,GAAoE,SAA3K;AACA,cAAIsB,CAAC,GAAG,CAAR;AACA,cAAIC,GAAG,GAAG;AAAA;AAAA,kEAA4B,KAAKzD,YAAL,CAAkBC,cAAlB,CAAiCsB,cAAjC,CAAgD,mBAAhD,EAAqEJ,YAArE,CAAkFhC,EAAE,CAACwC,QAArF,CAA5B,EAA4H,KAAKrB,KAAL,CAAWC,QAAX,CAAoBuB,MAApB,CAA2BM,YAA3B,CAAwCc,QAAQ,GAAG,CAAH,GAAO,CAAvD,CAA5H,EAAuL,IAAvL,EAA6L,MAAM;AAC5MM,YAAAA,CAAC;;AACD,gBAAIA,CAAC,IAAI,CAAT,EAAY;AACXD,cAAAA,QAAQ;AACR;AACD,WALS,CAAV;AAMAE,UAAAA,GAAG,CAACC,aAAJ;AACA;;AACOC,QAAAA,cAAc,CAACJ,QAAD,EAAW;AAChC,eAAKvD,YAAL,CAAkBC,cAAlB,CAAiCsB,cAAjC,CAAgD,mBAAhD,EAAqEE,MAArE,GAA8E,IAA9E;AACA,eAAKzB,YAAL,CAAkBC,cAAlB,CAAiCsB,cAAjC,CAAgD,iBAAhD,EAAmEE,MAAnE,GAA4E,KAA5E;AACA,eAAKzB,YAAL,CAAkBC,cAAlB,CAAiCsB,cAAjC,CAAgD,mBAAhD,EAAqEJ,YAArE,CAAkFhC,EAAE,CAACwC,QAArF,EAA+FM,OAA/F,CAAuG,KAAK3B,KAAL,CAAWC,QAAX,CAAoBuB,MAApB,CAA2BI,IAA3B,GAAkC,KAAK5B,KAAL,CAAWC,QAAX,CAAoBuB,MAApB,CAA2BI,IAA7D,GAAoE,SAA3K;AACA,cAAIuB,GAAG,GAAG;AAAA;AAAA,kEAA4B,KAAKzD,YAAL,CAAkBC,cAAlB,CAAiCsB,cAAjC,CAAgD,mBAAhD,EAAqEJ,YAArE,CAAkFhC,EAAE,CAACwC,QAArF,CAA5B,EAA4H,KAAKrB,KAAL,CAAWC,QAAX,CAAoBuB,MAApB,CAA2BM,YAA3B,CAAwC,CAAxC,CAA5H,EAAwK,KAAxK,EAA+K,MAAM;AAC9L;AACA,gBAAIwB,aAAa,GAAG,KAAK5D,YAAL,CAAkBG,oBAAlB,CAAuC0D,aAA3D;AACA,gBAAIC,cAAc,GAAG;AAAA;AAAA,sDAAiBC,IAAjB,CAAsB7C,IAAtB,CAA2BK,cAA3B,CAA0C,mBAA1C,EAA+DsC,aAApF,CAH8L,CAI9L;;AACA,gBAAI3C,IAAI,GAAGlC,WAAW,CAAC,KAAKgB,YAAL,CAAkBG,oBAAnB,CAAtB,CAL8L,CAM9L;;AACA;AAAA;AAAA,sDAAiB4D,IAAjB,CAAsB7C,IAAtB,CAA2B8C,QAA3B,CAAoC9C,IAApC,EAP8L,CAQ9L;;AACA,gBAAI+C,WAAW,GAAG;AAAA;AAAA,sDAAiBF,IAAjB,CAAsB7C,IAAtB,CAA2BC,YAA3B,CAAwC7B,WAAxC,CAAlB,CAT8L,CAU9L;;AACA,gBAAI4E,aAAa,GAAGD,WAAW,CAACE,oBAAZ,CAAiCP,aAAjC,CAApB;AACA,gBAAIQ,cAAc,GAAGH,WAAW,CAACE,oBAAZ,CAAiCL,cAAjC,CAArB;AACAM,YAAAA,cAAc,CAACvB,CAAf,GAAmBuB,cAAc,CAACvB,CAAf,GAAmB,EAAtC,CAb8L,CAc9L;;AACA3B,YAAAA,IAAI,CAAC8B,WAAL,CAAiBkB,aAAjB;AACA,iBAAKlE,YAAL,CAAkBG,oBAAlB,CAAuCsB,MAAvC,GAAgD,KAAhD,CAhB8L,CAiB9L;;AACApC,YAAAA,KAAK,CAAC6B,IAAD,CAAL,CACEmD,EADF,CACK,CADL,EACQ;AAAEC,cAAAA,QAAQ,EAAEF;AAAZ,aADR,EACsC;AAAEG,cAAAA,MAAM,EAAE;AAAV,aADtC,EAEEC,IAFF,CAEO,MAAM;AACXjB,cAAAA,QAAQ;AACRrC,cAAAA,IAAI,CAACuD,OAAL;AACA,aALF,EAME9D,KANF;AAOA,WAzBS,CAAV;AA0BA8C,UAAAA,GAAG,CAACC,aAAJ;AACA;;AACSgB,QAAAA,MAAM,GAAS,CAExB;;AAEDC,QAAAA,MAAM,CAACC,SAAD,EAAoB,CAEzB;;AAnIyE,O","sourcesContent":["import { _decorator, Component, debug, instantiate, Label, Node, sp, Sprite, tween, UITransform, Vec3 } from 'cc';\r\nimport { BaseComponent } from '../../../base/BaseComponent';\r\nimport { IconEffectType, IconType } from '../type';\r\nimport { sourceManageSeletor, winShowViewModel } from '../index';\r\nimport { SkeletalPathDefine } from '../sourceDefine/skeletalDefine';\r\nimport { getNodePositionInCanvas } from '../../../utils/tool';\r\nimport SkeletonAnimationPlayer from '../SkeletonPlay';\r\nconst { ccclass, property } = _decorator;\r\n\r\nexport interface IState {\r\n\r\n}\r\n\r\nexport interface IProps {\r\n\ticonData?: IconType\r\n\t/**将这个属性单拎出来，节约性能，不然每次都要重新初始化icon的界面 */\r\n\ticonEffect?: IconEffectType\r\n}\r\nexport interface IEvent {\r\n\r\n}\r\n\r\n@ccclass('Thor_RollerIcon')\r\nexport class Thor_RollerIcon extends BaseComponent<IState, IProps, IEvent> {\r\n\tstart() { }\r\n\r\n\tprotected propertyNode = {\r\n\t\tprops_iconWrap: new Node(),\r\n\t\tprops_iconId: new Label(),\r\n\t\tprops_label_rate_num: new Node(),\r\n\t\tprops_focusBorder: new Node(),\r\n\t\tprops_skeleton_bomb: new Node(),\r\n\t}\r\n\r\n\tpublic props: IProps = {\r\n\t\ticonData: null,\r\n\t\ticonEffect: IconEffectType.NONE\r\n\t}\r\n\r\n\tpublic events: IEvent = {\r\n\r\n\t}\r\n\r\n\tprotected initState() {\r\n\t\treturn {\r\n\r\n\t\t}\r\n\t}\r\n\r\n\tprotected bindEvent(): void {\r\n\r\n\t}\r\n\r\n\tprotected useProps(key: keyof IProps, value: { pre: any, cur: any }) {\r\n\t\tif (key === \"iconData\") {\r\n\t\t\tif (this.props.iconData) {\r\n\t\t\t\tconst uiTrasform = this.node.getComponent(UITransform)\r\n\t\t\t\tuiTrasform.width = this.props.iconData.width\r\n\t\t\t\tuiTrasform.height = this.props.iconData.height\r\n\t\t\t\tconst iconNodeSkeleton = this.propertyNode.props_iconWrap.getChildByName(\"iconNode_skeleton\")\r\n\t\t\t\tconst iconNodeSprite = this.propertyNode.props_iconWrap.getChildByName(\"iconNode_sprite\")\r\n\t\t\t\ticonNodeSkeleton.active = false\r\n\t\t\t\ticonNodeSprite.active = false\r\n\t\t\t\tlet iconNode: Node\r\n\t\t\t\t// if (this.props.iconData.LargeIcon) {\r\n\t\t\t\t// \ticonNode = iconNodeSprite\r\n\t\t\t\t// \ticonNodeSprite.active = false\r\n\t\t\t\t// \ticonNodeSprite.getComponent(Sprite).spriteFrame = sourceManageSeletor().getFile(this.props.iconData.uiData.fileName).source\r\n\t\t\t\t// } else {\r\n\r\n\t\t\t\t// }\r\n\t\t\t\ticonNode = iconNodeSkeleton\r\n\t\t\t\ticonNodeSkeleton.active = true\r\n\t\t\t\ticonNodeSkeleton.getComponent(sp.Skeleton).skeletonData = sourceManageSeletor().getFile(this.props.iconData.uiData.fileName).source\r\n\t\t\t\ticonNodeSkeleton.getComponent(sp.Skeleton).setSkin(this.props.iconData.uiData.skin ? this.props.iconData.uiData.skin : 'default')\r\n\t\t\t\ticonNodeSkeleton.getComponent(sp.Skeleton).animation = this.props.iconData.uiData.animationArr[0]\r\n\t\t\t\tthis.propertyNode.props_iconWrap.getChildByName(\"iconNode_skeleton\").active = false\r\n\t\t\t\tthis.propertyNode.props_iconWrap.getChildByName(\"iconNode_sprite\").active = true\r\n\t\t\t\tthis.propertyNode.props_iconWrap.getChildByName(\"iconNode_sprite\").getComponent(Sprite).spriteFrame = sourceManageSeletor().getFile(this.props.iconData.uiData.iconName).source\r\n\t\t\t\tif (this.props.iconData.iconId > 10) {\r\n\t\t\t\t\tthis.propertyNode.props_label_rate_num.active = true\r\n\t\t\t\t\tthis.propertyNode.props_label_rate_num.getComponent(Label).string = this.props.iconData.multiple + \"X\"\r\n\t\t\t\t}\r\n\t\t\t\ticonNode.setScale(new Vec3(...this.props.iconData.uiData.scale))\r\n\t\t\t\tconst { x, y, z } = iconNode.getPosition()\r\n\t\t\t\ticonNode.setPosition(new Vec3(x + this.props.iconData.uiData.distance[0], y + this.props.iconData.uiData.distance[1], x))\r\n\t\t\t\t// this.propertyNode.props_iconId.string = this.props.iconData.iconId + \"\"\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (key === \"iconEffect\") {\r\n\t\t\t//闪动框\r\n\t\t\tconst isActive = (value.cur === IconEffectType.NORMAIL)\r\n\t\t\tthis.propertyNode.props_focusBorder.active = isActive\r\n\t\t\tthis.propertyNode.props_iconWrap.getChildByName(\"iconNode_skeleton\").active = true\r\n\t\t\tthis.propertyNode.props_iconWrap.getChildByName(\"iconNode_sprite\").active = false\r\n\t\t\tthis.propertyNode.props_iconWrap.getChildByName(\"iconNode_skeleton\").getComponent(sp.Skeleton).setSkin(this.props.iconData.uiData.skin ? this.props.iconData.uiData.skin : 'default')\r\n\t\t\tthis.propertyNode.props_iconWrap.getChildByName(\"iconNode_skeleton\").getComponent(sp.Skeleton).animation = this.props.iconData.uiData.animationArr[isActive ? 1 : 0]\r\n\t\t\tthis.scheduleOnce(() => {\r\n\t\t\t\tthis.propertyNode.props_iconWrap.getChildByName(\"iconNode_skeleton\").active = false\r\n\t\t\t\tthis.propertyNode.props_skeleton_bomb.active = true\r\n\t\t\t}, 0.8)\r\n\t\t}\r\n\t}\r\n\tprivate playAni(isActive, callBack) {\r\n\t\tthis.propertyNode.props_iconWrap.getChildByName(\"iconNode_skeleton\").active = true\r\n\t\tthis.propertyNode.props_iconWrap.getChildByName(\"iconNode_sprite\").active = false\r\n\t\tthis.propertyNode.props_iconWrap.getChildByName(\"iconNode_skeleton\").getComponent(sp.Skeleton).setSkin(this.props.iconData.uiData.skin ? this.props.iconData.uiData.skin : 'default')\r\n\t\tlet i = 0\r\n\t\tlet ani = new SkeletonAnimationPlayer(this.propertyNode.props_iconWrap.getChildByName(\"iconNode_skeleton\").getComponent(sp.Skeleton), this.props.iconData.uiData.animationArr[isActive ? 2 : 0], true, () => {\r\n\t\t\ti++\r\n\t\t\tif (i == 2) {\r\n\t\t\t\tcallBack()\r\n\t\t\t}\r\n\t\t});\r\n\t\tani.playAnimation()\r\n\t}\r\n\tprivate playallPurpose(callBack) {\r\n\t\tthis.propertyNode.props_iconWrap.getChildByName(\"iconNode_skeleton\").active = true\r\n\t\tthis.propertyNode.props_iconWrap.getChildByName(\"iconNode_sprite\").active = false\r\n\t\tthis.propertyNode.props_iconWrap.getChildByName(\"iconNode_skeleton\").getComponent(sp.Skeleton).setSkin(this.props.iconData.uiData.skin ? this.props.iconData.uiData.skin : 'default')\r\n\t\tlet ani = new SkeletonAnimationPlayer(this.propertyNode.props_iconWrap.getChildByName(\"iconNode_skeleton\").getComponent(sp.Skeleton), this.props.iconData.uiData.animationArr[1], false, () => {\r\n\t\t\t// 获取起始和目标的世界坐标\r\n\t\t\tlet startWorldPos = this.propertyNode.props_label_rate_num.worldPosition;\r\n\t\t\tlet targetWorldPos = winShowViewModel.comp.node.getChildByName('props_spr_win_box').worldPosition;\r\n\t\t\t// 创建节点的实例\r\n\t\t\tlet node = instantiate(this.propertyNode.props_label_rate_num);\r\n\t\t\t// 将节点添加到目标节点所在的父节点\r\n\t\t\twinShowViewModel.comp.node.addChild(node);\r\n\t\t\t// 获取父节点的 UITransform 组件\r\n\t\t\tlet uiTransform = winShowViewModel.comp.node.getComponent(UITransform);\r\n\t\t\t// 将世界坐标转换为新父节点的局部坐标\r\n\t\t\tlet startLocalPos = uiTransform.convertToNodeSpaceAR(startWorldPos);\r\n\t\t\tlet targetLocalPos = uiTransform.convertToNodeSpaceAR(targetWorldPos);\r\n\t\t\ttargetLocalPos.y = targetLocalPos.y - 25\r\n\t\t\t// 设置节点的初始位置\r\n\t\t\tnode.setPosition(startLocalPos);\r\n\t\t\tthis.propertyNode.props_label_rate_num.active = false\r\n\t\t\t// 执行缓动动画\r\n\t\t\ttween(node)\r\n\t\t\t\t.to(1, { position: targetLocalPos }, { easing: 'sineInOut' })\r\n\t\t\t\t.call(() => {\r\n\t\t\t\t\tcallBack()\r\n\t\t\t\t\tnode.destroy()\r\n\t\t\t\t})\r\n\t\t\t\t.start();\r\n\t\t});\r\n\t\tani.playAnimation()\r\n\t}\r\n\tprotected bindUI(): void {\r\n\r\n\t}\r\n\r\n\tupdate(deltaTime: number) {\r\n\r\n\t}\r\n}\r\n\r\n"]}