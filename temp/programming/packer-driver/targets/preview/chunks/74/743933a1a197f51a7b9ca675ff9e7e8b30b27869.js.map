{"version":3,"sources":["file:///Users/geliang/web/dibai/hall/assets/script/subGame/phoenixV2/components/phoenixV2_sgChoose_small.ts"],"names":["_decorator","Node","sp","Sprite","tween","Vec3","BaseComponent","SkeletonAnimationPlayer","mainViewModel","phoenixV2_Audio","SoundPathDefine","ccclass","property","phoenixV2_sgChoose_small","propertyNode","props_btn_sgChoose_25","props_btn_sgChoose_20","props_btn_sgChoose_15","props_btn_sgChoose_13","props_btn_sgChoose_10","props_mask","props","events","onWindowCloseHandler","start","sgChooseShow","initState","bindEvent","listenerChooseSmallGameListEvent","changeGray","comp","getFreeNumNode","active","getupBgNode","stop","play","CHOOSE_CARD_IN","node","getChildByName","to","position","sgChooseSmall","isValid","children","filter","item","name","startsWith","forEach","v","i","on","EventType","TOUCH_END","playOneShot","CHOOSE_CARD","otherNode","index","getComponent","grayscale","skeleton","Skeleton","count","detryCloseWindow","playAnimation","destroy","useProps","key","value","bindUI","update","deltaTime"],"mappings":"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","sourcesContent":["import { _decorator, Button, Component, Node, sp, Sprite, tween, Vec3 } from 'cc';\r\nimport { BaseComponent } from '../../../base/BaseComponent';\r\nimport config from '../config';\r\nimport SkeletonAnimationPlayer from '../../../utils/SkeletonPlay';\r\nimport { mainViewModel, phoenixV2_Audio } from '../index';\r\nimport { SoundPathDefine } from '../sourceDefine/soundDefine';\r\nconst { ccclass, property } = _decorator;\r\n\r\nexport interface IState {\r\n\r\n}\r\n\r\nexport interface IProps {\r\n\r\n}\r\nexport interface IEvent {\r\n\tonWindowCloseHandler: (i:number) => void,\r\n\t\r\n}\r\n\r\n@ccclass('phoenixV2_sgChoose_small')\r\nexport class phoenixV2_sgChoose_small extends BaseComponent<IState, IProps, IEvent> {\r\n\r\n\r\n\tstart() {\r\n        this.sgChooseShow()\r\n\t}\r\n\r\n\tprotected propertyNode = {\r\n        props_btn_sgChoose_25: new Node(),\r\n        props_btn_sgChoose_20: new Node(),\r\n        props_btn_sgChoose_15: new Node(),\r\n        props_btn_sgChoose_13: new Node(),\r\n\t\tprops_btn_sgChoose_10: new Node(),\r\n\t\tprops_mask: new Node(),\r\n\t\t\t\t\r\n\t}\r\n\r\n\tpublic props: IProps = {\r\n\t\r\n\t}\r\n\r\n\tpublic events: IEvent = {\r\n\t\tonWindowCloseHandler: () => {},\r\n\t}\r\n\r\n\tprotected initState() {\r\n\t\treturn {\r\n\r\n\t\t}\r\n\t}\r\n\r\n\tprotected bindEvent(): void {\r\n\r\n\t\tthis.listenerChooseSmallGameListEvent()\r\n\r\n\t}\r\n\r\n\tpublic changeGray() {\r\n\r\n\r\n\t}\r\n\t\r\n\r\n\tprivate sgChooseShow() {\r\n\t\tmainViewModel.comp.getFreeNumNode().active = false;\r\n\t\tmainViewModel.comp.getupBgNode().active = false;\r\n\t\tphoenixV2_Audio.stop();\r\n\t\tphoenixV2_Audio.play(SoundPathDefine.CHOOSE_CARD_IN, true)\r\n\t\ttween(this.node.getChildByName('props_btn_sgChoose_25'))\r\n\t\t\t.to(0.2, { position: new Vec3(-392, -4, 0) })\r\n\t\t\t.start()\r\n\t\ttween(this.node.getChildByName('props_btn_sgChoose_20'))\r\n\t\t\t.to(0.4, { position:new Vec3(-194,-4, 0) })\r\n\t\t\t.start()\r\n\t\ttween(this.node.getChildByName('props_btn_sgChoose_15'))\r\n\t\t\t.to(0.6, { position:new Vec3(4,-4, 0) })\r\n\t\t\t.start()\r\n\t\ttween(this.node.getChildByName('props_btn_sgChoose_13'))\r\n\t\t\t.to(0.8, { position:new Vec3(202,-4, 0) })\r\n\t\t\t.start()\r\n\t\ttween(this.node.getChildByName('props_btn_sgChoose_10'))\r\n\t\t\t.to(1, { position:new Vec3(400,-4, 0) })\r\n\t\t\t.start()\r\n\t}\r\n\r\n\t\r\n\tprivate listenerChooseSmallGameListEvent() {\r\n\t\tconst sgChooseSmall=this.node && this.node.isValid && this.node.children.filter( item => item.name.startsWith(\"props_btn_sgChoose\"));\r\n\t\t\r\n\t\tsgChooseSmall && sgChooseSmall.forEach((v, i) => {\r\n\t\t\tv.on(Node.EventType.TOUCH_END, () => {\r\n\t\t\t\tphoenixV2_Audio.playOneShot(SoundPathDefine.CHOOSE_CARD)\r\n\r\n\t\t\t\tthis.propertyNode.props_mask.active = true;\r\n\t\t\t\tsgChooseSmall.forEach((otherNode, index) => {\r\n\t\t\t\t\tif (index !== i) {\r\n\t\t\t\t\t\totherNode.getChildByName(\"skeleton_in\").active = false;\r\n\t\t\t\t\t\totherNode.getChildByName(\"free_box_goin\").active = false;\r\n\t\t\t\t\t\totherNode.getComponent(Sprite).grayscale = true;\r\n\t\t\t\t\t\t// otherNode.getComponent(Button).enabled = false;\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\r\n\t\t\t\t// Update the clicked node\r\n\t\t\t\tv.getChildByName(\"skeleton_in\").active = true;\r\n\t\t\t\tv.getChildByName(\"free_box_goin\").active = false;\r\n\t\t\t\tv.getComponent(Sprite).grayscale = false;\r\n\t\t\t\tconst skeleton = v.getChildByName(\"skeleton_in\").getComponent(sp.Skeleton);\r\n\t\t\t\tlet count = 0;\r\n\t\t\t\tnew SkeletonAnimationPlayer(skeleton, \"animation\", true, () => {\r\n\t\t\t\t\tcount++\r\n\t\t\t\t\tif (count >= 2) {\r\n\t\t\t\t\t   this.detryCloseWindow(i);\r\n\t\t\t\t\t}\r\n\t\t\t\t}).playAnimation()\r\n\t\t\t\t// v.getComponent(sp.Skeleton).setCompleteListener(() => { \r\n\t\t\t\t// \tthis.detryCloseWindow(i);\r\n\t\t\t\t// })\r\n\t\t\t});\r\n\t\t});\r\n\t}\r\n\r\n\tprivate detryCloseWindow(i:number) {\r\n\t\tif (this.node && this.node.isValid) {\r\n\t\t\tthis.node.destroy();\r\n\t\t\tthis.events.onWindowCloseHandler(i);\r\n\t\t}\r\n\t}\r\n\tprotected useProps(key: keyof IProps, value: { pre: any, cur: any }) {\r\n\r\n\t}\r\n\r\n\tprotected bindUI(): void {\r\n\t\t\r\n\t}\r\n\r\n\r\n\tupdate(deltaTime: number) {\r\n\r\n\t}\r\n}\r\n\r\n"]}