{"version":3,"sources":["file:///Users/geliang/web/dibai/hall/assets/script/hall/viewModel/WithdrawalViewModel.ts"],"names":["WithdrawalViewModel","Prefab","ViewModel","SKT_MAG_TYPE","sktInstance","sktMsgListener","baseBoardView","fetcher","sourceManageSeletor","PrefabPathDefine","EffectType","WithdrawBankViewModel","setWithdrawChannelList","sizeChangeAction","ApiUrl","addToastAction","BaseViewModel","lang","ModalBox","constructor","validFlowingWater","begin","setEvent","openWithdrawBank","withdrawBankViewModel","mountView","getFileAsync","_HELL_WITHDRAWAL_BANK_LIST","source","appendTo","parentNode","effectType","EFFECT1","isModal","onCloseHandler","unMount","onClickBankChannl","bankItem","bankBindViewModel","onlineBanking","_HELL_WITHDRAW_WALLET_BIND","_HELL_WITHDRAW_BANK_BIND","onClosehandler","onBindDone","hadChooseBankChannl","accountNumber","realName","mainPanelViewModel","isTouristPass","send","WITHDRAW_BIND_CARD","rechargeChannelId","id","then","data","Instance","show","content","write","k","withdrawal","withdrawalSuccess","gold","placeStr","type","refreshList","catch","e","console","log","setProps","bind","onBankChannlDone","dispatch","comp","events","connect","trueToWithdraw","amount","storeState","store","getState","withDrawTip","_HELL_WITHDRAW_TIPS","doneHandler","WITHDRAW_ORDER","bankId","withdraw","withdrawBankChannelChoose","money","rsp","HallModule","WithdrawalApply","iconName","name","withdrawAmount","accountName","withdrawalPremium","logUrl","iconMax","openWithdrawBill","_HELL_WITHDRAW_BILL","EFFECT2","USER_ORDER_LIST","orderList","add","WITH_DRAW_LIST","addWithdrawBill","sendSktMessage","WITHDRAW_BANK_CHANNEL_LIST","unMountCallBack","removeById","inject","memberAssetGoldPieces","memberInfo","state","flowingWater"],"mappings":"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","sourcesContent":["import { Node, Prefab, Sprite } from \"cc\"\r\nimport ViewModel from \"../../base/ViewModel\"\r\nimport { Hall_WithdrawalPanel, IProps, IEvent } from \"../components/Hall_Withdraw/Hall_WithdrawalPanel\"\r\nimport { Hall_WithdrawBankBind, IState as BBIState, IProps as BBIProps, IEvent as BBIEvent } from \"../components/Hall_Withdraw/Hall_WithdrawBankBind\"\r\nimport { StateType } from \"../store/reducer\"\r\nimport { SKT_MAG_TYPE, sktInstance, sktMsgListener } from \"../socketConnect\"\r\nimport { baseBoardView, fetcher, sourceManageSeletor } from \"../index\"\r\nimport { PrefabPathDefine } from \"../sourceDefine/prefabDefine\"\r\nimport { EffectType } from \"../../utils/NodeIOEffect\"\r\nimport WithdrawBankViewModel from \"./WithdrawBankViewModel\"\r\nimport { setWithdrawChannelList, sizeChangeAction, WithdrawBankChannelType } from \"../store/actions/withdraw\"\r\nimport Fetcher from \"../../utils/Fetcher\"\r\nimport { ApiUrl } from \"../apiUrl\"\r\nimport { addToastAction } from \"../store/actions/baseBoard\"\r\nimport BaseViewModel from \"../../common/viewModel/BaseViewModel\"\r\nimport { lang } from \"../index\"\r\nimport ModalBox from \"../../common/ModalBox\"\r\nimport Guide from \"../../utils/Guide\"\r\n\r\n\r\nclass WithdrawalViewModel extends ViewModel<Hall_WithdrawalPanel, IProps, IEvent> {\r\n  constructor() {\r\n    super('Hall_WithdrawalPanel')\r\n  }\r\n  private validFlowingWater: number = 0\r\n  protected begin() {\r\n    this.setEvent({\r\n      openWithdrawBank: async () => {\r\n        const withdrawBankViewModel = new WithdrawBankViewModel().mountView((await sourceManageSeletor().getFileAsync(PrefabPathDefine._HELL_WITHDRAWAL_BANK_LIST, Prefab)).source)\r\n          .appendTo(this.parentNode, { effectType: EffectType.EFFECT1, isModal: true }).setEvent({\r\n            onCloseHandler: () => {\r\n              withdrawBankViewModel.unMount(EffectType.EFFECT1)\r\n            },\r\n            onClickBankChannl: async (bankItem: WithdrawBankChannelType) => {\r\n              const bankBindViewModel = new BaseViewModel<Hall_WithdrawBankBind, BBIState, BBIProps, BBIEvent>(\"Hall_WithdrawBankBind\").mountView((await sourceManageSeletor()\r\n                .getFileAsync(bankItem.onlineBanking === 0 ? PrefabPathDefine._HELL_WITHDRAW_WALLET_BIND : PrefabPathDefine._HELL_WITHDRAW_BANK_BIND, Prefab)).source)\r\n              bankBindViewModel.appendTo(this.parentNode, { effectType: EffectType.EFFECT1, isModal: true }).setEvent({\r\n                onClosehandler: () => {\r\n                  bankBindViewModel.unMount(EffectType.EFFECT1)\r\n                },\r\n                onBindDone: (hadChooseBankChannl: WithdrawBankChannelType, accountNumber: string, realName: string) => {\r\n                  if (!baseBoardView.mainPanelViewModel.isTouristPass()) return\r\n                  fetcher.send(ApiUrl.WITHDRAW_BIND_CARD, {\r\n                    rechargeChannelId: hadChooseBankChannl.id, accountNumber, realName\r\n                  }).then((data) => {\r\n                    if (data !== -1) {\r\n                      ModalBox.Instance().show({ content: lang.write(k => k.withdrawal.withdrawalSuccess, { gold: data }, { placeStr: \"绑定提款信息成功获取金币\" }), type: \"Prompt\" }, () => {\r\n                        //重新拉取数据\r\n                        this.refreshList()\r\n                        bankBindViewModel.unMount(EffectType.EFFECT1)\r\n                        return true\r\n                      })\r\n                    } else {\r\n                      this.refreshList()\r\n                      bankBindViewModel.unMount(EffectType.EFFECT1)\r\n                    }\r\n                  }).catch((e) => {\r\n                    console.log(e)\r\n                  })\r\n                }\r\n              }).setProps({\r\n                hadChooseBankChannl: bankItem\r\n              })\r\n              if (bankItem.bind) {\r\n                //已绑定\r\n\r\n              }\r\n            },\r\n            onBankChannlDone: (bankItem: WithdrawBankChannelType) => {\r\n              if (bankItem.bind) {\r\n                this.dispatch(sizeChangeAction(bankItem))\r\n                withdrawBankViewModel.unMount(EffectType.EFFECT1)\r\n              } else {\r\n                withdrawBankViewModel.comp.events.onClickBankChannl(bankItem)\r\n                // this.dispatch(addToastAction({ content: \"请选择已经绑定的渠道\" }))\r\n              }\r\n            }\r\n          }).connect()\r\n      },\r\n      trueToWithdraw: async (amount: number) => {\r\n        // 确认提现，先弹出信息展示框\r\n        const storeState = this.store.getState() as StateType;\r\n        const withDrawTip = new BaseViewModel(\"Hall_WithdrawTip\").mountView((await sourceManageSeletor().getFileAsync(PrefabPathDefine._HELL_WITHDRAW_TIPS, Prefab)).source)\r\n          .appendTo(this.parentNode, { effectType: EffectType.EFFECT1, isModal: true }).setEvent({\r\n            onClosehandler: () => {\r\n              withDrawTip.unMount()\r\n            },\r\n            doneHandler: () => {\r\n              fetcher.send(ApiUrl.WITHDRAW_ORDER, {\r\n                bankId: storeState.withdraw.withdrawBankChannelChoose.bankId,\r\n                money: amount\r\n              }).then((rsp) => {\r\n                withDrawTip.unMount()\r\n                this.dispatch(addToastAction({ content: lang.write(k => k.HallModule.WithdrawalApply, {}, { placeStr: \"请求提交成功\" }) }))\r\n              })\r\n            }\r\n          }).setProps({\r\n            iconName: storeState.withdraw.withdrawBankChannelChoose.name,\r\n            accountNumber: storeState.withdraw.withdrawBankChannelChoose.accountNumber,\r\n            withdrawAmount: amount,\r\n            accountName: storeState.withdraw.withdrawBankChannelChoose.realName,\r\n            withdrawalPremium: storeState.withdraw.withdrawBankChannelChoose.withdrawalPremium,\r\n            logUrl: storeState.withdraw.withdrawBankChannelChoose.iconMax,\r\n          })\r\n      },\r\n      openWithdrawBill: async () => {\r\n        const withDrawTip = new BaseViewModel(\"Hall_WithdrawBill\").mountView((await sourceManageSeletor().getFileAsync(PrefabPathDefine._HELL_WITHDRAW_BILL, Prefab)).source)\r\n          .appendTo(this.parentNode, { effectType: EffectType.EFFECT1, isModal: true }).setEvent({\r\n            onClosehandler: () => {\r\n              withDrawTip.unMount(EffectType.EFFECT2)\r\n            }\r\n          })\r\n        //提现列表\r\n        fetcher.send(ApiUrl.USER_ORDER_LIST, { data: 2 }).then(async (rsp) => {\r\n          withDrawTip.setProps({ orderList: rsp })\r\n        }).catch((e) => {\r\n          console.log(e)\r\n        })\r\n      }\r\n    })\r\n    \r\n    sktMsgListener.add(SKT_MAG_TYPE.WITH_DRAW_LIST, \"withdraw\", (data) => {\r\n      this.comp.addWithdrawBill(data)\r\n    })\r\n    sktInstance.sendSktMessage(SKT_MAG_TYPE.WITH_DRAW_LIST)\r\n  }\r\n  private refreshList() {\r\n    //重新拉取数据\r\n    fetcher.send(ApiUrl.WITHDRAW_BANK_CHANNEL_LIST, {}, \"get\").then((rsp) => {\r\n      this.dispatch(setWithdrawChannelList(rsp))\r\n    }).catch((e) => {\r\n      console.log(e)\r\n    })\r\n  }\r\n\r\n  protected unMountCallBack(): void {\r\n    sktMsgListener.removeById('withdraw')\r\n  }\r\n\r\n  public connect() {\r\n    const storeState = this.store.getState() as StateType;\r\n    this.inject({\r\n      memberAssetGoldPieces: storeState.memberInfo.memberAssetGoldPieces,\r\n      withdrawBankChannelChoose: storeState.withdraw.withdrawBankChannelChoose,\r\n    }, (state: StateType) => {\r\n      // this.validFlowingWater = state.memberInfo.flowingWater\r\n      return {\r\n        memberAssetGoldPieces: state.memberInfo.memberAssetGoldPieces,\r\n        withdrawBankChannelChoose: state.withdraw.withdrawBankChannelChoose,\r\n        validFlowingWater: state.memberInfo.flowingWater\r\n      }\r\n    })\r\n    return this\r\n  }\r\n}\r\n\r\nexport default WithdrawalViewModel"]}