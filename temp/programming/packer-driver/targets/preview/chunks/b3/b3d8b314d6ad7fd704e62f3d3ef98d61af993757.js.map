{"version":3,"sources":["file:///Users/geliang/web/dibai/hall/assets/script/subGame/bandarQiuQiu/components/BandarQiuQiu_begin.ts"],"names":["_decorator","Node","Animation","Label","game","Game","BaseComponent","GameStatus","mainGameViewModel","playGame","playTimeout","stopBet","TaskScheduler","ccclass","property","BandarQiuQiu_begin","taskScheduler","isShowGame","propertyNode","props_spr_begin_bg","props_spr_startBeil_text","props_spr_stopBeil_text","props_spr_countdown_bg","props_label_clockNum","props","gameStatus","layCountDown","countDown","events","start","initState","bindEvent","on","EVENT_HIDE","EVENT_SHOW","isUnMount","node","useProps","key","value","cur","string","BET","playBeginAnim","active","STOP_BET","WAIT","playLayAnim","QUIT_GAME","console","log","animation","getComponent","play","EventType","FINISHED","bindUI","update","deltaTime"],"mappings":"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","sourcesContent":["import { _decorator, Node, Animation, Label, game, Game } from 'cc';\r\nimport { BaseComponent } from '../../../base/BaseComponent';\r\nimport { initToggle } from '../../../utils/tool';\r\nimport { GameStatus } from '../type';\r\nimport { mainGameViewModel, playGame, playTimeout, stopBet } from '../index';\r\nimport { sendCardsViewModel } from '../viewModel/BandarQiuQiuGameBoardViewModel';\r\nimport TaskScheduler, { Task } from '../../../utils/TaskScheduler';\r\nconst { ccclass, property } = _decorator;\r\n\r\n\r\n\r\nexport interface IState {\r\n\r\n}\r\n\r\nexport interface IProps {\r\n\tgameStatus: GameStatus,\r\n\tlayCountDown: number,\r\n\tcountDown:number,\r\n}\r\nexport interface IEvent {\r\n\t\r\n}\r\n\r\n\r\n@ccclass('BandarQiuQiu_begin')\r\nexport class BandarQiuQiu_begin extends BaseComponent<IState, IProps, IEvent> {\r\n\tprivate taskScheduler = new TaskScheduler();\r\n\tprivate isShowGame: boolean = true;\r\n\tstart() {\r\n      \r\n\t  \r\n\t }\r\n\r\n\tprotected propertyNode = {\r\n\t\tprops_spr_begin_bg: new Node(),\r\n\t\tprops_spr_startBeil_text: new Node(),\r\n\t\tprops_spr_stopBeil_text: new Node(),\r\n\t\tprops_spr_countdown_bg: new Node(),\r\n\t\tprops_label_clockNum:new Label(),\r\n\t}\r\n\r\n\tpublic props: IProps = {\r\n\t\tgameStatus: null,\r\n\t\tlayCountDown: 0,\r\n\t\tcountDown:0,\r\n\t}\r\n\r\n\tpublic events: IEvent = {\r\n\t\t\r\n\t}\r\n\r\n\tprotected initState() {\r\n\t\treturn {\r\n\t\t\t\r\n\t\t}\r\n\t}\r\n\r\n\tprotected bindEvent(): void {\r\n\t\tgame.on(Game.EVENT_HIDE,()=>{//游戏切入后台\r\n            this.isShowGame = false;\r\n\t\t})\r\n\t\tgame.on(Game.EVENT_SHOW,()=>{//游戏进入\r\n\t\t\t  this.isShowGame = true;\r\n\t\t\t  if (!mainGameViewModel.isUnMount) {\r\n\t\t\t\t  if (this.node) {\r\n\t\t\t\t\t  \r\n\t\t\t\t  }\r\n\t\t\t  }\r\n\t\t\t  \r\n\t\t})\r\n\r\n\t}\r\n\r\n\tprotected useProps(key: keyof IProps, value: { pre: any, cur: any }) {\r\n\t\tif (key === \"layCountDown\") {\r\n\t\t\tif (value.cur > 0) {\r\n\t\t\t\tthis.propertyNode.props_label_clockNum.string = value.cur + \"\";\r\n\t\t\t} \r\n\t\t\t\r\n\t\t}\r\n\t\tif (key === \"gameStatus\") {\r\n\t\t\tif (value.cur === GameStatus.BET) {\r\n\t\t\t\tthis.playBeginAnim();\r\n\t\t\t\tthis.propertyNode.props_spr_stopBeil_text.active = false;\r\n\t\t\t\tthis.propertyNode.props_spr_startBeil_text.active = true;\r\n\r\n\t\t\t} else if (value.cur === GameStatus.STOP_BET) {\t\t\t\r\n\t\t\t\tthis.playBeginAnim();\r\n\t\t\t\tthis.propertyNode.props_spr_startBeil_text.active = false;\r\n\t\t\t\tthis.propertyNode.props_spr_stopBeil_text.active = true;\r\n\t\t\t} else if (value.cur === GameStatus.WAIT) {\r\n\t\t\t\tthis.playLayAnim();\r\n\t\t\t} else if (value.cur === GameStatus.QUIT_GAME) {\r\n\t\t\t\t\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t}\r\n    /**播放开始动画 */\r\n\tprivate playBeginAnim() {\r\n\t\tif (!this.isShowGame) {\r\n\t\t\tthis.propertyNode.props_spr_countdown_bg.active = false;\r\n\t\t\tthis.propertyNode.props_spr_begin_bg.active = false;\r\n\t\t\treturn\r\n\t\t}\r\n\t\tif (this.props.gameStatus === 1) {\r\n\t\t\t\r\n\t\t\tif (this.props && this.props.countDown && this.props.countDown < 5) { return };\r\n\t\t\tconsole.log(\"this.props.countDown\",this.props.countDown);\r\n\t\t}\r\n\r\n\t\t\r\n\t\tplayGame();\r\n\t\tif (this.props.gameStatus === 2) {\r\n\t\t\tstopBet()\r\n\t\t}\r\n\t\t// console.log(\"this.props.gameStatus\",this.props.gameStatus);\r\n\t\tthis.propertyNode.props_spr_countdown_bg.active = false;\r\n\t\tthis.propertyNode.props_spr_begin_bg.active = true;\r\n\r\n        let animation = this.propertyNode.props_spr_begin_bg.getComponent(Animation);\r\n        animation.play()\r\n        animation.on(Animation.EventType.FINISHED,()=>{\r\n\t\t\tthis.propertyNode.props_spr_begin_bg.active = false;\r\n        },this)\r\n\t}\r\n\t/**播放等待动画 */\r\n\tprivate playLayAnim() {\r\n\t\tif (!this.isShowGame) {\r\n\t\t\tthis.propertyNode.props_spr_countdown_bg.active = false;\r\n\t\t\tthis.propertyNode.props_spr_begin_bg.active = false;\r\n\t\t\treturn\r\n\t\t}\r\n\t\tif (this.props && this.props.layCountDown && this.props.layCountDown < 3) { return };\r\n\t\tconsole.log(\"this.props.layCountDown\",this.props.layCountDown);\r\n\t\t\t\t\r\n\t\tplayTimeout();\r\n\t\tthis.propertyNode.props_spr_begin_bg.active = false;\r\n\t\tthis.propertyNode.props_spr_countdown_bg.active = true;\r\n\r\n\t\tlet animation = this.propertyNode.props_spr_countdown_bg.getComponent(Animation);\r\n\t\tanimation.play();\r\n\t\tanimation.on(Animation.EventType.FINISHED,()=>{\r\n\t\t\tthis.propertyNode.props_spr_countdown_bg.active = false;\r\n\t\t},this)\r\n\t}\r\n\r\n\tprotected bindUI(): void {\r\n\t\tthis.propertyNode.props_spr_startBeil_text.active = false;\r\n\t\tthis.propertyNode.props_spr_stopBeil_text.active = false;\r\n\t\tthis.propertyNode.props_spr_countdown_bg.active = false;\r\n\t\tthis.propertyNode.props_spr_begin_bg.active = false;\r\n\t}\r\n\r\n\tupdate(deltaTime: number) {\r\n\r\n\t}\r\n}\r\n\r\n"]}