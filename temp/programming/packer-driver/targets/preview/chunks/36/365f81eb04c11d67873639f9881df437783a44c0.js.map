{"version":3,"sources":["file:///Users/geliang/web/dibai/hall/assets/script/hall/components/Hall_PC_SubComp/Hall_PC_Share_Info.ts"],"names":["_decorator","EditBox","ImageAsset","instantiate","Label","native","Node","Prefab","Sprite","SpriteFrame","sys","Texture2D","tween","UIOpacity","UITransform","Vec3","BaseComponent","qrcode","BridgeCode","addToastAction","ToastType","fetcher","global","lang","sourceManageSeletor","ApiUrl","BaseViewModel","PrefabPathDefine","EffectType","copyToClipboard","ccclass","property","Share_Info","isZoomed","zoomScale","fadeDuration","shareLink","propertyNode","props_spr_QR_code","props_background","props_btn_fenxiang","props_Label_num1","props_Label_totalTaruhan","props_Label_kode","props_btn_share_copy","props_Label_num2","props_Label_num3","props_Label_num4","props_Label_num5","props_Label_num6","props_label_link","props_btn_draw","props_btn_share_mengi","props_EditBox_shareName","props_spr_title","props","isShow","forceRefresh","events","openShareSure","start","initState","bindEvent","on","EventType","TOUCH_END","getFileAsync","_SHARE_SHARE_HELP","then","file","help","mountView","source","appendTo","node","parent","effectType","EFFECT1","isModal","setProps","setEvent","onClosePanel","unMount","EFFECT2","actingId","getComponent","string","trim","length","ekstrakHandle","copiedToClipboard","to","height","getChildByName","destroy","name","setPosition","opacity","createQRCode","res","spriteFrame","easing","addChild","renderData","useProps","key","value","cur","active","text","isNative","os","OS","ANDROID","bridge","sendToNative","COPY_CLIPBOARD","hallDispatch","content","write","k","MainPaneModule","ShareCopy","placeStr","send","RECOMMEND_DATA","rsp","promotionMemberCode","enabled","totalPromotionMemberBet","formatAmountWithCommas","promotionCode","totalPromotionMemberCount","totalPromotionRewardsSum","promotionRewardsSum","grayscale","RECOMMENDDATATOTODAY","todayTotalPromotionMemberCount","todayPromotionMemberBet","todayPromotionRewardsSum","sz","callback","qr","addData","make","canvas","document","createElement","ctx","getContext","size","width","fillStyle","fillRect","tileW","getModuleCount","tileH","row","col","isDark","Math","round","imageAsset","texture","image","parseFloat","replace","DRAW_WATER","type","BaseBoardModule","operateDone","SUCCESS","catch","e","bindUI","update","deltaTime"],"mappings":"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","sourcesContent":["import { _decorator, Component, EditBox, ImageAsset, instantiate, Label, native, Node, Prefab, Sprite, SpriteFrame, sys, systemEvent, Texture2D, tween, UIOpacity, UITransform, Vec2, Vec3 } from 'cc';\r\nimport { BaseComponent } from '../../../base/BaseComponent';\r\nconst { ccclass, property } = _decorator;\r\nimport qrcode from \"qrcode-generator\"\r\nimport { BridgeCode } from '../../../common/bridge';\r\nimport { addToastAction, ToastType } from '../../store/actions/baseBoard';\r\nimport { fetcher, global, lang, sourceManageSeletor } from '../../index';\r\nimport { ApiUrl } from '../../apiUrl';\r\nimport BaseViewModel from '../../viewModel/BaseViewModel';\r\nimport { share_help, IState as SHIState, IProps as SHIprops, IEvent as SHIEvent } from './Hall_PC_share_help';\r\nimport { PrefabPathDefine } from '../../sourceDefine/prefabDefine';\r\nimport { EffectType } from '../../../utils/NodeIOEffect';\r\nimport copyToClipboard from '../../../utils/copyToClipboard';\r\nexport interface IState {\r\n\r\n}\r\n\r\nexport interface IProps {\r\n  isShow: boolean,\r\n  forceRefresh: boolean\r\n}\r\nexport interface IEvent {\r\n  /**绑定会员 */\r\n  openShareSure?: (id) => void\r\n}\r\n\r\n@ccclass('Share_Info')\r\nexport class Share_Info extends BaseComponent<IState, IProps, IEvent> {\r\n  isZoomed: boolean\r\n  zoomScale = 3 // 放大的倍数\r\n  fadeDuration = 0.3 // 背景渐变时间，单位为秒\r\n  shareLink = ''\r\n  start() {\r\n\r\n  }\r\n\r\n  protected propertyNode = {\r\n    props_spr_QR_code: new Node(),\r\n    props_background: new Node(),\r\n    props_btn_fenxiang: new Node(),\r\n    props_Label_num1: new Label(),\r\n    props_Label_totalTaruhan: new Label(),\r\n    props_Label_kode: new Label(),\r\n    props_btn_share_copy: new Node(),\r\n    props_Label_num2: new Label(),\r\n    props_Label_num3: new Label(),\r\n    props_Label_num4: new Label(),\r\n    props_Label_num5: new Label(),\r\n    props_Label_num6: new Label(),\r\n    props_label_link: new Label(),\r\n    props_btn_draw: new Node(),\r\n    props_btn_share_mengi: new Node(),\r\n    props_EditBox_shareName: new Node(),\r\n    props_spr_title: new Node(),\r\n  }\r\n\r\n  public props: IProps = {\r\n    isShow: true,\r\n    forceRefresh: false\r\n  }\r\n\r\n  public events: IEvent = {\r\n    openShareSure: () => { },\r\n  }\r\n\r\n  protected initState() {\r\n    return {\r\n\r\n    }\r\n  }\r\n\r\n  protected bindEvent(): void {\r\n    this.propertyNode.props_spr_title.on(Node.EventType.TOUCH_END, () => {\r\n      sourceManageSeletor().getFileAsync(PrefabPathDefine._SHARE_SHARE_HELP, Prefab).then(file => {\r\n        let help = new BaseViewModel<share_help, SHIState, SHIprops, SHIEvent>(\"share_help\").mountView(file.source)\r\n          .appendTo(this.node.parent, { effectType: EffectType.EFFECT1, isModal: true }).setProps({\r\n            isShow: true\r\n          }).setEvent({\r\n            onClosePanel: () => {\r\n              help.unMount(EffectType.EFFECT2)\r\n            }\r\n          })\r\n      })\r\n    })\r\n    this.propertyNode.props_btn_share_mengi.on(Node.EventType.TOUCH_END, () => { //绑定会员\r\n      const actingId = this.propertyNode.props_EditBox_shareName.getComponent(EditBox).string.trim();\r\n      if (actingId.length > 0) {\r\n        this.events.openShareSure(actingId)\r\n      }\r\n    })\r\n    this.propertyNode.props_btn_draw.on(Node.EventType.TOUCH_END, () => { // 体现\r\n      this.ekstrakHandle()\r\n    })\r\n    this.propertyNode.props_btn_share_copy.on(Node.EventType.TOUCH_END, () => { // 复制自己编码\r\n      this.copiedToClipboard(this.propertyNode.props_Label_kode.string)\r\n    })\r\n    this.propertyNode.props_btn_fenxiang.on(Node.EventType.TOUCH_END, () => { // 复制\r\n      this.copiedToClipboard(this.shareLink)\r\n    })\r\n    this.propertyNode.props_background.on(Node.EventType.TOUCH_END, () => { // 关闭二维码\r\n      tween(this.propertyNode.props_background.getComponent(UITransform))\r\n        .to(this.fadeDuration, { height: 0 })\r\n        .start()\r\n      this.node.getChildByName('copy_QR_code').destroy()\r\n    })\r\n    this.propertyNode.props_spr_QR_code.on(Node.EventType.TOUCH_END, () => { // 打开二维码\r\n      let node = instantiate(this.propertyNode.props_spr_QR_code)\r\n      node.name = 'copy_QR_code'\r\n      // node.setScale(new Vec3(0, 0, 1))\r\n      node.setPosition(new Vec3(134, 160, 1))\r\n      node.getComponent(UIOpacity).opacity = 255;\r\n      this.createQRCode(this.shareLink, 320, (res => {\r\n        node.getComponent(Sprite).spriteFrame = res;\r\n      }))\r\n      node.getComponent(UITransform).height = 0\r\n      tween(node.getComponent(UITransform))\r\n        .to(0.2, { height: 320 }, { easing: 'sineOut' })\r\n        .start()\r\n      this.node.addChild(node)\r\n      tween(this.propertyNode.props_background.getComponent(UITransform))\r\n        .to(this.fadeDuration, { height: 556 })\r\n        .start()\r\n    })\r\n    this.renderData()\r\n  }\r\n\r\n  protected useProps(key: keyof IProps, value: { pre: any, cur: any }) {\r\n    if (key === 'isShow') {\r\n      if (!value.cur) {\r\n        this.propertyNode.props_background.getComponent(UITransform).height = 0\r\n        this.node.getChildByName('copy_QR_code')?.destroy()\r\n      }\r\n      this.node.active = value.cur\r\n    }\r\n    if (key === 'forceRefresh') {\r\n      value.cur && this.renderData()\r\n    }\r\n  }\r\n  private copiedToClipboard(text) { //统一复制\r\n    if (sys.isNative) {\r\n      if (sys.os === sys.OS.ANDROID) {\r\n        native.bridge.sendToNative(BridgeCode.COPY_CLIPBOARD, text);\r\n        global.hallDispatch(addToastAction({ content: lang.write(k => k.MainPaneModule.ShareCopy, {}, { placeStr: \"已复制内容到剪切板\" }) }))\r\n      }\r\n    } else {\r\n      copyToClipboard(text);\r\n      global.hallDispatch(addToastAction({ content: lang.write(k => k.MainPaneModule.ShareCopy, {}, { placeStr: \"已复制内容到剪切板\" }) }))\r\n      // navigator.clipboard.writeText(text).then(() => {\r\n      //     global.hallDispatch(addToastAction({ content: lang.write(k => k.MainPaneModule.ShareCopy, {}, { placeStr: \"已复制内容到剪切板\" }) }))\r\n      // }).catch((err) => {\r\n      //     console.error('share copy fail', err)\r\n      // });\r\n    }\r\n  }\r\n  private renderData() {\r\n    fetcher.send(ApiUrl.RECOMMEND_DATA, {}, \"get\").then((rsp) => {\r\n      if (rsp.promotionMemberCode && rsp.promotionMemberCode !== '') {\r\n        this.propertyNode.props_EditBox_shareName.getComponent(EditBox).string = rsp.promotionMemberCode\r\n        this.propertyNode.props_EditBox_shareName.getComponent(EditBox).enabled = false\r\n        this.propertyNode.props_btn_share_mengi.active = false\r\n      } else {\r\n        this.propertyNode.props_EditBox_shareName.getComponent(EditBox).enabled = true\r\n        this.propertyNode.props_btn_share_mengi.active = true\r\n      }\r\n      this.propertyNode.props_Label_totalTaruhan.string = rsp.totalPromotionMemberBet.formatAmountWithCommas()\r\n      this.propertyNode.props_Label_kode.string = rsp.promotionCode\r\n      this.propertyNode.props_Label_num1.string = rsp.totalPromotionMemberCount\r\n      this.propertyNode.props_Label_num2.string = rsp.totalPromotionRewardsSum.formatAmountWithCommas()\r\n      this.propertyNode.props_Label_num3.string = rsp.promotionRewardsSum.formatAmountWithCommas()\r\n      this.propertyNode.props_label_link.string = rsp.shareLink\r\n\r\n      this.propertyNode.props_btn_draw.getComponent(Sprite).grayscale = rsp.promotionRewardsSum <= 0\r\n      this.shareLink = rsp.shareLink\r\n      this.createQRCode(this.shareLink, 80, (res => {\r\n        this.propertyNode.props_spr_QR_code.getComponent(Sprite).spriteFrame = res;\r\n      }))\r\n    })\r\n    fetcher.send(ApiUrl.RECOMMENDDATATOTODAY, {}, \"get\").then((rsp) => {\r\n      this.propertyNode.props_Label_num4.string = rsp.todayTotalPromotionMemberCount.formatAmountWithCommas()\r\n      this.propertyNode.props_Label_num5.string = rsp.todayPromotionMemberBet.formatAmountWithCommas()\r\n      this.propertyNode.props_Label_num6.string = rsp.todayPromotionRewardsSum.formatAmountWithCommas()\r\n    })\r\n  }\r\n  private createQRCode(text, sz, callback) {\r\n    let qr = qrcode(4, 'L');\r\n    qr.addData(text);\r\n    qr.make();\r\n    let canvas = document.createElement('canvas');\r\n    let ctx = canvas.getContext('2d');\r\n    let size = sz;\r\n    canvas.width = size;\r\n    canvas.height = size;\r\n    ctx.fillStyle = \"white\";\r\n    ctx.fillRect(0, 0, size, size);\r\n    // 根据二维码模块计算每个点的大小\r\n    let tileW = size / qr.getModuleCount();\r\n    let tileH = size / qr.getModuleCount();\r\n    // 绘制二维码\r\n    for (let row = 0; row < qr.getModuleCount(); row++) {\r\n      for (let col = 0; col < qr.getModuleCount(); col++) {\r\n        ctx.fillStyle = qr.isDark(row, col) ? \"black\" : \"white\";\r\n        ctx.fillRect(Math.round(col * tileW), Math.round(row * tileH), tileW, tileH);\r\n      }\r\n    }\r\n    // 将 Canvas 转换为 ImageAsset\r\n    let imageAsset = new ImageAsset(canvas);\r\n    // 创建 Texture2D\r\n    let texture = new Texture2D();\r\n    texture.image = imageAsset;\r\n    // 应用到 Sprite\r\n    let spriteFrame = new SpriteFrame();\r\n    spriteFrame.texture = texture;\r\n    callback(spriteFrame)\r\n  }\r\n  /**提取分享奖励 */\r\n  private ekstrakHandle() {\r\n    if (parseFloat(this.propertyNode.props_Label_num3.string.replace(/,/g, \"\")) > 0) {\r\n      fetcher.send(ApiUrl.DRAW_WATER, { type: 0 }).then(() => {\r\n        global.hallDispatch(addToastAction({\r\n          content: lang.write(k => k.BaseBoardModule.operateDone, {}, { placeStr: \"操作完成\" }), type: ToastType.SUCCESS,\r\n        }))\r\n        this.renderData();\r\n      }).catch((e) => {\r\n      })\r\n    }\r\n  }\r\n\r\n\r\n  protected bindUI(): void {\r\n\r\n  }\r\n\r\n  update(deltaTime: number) {\r\n\r\n  }\r\n}\r\n\r\n"]}