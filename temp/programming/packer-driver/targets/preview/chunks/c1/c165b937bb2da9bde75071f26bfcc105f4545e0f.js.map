{"version":3,"sources":["file:///Users/geliang/web/dibai/hall/assets/script/subGame/gxfc/Slot/Mediator/BgMediator.ts"],"names":["BgMediator","Node","Prefab","Sprite","Toggle","CommandDefine","PrefabDefine","BaseMediator","SubGameType","AutoLaunchType","StopMode","DialogType","gxfc_DialogWin","BgCommandConst","getBgProxy","getSocketProxy","RollerMediatorConst","AudioManager","SoundList","global","UseSetOption","addToastAction","sendNativeVibrate","BgMediatorConst","constructor","mediatorName","viewComponent","buttonThrottling","sourceMap","key","path","SLOT_BG","sourceType","source","FLY_BG","DYNAMIC_NUMBER","DIALOG_WIN","RULE_PANEL","TOAST","listNotificationConst","name","INIT_MAIN_PANEL","handler","notification","init","pdd","Instance","option","gameSet","gxfc","betTarget","positionId","initUserSwitch","sendNotification","BG","order","UPDATE_BET_AMOUNT","SETGREYOUT","state","getBody","comp","wrapView","getComponent","setGreyOut","CHANGE_BG","gameType","changeBg","INITSCORE","updateScore","getNextGame","START_FLY_BG","flyBgNode","getSource","addChild","setSiblingIndex","window","setTimeout","TOGGLETHESTARTBUTTON","AUTO_LAUNCH","removeChild","UPDATE_NUMBER","UPDATE_AUTO_LAUNCH","setActiveButton","getAutoLaunchType","UPDATE_GAME_STATUS","setDisable","getDisable","getLastGame","setDis_btn","homeButton","grayscale","UPDATE_BTN_LABEL","frequency","setBtnLabel","UPDATE_USER_GOLD","gold","getTransferGameInfo","getUserGold","setGold","SHOW_DIALOG_WIN","dialogType","amount","keepTime","done","dialog","type","getShiftAmount","jackpot","showDialog","OPEN_RULE_PANEL","rulePanel","checkAutoLaunch","str","isUNLIMT","getAutoLaunchNum","getTotal","setBtnState","InsufficientBalanceDisplay","bl","Balance_tips","baseBetAmount","lineCount","updateBetAmount","UPDATE_CURRENT_SCORE","currentScore","getCurrentScore","getInstance","playSound","coinCollection","SHOW_TOAST","content","hallDispatch","String","NUMBEROFDISPLAYS","fab","amountTmp","getIsChangeGameRunning","MAIN","PRESS_START","SUB_GAME1","YOUWON","console","log","listenerEvent","autoButtonWrap","autoLaunch","props_toggle_fast","propsToggleFast","isChecked","pressTime","timeLimit","timer","isLongPress","ruleButton","on","EventType","TOUCH_END","buttonClick","startButton","TOUCH_START","setInterval","clearInterval","presentGame","triggeAutoLaunch","TOUCH_CANCEL","fbp","DISABLE","setAutoLaunchType","sendLaunch","END_ROLL","scheduleOnce","closeMusic","closeSubGame","addBet","add_coin","calculateTheBalanceStatus","subtractBet","reduce_coin","maxBet","active","children","forEach","child","index","setStopMode","TOGGLE","toggle","QUEUE_STOP","NORMAL","gameRunner","_gameRunner","bgIndex","currentTime","Date","currentHour","getHours","setBg","UPDATE_ICON_STATE"],"mappings":";;;8WA+DqBA,U;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA/DZC,MAAAA,I,OAAAA,I;AAAMC,MAAAA,M,OAAAA,M;AAAQC,MAAAA,M,OAAAA,M;AAAQC,MAAAA,M,OAAAA,M;;AAEtBC,MAAAA,a,iBAAAA,a;;AACAC,MAAAA,Y,iBAAAA,Y;;AACFC,MAAAA,Y;;AAIEC,MAAAA,W,iBAAAA,W;;AACAC,MAAAA,c,iBAAAA,c;AAAgBC,MAAAA,Q,iBAAAA,Q;;AAChBC,MAAAA,U,iBAAAA,U;AAAYC,MAAAA,c,iBAAAA,c;;AACZC,MAAAA,c,iBAAAA,c;;AACAC,MAAAA,U,iBAAAA,U;AAAYC,MAAAA,c,iBAAAA,c;;AAEZC,MAAAA,mB,kBAAAA,mB;;AACAC,MAAAA,Y,kBAAAA,Y;AAAcC,MAAAA,S,kBAAAA,S;;AACdC,MAAAA,M,kBAAAA,M;;AACFC,MAAAA,Y;;AACEC,MAAAA,c,kBAAAA,c;;AACAC,MAAAA,iB,kBAAAA,iB;;;;;;;;;AACT;AACA;AACA;AACA;AACA;iCACYC,e,0BAAAA,e;AAAAA,QAAAA,e;AAAAA,QAAAA,e;AAAAA,QAAAA,e;AAAAA,QAAAA,e;AAAAA,QAAAA,e;AAAAA,QAAAA,e;AAAAA,QAAAA,e;AAAAA,QAAAA,e;AAAAA,QAAAA,e;AAAAA,QAAAA,e;AAAAA,QAAAA,e;AAAAA,QAAAA,e;AAAAA,QAAAA,e;AAAAA,QAAAA,e;AAAAA,QAAAA,e;AAAAA,QAAAA,e;AAAAA,QAAAA,e;AAAAA,QAAAA,e;eAAAA,e;;;yBAsCSvB,U,GAAN,MAAMA,UAAN;AAAA;AAAA,wCAAsC;AAE5CwB,QAAAA,WAAW,CAACC,YAAD,EAA8BC,aAA9B,EAAyD;AAAA,cAAxDD,YAAwD;AAAxDA,YAAAA,YAAwD,GAAjC,IAAiC;AAAA;;AAAA,cAA3BC,aAA2B;AAA3BA,YAAAA,aAA2B,GAAN,IAAM;AAAA;;AACzE,gBAAMD,YAAN,EAAoBC,aAApB;AADyE,eAD3EC,gBAC2E,GADxD,IACwD;AAAA,eAGpEC,SAHoE,GAGpC,CACrC;AACEC,YAAAA,GAAG,EAAE,YADP;AAEEC,YAAAA,IAAI,EAAE;AAAA;AAAA,8CAAaC,OAFrB;AAGEC,YAAAA,UAAU,EAAE9B,MAHd;AAIE+B,YAAAA,MAAM,EAAE;AAJV,WADqC,EAOrC;AACEJ,YAAAA,GAAG,EAAE,OADP;AAEEC,YAAAA,IAAI,EAAE;AAAA;AAAA,8CAAaI,MAFrB;AAGEF,YAAAA,UAAU,EAAE9B,MAHd;AAIE+B,YAAAA,MAAM,EAAE;AAJV,WAPqC,EAarC;AACEJ,YAAAA,GAAG,EAAE,eADP;AAEEC,YAAAA,IAAI,EAAE;AAAA;AAAA,8CAAaK,cAFrB;AAGEH,YAAAA,UAAU,EAAE9B,MAHd;AAIE+B,YAAAA,MAAM,EAAE;AAJV,WAbqC,EAmBrC;AACEJ,YAAAA,GAAG,EAAE,WADP;AAEEC,YAAAA,IAAI,EAAE;AAAA;AAAA,8CAAaM,UAFrB;AAGEJ,YAAAA,UAAU,EAAE9B,MAHd;AAIE+B,YAAAA,MAAM,EAAE;AAJV,WAnBqC,EAyBrC;AACEJ,YAAAA,GAAG,EAAE,WADP;AAEEC,YAAAA,IAAI,EAAE;AAAA;AAAA,8CAAaO,UAFrB;AAGEL,YAAAA,UAAU,EAAE9B,MAHd;AAIE+B,YAAAA,MAAM,EAAE;AAJV,WAzBqC,EA+BrC;AACEJ,YAAAA,GAAG,EAAE,OADP;AAEEC,YAAAA,IAAI,EAAE;AAAA;AAAA,8CAAaQ,KAFrB;AAGEN,YAAAA,UAAU,EAAE9B,MAHd;AAIE+B,YAAAA,MAAM,EAAE;AAJV,WA/BqC,CAHoC;AAAA,eAyKjEM,qBAzKiE,GAyKL,CACpE;AACEC,YAAAA,IAAI,EAAEjB,eAAe,CAACkB,eADxB;;AAEEC,YAAAA,OAAO,CAACC,YAAD,EAA8B;AACnC,mBAAKC,IAAL;AACA,kBAAIC,GAAG,GAAG;AAAA;AAAA,gDAAaC,QAAb,GAAwBC,MAAxB,CAA+BC,OAA/B,CAAuCC,IAAvC,GAA8C;AAAA;AAAA,gDAAaH,QAAb,GAAwBC,MAAxB,CAA+BC,OAA/B,CAAuCC,IAAvC,CAA4CC,SAA5C,CAAsDC,UAApG,GAAiH,CAA3H;AACA;AAAA;AAAA,sDAAiBC,cAAjB,CAAgCP,GAAhC;AACA,mBAAKQ,gBAAL,CAAsB;AAAA;AAAA,kDAAcC,EAApC,EAAwC;AAAEC,gBAAAA,KAAK,EAAE;AAAT,eAAxC,EAA2DhC,eAAe,CAACiC,iBAA3E;AACD;;AAPH,WADoE,EAUpE;AACEhB,YAAAA,IAAI,EAAEjB,eAAe,CAACkC,UADxB;;AAEEf,YAAAA,OAAO,CAACC,YAAD,EAA8B;AACnC,kBAAM;AAAEe,gBAAAA;AAAF,kBAAYf,YAAY,CAACgB,OAAb,EAAlB;AAAA,kBACEC,IAAI,GAAI,KAAKC,QAAL,CAAcC,YAAd,CAA2B,aAA3B,CADV;;AAEA,kBAAIJ,KAAK,KAAK,CAAd,EAAiB;AACfE,gBAAAA,IAAI,CAACG,UAAL,CAAgB,OAAhB,EAAyBL,KAAK,IAAI,CAAlC;AACAE,gBAAAA,IAAI,CAACG,UAAL,CAAgB,OAAhB,EAAyBL,KAAK,IAAI,CAAlC;AACD,eAHD,MAGO;AACLE,gBAAAA,IAAI,CAACG,UAAL,CAAgB,OAAhB,EAAyB,KAAzB;AACAH,gBAAAA,IAAI,CAACG,UAAL,CAAgB,OAAhB,EAAyB,KAAzB;AACD;AAEF;;AAbH,WAVoE,EAyBpE;AACEvB,YAAAA,IAAI,EAAEjB,eAAe,CAACyC,SADxB;;AAEEtB,YAAAA,OAAO,CAACC,YAAD,EAA8B;AACnC,kBAAM;AAAEsB,gBAAAA;AAAF,kBAAetB,YAAY,CAACgB,OAAb,MAA0B,EAA/C;AACA,mBAAKO,QAAL,CAAcD,QAAd;AACD;;AALH,WAzBoE,EAgCpE;AACEzB,YAAAA,IAAI,EAAEjB,eAAe,CAAC4C,SADxB;;AAEEzB,YAAAA,OAAO,CAACC,YAAD,EAA8B;AACnC,kBAAM;AAAEe,gBAAAA;AAAF,kBAAYf,YAAY,CAACgB,OAAb,MAA0B,EAA5C;;AACA,kBAAID,KAAJ,EAAW;AACR,qBAAKG,QAAL,CAAcC,YAAd,CAA2B,aAA3B,CAAD,CAA2DM,WAA3D,CAAuE,CAAvE;AACD;;AACD,kBAAI;AAAA;AAAA,8CAAaC,WAAb,MAA8B,CAAlC,EAAqC;AAClC,qBAAKR,QAAL,CAAcC,YAAd,CAA2B,aAA3B,CAAD,CAA2DM,WAA3D,CAAuE,CAAvE;AACD;AACF;;AAVH,WAhCoE,EA4CpE;AACE5B,YAAAA,IAAI,EAAEjB,eAAe,CAAC+C,YADxB;;AAEE5B,YAAAA,OAAO,CAACC,YAAD,EAA8B;AACnC,kBAAM4B,SAAS,GAAG,KAAKC,SAAL,CAAe;AAAA;AAAA,gDAAatC,MAA5B,CAAlB;AACA,mBAAKR,aAAL,CAAmB+C,QAAnB,CAA4BF,SAA5B;AACAA,cAAAA,SAAS,CAACG,eAAV,CAA0B,IAA1B;AACAC,cAAAA,MAAM,CAACC,UAAP,CAAkB,MAAM;AACtB,qBAAKvB,gBAAL,CAAsB9B,eAAe,CAACsD,oBAAtC,EAA4D;AAAEnB,kBAAAA,KAAK,EAAE;AAAT,iBAA5D;AACA,qBAAKL,gBAAL,CAAsB;AAAA;AAAA,oDAAcC,EAApC,EAAwC,EAAxC,EAA4C;AAAA;AAAA,sDAAewB,WAA3D;AACA,qBAAKpD,aAAL,CAAmBqD,WAAnB,CAA+BR,SAA/B;AACD,eAJD,EAIG,IAJH;AAKD;;AAXH,WA5CoE,EAyDpE;AACE/B,YAAAA,IAAI,EAAEjB,eAAe,CAACyD,aADxB;;AAEEtC,YAAAA,OAAO,CAACC,YAAD,EAA8B,CACnC;AACA;AACA;AACD;;AANH,WAzDoE,EAiEpE;AACEH,YAAAA,IAAI,EAAEjB,eAAe,CAAC0D,kBADxB;;AAEEvC,YAAAA,OAAO,CAACC,YAAD,EAA8B;AACrB,mBAAKkB,QAAL,CAAcC,YAAd,CAA2B,aAA3B,CAAd,CAAyDoB,eAAzD,CAAyE;AAAA;AAAA,8CAAaC,iBAAb,EAAzE;AACD;;AAJH,WAjEoE,EAuEpE;AACE3C,YAAAA,IAAI,EAAEjB,eAAe,CAAC6D,kBADxB;;AAEE1C,YAAAA,OAAO,CAACC,YAAD,EAA8B;AACnC,kBAAMiB,IAAI,GAAiB,KAAKC,QAAL,CAAcC,YAAd,CAA2B,aAA3B,CAA3B;AACAF,cAAAA,IAAI,CAACyB,UAAL,CAAgB;AAAA;AAAA,8CAAaC,UAAb,EAAhB;;AACA,kBAAI;AAAA;AAAA,8CAAaC,WAAb,MAA8B,CAAlC,EAAqC;AACnC3B,gBAAAA,IAAI,CAAC4B,UAAL,CAAgB,IAAhB;AACD,eAFD,MAEO;AACL5B,gBAAAA,IAAI,CAAC4B,UAAL,CAAgB;AAAA;AAAA,gDAAaF,UAAb,EAAhB;AACD;;AACD1B,cAAAA,IAAI,CAAC6B,UAAL,CAAgB3B,YAAhB,CAA6B3D,MAA7B,EAAqCuF,SAArC,GAAiD;AAAA;AAAA,8CAAaJ,UAAb,EAAjD;AACD;;AAXH,WAvEoE,EAmFjE;AACD9C,YAAAA,IAAI,EAAEjB,eAAe,CAACoE,gBADrB;;AAEDjD,YAAAA,OAAO,CAACC,YAAD,EAA8B;AACnC,kBAAI;AAAEiD,gBAAAA;AAAF,kBAAgBjD,YAAY,CAACgB,OAAb,EAApB;AACA,kBAAMC,IAAI,GAAiB,KAAKC,QAAL,CAAcC,YAAd,CAA2B,aAA3B,CAA3B;AACAF,cAAAA,IAAI,CAACiC,WAAL,CAAiBD,SAAjB;AACD;;AANA,WAnFiE,EA0FjE;AACDpD,YAAAA,IAAI,EAAEjB,eAAe,CAACuE,gBADrB;;AAEDpD,YAAAA,OAAO,CAACC,YAAD,EAA8B;AACnC,kBAAI;AAAEe,gBAAAA;AAAF,kBAAYf,YAAY,CAACgB,OAAb,EAAhB;AACA,kBAAIoC,IAAI,GAAG;AAAA;AAAA,sDAAiBC,mBAAjB,GAAuCC,WAAvC,CAAmDvC,KAAnD,CAAX;AACA,kBAAME,IAAI,GAAiB,KAAKC,QAAL,CAAcC,YAAd,CAA2B,aAA3B,CAA3B;AACAF,cAAAA,IAAI,CAACsC,OAAL,CAAaH,IAAb;AACD;;AAPA,WA1FiE,EAmGpE;AACEvD,YAAAA,IAAI,EAAEjB,eAAe,CAAC4E,eADxB;;AAEEzD,YAAAA,OAAO,CAACC,YAAD,EAA8B;AACnC;AAAA;AAAA,0DAAkB,GAAlB;AACA,kBAAM;AAAEyD,gBAAAA,UAAF;AAAcC,gBAAAA,MAAd;AAAsBC,gBAAAA,QAAtB;AAAgCC,gBAAAA;AAAhC,kBAAyC5D,YAAY,CAACgB,OAAb,EAA/C;AACA,kBAAM6C,MAAM,GAAG,KAAKhC,SAAL,CAAe;AAAA;AAAA,gDAAapC,UAA5B,CAAf;AACA,mBAAKV,aAAL,CAAmB+C,QAAnB,CAA4B+B,MAA5B;AACA,kBAAIC,IAAI,GAAGL,UAAX;;AACA,kBAAIA,UAAU,KAAK,SAAf,IAA4B;AAAA;AAAA,sDAAiBM,cAAjB,CAAgC,MAAhC,EAAwCC,OAAxC,IAAmD,CAAnF,EAAsF;AACpFF,gBAAAA,IAAI,GAAG,UAAP;AACD;;AACAD,cAAAA,MAAM,CAAC1C,YAAP;AAAA;AAAA,mDAAD,CAAwD8C,UAAxD,CAAmER,UAAnE,EAA+EC,MAA/E,EAAuFC,QAAQ,IAAI,IAAnG,EAAyG,MAAM;AAAEC,gBAAAA,IAAI;AAAI,eAAzH;AACD;;AAZH,WAnGoE,EAiHpE;AACE/D,YAAAA,IAAI,EAAEjB,eAAe,CAACsF,eADxB;;AAEEnE,YAAAA,OAAO,CAACC,YAAD,EAA8B;AACnC,kBAAMmE,SAAS,GAAG,KAAKtC,SAAL,CAAe;AAAA;AAAA,gDAAanC,UAA5B,CAAlB;AACA,mBAAKX,aAAL,CAAmB+C,QAAnB,CAA4BqC,SAA5B;AACD;;AALH,WAjHoE,EAwHpE;AACEtE,YAAAA,IAAI,EAAEjB,eAAe,CAACsD,oBADxB;;AAEEnC,YAAAA,OAAO,CAACC,YAAD,EAA8B;AACnC,kBAAM;AAAEe,gBAAAA;AAAF,kBAAYf,YAAY,CAACgB,OAAb,EAAlB;;AACA,kBAAI;AAAA;AAAA,8CAAaU,WAAb,MAA8B,CAAlC,EAAqC;AACnC,oBAAI;AAAA;AAAA,gDAAa0C,eAAb,EAAJ,EAAoC;AAAE;AACpC,sBAAIC,GAAG,GAAI;AAAA;AAAA,kDAAaC,QAAb,EAAD,GAA4B,GAA5B,GAAkC;AAAA;AAAA,kDAAaC,gBAAb,KAAkC,GAAlC,GAAwC;AAAA;AAAA,kDAAaC,QAAb,EAApF;AACC,uBAAKtD,QAAL,CAAcC,YAAd,CAA2B,aAA3B,CAAD,CAA2DsD,WAA3D,CAAuE1D,KAAvE,EAA8E,CAA9E,EAAiFsD,GAAjF;AACD,iBAHD,MAGO;AACJ,uBAAKnD,QAAL,CAAcC,YAAd,CAA2B,aAA3B,CAAD,CAA2DsD,WAA3D,CAAuE1D,KAAvE;AACD;AACF,eAPD,MAOO;AAAE;AACN,qBAAKG,QAAL,CAAcC,YAAd,CAA2B,aAA3B,CAAD,CAA2DsD,WAA3D,CAAuE1D,KAAvE,EAA8E,CAA9E;AACD;AACF;;AAdH,WAxHoE,EAwIpE;AACElB,YAAAA,IAAI,EAAEjB,eAAe,CAAC8F,0BADxB;;AAEE3E,YAAAA,OAAO,CAACC,YAAD,EAA8B;AACnC,kBAAM;AAAE2E,gBAAAA;AAAF,kBAAS3E,YAAY,CAACgB,OAAb,EAAf;AACC,mBAAKE,QAAL,CAAcC,YAAd,CAA2B,aAA3B,CAAD,CAA2DyD,YAA3D,CAAwED,EAAxE;AACD;;AALH,WAxIoE,EA+IpE;AACE9E,YAAAA,IAAI,EAAEjB,eAAe,CAACiC,iBADxB;;AAEEd,YAAAA,OAAO,CAACC,YAAD,EAA8B;AACnC,kBAAM;AAAE6E,gBAAAA,aAAF;AAAiBC,gBAAAA;AAAjB,kBAA+B9E,YAAY,CAACgB,OAAb,EAArC;AACC,mBAAKE,QAAL,CAAcC,YAAd,CAA2B,aAA3B,CAAD,CAA2D4D,eAA3D,CAA2EF,aAA3E,EAA0FC,SAA1F;AACD;;AALH,WA/IoE,EAsJpE;AACEjF,YAAAA,IAAI,EAAEjB,eAAe,CAACoG,oBADxB;;AAEEjF,YAAAA,OAAO,CAACC,YAAD,EAA8B;AACnC,kBAAM;AAAEY,gBAAAA;AAAF,kBAAYZ,YAAY,CAACgB,OAAb,MAA0B,EAA5C;AACA,kBAAMiE,YAAY,GAAG;AAAA;AAAA,sDAAiB5B,mBAAjB,GAAuC6B,eAAvC,CAAuDtE,KAAK,IAAI,MAAhE,CAArB;;AACA,kBAAIqE,YAAY,GAAG,CAAnB,EAAsB;AACpB;AAAA;AAAA,kDAAaE,WAAb,GAA2BC,SAA3B,CAAqC;AAAA;AAAA,4CAAUC,cAA/C;AACD;;AACA,mBAAKnE,QAAL,CAAcC,YAAd,CAA2B,aAA3B,CAAD,CAA2DM,WAA3D,CAAuEwD,YAAvE;AACD;;AATH,WAtJoE,EAiKpE;AACEpF,YAAAA,IAAI,EAAEjB,eAAe,CAAC0G,UADxB;;AAEEvF,YAAAA,OAAO,CAACC,YAAD,EAA8B;AACnC,kBAAM;AAAEuF,gBAAAA;AAAF,kBAAcvF,YAAY,CAACgB,OAAb,MAA0B,EAA9C;AACA;AAAA;AAAA,oCAAOwE,YAAP,CAAoB;AAAA;AAAA,oDAAe;AAAED,gBAAAA,OAAO,EAAEE,MAAM,CAACF,OAAD;AAAjB,eAAf,CAApB,EAFmC,CAGnC;AACA;AACA;AACD;;AARH,WAjKoE,EA2KpE;AACE1F,YAAAA,IAAI,EAAEjB,eAAe,CAAC8G,gBADxB;;AAEE3F,YAAAA,OAAO,CAACC,YAAD,EAA8B;AACnC,kBAAM;AAAE0D,gBAAAA,MAAF;AAAUC,gBAAAA,QAAV;AAAoBC,gBAAAA;AAApB,kBAA6B5D,YAAY,CAACgB,OAAb,EAAnC;AACA,kBAAIyC,UAAsB,GAAG,IAA7B;AACA,kBAAMkC,GAAG,GAAG;AAAA;AAAA,6CAAZ;AACA,kBAAIC,SAAS,GAAGlC,MAAhB;;AAEA,kBAAIiC,GAAG,CAACE,sBAAJ,OAAiC,CAAC,CAAtC,EAAyC;AACvC,oBAAIF,GAAG,CAAC/C,WAAJ,OAAsB;AAAA;AAAA,gDAAYkD,IAAtC,EAA4C;AAC1CrC,kBAAAA,UAAU,GAAG;AAAA;AAAA,gDAAWsC,WAAxB;AACD,iBAFD,MAEO,IAAIJ,GAAG,CAAC/C,WAAJ,OAAsB;AAAA;AAAA,gDAAYoD,SAAtC,EAAiD;AACtDvC,kBAAAA,UAAU,GAAG;AAAA;AAAA,gDAAWwC,MAAxB;AACAL,kBAAAA,SAAS,GAAG;AAAA;AAAA,0DAAiBvC,mBAAjB,GAAuC6B,eAAvC,CAAuD,MAAvD,CAAZ;AACD;;AACD,oBAAMrB,MAAM,GAAG,KAAKhC,SAAL,CAAe;AAAA;AAAA,kDAAapC,UAA5B,CAAf;AACA,qBAAKV,aAAL,CAAmB+C,QAAnB,CAA4B+B,MAA5B;AAEAqC,gBAAAA,OAAO,CAACC,GAAR,iCAA0CR,GAAG,CAAC/C,WAAJ,EAA1C,kBAAwEgD,SAAxE,sBAAkGnC,UAAlG;AAECI,gBAAAA,MAAM,CAAC1C,YAAP;AAAA;AAAA,qDAAD,CAAwD8C,UAAxD,CAAmER,UAAnE,EAA+EmC,SAA/E,EAA0FjC,QAAQ,IAAI,IAAtG,EAA4G,MAAM;AAAEC,kBAAAA,IAAI;AAAI,iBAA5H;AACD,eAbD,MAaO;AAELsC,gBAAAA,OAAO,CAACC,GAAR;AACAvC,gBAAAA,IAAI;AACL;AACF;;AA1BH,WA3KoE,CAzKK;AAE1E;;AAwCSwC,QAAAA,aAAa,GAAG;AACxB,cAAMnF,IAAI,GAAiB,KAAKC,QAAL,CAAcC,YAAd,CAA2B,aAA3B,CAA3B;AACA,cAAMkF,cAAc,GAAiB,KAAKnF,QAAL,CAAcC,YAAd,CAA2B,aAA3B,CAAd,CAAyDmF,UAAhF;AACA,cAAMC,iBAAiB,GAAiB,KAAKrF,QAAL,CAAcC,YAAd,CAA2B,aAA3B,CAAd,CAAyDqF,eAAnF;AACAD,UAAAA,iBAAiB,CAACpF,YAAlB,CAA+B1D,MAA/B,EAAuCgJ,SAAvC,GAAmD,KAAnD;AAEA,cAAIC,SAAS,GAAG,CAAhB;AACA,cAAMC,SAAS,GAAG,GAAlB,CAPwB,CAOF;;AACtB,cAAIC,KAAK,GAAG,CAAZ;AACA,cAAIC,WAAW,GAAG,KAAlB;AACA5F,UAAAA,IAAI,CAAC6F,UAAL,CAAgBC,EAAhB,CAAmBzJ,IAAI,CAAC0J,SAAL,CAAeC,SAAlC,EAA6C,MAAM;AACjD;AAAA;AAAA,8CAAa9B,WAAb,GAA2BC,SAA3B,CAAqC;AAAA;AAAA,wCAAU8B,WAA/C;AACA,iBAAKxG,gBAAL,CAAsB9B,eAAe,CAACsF,eAAtC;AACD,WAHD;AAIAjD,UAAAA,IAAI,CAACkG,WAAL,CAAiBJ,EAAjB,CAAoBzJ,IAAI,CAAC0J,SAAL,CAAeI,WAAnC,EAAgD,MAAM;AACpDR,YAAAA,KAAK,GAAG5E,MAAM,CAACqF,WAAP,CAAmB,MAAM;AAC/BX,cAAAA,SAAS,IAAI,EAAb;;AACA,kBAAIA,SAAS,GAAGC,SAAhB,EAA2B;AACzB3E,gBAAAA,MAAM,CAACsF,aAAP,CAAqBV,KAArB;AACA,oBAAMW,WAAW,GAAG;AAAA;AAAA,gDAAa7F,WAAb,EAApB;;AACA,oBAAI6F,WAAW,KAAK;AAAA;AAAA,gDAAYzB,IAAhC,EAAsC;AACtB,uBAAK5E,QAAL,CAAcC,YAAd,CAA2B,aAA3B,CAAd,CAAyDqG,gBAAzD;AACAX,kBAAAA,WAAW,GAAG,IAAd;AACD,iBAHD,MAGO;AACLA,kBAAAA,WAAW,GAAG,KAAd;AACD;AACF;AACF,aAZO,EAYL,EAZK,CAAR;AAaA;AAAA;AAAA,8CAAa1B,WAAb,GAA2BC,SAA3B,CAAqC;AAAA;AAAA,wCAAU8B,WAA/C;AACA,iBAAKxG,gBAAL,CAAsB9B,eAAe,CAAC4C,SAAtC;AACD,WAhBD;AAiBAP,UAAAA,IAAI,CAACkG,WAAL,CAAiBJ,EAAjB,CAAoBzJ,IAAI,CAAC0J,SAAL,CAAeS,YAAnC,EAAiD,MAAM;AACrDzF,YAAAA,MAAM,CAACsF,aAAP,CAAqBV,KAArB;;AACA,gBAAIC,WAAJ,EAAiB;AACfH,cAAAA,SAAS,GAAG,CAAZ;AACAG,cAAAA,WAAW,GAAG,KAAd;AACA;AACD;AACF,WAPD;AAQA5F,UAAAA,IAAI,CAACkG,WAAL,CAAiBJ,EAAjB,CAAoBzJ,IAAI,CAAC0J,SAAL,CAAeC,SAAnC,EAA8C,MAAM;AAClDjF,YAAAA,MAAM,CAACsF,aAAP,CAAqBV,KAArB;;AACA,gBAAIC,WAAJ,EAAiB;AACfH,cAAAA,SAAS,GAAG,CAAZ;AACAG,cAAAA,WAAW,GAAG,KAAd;AACA;AACD;;AACD,gBAAMa,GAAG,GAAG;AAAA;AAAA,2CAAZ;;AACA,gBAAIA,GAAG,CAAClF,iBAAJ,OAA4B;AAAA;AAAA,kDAAemF,OAA/C,EAAwD;AACtDD,cAAAA,GAAG,CAACE,iBAAJ,CAAsB;AAAA;AAAA,oDAAeD,OAArC;AACD;;AACa,iBAAKzG,QAAL,CAAcC,YAAd,CAA2B,aAA3B,CAAd,CAAyDqG,gBAAzD,CAA0E,KAA1E,EAXkD,CAYlD;;AACA,gBAAI,CAACE,GAAG,CAAC/E,UAAJ,EAAL,EAAuB;AACrB,kBAAI,KAAK3D,gBAAT,EAA2B;AAAE;AAC3B,qBAAKA,gBAAL,GAAwB,KAAxB;AACAiD,gBAAAA,UAAU,CAAC,MAAM;AACf,uBAAKjD,gBAAL,GAAwB,IAAxB;AACD,iBAFS,EAEP,IAFO,CAAV;AAGA;AAAA;AAAA,wDAAiB6I,UAAjB;AACD;AACF,aARD,MAQO,IAAI,CAACH,GAAG,CAACtD,eAAJ,EAAL,EAA4B;AACjC,mBAAK1D,gBAAL,CAAsB;AAAA;AAAA,8DAAoBoH,QAA1C;AACD;;AACDpB,YAAAA,SAAS,GAAG,CAAZ;AACD,WAzBD,EAvCwB,CAiExB;;AACAzF,UAAAA,IAAI,CAAC6B,UAAL,CAAgBiE,EAAhB,CAAmBzJ,IAAI,CAAC0J,SAAL,CAAeC,SAAlC,EAA6C,MAAM;AACjD;AAAA;AAAA,8CAAa9B,WAAb,GAA2BC,SAA3B,CAAqC;AAAA;AAAA,wCAAU8B,WAA/C;AACA,gBAAMQ,GAAG,GAAG;AAAA;AAAA,2CAAZ;;AACA,gBAAIA,GAAG,CAAC/E,UAAJ,EAAJ,EAAsB;AACpB;AACD;;AACD1B,YAAAA,IAAI,CAAC8G,YAAL,CAAkB,MAAI;AACpB;AAAA;AAAA,gDAAa5C,WAAb,GAA2B6C,UAA3B,CAAsC,MAAM;AAC1C;AAAA;AAAA,sCAAOC,YAAP;AACD,eAFD;AAGD,aAJD,EAIE,CAJF;AAKD,WAXD;AAYAhH,UAAAA,IAAI,CAACiH,MAAL,CAAYnB,EAAZ,CAAezJ,IAAI,CAAC0J,SAAL,CAAeC,SAA9B,EAAyC,MAAM;AAC7C,gBAAMS,GAAG,GAAG;AAAA;AAAA,2CAAZ;;AACA,gBAAIA,GAAG,CAAC/E,UAAJ,MAAoB+E,GAAG,CAAC9E,WAAJ,MAAqB,CAA7C,EAAgD;AAC9C;AACD;;AACD;AAAA;AAAA,8CAAauC,WAAb,GAA2BC,SAA3B,CAAqC;AAAA;AAAA,wCAAU+C,QAA/C;AACA,iBAAKzH,gBAAL,CAAsB;AAAA;AAAA,gDAAcC,EAApC,EAAwC;AAAEC,cAAAA,KAAK,EAAE;AAAT,aAAxC,EAA0DhC,eAAe,CAACiC,iBAA1E;AACA;AAAA;AAAA,oDAAiBuH,yBAAjB;AACD,WARD;AASAnH,UAAAA,IAAI,CAACoH,WAAL,CAAiBtB,EAAjB,CAAoBzJ,IAAI,CAAC0J,SAAL,CAAeC,SAAnC,EAA8C,MAAM;AAClD,gBAAMS,GAAG,GAAG;AAAA;AAAA,2CAAZ;;AACA,gBAAIA,GAAG,CAAC/E,UAAJ,MAAoB+E,GAAG,CAAC9E,WAAJ,MAAqB,CAA7C,EAAgD;AAC9C;AACD;;AACD;AAAA;AAAA,8CAAauC,WAAb,GAA2BC,SAA3B,CAAqC;AAAA;AAAA,wCAAUkD,WAA/C;AACA,iBAAK5H,gBAAL,CAAsB;AAAA;AAAA,gDAAcC,EAApC,EAAwC;AAAEC,cAAAA,KAAK,EAAE;AAAT,aAAxC,EAA+DhC,eAAe,CAACiC,iBAA/E;AACA;AAAA;AAAA,oDAAiBuH,yBAAjB;AACD,WARD;AASAnH,UAAAA,IAAI,CAACsH,MAAL,CAAYxB,EAAZ,CAAezJ,IAAI,CAAC0J,SAAL,CAAeC,SAA9B,EAAyC,MAAM;AAC7C,gBAAMS,GAAG,GAAG;AAAA;AAAA,2CAAZ;;AACA,gBAAIA,GAAG,CAAC/E,UAAJ,MAAoB+E,GAAG,CAAC9E,WAAJ,MAAqB,CAA7C,EAAgD;AAC9C;AACD;;AACD;AAAA;AAAA,8CAAauC,WAAb,GAA2BC,SAA3B,CAAqC;AAAA;AAAA,wCAAU+C,QAA/C;AACA,iBAAKzH,gBAAL,CAAsB;AAAA;AAAA,gDAAcC,EAApC,EAAwC;AAAEC,cAAAA,KAAK,EAAE;AAAT,aAAxC,EAA0DhC,eAAe,CAACiC,iBAA1E;AACA;AAAA;AAAA,oDAAiBuH,yBAAjB;AACD,WARD;AASA/B,UAAAA,cAAc,CAACU,EAAf,CAAkBzJ,IAAI,CAAC0J,SAAL,CAAeC,SAAjC,EAA4C,MAAM;AAChDZ,YAAAA,cAAc,CAACmC,MAAf,GAAwB,KAAxB;AACD,WAFD;AAGAnC,UAAAA,cAAc,CAACoC,QAAf,CAAwBC,OAAxB,CAAgC,CAACC,KAAD,EAAQC,KAAR,KAAkB;AAChDD,YAAAA,KAAK,CAAC5B,EAAN,CAASzJ,IAAI,CAAC0J,SAAL,CAAeC,SAAxB,EAAmC,MAAM;AACvC,kBAAMS,GAAG,GAAG;AAAA;AAAA,6CAAZ,CADuC,CAEvC;;AACA,kBAAIA,GAAG,CAAClF,iBAAJ,OAA4B;AAAA;AAAA,oDAAemF,OAA/C,EAAwD;AACtDD,gBAAAA,GAAG,CAACE,iBAAJ,CAAsBgB,KAAtB;AACA,qBAAKlI,gBAAL,CAAsB;AAAA;AAAA,oDAAcC,EAApC,EAAwC,EAAxC,EAA4C;AAAA;AAAA,sDAAewB,WAA3D;AACD;AACF,aAPD;AAQD,WATD;AAUA,eAAK0G,WAAL,CAAiBtC,iBAAiB,CAACpF,YAAlB,CAA+B1D,MAA/B,CAAjB;AACA8I,UAAAA,iBAAiB,CAACQ,EAAlB,CAAqBtJ,MAAM,CAACuJ,SAAP,CAAiB8B,MAAtC,EAA+CC,MAAD,IAAoB;AAChE;AAAA;AAAA,4CAAaF,WAAb,CAAyBE,MAAM,CAACtC,SAAP,GAAmB;AAAA;AAAA,sCAASuC,UAA5B,GAAyC;AAAA;AAAA,sCAASC,MAA3E;AACD,WAFD;AAGD;;AACOJ,QAAAA,WAAW,CAACE,MAAD,EAAiB;AAClC;AAAA;AAAA,0CAAaF,WAAb,CAAyBE,MAAM,CAACtC,SAAP,GAAmB;AAAA;AAAA,oCAASuC,UAA5B,GAAyC;AAAA;AAAA,oCAASC,MAA3E;AACD;;AA0MO1H,QAAAA,QAAQ,CAAC2H,UAAD,EAA2B;AACzC,cAAMC,WAAwB,GAAGD,UAAU,IAAI;AAAA;AAAA,kDAAiB7F,mBAAjB,GAAuC/B,QAAvC,EAA/C;;AACA4E,UAAAA,OAAO,CAACC,GAAR,CAAYgD,WAAZ;AACA,cAAIC,OAAe,GAAG,CAAtB;;AACA,cAAID,WAAW,KAAK;AAAA;AAAA,0CAAYnD,SAAhC,EAA2C;AACzCoD,YAAAA,OAAO,GAAG,CAAV;AACD,WAFD,MAEO;AACL,gBAAMC,WAAW,GAAG,IAAIC,IAAJ,EAApB;AACA,gBAAMC,WAAW,GAAGF,WAAW,CAACG,QAAZ,EAApB;;AACA,gBAAID,WAAW,IAAI,CAAf,IAAoBA,WAAW,GAAG,EAAtC,EAA0C;AACxCH,cAAAA,OAAO,GAAG,CAAV,CADwC,CAC3B;AACd,aAFD,MAEO,IAAIG,WAAW,IAAI,EAAf,IAAqBA,WAAW,GAAG,EAAvC,EAA2C;AAChDH,cAAAA,OAAO,GAAG,CAAV,CADgD,CACnC;AACd,aAFM,MAEA;AACLA,cAAAA,OAAO,GAAG,CAAV,CADK,CACQ;AACd;AACF;;AACA,eAAKlI,QAAL,CAAcC,YAAd,CAA2B,aAA3B,CAAD,CAA2DsI,KAA3D,CAAiEL,OAAjE;AACA,eAAK1I,gBAAL,CAAsB;AAAA;AAAA,0DAAoBgJ,iBAA1C,EAA6D;AAAEN,YAAAA,OAAO,EAAEA;AAAX,WAA7D;AACD;;AAtYkD,O","sourcesContent":["import { Node, Prefab, Sprite, Toggle } from \"cc\";\r\nimport { INotification } from \"../../Framework/interfaces/INotification\";\r\nimport { CommandDefine } from \"../Const/CommandDefine\";\r\nimport { PrefabDefine } from \"../Const/PrefabDefine\";\r\nimport BaseMediator from \"./BaseMediator\"\r\nimport { IlistTypeHander } from \"../types/IlistTypeHander\";\r\nimport { ISourceFile } from \"../types/ISourceFile\";\r\nimport { gxfc_SlotBg } from \"../Component/gxfc_SlotBg\";\r\nimport { SubGameType } from \"../Proxy/SocketProxy\";\r\nimport { AutoLaunchType, StopMode } from \"../Repositories/BgRepository\";\r\nimport { DialogType, gxfc_DialogWin } from \"../Component/gxfc_DialogWin\";\r\nimport { BgCommandConst } from \"../Command/BgCommand\";\r\nimport { getBgProxy, getSocketProxy } from \"../utils\";\r\nimport { gxfc_Toast } from \"../Component/gxfc_Toast\";\r\nimport { RollerMediatorConst } from \"./RollerMediator\";\r\nimport { AudioManager, SoundList } from \"../Managr/AudioManager\";\r\nimport { global } from \"db://assets/script/hall\";\r\nimport UseSetOption from \"db://assets/script/utils/UseSetOption\";\r\nimport { addToastAction } from \"../../../../hall/store/actions/baseBoard\";\r\nimport { sendNativeVibrate } from \"../../../../common/bridge\";\r\n// export interface IlistNotificationer {\r\n//  name: string\r\n//  isListen?: boolean\r\n//  handler(notification: INotification): void\r\n// }\r\nexport enum BgMediatorConst {\r\n  INIT_MAIN_PANEL = \"initMainPanel\",\r\n  /**开始飞水果 */\r\n  START_FLY_BG = \"startFlyBg\",\r\n  /**更新一些关于数字的界面（弃用） */\r\n  UPDATE_NUMBER = \"updateNumber\",\r\n  /**修改背景图片 */\r\n  CHANGE_BG = \"changeBG\",\r\n  /**更新自动启动按钮面板 */\r\n  UPDATE_AUTO_LAUNCH = \"updateAutoLaunch\",\r\n  /**更新游戏进行状态 */\r\n  UPDATE_GAME_STATUS = \"updateGameStatus\",\r\n  /**展示大奖弹窗 */\r\n  SHOW_DIALOG_WIN = \"showDialogWin\",\r\n  /**展示规则弹窗 */\r\n  OPEN_RULE_PANEL = \"openRulePanel\",\r\n  /**刷新下注信息 */\r\n  UPDATE_BET_AMOUNT = \"updateBetAmount\",\r\n  /**更新当前的奖励 */\r\n  UPDATE_CURRENT_SCORE = \"updateCurrentScore\",\r\n  /**展示toast */\r\n  SHOW_TOAST = \"showToast\",\r\n  /*更换按钮文字*/\r\n  UPDATE_BTN_LABEL = \"updateBtnLabel\",\r\n  /*更新玩家金币*/\r\n  UPDATE_USER_GOLD = \"updateUserGold\",\r\n  /*切换启动按钮状态*/\r\n  TOGGLETHESTARTBUTTON = 'togglethestartbutton',\r\n  /*初始化积分*/\r\n  INITSCORE = 'initScore',\r\n  /*其他动画*/\r\n  NUMBEROFDISPLAYS = 'numberOfDisplays',\r\n  /*余额不足*/\r\n  InsufficientBalanceDisplay = \"InsufficientBalanceDisplay\",\r\n  /*设置+-按钮置灰*/\r\n  SETGREYOUT = 'SETGREYOUT'\r\n}\r\n\r\nexport default class BgMediator extends BaseMediator {\r\n  buttonThrottling = true\r\n  public constructor(mediatorName: string = null, viewComponent: any = null) {\r\n    super(mediatorName, viewComponent)\r\n  }\r\n  public sourceMap: Array<ISourceFile> = [\r\n    {\r\n      key: 'fruitsSlot',\r\n      path: PrefabDefine.SLOT_BG,\r\n      sourceType: Prefab,\r\n      source: null\r\n    },\r\n    {\r\n      key: 'flyBg',\r\n      path: PrefabDefine.FLY_BG,\r\n      sourceType: Prefab,\r\n      source: null\r\n    },\r\n    {\r\n      key: 'dynamicNumber',\r\n      path: PrefabDefine.DYNAMIC_NUMBER,\r\n      sourceType: Prefab,\r\n      source: null\r\n    },\r\n    {\r\n      key: 'dialogWin',\r\n      path: PrefabDefine.DIALOG_WIN,\r\n      sourceType: Prefab,\r\n      source: null\r\n    },\r\n    {\r\n      key: 'rulePanel',\r\n      path: PrefabDefine.RULE_PANEL,\r\n      sourceType: Prefab,\r\n      source: null\r\n    },\r\n    {\r\n      key: 'toast',\r\n      path: PrefabDefine.TOAST,\r\n      sourceType: Prefab,\r\n      source: null\r\n    }\r\n  ]\r\n\r\n  protected listenerEvent() {\r\n    const comp = (<gxfc_SlotBg>this.wrapView.getComponent(\"gxfc_SlotBg\"))\r\n    const autoButtonWrap = (<gxfc_SlotBg>this.wrapView.getComponent(\"gxfc_SlotBg\")).autoLaunch\r\n    const props_toggle_fast = (<gxfc_SlotBg>this.wrapView.getComponent(\"gxfc_SlotBg\")).propsToggleFast\r\n    props_toggle_fast.getComponent(Toggle).isChecked = false;\r\n\r\n    let pressTime = 0\r\n    const timeLimit = 500 //按压触发自动面板时间\r\n    let timer = 0\r\n    let isLongPress = false\r\n    comp.ruleButton.on(Node.EventType.TOUCH_END, () => {\r\n      AudioManager.getInstance().playSound(SoundList.buttonClick);\r\n      this.sendNotification(BgMediatorConst.OPEN_RULE_PANEL)\r\n    })\r\n    comp.startButton.on(Node.EventType.TOUCH_START, () => {\r\n      timer = window.setInterval(() => {\r\n        pressTime += 10\r\n        if (pressTime > timeLimit) {\r\n          window.clearInterval(timer)\r\n          const presentGame = getBgProxy().getNextGame()\r\n          if (presentGame === SubGameType.MAIN) {\r\n            (<gxfc_SlotBg>this.wrapView.getComponent(\"gxfc_SlotBg\")).triggeAutoLaunch()\r\n            isLongPress = true\r\n          } else {\r\n            isLongPress = false\r\n          }\r\n        }\r\n      }, 10);\r\n      AudioManager.getInstance().playSound(SoundList.buttonClick);\r\n      this.sendNotification(BgMediatorConst.INITSCORE)\r\n    })\r\n    comp.startButton.on(Node.EventType.TOUCH_CANCEL, () => {\r\n      window.clearInterval(timer);\r\n      if (isLongPress) {\r\n        pressTime = 0\r\n        isLongPress = false\r\n        return\r\n      }\r\n    })\r\n    comp.startButton.on(Node.EventType.TOUCH_END, () => {\r\n      window.clearInterval(timer);\r\n      if (isLongPress) {\r\n        pressTime = 0\r\n        isLongPress = false\r\n        return\r\n      }\r\n      const fbp = getBgProxy()\r\n      if (fbp.getAutoLaunchType() !== AutoLaunchType.DISABLE) {\r\n        fbp.setAutoLaunchType(AutoLaunchType.DISABLE)\r\n      }\r\n      (<gxfc_SlotBg>this.wrapView.getComponent(\"gxfc_SlotBg\")).triggeAutoLaunch(false)\r\n      // 禁用状态不能点击发送下注\r\n      if (!fbp.getDisable()) {\r\n        if (this.buttonThrottling) { // 按钮防抖节流\r\n          this.buttonThrottling = false\r\n          setTimeout(() => {\r\n            this.buttonThrottling = true\r\n          }, 1000)\r\n          getSocketProxy().sendLaunch();\r\n        }\r\n      } else if (!fbp.checkAutoLaunch()) {\r\n        this.sendNotification(RollerMediatorConst.END_ROLL)\r\n      }\r\n      pressTime = 0\r\n    })\r\n    // 点击首页按钮\r\n    comp.homeButton.on(Node.EventType.TOUCH_END, () => {\r\n      AudioManager.getInstance().playSound(SoundList.buttonClick);\r\n      const fbp = getBgProxy()\r\n      if (fbp.getDisable()) {\r\n        return\r\n      }\r\n      comp.scheduleOnce(()=>{\r\n        AudioManager.getInstance().closeMusic(() => {\r\n          global.closeSubGame()\r\n        });\r\n      },1)\r\n    })\r\n    comp.addBet.on(Node.EventType.TOUCH_END, () => {\r\n      const fbp = getBgProxy()\r\n      if (fbp.getDisable() || fbp.getLastGame() != 0) {\r\n        return\r\n      }\r\n      AudioManager.getInstance().playSound(SoundList.add_coin)\r\n      this.sendNotification(CommandDefine.BG, { order: \"add\" }, BgMediatorConst.UPDATE_BET_AMOUNT)\r\n      getSocketProxy().calculateTheBalanceStatus()\r\n    })\r\n    comp.subtractBet.on(Node.EventType.TOUCH_END, () => {\r\n      const fbp = getBgProxy()\r\n      if (fbp.getDisable() || fbp.getLastGame() != 0) {\r\n        return\r\n      }\r\n      AudioManager.getInstance().playSound(SoundList.reduce_coin)\r\n      this.sendNotification(CommandDefine.BG, { order: \"subtract\" }, BgMediatorConst.UPDATE_BET_AMOUNT)\r\n      getSocketProxy().calculateTheBalanceStatus()\r\n    })\r\n    comp.maxBet.on(Node.EventType.TOUCH_END, () => {\r\n      const fbp = getBgProxy()\r\n      if (fbp.getDisable() || fbp.getLastGame() != 0) {\r\n        return\r\n      }\r\n      AudioManager.getInstance().playSound(SoundList.add_coin)\r\n      this.sendNotification(CommandDefine.BG, { order: \"max\" }, BgMediatorConst.UPDATE_BET_AMOUNT)\r\n      getSocketProxy().calculateTheBalanceStatus()\r\n    })\r\n    autoButtonWrap.on(Node.EventType.TOUCH_END, () => {\r\n      autoButtonWrap.active = false;\r\n    })\r\n    autoButtonWrap.children.forEach((child, index) => {\r\n      child.on(Node.EventType.TOUCH_END, () => {\r\n        const fbp = getBgProxy()\r\n        // 必须处于未开启状态才能修改自动执行\r\n        if (fbp.getAutoLaunchType() === AutoLaunchType.DISABLE) {\r\n          fbp.setAutoLaunchType(index);\r\n          this.sendNotification(CommandDefine.BG, {}, BgCommandConst.AUTO_LAUNCH)\r\n        }\r\n      })\r\n    })\r\n    this.setStopMode(props_toggle_fast.getComponent(Toggle));\r\n    props_toggle_fast.on(Toggle.EventType.TOGGLE, (toggle: Toggle) => {\r\n      getBgProxy().setStopMode(toggle.isChecked ? StopMode.QUEUE_STOP : StopMode.NORMAL);\r\n    })\r\n  }\r\n  private setStopMode(toggle: Toggle) {\r\n    getBgProxy().setStopMode(toggle.isChecked ? StopMode.QUEUE_STOP : StopMode.NORMAL);\r\n  }\r\n\r\n  protected listNotificationConst: Array<IlistTypeHander<BgMediator>> = [\r\n    {\r\n      name: BgMediatorConst.INIT_MAIN_PANEL,\r\n      handler(notification: INotification) {\r\n        this.init()\r\n        let pdd = UseSetOption.Instance().option.gameSet.gxfc ? UseSetOption.Instance().option.gameSet.gxfc.betTarget.positionId : 1\r\n        getSocketProxy().initUserSwitch(pdd)\r\n        this.sendNotification(CommandDefine.BG, { order: \"curr\" }, BgMediatorConst.UPDATE_BET_AMOUNT)\r\n      }\r\n    },\r\n    {\r\n      name: BgMediatorConst.SETGREYOUT,\r\n      handler(notification: INotification) {\r\n        const { state } = notification.getBody(),\r\n          comp = (this.wrapView.getComponent(\"gxfc_SlotBg\") as gxfc_SlotBg)\r\n        if (state !== 0) {\r\n          comp.setGreyOut('SZX_-', state == 1)\r\n          comp.setGreyOut('SZX_+', state == 2)\r\n        } else {\r\n          comp.setGreyOut('SZX_-', false)\r\n          comp.setGreyOut('SZX_+', false)\r\n        }\r\n\r\n      }\r\n    },\r\n    {\r\n      name: BgMediatorConst.CHANGE_BG,\r\n      handler(notification: INotification) {\r\n        const { gameType } = notification.getBody() || {}\r\n        this.changeBg(gameType)\r\n      }\r\n    },\r\n    {\r\n      name: BgMediatorConst.INITSCORE,\r\n      handler(notification: INotification) {\r\n        const { state } = notification.getBody() || {}\r\n        if (state) {\r\n          (this.wrapView.getComponent(\"gxfc_SlotBg\") as gxfc_SlotBg).updateScore(0);\r\n        }\r\n        if (getBgProxy().getNextGame() == 0) {\r\n          (this.wrapView.getComponent(\"gxfc_SlotBg\") as gxfc_SlotBg).updateScore(0);\r\n        }\r\n      }\r\n    },\r\n    {\r\n      name: BgMediatorConst.START_FLY_BG,\r\n      handler(notification: INotification) {\r\n        const flyBgNode = this.getSource(PrefabDefine.FLY_BG)\r\n        this.viewComponent.addChild(flyBgNode)\r\n        flyBgNode.setSiblingIndex(1000)\r\n        window.setTimeout(() => {\r\n          this.sendNotification(BgMediatorConst.TOGGLETHESTARTBUTTON, { state: true })\r\n          this.sendNotification(CommandDefine.BG, {}, BgCommandConst.AUTO_LAUNCH)\r\n          this.viewComponent.removeChild(flyBgNode)\r\n        }, 3000)\r\n      }\r\n    },\r\n    {\r\n      name: BgMediatorConst.UPDATE_NUMBER,\r\n      handler(notification: INotification) {\r\n        // const { betAmount, score } = notification.getBody();\r\n        // (this.wrapView.getComponent(\"gxfc_SlotBg\") as gxfc_SlotBg).updateBetAmount(betAmount);\r\n        // (this.wrapView.getComponent(\"gxfc_SlotBg\") as gxfc_SlotBg).updateScore(score);\r\n      }\r\n    },\r\n    {\r\n      name: BgMediatorConst.UPDATE_AUTO_LAUNCH,\r\n      handler(notification: INotification) {\r\n        (<gxfc_SlotBg>this.wrapView.getComponent(\"gxfc_SlotBg\")).setActiveButton(getBgProxy().getAutoLaunchType())\r\n      }\r\n    },\r\n    {\r\n      name: BgMediatorConst.UPDATE_GAME_STATUS,\r\n      handler(notification: INotification) {\r\n        const comp = (<gxfc_SlotBg>this.wrapView.getComponent(\"gxfc_SlotBg\"))\r\n        comp.setDisable(getBgProxy().getDisable())\r\n        if (getBgProxy().getLastGame() != 0) {\r\n          comp.setDis_btn(true)\r\n        } else {\r\n          comp.setDis_btn(getBgProxy().getDisable())\r\n        }\r\n        comp.homeButton.getComponent(Sprite).grayscale = getBgProxy().getDisable()\r\n      }\r\n    }, {\r\n      name: BgMediatorConst.UPDATE_BTN_LABEL,\r\n      handler(notification: INotification) {\r\n        let { frequency } = notification.getBody()\r\n        const comp = (<gxfc_SlotBg>this.wrapView.getComponent(\"gxfc_SlotBg\"))\r\n        comp.setBtnLabel(frequency)\r\n      }\r\n    }, {\r\n      name: BgMediatorConst.UPDATE_USER_GOLD,\r\n      handler(notification: INotification) {\r\n        let { state } = notification.getBody()\r\n        let gold = getSocketProxy().getTransferGameInfo().getUserGold(state)\r\n        const comp = (<gxfc_SlotBg>this.wrapView.getComponent(\"gxfc_SlotBg\"))\r\n        comp.setGold(gold)\r\n      }\r\n    },\r\n    {\r\n      name: BgMediatorConst.SHOW_DIALOG_WIN,\r\n      handler(notification: INotification) {\r\n        sendNativeVibrate(200);\r\n        const { dialogType, amount, keepTime, done } = notification.getBody()\r\n        const dialog = this.getSource(PrefabDefine.DIALOG_WIN);\r\n        this.viewComponent.addChild(dialog);\r\n        let type = dialogType\r\n        if (dialogType === 'jackpot' && getSocketProxy().getShiftAmount(\"curr\").jackpot == 0) {\r\n          type = 'superWin'\r\n        }\r\n        (dialog.getComponent(gxfc_DialogWin) as gxfc_DialogWin).showDialog(dialogType, amount, keepTime || 2000, () => { done() })\r\n      }\r\n    },\r\n    {\r\n      name: BgMediatorConst.OPEN_RULE_PANEL,\r\n      handler(notification: INotification) {\r\n        const rulePanel = this.getSource(PrefabDefine.RULE_PANEL);\r\n        this.viewComponent.addChild(rulePanel)\r\n      }\r\n    },\r\n    {\r\n      name: BgMediatorConst.TOGGLETHESTARTBUTTON,\r\n      handler(notification: INotification) {\r\n        const { state } = notification.getBody();\r\n        if (getBgProxy().getNextGame() == 0) {\r\n          if (getBgProxy().checkAutoLaunch()) { // 是自动\r\n            let str = (getBgProxy().isUNLIMT()) ? \"∞\" : getBgProxy().getAutoLaunchNum() + \"/\" + getBgProxy().getTotal();\r\n            (this.wrapView.getComponent(\"gxfc_SlotBg\") as gxfc_SlotBg).setBtnState(state, 3, str);\r\n          } else {\r\n            (this.wrapView.getComponent(\"gxfc_SlotBg\") as gxfc_SlotBg).setBtnState(state);\r\n          }\r\n        } else { // 小游戏\r\n          (this.wrapView.getComponent(\"gxfc_SlotBg\") as gxfc_SlotBg).setBtnState(state, 1);\r\n        }\r\n      }\r\n    },\r\n    {\r\n      name: BgMediatorConst.InsufficientBalanceDisplay,\r\n      handler(notification: INotification) {\r\n        const { bl } = notification.getBody();\r\n        (this.wrapView.getComponent(\"gxfc_SlotBg\") as gxfc_SlotBg).Balance_tips(bl)\r\n      }\r\n    },\r\n    {\r\n      name: BgMediatorConst.UPDATE_BET_AMOUNT,\r\n      handler(notification: INotification) {\r\n        const { baseBetAmount, lineCount } = notification.getBody();\r\n        (this.wrapView.getComponent(\"gxfc_SlotBg\") as gxfc_SlotBg).updateBetAmount(baseBetAmount, lineCount);\r\n      }\r\n    },\r\n    {\r\n      name: BgMediatorConst.UPDATE_CURRENT_SCORE,\r\n      handler(notification: INotification) {\r\n        const { order } = notification.getBody() || {}\r\n        const currentScore = getSocketProxy().getTransferGameInfo().getCurrentScore(order || \"auto\");\r\n        if (currentScore > 0) {\r\n          AudioManager.getInstance().playSound(SoundList.coinCollection);\r\n        }\r\n        (this.wrapView.getComponent(\"gxfc_SlotBg\") as gxfc_SlotBg).updateScore(currentScore)\r\n      }\r\n    },\r\n    {\r\n      name: BgMediatorConst.SHOW_TOAST,\r\n      handler(notification: INotification) {\r\n        const { content } = notification.getBody() || {};\r\n        global.hallDispatch(addToastAction({ content: String(content) }))\r\n        // const toastPanel = this.getSource(PrefabDefine.TOAST)\r\n        // this.viewComponent.addChild(toastPanel);\r\n        // (toastPanel.getComponent(\"gxfc_Toast\") as gxfc_Toast).showContent(content)\r\n      }\r\n    },\r\n    {\r\n      name: BgMediatorConst.NUMBEROFDISPLAYS,\r\n      handler(notification: INotification) {\r\n        const { amount, keepTime, done } = notification.getBody();\r\n        let dialogType: DialogType = null;\r\n        const fab = getBgProxy()\r\n        let amountTmp = amount;\r\n\r\n        if (fab.getIsChangeGameRunning() !== -1) {\r\n          if (fab.getLastGame() === SubGameType.MAIN) {\r\n            dialogType = DialogType.PRESS_START\r\n          } else if (fab.getLastGame() === SubGameType.SUB_GAME1) {\r\n            dialogType = DialogType.YOUWON\r\n            amountTmp = getSocketProxy().getTransferGameInfo().getCurrentScore('auto');\r\n          }\r\n          const dialog = this.getSource(PrefabDefine.DIALOG_WIN);\r\n          this.viewComponent.addChild(dialog);\r\n\r\n          console.log(`NUMBEROFDISPLAYS lastgame: ${fab.getLastGame()}, amount: ${amountTmp}, dialogType: ${dialogType} `);\r\n\r\n          (dialog.getComponent(gxfc_DialogWin) as gxfc_DialogWin).showDialog(dialogType, amountTmp, keepTime || 2000, () => { done() });\r\n        } else {\r\n\r\n          console.log(`NUMBEROFDISPLAYS done `);\r\n          done()\r\n        }\r\n      }\r\n    }\r\n  ]\r\n  private changeBg(gameRunner?: SubGameType) {\r\n    const _gameRunner: SubGameType = gameRunner || getSocketProxy().getTransferGameInfo().gameType();\r\n    console.log(_gameRunner)\r\n    let bgIndex: number = 0\r\n    if (_gameRunner === SubGameType.SUB_GAME1) {\r\n      bgIndex = 3\r\n    } else {\r\n      const currentTime = new Date();\r\n      const currentHour = currentTime.getHours();\r\n      if (currentHour >= 6 && currentHour < 12) {\r\n        bgIndex = 0; // 早上\r\n      } else if (currentHour >= 12 && currentHour < 18) {\r\n        bgIndex = 1; // 中午\r\n      } else {\r\n        bgIndex = 2; // 晚上\r\n      }\r\n    }\r\n    (this.wrapView.getComponent(\"gxfc_SlotBg\") as gxfc_SlotBg).setBg(bgIndex)\r\n    this.sendNotification(RollerMediatorConst.UPDATE_ICON_STATE, { bgIndex: bgIndex })\r\n  }\r\n}\r\n"]}