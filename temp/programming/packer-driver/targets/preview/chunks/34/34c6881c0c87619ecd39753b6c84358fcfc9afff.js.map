{"version":3,"sources":["file:///Users/geliang/web/dibai/hall/assets/script/subGame/gxfc/Slot/Command/RollerCommand.ts"],"names":["RollerCommand","RollerMediatorConst","RollerType","BaseCommand","SubGameType","SKT_MAG_TYPE","sktMsgListener","getSlotProxy","getSocketProxy","RollerCommandConst","listExecute","type","INIT_ROLLER_PANEL","handler","notification","gameType","getBody","_gameRunner","getTransferGameInfo","initRoller","add","LAUNCH","data","rollerType","MAIN","NORMAL","LARGE","stopIndexArr","dockIocn","getWildRollerId","sendNotification","BEGIN_ROLL","stopIndex","targetList","map","item","coord","item2","END_ROLL","UNINSTALL_ROLLER_PANEL","remove","execute"],"mappings":";;;qJAeaA,a;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAZJC,MAAAA,mB,iBAAAA,mB;;AACWC,MAAAA,U,iBAAAA,U;;AACXC,MAAAA,W,iBAAAA,W;;AACAC,MAAAA,W,iBAAAA,W;AAAaC,MAAAA,Y,iBAAAA,Y;AAA2BC,MAAAA,c,iBAAAA,c;;AAExCC,MAAAA,Y,iBAAAA,Y;AAAcC,MAAAA,c,iBAAAA,c;;;;;;;oCAEXC,kB,0BAAAA,kB;AAAAA,QAAAA,kB;AAAAA,QAAAA,kB;eAAAA,kB;;;+BAKCT,a,GAAN,MAAMA,aAAN;AAAA;AAAA,sCAAwC;AAAA;AAAA;AAAA,eACpCU,WADoC,GACc,CAC3D;AACCC,YAAAA,IAAI,EAAE;AAAA;AAAA,4DAAoBC,iBAD3B;;AAECC,YAAAA,OAAO,CAACC,YAAD,EAA8B;AACpC,kBAAM;AAAEC,gBAAAA;AAAF,kBAAeD,YAAY,CAACE,OAAb,MAA0B,EAA/C,CADoC,CAEpC;;AACA,kBAAMC,WAAwB,GAAGF,QAAQ,IAAI;AAAA;AAAA,sDAAiBG,mBAAjB,GAAuCH,QAAvC,EAA7C,CAHoC,CAIpC;;;AACA;AAAA;AAAA,kDAAeI,UAAf,GALoC,CAOpC;;AACA;AAAA;AAAA,oDAAeC,GAAf,CAAmB;AAAA;AAAA,gDAAaC,MAAhC,EAAwC,QAAxC,EAAmDC,IAAD,IAAU;AAC3D;AACA;AACA,oBAAMC,UAAU,GAAGN,WAAW,KAAK;AAAA;AAAA,gDAAYO,IAA5B,GAAmC;AAAA;AAAA,8CAAWC,MAA9C,GAAuD;AAAA;AAAA,8CAAWC,KAArF;AACA,oBAAMC,YAAY,GAAG;AAAA;AAAA,wDAAiBT,mBAAjB,GAAuCS,YAAvC,EAArB;AACA,oBAAMC,QAAQ,GAAG;AAAA;AAAA,wDAAiBV,mBAAjB,GAAuCW,eAAvC,EAAjB,CAL2D,CAM3D;AACA;;AACA,qBAAKC,gBAAL,CAAsB;AAAA;AAAA,gEAAoBC,UAA1C,EAAsD;AACrD;AACA;AACAC,kBAAAA,SAAS,EAAEL,YAH0C;AAIrDM,kBAAAA,UAAU,EAAE;AAAA;AAAA,0DAAiBf,mBAAjB,GAAuCe,UAAvC,GAAoDC,GAApD,CAAwDC,IAAI,IAAIA,IAAI,CAACC,KAAL,CAAWF,GAAX,CAAeG,KAAK,IAAIA,KAAK,CAAC,CAAD,CAA7B,CAAhE,CAJyC;AAKrDT,kBAAAA;AALqD,iBAAtD;AAOA,eAfD,EAeG,CAfH;AAgBA,qBAAOd,YAAY,CAACE,OAAb,EAAP;AACA;;AA3BF,WAD2D,EA8B3D;AACCL,YAAAA,IAAI,EAAE;AAAA;AAAA,4DAAoBoB,UAD3B;;AAEClB,YAAAA,OAAO,CAACC,YAAD,EAA8B;AACpC,qBAAOA,YAAY,CAACE,OAAb,EAAP;AACA;;AAJF,WA9B2D,EAoC3D;AACCL,YAAAA,IAAI,EAAE;AAAA;AAAA,4DAAoB2B,QAD3B;;AAECzB,YAAAA,OAAO,CAACC,YAAD,EAA8B;AACpC,qBAAOA,YAAY,CAACE,OAAb,EAAP;AACA;;AAJF,WApC2D,EA0C3D;AACCL,YAAAA,IAAI,EAAE;AAAA;AAAA,4DAAoB4B,sBAD3B;;AAEC1B,YAAAA,OAAO,CAACC,YAAD,EAA8B;AACpC;AAAA;AAAA,oDAAe0B,MAAf,CAAsB;AAAA;AAAA,gDAAanB,MAAnC,EAA2C,QAA3C;AACA,qBAAO,IAAP;AACA;;AALF,WA1C2D,CADd;AAAA;;AAmDvCoB,QAAAA,OAAO,CAAC3B,YAAD,EAAoC;AACjD,gBAAM2B,OAAN,CAAc3B,YAAd;AACA;;AArD6C,O","sourcesContent":["import Facade from \"../../Framework/care/Facade\"\r\nimport { INotification } from \"../../Framework/interfaces/INotification\"\r\nimport { ProxyDefine } from \"../Const/ProxyDefine\";\r\nimport { RollerMediatorConst } from \"../Mediator/RollerMediator\";\r\nimport { SlotProxy, RollerType } from \"../Proxy/SlotProxy\";\r\nimport { BaseCommand, IListExecute } from './BaseCommand'\r\nimport { SubGameType, SKT_MAG_TYPE, SocketProxy, sktMsgListener } from \"../Proxy/SocketProxy\";\r\nimport { BgMediatorConst } from \"../Mediator/BgMediator\";\r\nimport { getSlotProxy, getSocketProxy } from \"../utils\";\r\n\r\nexport enum RollerCommandConst {\r\n\tBEGIN_ROLL = \"beginRoll\",\r\n\tEND_ROLL = \"endRoll\"\r\n}\r\n\r\nexport class RollerCommand extends BaseCommand {\r\n\tprotected listExecute: Array<IListExecute<RollerCommand>> = [\r\n\t\t{\r\n\t\t\ttype: RollerMediatorConst.INIT_ROLLER_PANEL,\r\n\t\t\thandler(notification: INotification) {\r\n\t\t\t\tconst { gameType } = notification.getBody() || {}\r\n\t\t\t\t//在初始化界面之前要初始化数据 'iconRollerQueue' | 'largeIconRollerQueue'\r\n\t\t\t\tconst _gameRunner: SubGameType = gameType || getSocketProxy().getTransferGameInfo().gameType()\r\n\t\t\t\t// const rollerType = _gameRunner === SubGameType.MAIN ? RollerType.NORMAL : RollerType.LARGE;\r\n\t\t\t\tgetSlotProxy().initRoller()\r\n\r\n\t\t\t\t// 接收下注的结果\r\n\t\t\t\tsktMsgListener.add(SKT_MAG_TYPE.LAUNCH, 'roller', (data) => {\r\n\t\t\t\t\t// const gt = (this.facade.retrieveProxy(ProxyDefine.WEBSOCKET) as SocketProxy).getTransferGameInfo().gameType();\r\n\t\t\t\t\t// if (gt === SubGameType.SUB_GAME1) return\r\n\t\t\t\t\tconst rollerType = _gameRunner === SubGameType.MAIN ? RollerType.NORMAL : RollerType.LARGE;\r\n\t\t\t\t\tconst stopIndexArr = getSocketProxy().getTransferGameInfo().stopIndexArr()\r\n\t\t\t\t\tconst dockIocn = getSocketProxy().getTransferGameInfo().getWildRollerId()\r\n\t\t\t\t\t// console.log(stopIndexArr)\r\n\t\t\t\t\t// console.log(this.getSocketProxy().getTransferGameInfo().targetList().map(item => item.coord.map(item2 => item2[1])))\r\n\t\t\t\t\tthis.sendNotification(RollerMediatorConst.BEGIN_ROLL, {\r\n\t\t\t\t\t\t// stopIndex: [42, 8, 29, 1, 1],\r\n\t\t\t\t\t\t// targetList: [[0, 0, 0, 0, 0], [1, 1, 1, 1, 1]],\r\n\t\t\t\t\t\tstopIndex: stopIndexArr,\r\n\t\t\t\t\t\ttargetList: getSocketProxy().getTransferGameInfo().targetList().map(item => item.coord.map(item2 => item2[1])),\r\n\t\t\t\t\t\tdockIocn\r\n\t\t\t\t\t})\r\n\t\t\t\t}, 2)\r\n\t\t\t\treturn notification.getBody()\r\n\t\t\t}\r\n\t\t},\r\n\t\t{\r\n\t\t\ttype: RollerMediatorConst.BEGIN_ROLL,\r\n\t\t\thandler(notification: INotification) {\r\n\t\t\t\treturn notification.getBody()\r\n\t\t\t}\r\n\t\t},\r\n\t\t{\r\n\t\t\ttype: RollerMediatorConst.END_ROLL,\r\n\t\t\thandler(notification: INotification) {\r\n\t\t\t\treturn notification.getBody()\r\n\t\t\t}\r\n\t\t},\r\n\t\t{\r\n\t\t\ttype: RollerMediatorConst.UNINSTALL_ROLLER_PANEL,\r\n\t\t\thandler(notification: INotification) {\r\n\t\t\t\tsktMsgListener.remove(SKT_MAG_TYPE.LAUNCH, 'roller')\r\n\t\t\t\treturn true\r\n\t\t\t}\r\n\t\t}\r\n\t]\r\n\tpublic execute(notification: INotification): void {\r\n\t\tsuper.execute(notification)\r\n\t}\r\n}\r\n"]}