{"version":3,"sources":["file:///Users/geliang/web/dibai/hall/assets/script/hall/components/Hall_LoginPage.ts"],"names":["_decorator","Node","sys","BaseComponent","ApiUrl","fetcher","deviceInfo","getPackageName","ccclass","property","Hall_LoginPage","loginViewModel","propertyNode","props_guestBtu","props_loginBtu","props_btn_login_service","props_btn_login_situs","props_btn_login_melayani","props","events","onOpenLoginDialog","onLoginSuccess","openService","openHomePage","openActivity","start","initState","bindEvent","on","EventType","TOUCH_END","send","LOGIN_OUT","type","macCode","getUniqueId","pkgCode","then","data","localStorage","setItem","catch","e","console","log","useProps","key","value","bindUI","update","deltaTime"],"mappings":"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","sourcesContent":["import { _decorator, Component, Node, sys } from 'cc';\r\nimport { BaseComponent } from '../../base/BaseComponent';\r\nimport LoginViewModel from '../viewModel/LoginViewDialogModel';\r\nimport { PrefabPathDefine } from '../sourceDefine/prefabDefine';\r\nimport { EffectType } from '../../utils/NodeIOEffect';\r\nimport Fetcher from '../../utils/Fetcher';\r\nimport { ApiUrl } from '../apiUrl';\r\nimport { fetcher } from '../index';\r\nimport { config, deviceInfo } from '../config';\r\nimport { getPackageName } from '../../common/bridge';\r\nconst { ccclass, property } = _decorator;\r\n\r\nexport interface IState {\r\n}\r\n\r\nexport interface IProps {\r\n\r\n}\r\n\r\nexport interface IEvent {\r\n\t/**打开登录框 */\r\n\tonOpenLoginDialog?: () => void\r\n\t/**登录完成之后的操作 */\r\n\tonLoginSuccess?: () => void\r\n\t/**打开客服 */\r\n\topenService: () => void\r\n\t/**打开落地页 */\r\n\topenHomePage: () => void\r\n\t/**打开活动页 */\r\n\topenActivity: () => void\r\n}\r\n\r\n@ccclass('Hall_LoginPage')\r\nexport class Hall_LoginPage extends BaseComponent<IState, IProps, IEvent> {\r\n\tstart() { }\r\n\tprivate loginViewModel: LoginViewModel\r\n\tprotected propertyNode = {\r\n\t\tprops_guestBtu: new Node(),\r\n\t\tprops_loginBtu: new Node(),\r\n\t\tprops_btn_login_service: new Node(),\r\n\t\tprops_btn_login_situs: new Node(),\r\n\t\tprops_btn_login_melayani: new Node()\r\n\t}\r\n\r\n\tpublic props: IProps = {}\r\n\r\n\tpublic events: IEvent = {\r\n\t\tonOpenLoginDialog: () => { },\r\n\t\tonLoginSuccess: () => { },\r\n\t\topenService: () => { },\r\n\t\topenHomePage: () => { },\r\n\t\topenActivity: () => { }\r\n\t}\r\n\r\n\tprotected initState() {\r\n\t\treturn {}\r\n\t}\r\n\r\n\tprotected bindEvent(): void {\r\n\t\tthis.propertyNode.props_loginBtu.on(Node.EventType.TOUCH_END, () => {\r\n\t\t\tthis.events.onOpenLoginDialog()\r\n\t\t})\r\n\t\tthis.propertyNode.props_btn_login_service.on(Node.EventType.TOUCH_END, () => {\r\n\t\t\t// sys.openURL(`${config.customerUrl}`)\r\n\t\t\tthis.events.openService()\r\n\t\t})\r\n\r\n\t\tthis.propertyNode.props_btn_login_situs.on(Node.EventType.TOUCH_END, () => {\r\n\t\t\tthis.events.openHomePage()\r\n\t\t})\r\n\r\n\t\tthis.propertyNode.props_btn_login_melayani.on(Node.EventType.TOUCH_END, () => {\r\n\t\t\tthis.events.openActivity()\r\n\t\t})\r\n\r\n\t\tthis.propertyNode.props_guestBtu.on(Node.EventType.TOUCH_END, () => {\r\n\t\t\tfetcher.send(ApiUrl.LOGIN_OUT, { type: 5, macCode: deviceInfo.getUniqueId(), pkgCode: getPackageName() }).then((data) => {\r\n\t\t\t\t//登录成功\r\n\t\t\t\tsys.localStorage.setItem('token', data)\r\n\t\t\t\tthis.events.onLoginSuccess()\r\n\t\t\t}).catch((e) => {\r\n\t\t\t\tconsole.log(e)\r\n\t\t\t})\r\n\t\t})\r\n\t}\r\n\r\n\tprotected useProps(key: keyof IProps, value: { pre: any, cur: any }) {\r\n\t\t/**传入的props变更触发的函数 */\r\n\t\t// console.log(key, \"change\", value.cur)\r\n\t}\r\n\r\n\tprotected bindUI(): void {\r\n\r\n\t}\r\n\r\n\tupdate(deltaTime: number) {\r\n\r\n\t}\r\n}\r\n\r\n"]}