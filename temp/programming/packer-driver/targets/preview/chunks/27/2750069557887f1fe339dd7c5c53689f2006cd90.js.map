{"version":3,"sources":["file:///Users/geliang/web/dibai/hall/assets/script/hall/index.ts"],"names":["Prefab","SpriteFrame","assetManager","hallStore","getStore","BundleSplit","HallPrefabPathDefine","PrefabPathDefine","SoundPathDefine","hallFileMap","commonFileMap","LoaderPanelViewModel","BaseBoardViewModel","AudioMgr","Fetcher","config","Internationalization","languagePkg","LanguageItemType","GameConfig","ModalBox","GiftUserViewModel","getPackageName","SKT_MAG_TYPE","sktInstance","TaskSchedulerDefault","sourceManageMap","sourceManageSeletor","bundleName","find","i","bundle","name","bundleCommon","bundleHall","lang","startUp","rootNode","rootNodeWrap","configureStore","init","use","isDev","ZH","IDA","fetcher","httpBaseUrl","loadBundle","err","commonBundle","hallBundle","load","LOADER_PANEL","prefab","loaderviweModel","mountView","appendTo","setProps","loadBarType","setEvent","onLoadDone","_sourceManageMap","hallAudio","commonAudio","unMount","then","baseBoardView","getSourceFile","BASE_BOARD","connect","play","MAIN_BGM","versionStr","appLocalVersion","comp","startLoad","playBgMusic","fn","document","getElementById","removeEventListener","addEventListener","global","hallDispatch","action","dispatch","closeSubGame","option","_option","Object","assign","isPre","confirmContent","confirmDoneAfterFn","confirmDoneBeforeFn","Instance","isShow","contentStr","show","content","type","stopQueue","sendSktMessage","MEMBER_INFO","isLoading","openShop","buyType","mainPanelViewModel","openPersonCenter","index","openPc","openVipMain","openSign","loadHeadSprite","icon","sprite","sp","spriteFrame","setSubGameGate","gameId","progress","isAllowOpenSubGame","showGiftWindow","gameType","userInfo","callback","isValid","flyGift","fromMemberId","toMemberId","startPos","endPos","value","parentNode"],"mappings":"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","sourcesContent":["import hallStore, { getStore } from './store';\r\nimport { Asset, AssetManager, AudioClip, ImageAsset, Node, Prefab, Sprite, SpriteFrame, TextAsset, Vec3, __private, assetManager, director, find, instantiate } from 'cc'\r\nimport SourceManage, { loopFiles } from '../base/SourceManage';\r\nimport BundleSplit from '../utils/BundleSplit';\r\nimport { PrefabPathDefine as HallPrefabPathDefine } from '../hall/sourceDefine/prefabDefine';\r\nimport { SoundPathDefine } from '../hall/sourceDefine/soundDefine';\r\nimport { SoundPathDefine as CommonSoundPathDefine } from '../common/sourceDefine/soundDefine';\r\nimport hallFileMap from './sourceDefine';\r\nimport commonFileMap from '../common/sourceDefine';\r\nimport LoaderPanelViewModel from '../common/viewModel/LoaderPanelViewModel';\r\nimport BaseBoardViewModel from './viewModel/BaseBoardViewModel';\r\nimport { AudioMgr } from '../utils/AudioMgr';\r\nimport { AnyAction } from 'redux';\r\nimport Fetcher from '../utils/Fetcher';\r\nimport { ApiUrl } from './apiUrl';\r\nimport { config } from './config';\r\nimport Internationalization from '../language/Internationalization';\r\nimport languagePkg, { LanguageItemType } from '../language/languagePkg';\r\nimport { GameConfig } from '../config/GameConfig';\r\nimport { BuyType } from './components/Hall_ShopPanel';\r\nimport ModalBox from '../common/ModalBox';\r\nimport GiftUserViewModel, { GameType, UserInfo } from '../common/viewModel/GiftUserViewModel';\r\nimport { getPackageName } from '../common/bridge';\r\nimport { SKT_MAG_TYPE, sktInstance } from './socketConnect';\r\nimport { DEV } from 'cc/env';\r\nimport { TaskSchedulerDefault } from '../utils/TaskScheduler';\r\n\r\nlet sourceManageMap: Array<SourceManage> = []\r\nlet rootNodeWrap: Node\r\nexport let baseBoardView: BaseBoardViewModel\r\nexport const sourceManageSeletor = (bundleName: string = 'hall') => sourceManageMap.find(i => i.bundle.name === bundleName)\r\nexport let bundleCommon: AssetManager.Bundle = null\r\nexport let bundleHall: AssetManager.Bundle = null\r\nexport let hallAudio: AudioMgr<SoundPathDefine>\r\nexport let commonAudio: AudioMgr<CommonSoundPathDefine>\r\nexport let fetcher: Fetcher<ApiUrl>\r\n\r\nexport const lang = new Internationalization(languagePkg)\r\n\r\nexport const startUp = (rootNode: Node) => {\r\n  rootNodeWrap = rootNode\r\n  hallStore.configureStore()\r\n  BundleSplit.init()\r\n  lang.use(GameConfig.isDev ? LanguageItemType.ZH : LanguageItemType.IDA)\r\n  // BuryPoint.Instance().init()\r\n  fetcher = new Fetcher<ApiUrl>(config.httpBaseUrl)\r\n  // const LOADER_PANEL = \"prefabs/loaderPanel\"\r\n  assetManager.loadBundle(\"common\", (err, commonBundle) => {\r\n    bundleCommon = commonBundle\r\n    assetManager.loadBundle(\"hall\", (err, hallBundle) => {\r\n      bundleHall = hallBundle\r\n      // 首先贴入加载框面板\r\n      hallBundle.load(HallPrefabPathDefine.LOADER_PANEL, Prefab, (err, prefab) => {\r\n        // const loaderPanel = instantiate(prefab)\r\n        // rootNode.addChild(loaderPanel)\r\n        // const loaderviweModel = loaderPanel.getComponent(\"Common_LoaderPanel\") as Common_LoaderPanel\r\n        const loaderviweModel = new LoaderPanelViewModel().mountView(prefab).appendTo(rootNode).setProps({\r\n          loadBarType: 2\r\n        }).setEvent({\r\n          onLoadDone: (_sourceManageMap) => {\r\n            sourceManageMap = _sourceManageMap\r\n            hallAudio = new AudioMgr<SoundPathDefine>(sourceManageSeletor(\"hall\"))\r\n            commonAudio = new AudioMgr<CommonSoundPathDefine>(sourceManageSeletor(\"common\"))\r\n            loaderviweModel.unMount().then(() => {\r\n              baseBoardView = new BaseBoardViewModel().mountView(sourceManageSeletor(\"hall\").getSourceFile(HallPrefabPathDefine.BASE_BOARD)).appendTo(rootNode)\r\n              baseBoardView.connect()\r\n              // playBgMusic(baseBoardView)\r\n              getPackageName() !== 'web' && hallAudio.play(SoundPathDefine.MAIN_BGM, true)\r\n            })\r\n          }\r\n        }).setProps({\r\n          versionStr: GameConfig.appLocalVersion\r\n        })\r\n        //开始加载大厅和通用的资源\r\n        loaderviweModel.comp.startLoad([hallBundle, commonBundle], [...hallFileMap, ...commonFileMap])\r\n      })\r\n    })\r\n  })\r\n}\r\n\r\nconst playBgMusic = (baseBoardView) => {\r\n  if (getPackageName() === 'web') {\r\n    const fn = () => {\r\n      // let element = document.documentElement\r\n      // if (element.requestFullscreen) {\r\n      //   element.requestFullscreen()\r\n      // } else if (element['msRequestFullscreen']) { \r\n      //   element['msRequestFullscreen']()\r\n      // } else if (element['mozRequestFullScreen']) {\r\n      //   element['mozRequestFullScreen']()\r\n      // } else if (element['webkitRequestFullscreen']) {\r\n      //   element['webkitRequestFullscreen']()\r\n      // }\r\n      hallAudio.play(SoundPathDefine.MAIN_BGM, true)\r\n      document.getElementById('GameDiv').removeEventListener('click', fn)\r\n      document.getElementById('GameDiv').removeEventListener('touchstart', fn)\r\n    }\r\n    document.getElementById('GameDiv').addEventListener('click', fn)\r\n    document.getElementById('GameDiv').addEventListener(\"touchstart\", fn)\r\n  } else {\r\n    hallAudio.play(SoundPathDefine.MAIN_BGM, true)\r\n  }\r\n}\r\n/**大厅暴露出来的通用方法 */\r\nexport const global = {\r\n  /**使用大厅的store */\r\n  hallDispatch: (action: AnyAction) => { getStore().dispatch(action) },\r\n  /**\r\n   * 关闭子游戏\r\n   * @param isPre 是否在初始化完成之前退出，一般指在加载的时候退出\r\n   * @param confirmContent 如果值非空的话，则会弹出确认框\r\n   * @param confirmDoneAfterFn 点击确认后，在实施关闭游戏之后要做的事情\r\n   * @param confirmDoneBeforeFn 点击确认后，在实施关闭游戏之前要做的事情\r\n   */\r\n  closeSubGame: (option?: {\r\n    isPre?: boolean,\r\n    confirmContent?: string,\r\n    confirmDoneAfterFn?: Function\r\n    confirmDoneBeforeFn?: Function\r\n  }) => {\r\n    const _option = Object.assign({ isPre: false, confirmContent: \"\", confirmDoneAfterFn: () => { }, confirmDoneBeforeFn: () => { } }, option || {})\r\n    // (find(\"Canvas/baseBoard\").getComponent('Hall_Baseboard') as Hall_Baseboard).closeSubGame()\r\n    //避免重复弹窗\r\n    if (_option.confirmContent) {\r\n      if (!ModalBox.Instance().isShow && _option.confirmContent !== ModalBox.Instance().contentStr) {\r\n        ModalBox.Instance().show({ content: _option.confirmContent, type: \"Prompt\" }, () => {\r\n          _option.confirmDoneBeforeFn()\r\n          baseBoardView.comp && baseBoardView.comp.closeSubGame(_option.isPre)\r\n          _option.confirmDoneAfterFn()\r\n          return true\r\n        })\r\n      }\r\n    } else {\r\n      baseBoardView.comp && baseBoardView.comp.closeSubGame(_option.isPre)\r\n    }\r\n    TaskSchedulerDefault().stopQueue(false)\r\n    sktInstance.sendSktMessage(SKT_MAG_TYPE.MEMBER_INFO, {}, { isLoading: false })\r\n  },\r\n  /**打开商城 */\r\n  openShop: (buyType?: BuyType) => {\r\n    baseBoardView && baseBoardView.mainPanelViewModel.openShop(buyType)\r\n  },\r\n  /**打开个人中心 */\r\n  openPersonCenter: (index?: number) => {\r\n    baseBoardView && baseBoardView.mainPanelViewModel.openPc(index)\r\n  },\r\n  /**打开vip主界面 */\r\n  openVipMain: () => {\r\n    baseBoardView && baseBoardView.mainPanelViewModel.openVipMain();\r\n  },\r\n  openSign: () => {\r\n    baseBoardView && baseBoardView.mainPanelViewModel.openSign();\r\n  },\r\n\r\n  /**加载头像 */\r\n  loadHeadSprite: (icon: number, sprite: Sprite) => {\r\n    bundleCommon && bundleCommon.load(`resource/head/head_circle_${icon}/spriteFrame`, SpriteFrame, (err, sp) => {\r\n      if (!err) {\r\n        sprite.spriteFrame = sp;\r\n      }\r\n    })\r\n  },\r\n  /**更新子游戏的进度信息 */\r\n  setSubGameGate: (gameId: number, progress: number) => {\r\n    baseBoardView && baseBoardView.mainPanelViewModel.comp.setSubGameGate(gameId, progress)\r\n  },\r\n  /**是否允许打开子游戏,一半用于子游戏的第一个首预制体已经加载完毕 */\r\n  isAllowOpenSubGame: (gameId: number) => {\r\n    if (baseBoardView) {\r\n      return baseBoardView.isAllowOpenSubGame(gameId)\r\n    }\r\n    return true\r\n  },\r\n  // 打开\r\n  showGiftWindow: (gameType: GameType, userInfo: UserInfo | null, callback) => {\r\n    if (rootNodeWrap && rootNodeWrap.isValid) {\r\n      GiftUserViewModel.show(rootNodeWrap, gameType, userInfo, callback);\r\n    }\r\n  },\r\n  flyGift: (fromMemberId: string, toMemberId: string, startPos: Vec3, endPos: Vec3, value: number, parentNode: Node) => {\r\n    if (!parentNode) {\r\n      parentNode = rootNodeWrap;\r\n    }\r\n    if (parentNode && parentNode.isValid) {\r\n      GiftUserViewModel.flyGift(parentNode, fromMemberId, toMemberId, startPos, endPos, value);\r\n    }\r\n  }\r\n}\r\n"]}