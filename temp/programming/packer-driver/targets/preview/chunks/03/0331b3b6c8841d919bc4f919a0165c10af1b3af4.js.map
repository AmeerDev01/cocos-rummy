{"version":3,"sources":["file:///Users/geliang/web/dibai/hall/assets/script/subGame/phoenix/Slot/Command/RollerCommand.ts"],"names":["RollerCommand","RollerMediatorConst","RollerType","BaseCommand","SKT_MAG_TYPE","sktMsgListener","SubGameType","getSlotProxy","getSocketProxy","RollerCommandConst","listExecute","type","INIT_ROLLER_PANEL","handler","notification","gameType","freeGameCount","getBody","_gameRunner","getTransferGameInfo","initRoller","add","LAUNCH","data","rollerType","MAIN","NORMAL","LARGE","stopIndexArr","dockIocn","getDockIcon","sendNotification","BEGIN_ROLL","stopIndex","targetList","map","item","coord","item2","END_ROLL","UNINSTALL_ROLLER_PANEL","remove","execute"],"mappings":"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","sourcesContent":["import { INotification } from \"../../Framework/interfaces/INotification\"\r\nimport { RollerMediatorConst } from \"../Mediator/RollerMediator\";\r\nimport { RollerType } from \"../Proxy/SlotProxy\";\r\nimport { BaseCommand, IListExecute } from './BaseCommand'\r\nimport { SKT_MAG_TYPE, sktMsgListener, SubGameType } from \"../Proxy/SocketProxy\";\r\nimport { BgMediatorConst } from \"../Mediator/BgMediator\";\r\nimport { getSlotProxy, getSocketProxy } from \"../phoenix_utils\";\r\n\r\nexport enum RollerCommandConst {\r\n    BEGIN_ROLL = \"beginRoll\",\r\n    END_ROLL = \"endRoll\"\r\n}\r\n\r\nexport class RollerCommand extends BaseCommand {\r\n    protected listExecute: Array<IListExecute<RollerCommand>> = [\r\n        {\r\n            type: RollerMediatorConst.INIT_ROLLER_PANEL,\r\n            handler(notification: INotification) {\r\n                const { gameType, freeGameCount } = notification.getBody() || {}\r\n                //在初始化界面之前要初始化数据 'iconRollerQueue' | 'largeIconRollerQueue'\r\n                const _gameRunner: SubGameType = gameType || getSocketProxy().getTransferGameInfo().gameType()\r\n                // const rollerType = _gameRunner === SubGameType.MAIN ? RollerType.NORMAL : RollerType.LARGE;\r\n                getSlotProxy().initRoller()\r\n\r\n                // if (gameType === 1 && freeGameCount === 0) {\r\n                //     // this.sendNotification(RollerMediatorConst.THESLOTISHIDDEN, { subGameType: SubGameType.MAIN, state: true })\r\n                //     this.sendNotification(BgMediatorConst.PHOENIX_SGCHOOSE)\r\n                // } else {\r\n                //     this.sendNotification(BgMediatorConst.CHANGE_BG, { gameType: _gameRunner })\r\n                // }\r\n                // 接收下注的结果\r\n                sktMsgListener.add(SKT_MAG_TYPE.LAUNCH, 'roller', (data) => {\r\n                    // const gt = (this.facade.retrieveProxy(ProxyDefine.WEBSOCKET) as SocketProxy).getTransferGameInfo().gameType();\r\n                    // if (gt === SubGameType.SUB_GAME1) return\r\n                    const rollerType = _gameRunner === SubGameType.MAIN ? RollerType.NORMAL : RollerType.LARGE;\r\n                    const stopIndexArr = getSocketProxy().getTransferGameInfo().stopIndexArr()\r\n                    const dockIocn = getSocketProxy().getTransferGameInfo().getDockIcon()\r\n                    this.sendNotification(RollerMediatorConst.BEGIN_ROLL, {\r\n                        //stopIndex: [42, 8, 29, 1, 1],\r\n                        // targetList:[\r\n                        //     [\r\n                        //         [0],\r\n                        //         [2],\r\n                        //         [2],\r\n                        //         [2],\r\n                        //         [0]\r\n                        //     ],\r\n                        //     [\r\n                        //         [1],\r\n                        //         [0],\r\n                        //         [0],\r\n                        //         [0],\r\n                        //         [1]\r\n                        //     ],\r\n                        //     [\r\n                        //         [0],\r\n                        //         [2],\r\n                        //         [2],\r\n                        //         [2],\r\n                        //         [0]\r\n                        //     ],\r\n                        // ],\r\n                        stopIndex: stopIndexArr,\r\n                        targetList: getSocketProxy().getTransferGameInfo().targetList().map(item => item.coord.map(item2 => item2[1])),\r\n                        dockIocn\r\n                    })\r\n                }, 2)\r\n                return notification.getBody();\r\n            }\r\n        },\r\n        {\r\n            type: RollerMediatorConst.BEGIN_ROLL,\r\n            handler(notification: INotification) {\r\n                return notification.getBody()\r\n            }\r\n        },\r\n        {\r\n            type: RollerMediatorConst.END_ROLL,\r\n            handler(notification: INotification) {\r\n                return notification.getBody()\r\n            }\r\n        },\r\n        {\r\n            type: RollerMediatorConst.UNINSTALL_ROLLER_PANEL,\r\n            handler(notification: INotification) {\r\n                sktMsgListener.remove(SKT_MAG_TYPE.LAUNCH, 'roller')\r\n                return true\r\n            }\r\n        }\r\n    ]\r\n\r\n    public execute(notification: INotification): void {\r\n        super.execute(notification)\r\n    }\r\n}\r\n"]}