{"version":3,"sources":["file:///Users/geliang/web/dibai/hall/assets/script/hall/components/Hall_VipMain.ts"],"names":["Button","Label","Node","ProgressBar","ScrollView","Sprite","SpriteFrame","Toggle","UITransform","Vec3","_decorator","instantiate","tween","BaseComponent","vipMap","getNodeByNameDeep","global","sourceManageSeletor","SpriteFramePathDefine","ccclass","property","Hall_VipMain","locateInitPosition","propertyNode","props_btn_vip_close","props_diamond_icon","props_me_vip_level_label","props_btn_topup","props_remind_next_level_gold","props_remind_vip","props_pro_levelbar","props_node_locate","props_togglegroup_vip","props_vip_toggle_item","props_remindtext_next_label_gold","props_remindtext_vip","props_ScrollView_vip","props_btn_aktifkan","props","memberInfo","events","close","start","initState","bindEvent","node","on","EventType","TOUCH_END","openShop","bindUI","position","x","y","useProps","key","value","initVipToggle","updateDiamondIcon","vipLevel","updateRemindInfo","updateLevelBar","updateBarLevelLabel","maxVipLevel","length","userVipLevel","removeAllChildren","forEach","v","vipToggleItem","getComponent","string","addChild","isChecked","updateRemindtextInfo","scrollToRight","userTotalRechange","getUserTotalRechange","vipLevelExperience","percent","find","barValue","locateNode","bar","getChildByName","formatAmountWithCommas","to","progress","onUpdate","barWidth","barSprite","width","setPosition","levels","children","filter","name","startsWith","i","iconFile","_DIAMOND_ICON_5","_DIAMOND_ICON_4","_DIAMOND_ICON_3","_DIAMOND_ICON_2","_DIAMOND_ICON_1","spriteFrame","getFileAsync","source","nextLevel","vipInfo","experience","getTotalRechange","sum","update","deltaTime"],"mappings":"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","sourcesContent":["import { Button, Label, Node, ProgressBar, ScrollView, Sprite, SpriteFrame, Toggle, UITransform, Vec3, _decorator, instantiate, log, sp, tween } from 'cc';\r\nimport { BaseComponent } from '../../base/BaseComponent';\r\nimport { config, vipMap } from '../config';\r\nimport { getNodeByNameDeep } from '../../utils/tool';\r\nimport { global, sourceManageSeletor } from '../index';\r\nimport { SpriteFramePathDefine } from '../sourceDefine/spriteDefine';\r\nimport { InitStateType } from '../store/actions/memberInfo';\r\nconst { ccclass, property } = _decorator;\r\n\r\nexport interface IState {\r\n}\r\n\r\nexport interface IProps {\r\n\tmemberInfo: InitStateType\r\n}\r\nexport interface IEvent {\r\n\tclose: () => void\r\n}\r\n\r\n@ccclass('Hall_VipMain')\r\nexport class Hall_VipMain extends BaseComponent<IState, IProps, IEvent> {\r\n\tstart() {\r\n\r\n\t}\r\n\r\n\tprivate locateInitPosition: Vec3;\r\n\tprotected propertyNode = {\r\n\t\tprops_btn_vip_close: new Button(),\r\n\t\tprops_diamond_icon: new Node(),\r\n\t\tprops_me_vip_level_label: new Node(),\r\n\t\tprops_btn_topup: new Button(),\r\n\t\tprops_remind_next_level_gold: new Node(),\r\n\t\tprops_remind_vip: new Node(),\r\n\t\tprops_pro_levelbar: new Node(),\r\n\t\tprops_node_locate: new Node(),\r\n\t\tprops_togglegroup_vip: new Node(),\r\n\t\tprops_vip_toggle_item: new Node(),\r\n\t\tprops_remindtext_next_label_gold: new Node(),\r\n\t\tprops_remindtext_vip: new Node(),\r\n\t\tprops_ScrollView_vip: new Node(),\r\n\t\tprops_btn_aktifkan: new Button(),\r\n\t}\r\n\r\n\tpublic props: IProps = {\r\n\t\tmemberInfo: null,\r\n\t}\r\n\r\n\tpublic events: IEvent = {\r\n\t\tclose: () => { }\r\n\t}\r\n\r\n\tprotected initState() {\r\n\t\treturn {\r\n\r\n\t\t}\r\n\t}\r\n\r\n\tprotected bindEvent(): void {\r\n\t\tthis.propertyNode.props_btn_vip_close.node.on(Node.EventType.TOUCH_END, () => {\r\n\t\t\tthis.events.close();\r\n\t\t});\r\n\t\tthis.propertyNode.props_btn_topup.node.on(Node.EventType.TOUCH_END, () => {\r\n\t\t\tglobal.openShop();\r\n\t\t\t// test代码\r\n\t\t\t// const info = instantiate(this.props);\r\n\t\t\t// info.memberInfo.vipLevel = 4;\r\n\t\t\t// info.memberInfo.vipLevelExperience = 1000;\r\n\t\t\t// this.setProps(info);\r\n\t\t});\r\n\t\tthis.propertyNode.props_btn_aktifkan.node.on(Node.EventType.TOUCH_END, () => {\r\n\t\t\tglobal.openShop();\r\n\t\t});\r\n\t}\r\n\r\n\tprotected bindUI(): void {\r\n\t\tthis.locateInitPosition = new Vec3(this.propertyNode.props_node_locate.position.x, this.propertyNode.props_node_locate.position.y);\r\n\t}\r\n\r\n\tprotected useProps(key: keyof IProps, value: { pre: any; cur: any; }): void {\r\n\t\tif (key === 'memberInfo') {\r\n\t\t\t// test代码\r\n\t\t\t// this.props.memberInfo.vipLevelExperience = 2500000;\r\n\t\t\t// this.props.memberInfo.vipLevel = 13;\r\n\r\n\t\t\tthis.initVipToggle();\r\n\t\t\tthis.updateDiamondIcon(this.props.memberInfo.vipLevel);\r\n\t\t\tthis.updateRemindInfo();\r\n\t\t\tthis.updateLevelBar();\r\n\t\t\tthis.updateBarLevelLabel(this.props.memberInfo.vipLevel);\r\n\t\t}\r\n\t}\r\n\r\n\tprivate initVipToggle() {\r\n\t\tconst maxVipLevel = vipMap.length;\r\n\t\tlet userVipLevel = this.props.memberInfo.vipLevel;\r\n\t\tif (this.props.memberInfo.vipLevel >= maxVipLevel) {\r\n\t\t\tuserVipLevel = 0;\r\n\t\t}\r\n\r\n\t\tthis.propertyNode.props_togglegroup_vip.removeAllChildren();\r\n\t\tvipMap.forEach(v => {\r\n\t\t\tconst vipLevel = v[0];\r\n\t\t\tconst vipToggleItem = instantiate(this.propertyNode.props_vip_toggle_item);\r\n\t\t\tgetNodeByNameDeep(\"label_vip_unchecked\", vipToggleItem).getComponent(Label).string = \"VIP\" + vipLevel;\r\n\t\t\tgetNodeByNameDeep(\"label_vip_checked\", vipToggleItem).getComponent(Label).string = \"VIP\" + vipLevel;\r\n\t\t\tthis.propertyNode.props_togglegroup_vip.addChild(vipToggleItem);\r\n\t\t\tconst isChecked = vipLevel === userVipLevel + 1;\r\n\t\t\t// 默认显示为下一个等级\r\n\t\t\tvipToggleItem.getComponent(Toggle).isChecked = isChecked;\r\n\r\n\t\t\t// isChecked && this.updateRemindtextInfo(v);\r\n\t\t\tif (isChecked) {\r\n\t\t\t\tthis.updateRemindtextInfo(v);\r\n\t\t\t\tif (userVipLevel > 10) {\r\n\t\t\t\t\tthis.propertyNode.props_ScrollView_vip.getComponent(ScrollView).scrollToRight();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tvipToggleItem.on(Node.EventType.TOUCH_END, () => {\r\n\t\t\t\tthis.updateRemindtextInfo(v);\r\n\t\t\t});\r\n\t\t})\r\n\t}\r\n\r\n\t/**更新等级进度条 */\r\n\tprivate updateLevelBar() {\r\n\t\tconst maxVipLevel = vipMap.length;\r\n\t\tconst userTotalRechange = this.getUserTotalRechange();\r\n\t\tconst vipLevel = this.props.memberInfo.vipLevel;\r\n\r\n\t\tconst vipLevelExperience = this.props.memberInfo.vipLevelExperience\r\n\r\n\t\t// 当前经验值 / 下一个等级需要的经验值 得到当前等级到下一个等级的一个百分比\r\n\t\t// const percent = vipLevel < maxVipLevel ? this.props.memberInfo.vipLevelExperience / vipMap.find(v => v[0] === vipLevel + 1)[1] / 10 : 0;\r\n\t\t// const barValue = vipLevel / maxVipLevel + percent;\r\n\t\tconst percent = vipLevel < maxVipLevel ? vipLevelExperience / vipMap.find(v => v[0] === vipLevel + 1)[1] * 0.5 : 0;\r\n\t\tconst barValue = vipLevel < maxVipLevel ? (vipLevel === 0 ? 0 : 0.5) + percent : 1;\r\n\r\n\t\tconst locateNode = this.propertyNode.props_node_locate;\r\n\t\tconst locateInitPosition = this.locateInitPosition;\r\n\t\tconst bar = this.propertyNode.props_pro_levelbar.getComponent(ProgressBar);\r\n\t\tlocateNode.getChildByName(\"label_suffer\").getComponent(Label).string = userTotalRechange.formatAmountWithCommas();\r\n\r\n\t\ttween(bar).to(0.5, { progress: barValue > 1 ? 1 : barValue }, {\r\n\t\t\tonUpdate: () => {\r\n\t\t\t\tconst barWidth = bar.barSprite.getComponent(UITransform).width;\r\n\t\t\t\tlocateNode.setPosition(new Vec3(locateInitPosition.x + barWidth,\r\n\t\t\t\t\tlocateInitPosition.y));\r\n\t\t\t}\r\n\t\t}).start();\r\n\t}\r\n\r\n\tprivate updateBarLevelLabel(vipLevel: number) {\r\n\t\tlet levels = [];\r\n\t\tif (vipLevel === 0) {\r\n\t\t\tlevels = [0, 1, 2]\r\n\t\t} else if (vipLevel >= vipMap.length) {\r\n\t\t\tlevels = [vipLevel - 2, vipLevel - 1, vipLevel]\r\n\t\t} else {\r\n\t\t\tlevels = [vipLevel - 1, vipLevel, vipLevel + 1]\r\n\t\t}\r\n\r\n\t\tthis.propertyNode.props_pro_levelbar.children.filter(v => v.name.startsWith(\"spr_level_\")).forEach((v, i) => {\r\n\t\t\tv.getChildByName(\"Label_level_vip\").getComponent(Label).string = levels[i] + \"\";\r\n\t\t})\r\n\t}\r\n\r\n\t/**更新钻石图标 */\r\n\tprivate async updateDiamondIcon(vipLevel: number) {\r\n\t\tlet iconFile = \"\";\r\n\t\tif (vipLevel >= 12) {\r\n\t\t\ticonFile = SpriteFramePathDefine._DIAMOND_ICON_5;\r\n\t\t} else if (vipLevel >= 9) {\r\n\t\t\ticonFile = SpriteFramePathDefine._DIAMOND_ICON_4;\r\n\t\t} else if (vipLevel >= 6) {\r\n\t\t\ticonFile = SpriteFramePathDefine._DIAMOND_ICON_3;\r\n\t\t} else if (vipLevel >= 3) {\r\n\t\t\ticonFile = SpriteFramePathDefine._DIAMOND_ICON_2;\r\n\t\t} else {\r\n\t\t\ticonFile = SpriteFramePathDefine._DIAMOND_ICON_1;\r\n\t\t}\r\n\r\n\t\tthis.propertyNode.props_diamond_icon.getComponent(Sprite).spriteFrame = (await sourceManageSeletor().getFileAsync(iconFile, SpriteFrame)).source;\r\n\t\tthis.propertyNode.props_me_vip_level_label.getComponent(Label).string = vipLevel + \"\";\r\n\t}\r\n\r\n\t/**更新top的等级文字描述 */\r\n\tprivate updateRemindInfo() {\r\n\t\tconst maxVipLevel = vipMap.length;\r\n\t\tlet nextLevel = this.props.memberInfo.vipLevel + 1;\r\n\t\tif (nextLevel >= maxVipLevel) {\r\n\t\t\tthis.propertyNode.props_remind_next_level_gold.getComponent(Label).string = '0';\r\n\t\t\tthis.propertyNode.props_remind_vip.getComponent(Label).string = \"VIP\" + maxVipLevel;\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tconst vipInfo = vipMap.find(v => v[0] === nextLevel);\r\n\t\tconst experience = vipInfo[1] - this.props.memberInfo.vipLevelExperience;\r\n\t\tthis.propertyNode.props_remind_next_level_gold.getComponent(Label).string = experience.formatAmountWithCommas();\r\n\t\tthis.propertyNode.props_remind_vip.getComponent(Label).string = \"VIP\" + nextLevel;\r\n\t}\r\n\r\n\t/**更新bottom的等级文字描述 */\r\n\tprivate updateRemindtextInfo(vipInfo: number[]) {\r\n\t\tconst vipLevel = vipInfo[0];\r\n\r\n\t\tif (vipLevel <= this.props.memberInfo.vipLevel) {\r\n\t\t\tthis.propertyNode.props_remindtext_next_label_gold.getComponent(Label).string = \"0\";\r\n\t\t} else {\r\n\t\t\tthis.propertyNode.props_remindtext_next_label_gold.getComponent(Label).string =\r\n\t\t\t\t(this.getTotalRechange(vipLevel) - this.getUserTotalRechange()).formatAmountWithCommas();\r\n\t\t}\r\n\t\tthis.propertyNode.props_remindtext_vip.getComponent(Label).string = \"VIP\" + vipLevel;\r\n\t}\r\n\r\n\t/**获得用户累计充值 */\r\n\tprivate getUserTotalRechange() {\r\n\t\treturn this.getTotalRechange(this.props.memberInfo.vipLevel) + this.props.memberInfo.vipLevelExperience;\r\n\t}\r\n\r\n\t/**获得充值到vip10时需要总的充值金币 */\r\n\tprivate getTotalRechange(vipLevel: number = 99) {\r\n\t\tlet sum = 0;\r\n\t\tvipMap.filter(v => v[0] <= vipLevel).forEach(v => sum += v[1]);\r\n\t\treturn sum;\r\n\t}\r\n\r\n\tupdate(deltaTime: number) {\r\n\r\n\t}\r\n}\r\n\r\n"]}