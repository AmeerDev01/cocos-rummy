{"version":3,"sources":["file:///Users/geliang/web/dibai/hall/assets/script/hall/components/demo/Counter.ts"],"names":["_decorator","color","Label","Node","BaseComponent","ccclass","property","Counter","constructor","propertyNode","props_value","props_leftBtu","props_rightBtu","props_factor","props","size","events","onChange","e","initState","count","factor","useProps","key","value","getComponent","fromHEX","fontSize","bindEvent","on","EventType","TOUCH_START","setState","state","bindUI","useState","pre","cur","string","start","update","deltaTime"],"mappings":"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","sourcesContent":["import { _decorator, Color, color, Component, Label, Node } from 'cc';\r\nimport { createStore, legacy_createStore } from 'redux'\r\nimport { BaseComponent } from '../../../base/BaseComponent';\r\nconst { ccclass, property } = _decorator;\r\n\r\n\r\n\r\nexport interface IState {\r\n\tcount: number,\r\n\tfactor: number\r\n}\r\n\r\nexport interface IProps {\r\n\tcolor: string,\r\n\tsize: number\r\n}\r\n\r\nexport interface IEvent {\r\n\tonChange?: (e: any) => void\r\n}\r\n@ccclass('Counter')\r\nexport class Counter extends BaseComponent<IState, IProps, IEvent> {\r\n\tconstructor() {\r\n\t\tsuper()\r\n\t}\r\n\tprotected propertyNode: { [key: string]: Node } = {\r\n\t\t/**运算显示值 */\r\n\t\tprops_value: null,\r\n\t\t/**左边按钮 */\r\n\t\tprops_leftBtu: null,\r\n\t\t/**右边按钮 */\r\n\t\tprops_rightBtu: null,\r\n\t\t/**因子显示 */\r\n\t\tprops_factor: null\r\n\t}\r\n\r\n\tpublic props: IProps = {\r\n\t\tcolor: \"#cccccc\",\r\n\t\tsize: 12\r\n\t}\r\n\r\n\tpublic events: IEvent = {\r\n\t\tonChange: (e) => { }\r\n\t}\r\n\tprotected initState() {\r\n\t\treturn {\r\n\t\t\tcount: 0,\r\n\t\t\tfactor: 1\r\n\t\t}\r\n\t}\r\n\tprotected useProps(key: keyof IProps, value: { pre: Partial<IState>, cur: Partial<IState> }) {\r\n\t\t/**传入的props变更触发的函数 */\r\n\t\t// console.log(key, \"change\", value.cur)\r\n\t\tif (key === \"color\") {\r\n\t\t\tthis.propertyNode.props_factor.getComponent(Label).color = color().fromHEX(this.props.color)\r\n\t\t}\r\n\t\tif (key === \"size\") {\r\n\t\t\tthis.propertyNode.props_factor.getComponent(Label).fontSize = this.props.size\r\n\t\t}\r\n\t}\r\n\tprotected bindEvent() {\r\n\t\tthis.propertyNode.props_leftBtu.on(Node.EventType.TOUCH_START, () => {\r\n\t\t\tthis.setState({\r\n\t\t\t\tcount: this.state.count - this.state.factor\r\n\t\t\t})\r\n\t\t})\r\n\t\tthis.propertyNode.props_rightBtu.on(Node.EventType.TOUCH_START, () => {\r\n\t\t\tthis.setState({\r\n\t\t\t\tcount: this.state.count + this.state.factor\r\n\t\t\t})\r\n\t\t})\r\n\r\n\t\tthis.propertyNode.props_factor.on(Node.EventType.TOUCH_START, () => {\r\n\t\t\tthis.setState({\r\n\t\t\t\tfactor: this.state.factor + 1\r\n\t\t\t})\r\n\t\t})\r\n\t}\r\n\tprotected bindUI() {\r\n\t\tthis.useState((key, { pre, cur }) => {\r\n\t\t\tthis.propertyNode.props_value.getComponent(Label).string = cur\r\n\t\t\tthis.events.onChange(cur)\r\n\t\t}, [\"count\"])\r\n\r\n\t\tthis.useState((key, { pre, cur }) => {\r\n\t\t\tthis.propertyNode.props_factor.getComponent(Label).string = `因子：${cur}`\r\n\t\t}, [\"factor\"])\r\n\t}\r\n\tstart() { }\r\n\tupdate(deltaTime: number) { }\r\n}\r\n\r\n"]}