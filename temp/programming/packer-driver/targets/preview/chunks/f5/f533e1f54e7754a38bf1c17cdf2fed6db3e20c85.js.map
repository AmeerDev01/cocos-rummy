{"version":3,"sources":["file:///Users/geliang/web/dibai/hall/assets/script/common/fish/utils/SkillRegisterFunc.ts"],"names":["SkillRegisterFunc","Label","Node","Vec3","Shake","SkillItemBossComing","SkillItemLine","SkillItemRotationScore","createFont","createParticleSystemNode","toNodeSpaceAR","constructor","skillPlayer","backgroundSceneManager","sourceManage","batteryManager","prefabName","rootNode","funs","func","fullScreenVibration","bind","ids","lineFish","bigFishBoom","rotationScore","bossComming","changeBGM","resumeCurrentBGM","addShowWord","init","uninit","obj","id","skillConfig","getConfigs","skConfig","commonConfig","comConfig","bkObj","getCurrentBkSenceObj","create","shake","uiRoot","t","dx","loop","start","exeObj","skid","textureConfig","tConfig","pt","getParent","spos","getCurrentPos","rlines","getLineRelObjLst","sid","src_id","i","length","epos","info","pos1","pos2","parent","addCurrentLineObj","console","log","getObjectId","x","y","getFishConfigId","buf","getChildByName","key","fl","getFishLevel","getComponent","string","label","addComponent","addChild","font","fnt_src","name","pos","setPosition","ski","k","src_id_lst","v","srcItem","stype","pobj","setSiblingIndex","children","config","getParentObj","forceChangeBkMus","bgm_id","setUseChangeBgm","resumeBkMus","userInfo","getUserInfo","batObj","getBatteryByPlayerId","player_id","getBatteryPos","beishu","getBeishu","score","getScoreVal","spr_name","skItem","getSide","getUseSkew","setScale"],"mappings":"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","sourcesContent":["/**\r\n  技能注册\r\n */\r\nimport { Label, Node, Vec3 } from \"cc\";\r\nimport { BackgroundSceneManager } from \"../BackgroundSceneManager\";\r\nimport { SkillPlayer } from \"../SkillPlayer\"\r\nimport { Shake } from \"../../../utils/Shake\";\r\nimport { SkillItemBossComing } from \"./skills/SkillItemBossComing\";\r\nimport { SkillItemLine } from \"./skills/SkillItemLine\";\r\nimport { SkillItemRotationScore } from \"./skills/SkillItemRotationScore\";\r\nimport { createFont, createParticleSystemNode, toNodeSpaceAR } from \"../FishTool\";\r\nimport { BatteryManager } from \"../BatteryManager\";\r\nimport { Fish } from \"../Fish\";\r\nimport SourceManage from \"../../../base/SourceManage\";\r\n\r\n//full screen shake\r\n\r\nexport class SkillRegisterFunc {\r\n  private skillPlayer: SkillPlayer;\r\n  private backgroundSceneManager: BackgroundSceneManager;\r\n  private sourceManage: SourceManage;\r\n  private batteryManager: BatteryManager;\r\n  private prefabName: string;\r\n  private rootNode: Node;\r\n\r\n  constructor(skillPlayer: SkillPlayer, backgroundSceneManager: BackgroundSceneManager, sourceManage: SourceManage,\r\n    batteryManager: BatteryManager, prefabName: string) {\r\n    this.skillPlayer = skillPlayer;\r\n    this.backgroundSceneManager = backgroundSceneManager;\r\n    this.sourceManage = sourceManage;\r\n    this.batteryManager = batteryManager;\r\n    this.prefabName = prefabName;\r\n  }\r\n\r\n  public init(rootNode: Node) {\r\n    this.rootNode = rootNode;\r\n  }\r\n\r\n  public uninit() {\r\n    this.skillPlayer = null;\r\n    this.backgroundSceneManager = null;\r\n    this.sourceManage = null;\r\n    this.batteryManager = null;\r\n  }\r\n\r\n  public fullScreenVibration(obj, id) {\r\n    let skillConfig = this.skillPlayer.getConfigs().skConfig\r\n    let commonConfig = this.skillPlayer.getConfigs().comConfig\r\n    let bkObj = this.backgroundSceneManager.getCurrentBkSenceObj()\r\n    if (bkObj && skillConfig[id]) {\r\n      Shake.create().shake(bkObj.uiRoot, skillConfig[id].t, skillConfig[id].dx, skillConfig[id].loop).start();\r\n    }\r\n  }\r\n  public lineFish(exeObj: Fish, skid) {\r\n    let skillConfig = this.skillPlayer.getConfigs().skConfig\r\n    let textureConfig = this.skillPlayer.getConfigs().tConfig\r\n    let pt = exeObj.getParent()\r\n    let spos = exeObj.getCurrentPos()\r\n    let rlines = exeObj.getLineRelObjLst()\r\n    let sid = skillConfig[skid].src_id\r\n\r\n    for (let i = 0; i < rlines.length; i++) {\r\n      let epos = rlines[i].getCurrentPos()\r\n      let info = { pos1: spos, pos2: epos, parent: pt, src_id: sid, }\r\n      exeObj.addCurrentLineObj(new SkillItemLine(this.sourceManage, info, textureConfig, this.rootNode))\r\n    }\r\n\r\n    console.log(\"execute line skill fshid =  \" + exeObj.getObjectId() + \",line lst (\" + spos.x + \" \" + spos.y + \")\" + \" cfg id = \" + exeObj.getFishConfigId())\r\n  }\r\n  public addShowWord(exeObj, skid) {\r\n    let skillConfig = this.skillPlayer.getConfigs().skConfig\r\n\r\n    let buf = exeObj.getChildByName(skillConfig[skid].key) as Node\r\n    let fl = exeObj.getFishLevel()\r\n    if (buf != null) {\r\n      buf.getComponent(Label).string = (`${fl}`)\r\n    } else {\r\n      buf = new Node()\r\n      const label = buf.addComponent(Label);\r\n      exeObj.addChild(buf)\r\n      label.string = fl;\r\n      // buf = cc.Label.createWithBMFont(skillConfig[skid].fnt_src, `${fl}`)\r\n      label.font = createFont(this.sourceManage, skillConfig[skid].fnt_src);\r\n      buf.name = skillConfig[skid].key\r\n      // buf.setWorldPosition(new Vec3(skillConfig[skid].pos.x, skillConfig[skid].pos.y))\r\n      const pos = skillConfig[skid].pos;\r\n      buf.setPosition(toNodeSpaceAR(this.rootNode, pos))\r\n    }\r\n  }\r\n\r\n  public bigFishBoom(exeObj, skid) {\r\n    let skillConfig = this.skillPlayer.getConfigs().skConfig\r\n    let textureConfig = this.skillPlayer.getConfigs().tConfig\r\n    let pos = exeObj.getCurrentPos()\r\n    let ski = skillConfig[skid]\r\n\r\n    for (const k in ski.src_id_lst) {\r\n      const v = ski.src_id_lst[k];\r\n      if (v == null) continue;\r\n      let srcItem = textureConfig[v]\r\n      if (srcItem.stype == 1) {\r\n\r\n      } else if (srcItem.stype == 2) {\r\n\r\n      } else if (srcItem.stype == 3) {\r\n        let pobj = createParticleSystemNode(this.sourceManage, exeObj.getParent(), srcItem)\r\n        pobj.setPosition(toNodeSpaceAR(this.rootNode, pos))\r\n        pobj.setSiblingIndex(pobj.parent.children.length);\r\n      }\r\n    }\r\n  }\r\n  public bossComming(obj, id) {\r\n    let skillConfig = this.skillPlayer.getConfigs().skConfig\r\n    let textureConfig = this.skillPlayer.getConfigs().tConfig\r\n    let config = skillConfig[id]\r\n    if (config) {\r\n      let obj = new SkillItemBossComing(this.skillPlayer, this.sourceManage, this.batteryManager.getParentObj(), config, textureConfig);\r\n      obj.uiRoot.setPosition(0, 0);\r\n    }\r\n  }\r\n  public changeBGM(obj, id) {\r\n    let skillConfig = this.skillPlayer.getConfigs().skConfig\r\n\r\n    let config = skillConfig[id]\r\n    if (config) {\r\n      this.backgroundSceneManager.forceChangeBkMus(config.bgm_id)\r\n      obj.setUseChangeBgm(true)\r\n    }\r\n  }\r\n  public resumeCurrentBGM(obj, id) {\r\n    this.backgroundSceneManager.resumeBkMus()\r\n  }\r\n\r\n\r\n  public rotationScore(obj, id) {\r\n    let skillConfig = this.skillPlayer.getConfigs().skConfig\r\n    let textureConfig = this.skillPlayer.getConfigs().tConfig\r\n    let config = skillConfig[id]\r\n    if (config) {\r\n      let userInfo = obj.getUserInfo()\r\n      let batObj = this.batteryManager.getBatteryByPlayerId(userInfo.player_id)\r\n      if (batObj) {\r\n        let pos = batObj.getBatteryPos()\r\n        let info = {\r\n          beishu: obj.getBeishu(),\r\n          score: obj.getScoreVal(),\r\n          spr_name: config.spr_name,\r\n          src_id: config.src_id,\r\n        }\r\n\r\n        let skItem = new SkillItemRotationScore(this.sourceManage, this.prefabName, this.batteryManager.getParentObj(), info, textureConfig)\r\n        if (batObj.getSide() == 3) {\r\n          skItem.uiRoot.setPosition(toNodeSpaceAR(this.rootNode, new Vec3(pos.x, pos.y - 200)))\r\n          // skItem.uiRoot.setWorldPosition(new Vec3(pos.x, pos.y - 200))\r\n        } else {\r\n          skItem.uiRoot.setPosition(toNodeSpaceAR(this.rootNode, new Vec3(pos.x, pos.y + 200)))\r\n          // skItem.uiRoot.setWorldPosition(new Vec3(pos.x, pos.y + 200))\r\n        }\r\n\r\n        skItem.uiRoot.setSiblingIndex(skItem.uiRoot.parent.children.length);\r\n        if (this.skillPlayer.getUseSkew() == true) {\r\n          skItem.uiRoot.setScale(new Vec3(-1, -1))\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  public funs = [\r\n    { func: this.fullScreenVibration.bind(this), ids: [1] },\r\n    { func: this.lineFish.bind(this), ids: [3, 4] },\r\n    { func: this.bigFishBoom.bind(this), ids: [5, 6, 7, 8, 9, 10, 11, 12, 13, 14] },\r\n    { func: this.rotationScore.bind(this), ids: [20, 21, 22, 23, 24, 25, 26, 27, 28, 29] },\r\n    { func: this.bossComming.bind(this), ids: [50, 51, 52] },\r\n    { func: this.changeBGM.bind(this), ids: [55] },\r\n    { func: this.resumeCurrentBGM.bind(this), ids: [56] },\r\n    { func: this.addShowWord.bind(this), ids: [100] },\r\n  ]\r\n\r\n}\r\n"]}