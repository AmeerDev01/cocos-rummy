{"version":3,"sources":["file:///Users/geliang/web/dibai/hall/assets/script/common/fish/utils/skills/SkillItemBossComing.ts"],"names":["SkillItemBossComing","Node","UIOpacity","UITransform","Vec3","tween","createAnimationNode","createSpriteAtlasNode","createSpriteNode","constructor","skillPlayer","sourceManage","parentNode","config","textureConfig","uiRoot","spr","spr_ani","addChild","setSiblingIndex","children","length","init","getUseSkew","setScale","firstTexture","src_id_lst","secondTexture","src_cfg","file","op","addComponent","setPosition","scale","getScale","multiplyScalar","getScaleRatio","then","to","opacity","repeatForever","start","ani_config","delay","call","isValid","destroy","k","icon_id_lst","v","ani_config1","spriteFrame","String","pattern","format","spr_size","getComponent","width","position"],"mappings":"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","sourcesContent":["/**\r\n  boss 来临\r\n */\r\n\r\nimport { Node, UIOpacity, UITransform, Vec2, Vec3, tween } from \"cc\";\r\nimport { createAnimationNode, createSpriteAtlasNode, createSpriteNode } from \"../../FishTool\";\r\nimport { SkillPlayer } from \"../../SkillPlayer\";\r\nimport SourceManage from \"../../../../base/SourceManage\";\r\n\r\nexport class SkillItemBossComing {\r\n  public uiRoot: Node;\r\n  private spr: Node;\r\n  private spr_ani: Node;\r\n  private skillPlayer: SkillPlayer;\r\n  private sourceManage: SourceManage;\r\n\r\n  constructor(skillPlayer: SkillPlayer, sourceManage: SourceManage, parentNode: Node, config, textureConfig) {\r\n    this.skillPlayer = skillPlayer\r\n    this.sourceManage = sourceManage\r\n    this.uiRoot = new Node();\r\n    parentNode.addChild(this.uiRoot)\r\n    this.uiRoot.setSiblingIndex(parentNode.children.length)\r\n    this.init(config, textureConfig);\r\n  }\r\n  public init(config, textureConfig) {\r\n    if (this.skillPlayer.getUseSkew() == true) {\r\n      this.uiRoot.setScale(new Vec3(-1, -1))\r\n    }\r\n\r\n    const firstTexture = config.src_id_lst[0];\r\n    const secondTexture = config.src_id_lst[1];\r\n\r\n    if (firstTexture) {\r\n      let src_cfg = textureConfig[firstTexture]\r\n      this.spr = createSpriteNode(this.sourceManage, this.uiRoot, src_cfg.file)\r\n      const op = this.spr.addComponent(UIOpacity)\r\n      this.spr.setPosition(0, 0)\r\n      this.spr.setScale(new Vec3(1.5, 1.5));\r\n\r\n      const scale = this.spr.getScale().multiplyScalar(this.skillPlayer.getScaleRatio())\r\n      this.spr.setScale(scale)\r\n\r\n      tween(op).then(tween().to(0.5, { opacity: 0 }).to(0.5, { opacity: 255 })).repeatForever().start()\r\n    }\r\n\r\n    if (secondTexture) {\r\n      let ani_config = textureConfig[secondTexture]\r\n      this.spr_ani = createAnimationNode(this.sourceManage, this.uiRoot, ani_config, true, false)\r\n      this.spr_ani.setPosition(0, 0)\r\n\r\n      tween(this.spr_ani).delay(3).call(() => {\r\n        this.spr_ani.isValid && this.destroy();\r\n      }).start();\r\n    }\r\n\r\n    for (let k = 0; k < config.icon_id_lst.length; k++) {\r\n      const v = config.icon_id_lst[k];\r\n      let ani_config1 = textureConfig[v]\r\n      if (ani_config1) {\r\n        const spriteFrame = String(ani_config1.pattern).format(1);\r\n        let spr = createSpriteAtlasNode(this.sourceManage, this.uiRoot, ani_config1, spriteFrame);\r\n        let spr_size = spr.getComponent(UITransform);\r\n        // spr.setPosition(-568 - spr_size.width / 2 - 10, 0)\r\n        spr.setPosition(-568 - spr_size.width, 0)\r\n\r\n        tween(spr).to(0.6, { position: new Vec3(-450, 0) }).start();\r\n      }\r\n    }\r\n  }\r\n\r\n  public destroy() {\r\n    this.uiRoot.destroy();\r\n    this.spr = null;\r\n    this.spr_ani = null;\r\n    this.skillPlayer = null;\r\n    this.sourceManage = null;\r\n  }\r\n}\r\n\r\n"]}