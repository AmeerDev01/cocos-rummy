{"version":3,"sources":["file:///Users/geliang/web/dibai/hall/assets/script/subGame/qiuqiu/components/Qiuqiu_Sure.ts"],"names":["Label","Node","Slider","Sprite","_decorator","BaseComponent","OperationType","ccclass","property","Qiuqiu_Sure","propertyNode","props_label_bet_pour","props_mask_node","props_spr_bet_bg","props_Slider","props_btn_bet_ok","props_btn_bet_buta5x","props_btn_bet_buta10x","props_btn_bet_buta20x","props_btn_bet_buta50x","props","newBetAmount","maxAmount","afee","gold","events","sendBet","betAmount","opType","min","max","progress","start","initState","cellAmount","bindEvent","on","EventType","TOUCH_END","node","active","slider","getComponent","fillRange","getProgress","setState","bet","value","Number","toFixed","CALL","SHOW_HAND","state","FILL","useProps","key","cur","enabled","bindUI","useState","string","formatAmountWithLetter","showHideAnima","show","undefined","update","deltaTime"],"mappings":"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","sourcesContent":["import { Label, Node, Slider, Sprite, Toggle, UITransform, Vec3, Widget, _decorator, tween } from 'cc';\r\nimport { BaseComponent } from '../../../base/BaseComponent';\r\nimport { DeskStatus, OperationType } from '../type';\r\nconst { ccclass, property } = _decorator;\r\n\r\nexport interface IState {\r\n\t/**跟注金额 */\r\n\tcellAmount: number\r\n}\r\n\r\nexport interface IProps {\r\n\t/**当前最新下注金额 */\r\n\tnewBetAmount: number,\r\n\tmaxAmount: number,\r\n\tafee: number,\r\n\tgold: number\r\n}\r\nexport interface IEvent {\r\n\tsendBet: (betAmount: number, opType: OperationType) => void\r\n}\r\n\r\n@ccclass('Qiuqiu_Sure')\r\nexport class Qiuqiu_Sure extends BaseComponent<IState, IProps, IEvent> {\r\n\tstart() { }\r\n\r\n\tprotected propertyNode = {\r\n\t\tprops_label_bet_pour: new Node(),\r\n\t\tprops_mask_node: new Node(),\r\n\t\tprops_spr_bet_bg: new Node(),\r\n\t\tprops_Slider: new Node(),\r\n\t\tprops_btn_bet_ok: new Node(),\r\n\t\tprops_btn_bet_buta5x: new Node(),\r\n\t\tprops_btn_bet_buta10x: new Node(),\r\n\t\tprops_btn_bet_buta20x: new Node(),\r\n\t\tprops_btn_bet_buta50x: new Node(),\r\n\t}\r\n\r\n\tpublic props: IProps = {\r\n\t\tnewBetAmount: -1,\r\n\t\tmaxAmount: -1,\r\n\t\tafee: 0,\r\n\t\tgold: 0,\r\n\t}\r\n\r\n\tpublic events: IEvent = {\r\n\t\tsendBet: (betAmount: number, opType: OperationType) => { }\r\n\t}\r\n\r\n\tprotected initState() {\r\n\t\treturn {\r\n\t\t\tcellAmount: -1\r\n\t\t}\r\n\t}\r\n\tprivate min = 0.11\r\n\tprivate max = 0.94\r\n\tprivate progress = 0;\r\n\tprotected bindEvent(): void {\r\n\t\tthis.propertyNode.props_mask_node.on(Node.EventType.TOUCH_END, () => {\r\n\t\t\tthis.node.active = false;\r\n\t\t})\r\n\r\n\t\tthis.propertyNode.props_Slider.on('slide', (slider: Slider) => {\r\n\t\t\tslider.progress < this.min && (slider.progress = this.min)\r\n\t\t\tslider.progress > this.max && (slider.progress = this.max)\r\n\t\t\tthis.propertyNode.props_Slider.getComponent(Sprite).fillRange = slider.progress;\r\n\r\n\t\t\tthis.progress = this.getProgress(slider);\r\n\r\n\t\t\tthis.setState({ cellAmount: this.props.newBetAmount + this.props.gold * this.progress });\r\n\t\t})\r\n\r\n\t\tthis.propertyNode.props_btn_bet_ok.on(Node.EventType.TOUCH_END, () => {\r\n\t\t\tthis.bet();\r\n\t\t})\r\n\t\tthis.propertyNode.props_btn_bet_buta5x.on(Node.EventType.TOUCH_END, () => {\r\n\t\t\tthis.setState({ cellAmount: this.props.newBetAmount + this.props.afee * 5 });\r\n\t\t\tthis.bet();\r\n\t\t})\r\n\t\tthis.propertyNode.props_btn_bet_buta10x.on(Node.EventType.TOUCH_END, () => {\r\n\t\t\tthis.setState({ cellAmount: this.props.newBetAmount + this.props.afee * 10 });\r\n\t\t\tthis.bet();\r\n\t\t})\r\n\t\tthis.propertyNode.props_btn_bet_buta20x.on(Node.EventType.TOUCH_END, () => {\r\n\t\t\tthis.setState({ cellAmount: this.props.newBetAmount + this.props.afee * 20 });\r\n\t\t\tthis.bet();\r\n\t\t})\r\n\t\tthis.propertyNode.props_btn_bet_buta50x.on(Node.EventType.TOUCH_END, () => {\r\n\t\t\tthis.setState({ cellAmount: this.props.newBetAmount + this.props.afee * 50 });\r\n\t\t\tthis.bet();\r\n\t\t})\r\n\t}\r\n\r\n\tprivate getProgress(slider: Slider) {\r\n\t\tlet value = slider.progress - this.min;\r\n\t\treturn Number((value / (this.max - this.min)).toFixed(2));\r\n\t}\r\n\r\n\tprivate bet() {\r\n\t\tlet opType = OperationType.CALL;\r\n\t\tif (this.progress === 1) {\r\n\t\t\topType = OperationType.SHOW_HAND;\r\n\t\t} else if (this.state.cellAmount > this.props.newBetAmount) {\r\n\t\t\topType = OperationType.FILL;\r\n\t\t}\r\n\t\tthis.events.sendBet(this.state.cellAmount, opType);\r\n\t\tthis.node.active = false;\r\n\r\n\t\tthis.propertyNode.props_Slider.getComponent(Slider).progress = this.min;\r\n\t\tthis.setState({ cellAmount: this.props.afee })\r\n\t}\r\n\r\n\tprotected useProps(key: keyof IProps, value: { pre: any, cur: any }) {\r\n\t\tif (key === 'afee' || key === 'newBetAmount') {\r\n\t\t\tlet cellAmount = this.props.newBetAmount === 0 ? this.props.afee : value.cur;\r\n\t\t\tif (cellAmount > this.props.gold) {\r\n\t\t\t\tcellAmount = this.props.gold;\r\n\t\t\t\tthis.progress = 1;\r\n\t\t\t\tthis.propertyNode.props_Slider.getComponent(Slider).progress = this.max;\r\n\t\t\t\tthis.propertyNode.props_Slider.getComponent(Slider).enabled = false;\r\n\t\t\t} else {\r\n\t\t\t\tthis.propertyNode.props_Slider.getComponent(Slider).enabled = true;\r\n\t\t\t}\r\n\t\t\tthis.setState({ cellAmount: cellAmount })\r\n\t\t}\r\n\t}\r\n\r\n\tprotected bindUI(): void {\r\n\t\tthis.useState((key, value) => {\r\n\t\t\tif (value.cur > this.props.gold) {\r\n\t\t\t\tthis.setState({ cellAmount: this.props.gold });\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tthis.propertyNode.props_label_bet_pour.getComponent(Label).string = Number(value.cur).formatAmountWithLetter();\r\n\t\t}, ['cellAmount'])\r\n\t}\r\n\r\n\tpublic showHideAnima(show: boolean = undefined) {\r\n\t\tconst value = show !== undefined ? show : !this.node.active;\r\n\t\tthis.node.active = value;\r\n\t\t// let startVec = value ? new Vec3(0, 0) : new Vec3(1, 1);\r\n\t\t// let endVec = value ? new Vec3(1, 1) : new Vec3(0, 0);\r\n\t\t// this.propertyNode.props_spr_bet_bg.setScale(startVec);\r\n\t\t// if (show === undefined) {\r\n\t\t// \ttween(this.propertyNode.props_spr_bet_bg).to(0.2, { scale: endVec }).call(() => {\r\n\t\t// \t\tif (!value) {\r\n\t\t// \t\t\tthis.node.active = false;\r\n\t\t// \t\t}\r\n\t\t// \t}).start();\r\n\t\t// \tvalue && (this.node.active = value);\r\n\t\t// } else {\r\n\t\t// \tthis.node.active = value;\r\n\t\t// }\r\n\t}\r\n\r\n\tupdate(deltaTime: number) {\r\n\r\n\t}\r\n}\r\n\r\n"]}