{"version":3,"sources":["file:///Users/geliang/web/dibai/hall/assets/script/subGame/thorV2/viewModel/ThorV2MainViewModel.ts"],"names":["ViewModel","StoreInject","ModalBox","global","lang","addToastAction","setLoadingAction","UseSetOption","config","cacheData","clearCacheData","thorv2_Audio","sourceManageSeletor","SKT_MAG_TYPE","sktInstance","sktMsgListener","bundlePkgName","PrefabPathDefine","getStore","changeGame","setAutoLauncherInfo","updateFreeGameOdds","updateGameMode","updateGold","updateJackpotAmount","updateJackpotDatas","updatePositionId","updateSubGameWinloss","updateManualSpeedStatus","updateRollerStatus","AutoLauncherType","GameModeType","GameType","RollerStatus","calBetAmount","isAuto","verifyBetResultData","ThorV2DialogWinViewModel","ThorV2FoolerViewModel","ThorV2HeaderViewModel","ThorV2RollerPanelViewModel","ThorV2RulePanelViewModel","EffectType","SoundPathDefine","ThorV2BuyMiniViewModel","ThorV2SubGameCalculateViewModel","ThorV2AuthLauncherViewModel","ThorV2MainViewModel","constructor","initCallback","headerViewModel","footerViewModel","rollerPanelViewModel","isAuthDone","isBetResult","goodLuckPos","betCallbackFun","begin","mountView","getFile","FOOTER","source","appendTo","comp","getActionBarNode","connect","HEADER","setEvent","quitGame","onQuitGame","onOpenRule","openRule","mountViewNode","getRollerPanel","onSendBet","sendBet","onOpenAuto","openAutoPanel","onOpenBuyMiniPanel","openBubMiniPanel","addOnce","AUTH","data","error","closeSubGame","confirmContent","write","k","InitGameModule","FetcherFaild","authData","dispatch","coinsBeforeBetting","lastGameType","gameType","viewGameType","currGameType","leftCount","freeGameCount","freeGameAmount","freeGameCoins","normal","playBgMusic","SUBGAME1","lessGodFreeGameMultiple","initSlot","scheduleOnce","viewNode","isValid","props","autoLauncherInfo","gameTypeInfo","sendSktMessage","token","localStorage","getItem","gameId","add","LAUNCH","unschedule","undefined","result","content","Instance","show","type","rollerLaunchResult","si","dl","rollerId","i","length","console","log","freeCount","NONE","indexGameType","nextGameType","REFRESHCOINS","JACKPOT","JACKPOT_TOTAL","VACATETHEROOM","UpdateModule","GameNotice","placeStr","option","gameSet","egyptV2","betTarget","betAmount","isBuy","gameModeType","buyMiniGames","positionId","MAIN","gold","openShop","hallDispatch","palyingModule","RechangeGlod","autoLauncherType","totalCount","playOneShot","PER_HIT","sendBetTime","Date","now","RUNNING","betListenerTimeHandle","bind","schedule","tableId","buy","isShow","WebSocketModule","WebSocketError","unMountCallBack","removeById","unMount","getRollerPanelViewModel","enterExitSubGame","dialogInfo","done","thorV2SubGameCalculateViewModel","SUB_GAME_CACULATE","isModal","setProps","onWindowCloseHandler","showDialogWin","winningConfig","amount","thorV2DialogWinViewModel","DIALOG_WIN","getGoodLuckPos","setGoodLuckPos","pos","rulePanelViewMode","RULEPANEL","effectType","EFFECT1","stop","play","BG_MUSIC_MAIN","BG_MUSIC_1","buyAmount","getBuyMiniGameAmount","thorV2BuyMiniViewModel","BUY_MINI","onBuy","thorV2AuthLauncherViewModel","AUTH_LAUNCHER","inject","state","betDropDownlist","game","subGameAnimationPlayInfo","jackpotDatas","jackpotTotalAmount","winIconDataItem","rollerStatus","roller","playThorAnimation","playWinOddsAnimation","winloss","subGameWinloss","freeGameOdds"],"mappings":"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","sourcesContent":["import { Vec3 } from \"cc\"\r\nimport ViewModel, { StoreInject } from \"../../../base/ViewModel\"\r\nimport ModalBox from \"../../../common/ModalBox\"\r\nimport { global, lang } from \"../../../hall\"\r\nimport { addToastAction, setLoadingAction } from \"../../../hall/store/actions/baseBoard\"\r\nimport UseSetOption from \"../../../utils/UseSetOption\"\r\nimport { ThorV2_Main, IEvent, IProps } from \"../components/ThorV2_Main\"\r\nimport config from \"../config\"\r\nimport { cacheData, clearCacheData } from \"../dataTransfer\"\r\nimport { thorv2_Audio, sourceManageSeletor } from \"../index\"\r\nimport { SKT_MAG_TYPE, sktInstance, sktMsgListener } from \"../socketConnect\"\r\nimport { bundlePkgName } from \"../sourceDefine\"\r\nimport { PrefabPathDefine } from \"../sourceDefine/prefabDefine\"\r\nimport { getStore } from \"../store\"\r\nimport { changeGame, initGameStore, setAutoLauncherInfo, updateFreeGameOdds, updateGameMode, updateGold, updateJackpotAmount, updateJackpotDatas, updatePositionId, updateSubGameWinloss, updateWinloss } from \"../store/actions/game\"\r\nimport { updateManualSpeedStatus, updateRollerStatus } from \"../store/actions/roller\"\r\nimport { StateType } from \"../store/reducer\"\r\nimport { AuthDataVo, AutoLauncherType, DialogInfo, DialogType, GameModeType, GameType, JackpotData, RollerLaunchResult, RollerStatus, calBetAmount, isAuto, verifyBetResultData } from \"../type\"\r\nimport ThorV2DialogWinViewModel from \"./ThorV2DialogWinViewModel\"\r\nimport ThorV2FoolerViewModel from \"./ThorV2FoolerViewModel\"\r\nimport ThorV2HeaderViewModel from \"./ThorV2HeaderViewModel\"\r\nimport ThorV2RollerPanelViewModel from \"./ThorV2RollerPanelViewModel\"\r\nimport ThorV2RulePanelViewModel from \"./ThorV2RulePanelViewModel\"\r\nimport { EffectType } from \"../../../utils/NodeIOEffect\"\r\nimport { SoundPathDefine } from \"../sourceDefine/soundDefine\"\r\nimport ThorV2BuyMiniViewModel from \"./ThorV2BuyMiniViewModel\"\r\nimport ThorV2SubGameCalculateViewModel from \"./ThorV2SubGameCalculateViewModel\"\r\nimport ThorV2AuthLauncherViewModel from \"./ThorV2AuthLauncherViewModel\"\r\n\r\n@StoreInject(getStore())\r\nclass ThorV2MainViewModel extends ViewModel<ThorV2_Main, IProps, IEvent> {\r\n  private initCallback;\r\n  constructor(initCallback) {\r\n    super('ThorV2_Main')\r\n    this.initCallback = initCallback;\r\n  }\r\n\r\n  private headerViewModel: ThorV2HeaderViewModel;\r\n  private footerViewModel: ThorV2FoolerViewModel;\r\n  private rollerPanelViewModel: ThorV2RollerPanelViewModel;\r\n  public isAuthDone: boolean = false\r\n  private isBetResult = true;\r\n\r\n  /**奖励的坐标 */\r\n  private goodLuckPos: Vec3;\r\n\r\n  private betCallbackFun;\r\n  protected begin() {\r\n    this.footerViewModel = new ThorV2FoolerViewModel().mountView(sourceManageSeletor().getFile(PrefabPathDefine.FOOTER).source).appendTo(this.comp.getActionBarNode()).connect();\r\n    this.headerViewModel = new ThorV2HeaderViewModel().mountView(sourceManageSeletor().getFile(PrefabPathDefine.HEADER).source).appendTo(this.comp.getActionBarNode()).connect();\r\n    this.headerViewModel.setEvent({\r\n      quitGame: () => {\r\n        this.onQuitGame();\r\n      },\r\n      onOpenRule: () => {\r\n        this.openRule();\r\n      }\r\n    })\r\n    this.rollerPanelViewModel = new ThorV2RollerPanelViewModel().mountViewNode(this.comp.getRollerPanel()).connect();\r\n\r\n    this.footerViewModel.setEvent({\r\n      onSendBet: () => {\r\n        this.sendBet();\r\n      },\r\n      onOpenRule: () => {\r\n        this.openRule();\r\n      },\r\n      onOpenAuto: () => {\r\n        this.openAutoPanel();\r\n      }\r\n    })\r\n    this.setEvent({\r\n      onSendBet: () => {\r\n        this.sendBet();\r\n      },\r\n      onOpenBuyMiniPanel: () => {\r\n        this.openBubMiniPanel();\r\n      }\r\n    })\r\n\r\n    sktMsgListener.addOnce(SKT_MAG_TYPE.AUTH, bundlePkgName, (data: AuthDataVo, error) => {\r\n      if (error) {\r\n        return;\r\n      }\r\n\r\n      if (!data) {\r\n        global.closeSubGame({\r\n          confirmContent: lang.write(k => k.InitGameModule.FetcherFaild) + '-' + SKT_MAG_TYPE.AUTH\r\n        });\r\n        return;\r\n      }\r\n      this.isAuthDone = true\r\n      cacheData.authData = data;\r\n      this.dispatch(updateGold(data.coinsBeforeBetting));\r\n\r\n      this.dispatch(changeGame({\r\n        lastGameType: data.gameType,\r\n        viewGameType: data.gameType,\r\n        currGameType: data.gameType,\r\n        leftCount: data.freeGameCount,\r\n        freeGameAmount: data.freeGameCoins,\r\n      }))\r\n\r\n      this.dispatch(updateGameMode(GameModeType.normal))\r\n      this.playBgMusic();\r\n\r\n      if (data.gameType === GameType.SUBGAME1) {\r\n        this.dispatch(updateFreeGameOdds(data.lessGodFreeGameMultiple))\r\n        if (data.freeGameCoins > 0) {\r\n          this.dispatch(updateSubGameWinloss(data.freeGameCoins));\r\n        }\r\n      }\r\n\r\n      // 这里初始化插槽\r\n      this.rollerPanelViewModel.comp.initSlot();\r\n      // 延时一点时间才卸载laoding界面\r\n      this.comp.scheduleOnce(() => {\r\n        this.viewNode.isValid && this.initCallback && this.initCallback();\r\n\r\n        // 进入游戏之后如果是自动游戏，就发送下注\r\n        if (isAuto(this.comp.props.autoLauncherInfo, this.comp.props.gameTypeInfo)) {\r\n          this.sendBet();\r\n        }\r\n\r\n      }, 0.1)\r\n    })\r\n    sktInstance.sendSktMessage(SKT_MAG_TYPE.AUTH, {\r\n      token: localStorage.getItem(\"token\"),\r\n      gameId: config.gameId\r\n    });\r\n    sktMsgListener.add(SKT_MAG_TYPE.LAUNCH, bundlePkgName, (data: RollerLaunchResult, error) => {\r\n      this.comp.unschedule(this.betCallbackFun);\r\n      this.betCallbackFun = undefined;\r\n      this.isBetResult = true;\r\n      const result = verifyBetResultData(data)\r\n      if (!error && result > 0) {\r\n        const content = lang.write(k => k.InitGameModule.FetcherFaild) + '-ERROR(' + result + ')';\r\n        ModalBox.Instance().show({\r\n          content: content, type: 'Prompt'\r\n        }, () => {\r\n          return true\r\n        })\r\n        return;\r\n      }\r\n      cacheData.rollerLaunchResult = data;\r\n\r\n      const si = cacheData.rollerLaunchResult.dl.si[0];\r\n\r\n      // 服务器的索引是从1开始的\r\n      const rollerId = si.rollerId\r\n      for (let i = 0; i < rollerId.length; i++) {\r\n        rollerId[i]--;\r\n      }\r\n      console.log(\"rollerId \", si.rollerId)\r\n      let leftCount = si.freeCount;\r\n      this.dispatch(changeGame({\r\n        lastGameType: GameType.NONE,\r\n        viewGameType: si.indexGameType,\r\n        currGameType: si.nextGameType,\r\n        leftCount: leftCount,\r\n        freeGameAmount: si.freeGameAmount,\r\n      }))\r\n    })\r\n    // 更新金额\r\n    sktMsgListener.add(SKT_MAG_TYPE.REFRESHCOINS, bundlePkgName, (data, error) => {\r\n      this.dispatch(updateGold(data));\r\n    })\r\n    sktMsgListener.add(SKT_MAG_TYPE.JACKPOT, bundlePkgName, (data: JackpotData[], error) => {\r\n      this.dispatch(updateJackpotDatas(data))\r\n    })\r\n    sktMsgListener.add(SKT_MAG_TYPE.JACKPOT_TOTAL, bundlePkgName, (data, error) => {\r\n      this.dispatch(updateJackpotAmount(data))\r\n    })\r\n    sktMsgListener.add(SKT_MAG_TYPE.VACATETHEROOM, bundlePkgName, (data) => {\r\n      global.closeSubGame({ confirmContent: lang.write(k => k.UpdateModule.GameNotice, {}, { placeStr: \"对不起，系统维护中，请稍后再尝试登录\" }) })\r\n    })\r\n\r\n    if (UseSetOption.Instance().option.gameSet.egyptV2 && UseSetOption.Instance().option.gameSet.egyptV2.betTarget) {\r\n      this.dispatch(updatePositionId(UseSetOption.Instance().option.gameSet.egyptV2.betTarget))\r\n    } else {\r\n      this.dispatch(updatePositionId(1))\r\n    }\r\n  }\r\n\r\n  private sendBet(betAmount: number = 0) {\r\n    if (!this.isAuthDone) {\r\n      return\r\n    }\r\n    if (!this.isBetResult) {\r\n      console.log(\"已经发送过了下注，不能重复发送，等待服务器返回\")\r\n      return;\r\n    }\r\n\r\n    // 是否购买\r\n    const isBuy = betAmount > 0;\r\n\r\n    const gameModeType = isBuy ? GameModeType.buyMiniGames : this.comp.props.gameModeType;\r\n\r\n    if (betAmount === 0) {\r\n      betAmount = calBetAmount(this.comp.props.betAmount, this.comp.props.positionId)\r\n    }\r\n    // 在主游戏中才提示余额不足\r\n    if (this.comp.props.gameTypeInfo.viewGameType === GameType.MAIN && this.comp.props.gold < betAmount) {\r\n      if (isBuy) {\r\n        global.openShop();\r\n      } else {\r\n        global.hallDispatch(addToastAction({ content: lang.write(k => k.palyingModule.RechangeGlod, {}, { placeStr: \"对不起，您的金币不足，请充值！\" }) }))\r\n      }\r\n\r\n      // 如果余额不足，并且是自动状态，就取消自动\r\n      if (isAuto(this.comp.props.autoLauncherInfo, this.comp.props.gameTypeInfo)) {\r\n        this.dispatch(setAutoLauncherInfo({\r\n          autoLauncherType: AutoLauncherType.NONE,\r\n          totalCount: 0,\r\n          leftCount: 0\r\n        }))\r\n      }\r\n\r\n      return;\r\n    }\r\n    thorv2_Audio.playOneShot(SoundPathDefine.PER_HIT);\r\n    this.dispatch(updateManualSpeedStatus(false));\r\n\r\n    if (this.comp.props.gameTypeInfo.viewGameType === GameType.MAIN) {\r\n      this.dispatch(updateGold(this.comp.props.gold - betAmount));\r\n    }\r\n\r\n    cacheData.sendBetTime = Date.now();\r\n    console.log(\"sendBet time \" + cacheData.sendBetTime)\r\n\r\n    cacheData.rollerLaunchResult = null;\r\n    this.dispatch(updateRollerStatus(RollerStatus.RUNNING));\r\n    this.isBetResult = false;\r\n    this.betCallbackFun = this.betListenerTimeHandle.bind(this);\r\n    this.comp.schedule(this.betCallbackFun, 10);\r\n\r\n    sktInstance.sendSktMessage(SKT_MAG_TYPE.LAUNCH, {\r\n      positionId: this.comp.props.positionId,\r\n      tableId: cacheData.authData.tableId,\r\n      buy: gameModeType,\r\n    });\r\n  }\r\n\r\n  private betListenerTimeHandle() {\r\n    if (!this.isBetResult) {\r\n      this.isBetResult = true;\r\n\r\n      global.hallDispatch(setLoadingAction({\r\n        isShow: false\r\n      }));\r\n\r\n      const content = lang.write(k => k.WebSocketModule.WebSocketError) + '-' + SKT_MAG_TYPE.LAUNCH;\r\n      ModalBox.Instance().show({\r\n        content: content, type: 'Prompt'\r\n      }, () => {\r\n        this.onQuitGame();\r\n        return true\r\n      })\r\n    }\r\n  }\r\n\r\n  protected unMountCallBack(): void {\r\n    sktMsgListener.removeById(bundlePkgName)\r\n    this.footerViewModel.unMount();\r\n    this.headerViewModel.unMount();\r\n    this.rollerPanelViewModel.unMount();\r\n    clearCacheData();\r\n  }\r\n\r\n  public getRollerPanelViewModel() {\r\n    return this.rollerPanelViewModel;\r\n  }\r\n\r\n  private onQuitGame() {\r\n    global.closeSubGame();\r\n  }\r\n\r\n  /**进入退出小游戏处理 */\r\n  public enterExitSubGame(dialogInfo: DialogInfo, done) {\r\n    let thorV2SubGameCalculateViewModel = new ThorV2SubGameCalculateViewModel().mountView(sourceManageSeletor().getFile(PrefabPathDefine.SUB_GAME_CACULATE).source)\r\n      .appendTo(this.viewNode, { isModal: true });\r\n    thorV2SubGameCalculateViewModel.setProps({\r\n      dialogInfo: dialogInfo,\r\n      gameTypeInfo: this.comp.props.gameTypeInfo,\r\n      autoLauncherInfo: this.comp.props.autoLauncherInfo,\r\n    })\r\n    thorV2SubGameCalculateViewModel.setEvent({\r\n      onWindowCloseHandler: () => {\r\n        done && done();\r\n      }\r\n    })\r\n  }\r\n\r\n  /**显示大奖 */\r\n  public showDialogWin(winningConfig: any, amount: number, done) {\r\n    let thorV2DialogWinViewModel = new ThorV2DialogWinViewModel().mountView(sourceManageSeletor().getFile(PrefabPathDefine.DIALOG_WIN).source)\r\n      .appendTo(this.viewNode, { isModal: true });\r\n    thorV2DialogWinViewModel.setProps({\r\n      winningConfig: winningConfig,\r\n      amount: amount,\r\n      gameTypeInfo: this.comp.props.gameTypeInfo,\r\n      autoLauncherInfo: this.comp.props.autoLauncherInfo,\r\n    })\r\n    thorV2DialogWinViewModel.setEvent({\r\n      onWindowCloseHandler: () => {\r\n        done && done();\r\n      }\r\n    })\r\n  }\r\n\r\n  public getGoodLuckPos() {\r\n    return this.goodLuckPos;\r\n  }\r\n\r\n  public setGoodLuckPos(pos: Vec3) {\r\n    this.goodLuckPos = pos;\r\n  }\r\n\r\n  public openRule() {\r\n    const rulePanelViewMode = new ThorV2RulePanelViewModel()\r\n      .mountView(sourceManageSeletor().getFile(PrefabPathDefine.RULEPANEL).source)\r\n      .appendTo(this.viewNode, { effectType: EffectType.EFFECT1, isModal: true });\r\n  }\r\n\r\n  public playBgMusic() {\r\n    thorv2_Audio.stop();\r\n    if (this.comp.props.gameTypeInfo.viewGameType === GameType.MAIN) {\r\n      thorv2_Audio.play(SoundPathDefine.BG_MUSIC_MAIN, true)\r\n    } else {\r\n      thorv2_Audio.play(SoundPathDefine.BG_MUSIC_1, true)\r\n    }\r\n  }\r\n\r\n  private openBubMiniPanel() {\r\n    const buyAmount = this.comp.getBuyMiniGameAmount();\r\n    const thorV2BuyMiniViewModel = new ThorV2BuyMiniViewModel().mountView(sourceManageSeletor()\r\n      .getFile(PrefabPathDefine.BUY_MINI).source)\r\n      .appendTo(this.viewNode, { effectType: EffectType.EFFECT1, isModal: true })\r\n      .connect();\r\n    thorV2BuyMiniViewModel.setProps({\r\n      buyAmount\r\n    })\r\n\r\n    thorV2BuyMiniViewModel.setEvent({\r\n      onBuy: () => {\r\n        this.sendBet(buyAmount);\r\n      }\r\n    })\r\n  }\r\n\r\n  private openAutoPanel() {\r\n    const thorV2AuthLauncherViewModel = new ThorV2AuthLauncherViewModel().mountView(sourceManageSeletor().getFile(PrefabPathDefine.AUTH_LAUNCHER).source)\r\n      .appendTo(this.viewNode, { effectType: EffectType.EFFECT1, isModal: true })\r\n      .connect();\r\n    thorV2AuthLauncherViewModel.setEvent({\r\n      onSendBet: () => {\r\n        this.sendBet();\r\n      }\r\n    })\r\n  }\r\n\r\n  public connect() {\r\n    this.inject({}, (state: StateType) => {\r\n      return {\r\n        betDropDownlist: state.game.betDropDownlist,\r\n        positionId: state.game.positionId,\r\n        gold: state.game.gold,\r\n        gameTypeInfo: state.game.gameTypeInfo,\r\n        subGameAnimationPlayInfo: state.game.subGameAnimationPlayInfo,\r\n        jackpotDatas: state.game.jackpotDatas,\r\n        jackpotTotalAmount: state.game.jackpotTotalAmount,\r\n        autoLauncherInfo: state.game.autoLauncherInfo,\r\n        winIconDataItem: state.game.winIconDataItem,\r\n        rollerStatus: state.roller.rollerStatus,\r\n        playThorAnimation: state.game.playThorAnimation,\r\n        playWinOddsAnimation: state.game.playWinOddsAnimation,\r\n        winloss: state.game.winloss,\r\n        subGameWinloss: state.game.subGameWinloss,\r\n        betAmount: state.game.betAmount,\r\n        gameModeType: state.game.gameModeType,\r\n        freeGameOdds: state.game.freeGameOdds,\r\n      }\r\n    })\r\n    return this\r\n  }\r\n\r\n\r\n}\r\n\r\nexport default ThorV2MainViewModel"]}