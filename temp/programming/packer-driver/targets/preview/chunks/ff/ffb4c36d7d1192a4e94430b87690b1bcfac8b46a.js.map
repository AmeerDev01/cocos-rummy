{"version":3,"sources":["file:///Users/geliang/web/dibai/hall/assets/script/subGame/bandar/components/Bandar_jackpot.ts"],"names":["_decorator","instantiate","Label","Node","Sprite","BaseComponent","getNodeByNameDeep","global","SpriteFramePathDefine","sourceManageSelector","numToString","config","ccclass","property","Bandar_jackpot","propertyNode","props_label_jackpot_num","props_jackpot_off","props_label_last_gold","props_label_last_time","props_content","props_spr_winer1","props_all_card","props_card","props","jackpot","trigJackpot","jackpotWin","jackpotCard","events","onClosePanel","start","initState","bindEvent","on","EventType","TOUCH_END","useProps","key","value","createWiner","removeAllChildren","forEach","item","index","winer","setPosition","getComponent","string","name","winGold","formatAmountWithLetter","addChild","getHead","icon","sp","loadHeadSprite","createJackpotCard","itemCard","getCard","card","spriteFrame","getSpriteFrame","up","down","toggleCallback","event","customEventData","cardT","cardType","bindUI","num","format","Date","formatAmountWithCommas","result","fileName","BANDAR_POKER0","BANDAR_POKER1","BANDAR_POKER2","BANDAR_POKER3","BANDAR_POKER4","BANDAR_POKER5","BANDAR_POKER6","getFile","source","t","y","getFullYear","m","getMonth","d","getDate","h","getHours","minute","getMinutes","second","getSeconds","time","update","deltaTime"],"mappings":"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","sourcesContent":["import { _decorator,instantiate,Label,Node, Sprite, SpriteFrame, UITransform, Vec2, Vec3 } from 'cc';\r\nimport { BaseComponent } from '../../../base/BaseComponent';\r\nimport { getNodeByNameDeep, getNodePositionInCanvas, initToggle } from '../../../utils/tool';\r\nimport { JackpotWin } from '../store/actions/history';\r\nimport { global } from '../../../hall';\r\nimport { Poker } from '../store/actions/pokerDetail';\r\nimport { SpriteFramePathDefine } from '../sourceDefine/spriteDefine';\r\nimport { sourceManageSelector } from '../index';\r\nimport { numToString } from './Bandar_pot';\r\nimport config from '../config';\r\nconst { ccclass, property } = _decorator;\r\n\r\n\r\n\r\nexport interface IState {\r\n\r\n}\r\n\r\nexport interface IProps {\r\n    jackpot:number,\r\n    trigJackpot:number,\r\n\tjackpotWin:JackpotWin[],\r\n    jackpotCard:number[]\r\n}\r\nexport interface IEvent {\r\n\tonClosePanel:()=>void,\r\n}\r\n\r\n\r\n@ccclass('Bandar_jackpot')\r\nexport class Bandar_jackpot extends BaseComponent<IState, IProps, IEvent> {\r\n\tstart() {\r\n\r\n\t }\r\n\r\n\tprotected propertyNode = {\r\n        props_label_jackpot_num:new Label(),\r\n        props_jackpot_off:new Node(),\r\n        props_label_last_gold:new Label(),\r\n        props_label_last_time:new Label(),\r\n        props_content:new Node(),\r\n        props_spr_winer1:new Node(),\r\n        props_all_card:new Node(),\r\n        props_card:new Node(),\r\n\t}\r\n\r\n\tpublic props: IProps = {\r\n        jackpot:12345678900,\r\n        trigJackpot:234567,\r\n\t\tjackpotWin:[],\r\n        jackpotCard:[13,5,9,16],\r\n\r\n\t}\r\n\r\n\tpublic events: IEvent = {\r\n\t\tonClosePanel:()=>{}\r\n\t}\r\n\r\n\tprotected initState() {\r\n\t\treturn {\r\n\t\t\t\r\n\t\t}\r\n\t}\r\n\r\n\tprotected bindEvent(): void {\r\n\t  this.propertyNode.props_jackpot_off.on(Node.EventType.TOUCH_END,()=>{\r\n\r\n        this.events.onClosePanel()\r\n      })\r\n\r\n\t}\r\n\r\n\tprotected useProps(key: keyof IProps, value: { pre: any, cur: any }) {\r\n        // if(key===\"trigJackpot\"){\r\n        //     this.propertyNode.props_label_last_gold.string=value.cur.formatAmountWithCommas()\r\n        // }\r\n\t}\r\n    /**创建winer */\r\n    private createWiner(){\r\n        this.propertyNode.props_content.removeAllChildren();\r\n        this.props.jackpotWin.forEach((item,index)=>{\r\n            let winer=instantiate(this.propertyNode.props_spr_winer1);\r\n        //    let uiTransform=winer.getComponent(UITransform)\r\n            winer.setPosition(0,-38-index*80)\r\n            // winer.setWorldPosition(uiTransform.convertToWorldSpaceAR(new Vec3(0,0-index*80)));\r\n            getNodeByNameDeep(\"label_first_num\",winer).getComponent(Label).string=index+1+\"\";\r\n            // this.getHead(item.icon, getNodeByNameDeep(\"spr_avatar\",winer).getComponent(Sprite));\r\n            getNodeByNameDeep(\"label_name\",winer).getComponent(Label).string=item.name;\r\n            getNodeByNameDeep(\"label_win\",winer).getComponent(Label).string=item.winGold.formatAmountWithLetter();\r\n            this.propertyNode.props_content.addChild(winer)\r\n        })\r\n    }\r\n\r\n    /**获取头像 */\r\n    private getHead(icon:number,sp){\r\n       return global.loadHeadSprite(icon,sp)\r\n    }\r\n\r\n    /** 更新牌资源 */\r\n    private createJackpotCard(){\r\n        this.propertyNode.props_all_card.removeAllChildren();\r\n        let index=0\r\n        this.props.jackpotCard.forEach((item,index)=>{\r\n            let itemCard=this.getCard(item)\r\n            let card=instantiate(this.propertyNode.props_card);\r\n            card.setPosition(-60+index*40,0)\r\n            getNodeByNameDeep(\"spr_card_up\",card).getComponent(Sprite).spriteFrame=this.getSpriteFrame(itemCard.up);\r\n            getNodeByNameDeep(\"spr_card_down\",card).getComponent(Sprite).spriteFrame=this.getSpriteFrame(itemCard.down);\r\n            this.propertyNode.props_all_card.addChild(card)\r\n        })\r\n    }\r\n\r\n\ttoggleCallback(event: Event, customEventData: string) {\r\n\r\n\t}\r\n\r\n    /**获取每张牌的组型 */\r\n    private getCard(cardT:number){\r\n        return config.cardType[cardT]\r\n    }\r\n\r\n\tprotected bindUI(): void {\r\n        let num=234567\r\n        \r\n        this.propertyNode.props_label_jackpot_num.string=numToString(this.props.jackpot,14);\r\n        this.createJackpotCard();\r\n        this.propertyNode.props_label_last_time.string=this.format(new Date());\r\n        this.propertyNode.props_label_last_gold.string=num.formatAmountWithCommas();//测试\r\n        this.createWiner();\r\n\t\t\t\t \r\n\t}\r\n    private getSpriteFrame(result:number): SpriteFrame {\r\n\t\tlet fileName = '';\r\n\t\tif (result === 0) {\r\n\t\t\tfileName = SpriteFramePathDefine.BANDAR_POKER0;\r\n\t\t}else if (result === 1) {\r\n\t\t\tfileName = SpriteFramePathDefine.BANDAR_POKER1;\r\n\t\t} else if (result === 2) {\r\n\t\t\tfileName = SpriteFramePathDefine.BANDAR_POKER2;\r\n\t\t} else if (result === 3) {\r\n\t\t\tfileName = SpriteFramePathDefine.BANDAR_POKER3;\r\n\t\t} else if (result === 4) {\r\n\t\t\tfileName = SpriteFramePathDefine.BANDAR_POKER4;\r\n\t\t} else if (result === 5) {\r\n\t\t\tfileName = SpriteFramePathDefine.BANDAR_POKER5;\r\n\t\t} else if (result === 6) {\r\n\t\t\tfileName = SpriteFramePathDefine.BANDAR_POKER6;\r\n\t\t} \r\n\t\treturn sourceManageSelector().getFile(fileName).source;\r\n\t}\r\n\r\n\r\n    /**获取时间 */\r\n    private format(t){ \r\n        let y = t.getFullYear();\r\n        let m = t.getMonth() + 1;\r\n        m = m < 10 ? ('0' + m) : m;\r\n        var d = t.getDate();\r\n        d = d < 10 ? ('0' + d) : d;\r\n        let h = t.getHours();\r\n        let minute = t.getMinutes();\r\n        minute = minute < 10 ? ('0' + minute) : minute;\r\n        let second = t.getSeconds();\r\n        second = second < 10 ? ('0' + second) : second;\r\n        let time = d +'/'+ m + '/'+y + ' ' +h+':'+minute+':'+second;\r\n        return time\r\n    }\r\n\r\n    \r\n\r\n\tupdate(deltaTime: number) {\r\n\r\n\t}\r\n}\r\n\r\n"]}