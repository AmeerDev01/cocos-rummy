{"version":3,"sources":["file:///Users/geliang/web/dibai/hall/assets/script/hall/components/Hall_LoginDialog.ts"],"names":["_decorator","Color","EditBox","instantiate","Label","Node","ScrollView","BaseComponent","initDropDownBox","ApiUrl","InputValidator","initToggle","fetcher","hallAudio","SoundPathDefine","ccclass","property","LoginType","Hall_LoginDialog","propertyNode","props_closeBtu","props_toggleContainer","props_switchPanel","props_togglePhoneAreaNum_phone","props_ScrollView_areaNum_phone","props_intput_phone_areaNum_phone","props_intput_phone_phoneNum_phone","props_intput_phone_captcha","props_btn_send_vercode","props_btn_login_phone","props_togglePhoneAreaNum_pwd","props_ScrollView_areaNum_pwd","props_intput_phone_areaNum_pwd","props_intput_phone_phoneNum_pwd","props_input_password","props_btn_setPassword","props_btn_login_pwd","props_intput_promotionCode","events","closeHandler","loginHandler","sendSmsHandler","phoneNumber","setPasswordHandler","loginDoneHandler","errorHandler","errorInfo","props","start","initState","showLoginType","PASSWORD","phoneLogin","areaCode","number","verCode","pwdLogin","password","bindEvent","on","EventType","TOUCH_END","node","EventHandler","list","checkIndex","toggleNode","scrollView","bgNode","parent","renderItem","record","templateBtu","getComponent","content","children","getChildByName","string","chooseItem","item","updateItemNode","isChoose","color","RED","BLACK","login","begin","isPhoneNumber","done","send","SEND_SMS","phone","then","rsp","catch","e","console","log","useProps","key","value","bindUI","useState","pre","cur","forEach","child","active","find","name","PHONE","loginData","state","authStr","promotionCode","callback","event","customEventData","playOneShot","BTU_CLICK","target","setState","update","deltaTime"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAASA,MAAAA,U,OAAAA,U;AAAoBC,MAAAA,K,OAAAA,K;AAAkBC,MAAAA,O,OAAAA,O;AAAuBC,MAAAA,W,OAAAA,W;AAAaC,MAAAA,K,OAAAA,K;AAAOC,MAAAA,I,OAAAA,I;AAAMC,MAAAA,U,OAAAA,U;;AACvFC,MAAAA,a,iBAAAA,a;;AACFC,MAAAA,e;;AAEEC,MAAAA,M,iBAAAA,M;;AACFC,MAAAA,c;;AACEC,MAAAA,U,iBAAAA,U;;AACAC,MAAAA,O,iBAAAA,O;AAASC,MAAAA,S,iBAAAA,S;;AACTC,MAAAA,e,iBAAAA,e;;;;;;;;;OACH;AAAEC,QAAAA,OAAF;AAAWC,QAAAA;AAAX,O,GAAwBhB,U;;2BAElBiB,S,0BAAAA,S;AAAAA,QAAAA,S,CAAAA,S;AAAAA,QAAAA,S,CAAAA,S;eAAAA,S;;;kCA4CCC,gB,WADZH,OAAO,CAAC,kBAAD,C,gBAAR,MACaG,gBADb;AAAA;AAAA,0CAC4E;AAAA;AAAA;AAAA,eAKjEC,YALiE,GAKlD;AACxB;AACAC,YAAAA,cAAc,EAAE,IAAIf,IAAJ,EAFQ;;AAGxB;AACAgB,YAAAA,qBAAqB,EAAE,IAAIhB,IAAJ,EAJC;;AAKxB;AACAiB,YAAAA,iBAAiB,EAAE,IAAIjB,IAAJ,EANK;;AAQxB;;AACA;AACAkB,YAAAA,8BAA8B,EAAE,IAAIlB,IAAJ,EAVR;;AAWxB;AACAmB,YAAAA,8BAA8B,EAAE,IAAInB,IAAJ,EAZR;;AAaxB;AACAoB,YAAAA,gCAAgC,EAAE,IAAIvB,OAAJ,EAdV;;AAexB;AACAwB,YAAAA,iCAAiC,EAAE,IAAIxB,OAAJ,EAhBX;;AAiBxB;AACAyB,YAAAA,0BAA0B,EAAE,IAAIzB,OAAJ,EAlBJ;;AAmBxB;AACA0B,YAAAA,sBAAsB,EAAE,IAAIvB,IAAJ,EApBA;;AAqBxB;AACAwB,YAAAA,qBAAqB,EAAE,IAAIxB,IAAJ,EAtBC;;AAwBxB;;AACA;AACAyB,YAAAA,4BAA4B,EAAE,IAAIzB,IAAJ,EA1BN;;AA2BxB;AACA0B,YAAAA,4BAA4B,EAAE,IAAI1B,IAAJ,EA5BN;;AA6BxB;AACA2B,YAAAA,8BAA8B,EAAE,IAAI9B,OAAJ,EA9BR;;AA+BxB;AACA+B,YAAAA,+BAA+B,EAAE,IAAI/B,OAAJ,EAhCT;;AAiCxB;AACAgC,YAAAA,oBAAoB,EAAE,IAAIhC,OAAJ,EAlCE;;AAmCxB;AACAiC,YAAAA,qBAAqB,EAAE,IAAI9B,IAAJ,EApCC;;AAqCxB;AACA+B,YAAAA,mBAAmB,EAAE,IAAI/B,IAAJ,EAtCG;;AAuCxB;AACAgC,YAAAA,0BAA0B,EAAE,IAAInC,OAAJ;AAxCJ,WALkD;AAAA,eAgDpEoC,MAhDoE,GAgDnD;AACvBC,YAAAA,YAAY,EAAE,MAAM,CAAG,CADA;AAEvBC,YAAAA,YAAY,EAAE,MAAM,CAAG,CAFA;AAGvBC,YAAAA,cAAc,EAAGC,WAAD,IAAyB,CAAG,CAHrB;AAIvBC,YAAAA,kBAAkB,EAAE,MAAM,CAAG,CAJN;AAKvBC,YAAAA,gBAAgB,EAAE,MAAM,CAAG,CALJ;AAMvBC,YAAAA,YAAY,EAAGC,SAAD,IAAuB,CAAG;AANjB,WAhDmD;AAAA,eAyDpEC,KAzDoE,GAyDpD,EAzDoD;AAAA;;AAC3EC,QAAAA,KAAK,GAAG,CAEP;;AAyDSC,QAAAA,SAAS,GAAG;AACrB,iBAAO;AACNC,YAAAA,aAAa,EAAEjC,SAAS,CAACkC,QADnB;AAENC,YAAAA,UAAU,EAAE;AACXC,cAAAA,QAAQ,EAAE,EADC;AAEXC,cAAAA,MAAM,EAAE,EAFG;AAGXC,cAAAA,OAAO,EAAE;AAHE,aAFN;AAONC,YAAAA,QAAQ,EAAE;AACTH,cAAAA,QAAQ,EAAE,EADD;AAETC,cAAAA,MAAM,EAAE,EAFC;AAGTG,cAAAA,QAAQ,EAAE;AAHD;AAPJ,WAAP;AAaA;;AAESC,QAAAA,SAAS,GAAS;AAC3B,eAAKvC,YAAL,CAAkBC,cAAlB,CAAiCuC,EAAjC,CAAoCtD,IAAI,CAACuD,SAAL,CAAeC,SAAnD,EAA8D,MAAM;AACnE,iBAAKvB,MAAL,CAAYC,YAAZ;AACA,WAFD,EAD2B,CAI3B;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AAAA;AAAA,wCAAW,KAAKpB,YAAL,CAAkBE,qBAA7B,EAAoD,KAAKyC,IAAzD,EAA+D,IAAI5C,gBAAgB,CAAC6C,YAArB,EAA/D,EAAoG,kBAApG,EAAwH,UAAxH,EAZ2B,CAc3B;;AACA;AAAA;AAAA,kDAAgB;AACfC,YAAAA,IAAI,EAAE,CAAC,KAAD,CADS;AAEfC,YAAAA,UAAU,EAAE;AAFG,WAAhB,EAGG;AACFC,YAAAA,UAAU,EAAE,KAAK/C,YAAL,CAAkBW,4BAD5B;AAEFqC,YAAAA,UAAU,EAAE,KAAKhD,YAAL,CAAkBY,4BAF5B;AAGFqC,YAAAA,MAAM,EAAE,KAAKN,IAAL,CAAUO;AAHhB,WAHH,EAOG;AACFC,YAAAA,UAAU,EAAGC,MAAD,IAAY;AACvB,kBAAMC,WAAiB,GAAGrE,WAAW,CAAC,KAAKgB,YAAL,CAAkBY,4BAAlB,CAA+C0C,YAA/C,CAA4DnE,UAA5D,EAAwEoE,OAAxE,CAAgFC,QAAhF,CAAyF,CAAzF,CAAD,CAArC;AACAH,cAAAA,WAAW,CAACI,cAAZ,CAA2B,OAA3B,EAAoCH,YAApC,CAAiDrE,KAAjD,EAAwDyE,MAAxD,GAAiEN,MAAjE;AACA,qBAAOC,WAAP;AACA,aALC;AAMFM,YAAAA,UAAU,EAAE,QAAc;AAAA,kBAAb;AAAEC,gBAAAA;AAAF,eAAa;AACzB,mBAAK5D,YAAL,CAAkBa,8BAAlB,CAAiD6C,MAAjD,GAA0DE,IAA1D,CADyB,CAEzB;AACA,aATC;AAUFC,YAAAA,cAAc,EAAE,CAAClB,IAAD,EAAOmB,QAAP,KAAoB;AACnCnB,cAAAA,IAAI,CAACc,cAAL,CAAoB,OAApB,EAA6BH,YAA7B,CAA0CrE,KAA1C,EAAiD8E,KAAjD,GAAyDD,QAAQ,GAAGhF,KAAK,CAACkF,GAAT,GAAelF,KAAK,CAACmF,KAAtF;AACA;AAZC,WAPH;AAsBA;AAAA;AAAA,kDAAgB;AACfpB,YAAAA,IAAI,EAAE,CAAC,KAAD,CADS;AAEfC,YAAAA,UAAU,EAAE;AAFG,WAAhB,EAGG;AACFC,YAAAA,UAAU,EAAE,KAAK/C,YAAL,CAAkBI,8BAD5B;AAEF4C,YAAAA,UAAU,EAAE,KAAKhD,YAAL,CAAkBK,8BAF5B;AAGF4C,YAAAA,MAAM,EAAE,KAAKN,IAAL,CAAUO;AAHhB,WAHH,EAOG;AACFC,YAAAA,UAAU,EAAGC,MAAD,IAAY;AACvB,kBAAMC,WAAiB,GAAGrE,WAAW,CAAC,KAAKgB,YAAL,CAAkBK,8BAAlB,CAAiDiD,YAAjD,CAA8DnE,UAA9D,EAA0EoE,OAA1E,CAAkFC,QAAlF,CAA2F,CAA3F,CAAD,CAArC;AACAH,cAAAA,WAAW,CAACI,cAAZ,CAA2B,OAA3B,EAAoCH,YAApC,CAAiDrE,KAAjD,EAAwDyE,MAAxD,GAAiEN,MAAjE;AACA,qBAAOC,WAAP;AACA,aALC;AAMFM,YAAAA,UAAU,EAAE,SAAc;AAAA,kBAAb;AAAEC,gBAAAA;AAAF,eAAa;AACzB,mBAAK5D,YAAL,CAAkBM,gCAAlB,CAAmDoD,MAAnD,GAA4DE,IAA5D,CADyB,CAEzB;AACA,aATC;AAUFC,YAAAA,cAAc,EAAE,CAAClB,IAAD,EAAOmB,QAAP,KAAoB;AACnCnB,cAAAA,IAAI,CAACc,cAAL,CAAoB,OAApB,EAA6BH,YAA7B,CAA0CrE,KAA1C,EAAiD8E,KAAjD,GAAyDD,QAAQ,GAAGhF,KAAK,CAACkF,GAAT,GAAelF,KAAK,CAACmF,KAAtF;AACA;AAZC,WAPH;AAqBA,eAAKjE,YAAL,CAAkBU,qBAAlB,CAAwC8B,EAAxC,CAA2CtD,IAAI,CAACuD,SAAL,CAAeC,SAA1D,EAAqE,MAAM,KAAKwB,KAAL,EAA3E;AACA,eAAKlE,YAAL,CAAkBiB,mBAAlB,CAAsCuB,EAAtC,CAAyCtD,IAAI,CAACuD,SAAL,CAAeC,SAAxD,EAAmE,MAAM,KAAKwB,KAAL,EAAzE;AAEA,eAAKlE,YAAL,CAAkBS,sBAAlB,CAAyC+B,EAAzC,CAA4CtD,IAAI,CAACuD,SAAL,CAAeC,SAA3D,EAAsE,MAAM;AAC3E,gBAAMnB,WAAW,GAAG,KAAKvB,YAAL,CAAkBO,iCAAlB,CAAoDmD,MAAxE;AACA;AAAA;AAAA,oDAAqBS,KAArB,GAA6BC,aAA7B,CAA2C7C,WAA3C,EAAwD8C,IAAxD,CAA6D,MAAM;AAClE;AAAA;AAAA,sCAAQC,IAAR,CAAa;AAAA;AAAA,oCAAOC,QAApB,EAA8B;AAAEC,gBAAAA,KAAK,EAAEjD;AAAT,eAA9B,EAAsDkD,IAAtD,CAA4DC,GAAD,IAAS;AACnE,qBAAKvD,MAAL,CAAYG,cAAZ,CAA2BC,WAA3B;AACA,qBAAKvB,YAAL,CAAkBQ,0BAAlB,CAA6CkD,MAA7C,GAAsDgB,GAAtD;AACA,eAHD,EAGGC,KAHH,CAGUC,CAAD,IAAO;AACf,qBAAKzD,MAAL,CAAYO,YAAZ,CAAyBkD,CAAzB;AACAC,gBAAAA,OAAO,CAACC,GAAR,CAAYF,CAAZ;AACA,eAND;AAOA,aARD;AASA,WAXD;AAYA,eAAK5E,YAAL,CAAkBgB,qBAAlB,CAAwCwB,EAAxC,CAA2CtD,IAAI,CAACuD,SAAL,CAAeC,SAA1D,EAAqE,MAAM,KAAKvB,MAAL,CAAYK,kBAAZ,EAA3E;AACA;;AAISuD,QAAAA,QAAQ,CAACC,GAAD,EAAoBC,KAApB,EAA2E;AAC5F;AACA;AACA;;AAESC,QAAAA,MAAM,GAAS;AACxB,eAAKC,QAAL,CAAc,CAACH,GAAD,YAAuB;AAAA,gBAAjB;AAAEI,cAAAA,GAAF;AAAOC,cAAAA;AAAP,aAAiB;AACpC,iBAAKrF,YAAL,CAAkBG,iBAAlB,CAAoCqD,QAApC,CAA6C8B,OAA7C,CAAqDC,KAAK,IAAIA,KAAK,CAACC,MAAN,GAAe,KAA7E;;AACA,gBAAIH,GAAG,KAAKvF,SAAS,CAACkC,QAAtB,EAAgC;AAC/B,mBAAKhC,YAAL,CAAkBG,iBAAlB,CAAoCqD,QAApC,CAA6CiC,IAA7C,CAAkDF,KAAK,IAAIA,KAAK,CAACG,IAAN,KAAe,gBAA1E,EAA4FF,MAA5F,GAAqG,IAArG;AACA,aAFD,MAEO,IAAIH,GAAG,KAAKvF,SAAS,CAAC6F,KAAtB,EAA6B;AACnC,mBAAK3F,YAAL,CAAkBG,iBAAlB,CAAoCqD,QAApC,CAA6CiC,IAA7C,CAAkDF,KAAK,IAAIA,KAAK,CAACG,IAAN,KAAe,aAA1E,EAAyFF,MAAzF,GAAkG,IAAlG;AACA;AACD,WAPD,EAOG,CAAC,eAAD,CAPH;AAQA;;AAEOtB,QAAAA,KAAK,GAAG;AACf,cAAM0B,SAAS,GAAG,KAAKC,KAAL,CAAW9D,aAAX,KAA6BjC,SAAS,CAACkC,QAAvC,GAAkD;AACnEE,YAAAA,QAAQ,EAAE,KAAKlC,YAAL,CAAkBa,8BAAlB,CAAiD6C,MADQ;AAEnEvB,YAAAA,MAAM,EAAE,KAAKnC,YAAL,CAAkBc,+BAAlB,CAAkD4C,MAFS;AAGnEoC,YAAAA,OAAO,EAAE,KAAK9F,YAAL,CAAkBe,oBAAlB,CAAuC2C,MAHmB;AAInEqC,YAAAA,aAAa,EAAE,KAAK/F,YAAL,CAAkBkB,0BAAlB,CAA6CwC;AAJO,WAAlD,GAKd;AACHxB,YAAAA,QAAQ,EAAE,KAAKlC,YAAL,CAAkBM,gCAAlB,CAAmDoD,MAD1D;AAEHvB,YAAAA,MAAM,EAAE,KAAKnC,YAAL,CAAkBO,iCAAlB,CAAoDmD,MAFzD;AAGHoC,YAAAA,OAAO,EAAE,KAAK9F,YAAL,CAAkBQ,0BAAlB,CAA6CkD,MAHnD;AAIHqC,YAAAA,aAAa,EAAE,KAAK/F,YAAL,CAAkBkB,0BAAlB,CAA6CwC;AAJzD,WALJ;AAWA,eAAKvC,MAAL,CAAYE,YAAZ,CAAyB,KAAKwE,KAAL,CAAW9D,aAApC,EAAmD6D,SAAnD;AACA;;AAEDI,QAAAA,QAAQ,CAACC,KAAD,EAAeC,eAAf,EAAwC;AAC/C;AAAA;AAAA,sCAAUC,WAAV,CAAsB;AAAA;AAAA,kDAAgBC,SAAtC;;AACA,kBAAQH,KAAK,CAACI,MAAN,CAAa,MAAb,CAAR;AACC,iBAAK,cAAL;AACC;AACA,mBAAKC,QAAL,CAAc;AAAEvE,gBAAAA,aAAa,EAAEjC,SAAS,CAAC6F;AAA3B,eAAd;AACA;;AACD,iBAAK,iBAAL;AACC;AACA,mBAAKW,QAAL,CAAc;AAAEvE,gBAAAA,aAAa,EAAEjC,SAAS,CAACkC;AAA3B,eAAd;AACA;AARF;AAUA;;AACDuE,QAAAA,MAAM,CAACC,SAAD,EAAoB,CAEzB;;AAxM0E,O","sourcesContent":["import { _decorator, Button, Color, Component, EditBox, EventHandler, instantiate, Label, Node, ScrollView, Toggle, ToggleContainer } from 'cc';\r\nimport { BaseComponent } from '../../base/BaseComponent';\r\nimport initDropDownBox from '../../utils/DropDownBox';\r\nimport Fetcher from '../../utils/Fetcher';\r\nimport { ApiUrl } from '../apiUrl';\r\nimport InputValidator from '../../utils/InputValidator';\r\nimport { initToggle } from '../../utils/tool';\r\nimport { fetcher, hallAudio } from '../index';\r\nimport { SoundPathDefine } from '../sourceDefine/soundDefine';\r\nconst { ccclass, property } = _decorator;\r\n\r\nexport enum LoginType {\r\n\tPHONE = 1,\r\n\tPASSWORD = 4\r\n}\r\n\r\nexport interface IState {\r\n\tshowLoginType: LoginType,\r\n\tphoneLogin: {\r\n\t\tareaCode: string,\r\n\t\tnumber: string,\r\n\t\tverCode: string,\r\n\t},\r\n\tpwdLogin: {\r\n\t\tareaCode: string,\r\n\t\tnumber: string,\r\n\t\tpassword: string\r\n\t}\r\n}\r\n\r\nexport interface IProps {\r\n\r\n}\r\n\r\nexport interface IEvent {\r\n\t/**关闭窗口回调 */\r\n\tcloseHandler?: () => void\r\n\t/**登录回调 */\r\n\tloginHandler?: (showLoginType: LoginType, loginData: {\r\n\t\tareaCode: string,\r\n\t\tnumber: string,\r\n\t\tauthStr: string,\r\n\t\tpromotionCode: string\r\n\t}) => void,\r\n\t/**发送验证码回调 */\r\n\tsendSmsHandler?: (phoneNumber: string) => void\r\n\t/**重设密码回调 */\r\n\tsetPasswordHandler?: () => void\r\n\t/**登录完成后的回调 */\r\n\tloginDoneHandler?: () => void\r\n\t/**错误输入回调 */\r\n\terrorHandler: (errorInfo: string) => void\r\n}\r\n\r\n@ccclass('Hall_LoginDialog')\r\nexport class Hall_LoginDialog extends BaseComponent<IState, IProps, IEvent> {\r\n\tstart() {\r\n\r\n\t}\r\n\r\n\tprotected propertyNode = {\r\n\t\t/**关闭节点 */\r\n\t\tprops_closeBtu: new Node(),\r\n\t\t/**头部两个tab触发器的容器节点 */\r\n\t\tprops_toggleContainer: new Node(),\r\n\t\t/**tab的内容切换容器节点 */\r\n\t\tprops_switchPanel: new Node(),\r\n\r\n\t\t/**手机验证码登录框组 */\r\n\t\t/**验证码登录模式的手机区号触发器 */\r\n\t\tprops_togglePhoneAreaNum_phone: new Node(),\r\n\t\t/**验证码登录模式的手机区号下拉框展示板 */\r\n\t\tprops_ScrollView_areaNum_phone: new Node(),\r\n\t\t/**验证码登录模式的手机区号输入框 */\r\n\t\tprops_intput_phone_areaNum_phone: new EditBox(),\r\n\t\t/**验证码登录模式的手机号码输入框 */\r\n\t\tprops_intput_phone_phoneNum_phone: new EditBox(),\r\n\t\t/**验证码登录模式的手机验证码输入框 */\r\n\t\tprops_intput_phone_captcha: new EditBox(),\r\n\t\t/**验证码登录模式的验证码发送按钮 */\r\n\t\tprops_btn_send_vercode: new Node(),\r\n\t\t/**密码登录模式的登录按钮 */\r\n\t\tprops_btn_login_phone: new Node(),\r\n\r\n\t\t/**密码登录框组 */\r\n\t\t/**密码登录模式的手机区号触发器 */\r\n\t\tprops_togglePhoneAreaNum_pwd: new Node(),\r\n\t\t/**密码登录模式的手机区号下拉框展示板 */\r\n\t\tprops_ScrollView_areaNum_pwd: new Node(),\r\n\t\t/**密码登录模式的手机区号输入框 */\r\n\t\tprops_intput_phone_areaNum_pwd: new EditBox(),\r\n\t\t/**密码登录模式的手机号码输入框 */\r\n\t\tprops_intput_phone_phoneNum_pwd: new EditBox(),\r\n\t\t/**密码登录模式的手机验证码输入框 */\r\n\t\tprops_input_password: new EditBox(),\r\n\t\t/**密码登录模式的验证码发送按钮 */\r\n\t\tprops_btn_setPassword: new Node(),\r\n\t\t/**密码登录模式的登录按钮 */\r\n\t\tprops_btn_login_pwd: new Node(),\r\n\t\t/**推荐码 */\r\n\t\tprops_intput_promotionCode: new EditBox()\r\n\t}\r\n\r\n\tpublic events: IEvent = {\r\n\t\tcloseHandler: () => { },\r\n\t\tloginHandler: () => { },\r\n\t\tsendSmsHandler: (phoneNumber: string) => { },\r\n\t\tsetPasswordHandler: () => { },\r\n\t\tloginDoneHandler: () => { },\r\n\t\terrorHandler: (errorInfo: string) => { }\r\n\t}\r\n\r\n\tpublic props: IProps = {\r\n\r\n\t}\r\n\tprotected initState() {\r\n\t\treturn {\r\n\t\t\tshowLoginType: LoginType.PASSWORD,\r\n\t\t\tphoneLogin: {\r\n\t\t\t\tareaCode: \"\",\r\n\t\t\t\tnumber: \"\",\r\n\t\t\t\tverCode: \"\",\r\n\t\t\t},\r\n\t\t\tpwdLogin: {\r\n\t\t\t\tareaCode: \"\",\r\n\t\t\t\tnumber: \"\",\r\n\t\t\t\tpassword: \"\"\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tprotected bindEvent(): void {\r\n\t\tthis.propertyNode.props_closeBtu.on(Node.EventType.TOUCH_END, () => {\r\n\t\t\tthis.events.closeHandler()\r\n\t\t})\r\n\t\t// const container = this.propertyNode.props_toggleContainer.getComponent(ToggleContainer)\r\n\t\t// const containerEventHandler = new EventHandler();\r\n\t\t// containerEventHandler.target = this.node;\r\n\t\t// containerEventHandler.component = 'Hall_LoginDialog';\r\n\t\t// containerEventHandler.handler = 'callback';\r\n\t\t// // containerEventHandler.customEventData = 'switchLoginType';\r\n\t\t// container.checkEvents.push(containerEventHandler);\r\n\r\n\t\tinitToggle(this.propertyNode.props_toggleContainer, this.node, new Hall_LoginDialog.EventHandler(), \"Hall_LoginDialog\", \"callback\")\r\n\r\n\t\t//初始化下拉框\r\n\t\tinitDropDownBox({\r\n\t\t\tlist: ['+62'],\r\n\t\t\tcheckIndex: 0\r\n\t\t}, {\r\n\t\t\ttoggleNode: this.propertyNode.props_togglePhoneAreaNum_pwd,\r\n\t\t\tscrollView: this.propertyNode.props_ScrollView_areaNum_pwd,\r\n\t\t\tbgNode: this.node.parent\r\n\t\t}, {\r\n\t\t\trenderItem: (record) => {\r\n\t\t\t\tconst templateBtu: Node = instantiate(this.propertyNode.props_ScrollView_areaNum_pwd.getComponent(ScrollView).content.children[0])\r\n\t\t\t\ttemplateBtu.getChildByName(\"Label\").getComponent(Label).string = record\r\n\t\t\t\treturn templateBtu\r\n\t\t\t},\r\n\t\t\tchooseItem: ({ item }) => {\r\n\t\t\t\tthis.propertyNode.props_intput_phone_areaNum_pwd.string = item\r\n\t\t\t\t// this.setState({ pwdLogin: Object.assign({}, this.state.pwdLogin, { areaCode: item }) })\r\n\t\t\t},\r\n\t\t\tupdateItemNode: (node, isChoose) => {\r\n\t\t\t\tnode.getChildByName(\"Label\").getComponent(Label).color = isChoose ? Color.RED : Color.BLACK\r\n\t\t\t}\r\n\t\t})\r\n\r\n\t\tinitDropDownBox({\r\n\t\t\tlist: ['+62'],\r\n\t\t\tcheckIndex: 0\r\n\t\t}, {\r\n\t\t\ttoggleNode: this.propertyNode.props_togglePhoneAreaNum_phone,\r\n\t\t\tscrollView: this.propertyNode.props_ScrollView_areaNum_phone,\r\n\t\t\tbgNode: this.node.parent\r\n\t\t}, {\r\n\t\t\trenderItem: (record) => {\r\n\t\t\t\tconst templateBtu: Node = instantiate(this.propertyNode.props_ScrollView_areaNum_phone.getComponent(ScrollView).content.children[0])\r\n\t\t\t\ttemplateBtu.getChildByName(\"Label\").getComponent(Label).string = record\r\n\t\t\t\treturn templateBtu\r\n\t\t\t},\r\n\t\t\tchooseItem: ({ item }) => {\r\n\t\t\t\tthis.propertyNode.props_intput_phone_areaNum_phone.string = item\r\n\t\t\t\t// this.setState({ phoneLogin: Object.assign({}, this.state.phoneLogin, { areaCode: item }) })\r\n\t\t\t},\r\n\t\t\tupdateItemNode: (node, isChoose) => {\r\n\t\t\t\tnode.getChildByName(\"Label\").getComponent(Label).color = isChoose ? Color.RED : Color.BLACK\r\n\t\t\t}\r\n\t\t})\r\n\t\tthis.propertyNode.props_btn_login_phone.on(Node.EventType.TOUCH_END, () => this.login())\r\n\t\tthis.propertyNode.props_btn_login_pwd.on(Node.EventType.TOUCH_END, () => this.login())\r\n\r\n\t\tthis.propertyNode.props_btn_send_vercode.on(Node.EventType.TOUCH_END, () => {\r\n\t\t\tconst phoneNumber = this.propertyNode.props_intput_phone_phoneNum_phone.string\r\n\t\t\tnew InputValidator().begin().isPhoneNumber(phoneNumber).done(() => {\r\n\t\t\t\tfetcher.send(ApiUrl.SEND_SMS, { phone: phoneNumber }).then((rsp) => {\r\n\t\t\t\t\tthis.events.sendSmsHandler(phoneNumber)\r\n\t\t\t\t\tthis.propertyNode.props_intput_phone_captcha.string = rsp\r\n\t\t\t\t}).catch((e) => {\r\n\t\t\t\t\tthis.events.errorHandler(e)\r\n\t\t\t\t\tconsole.log(e)\r\n\t\t\t\t})\r\n\t\t\t})\r\n\t\t})\r\n\t\tthis.propertyNode.props_btn_setPassword.on(Node.EventType.TOUCH_END, () => this.events.setPasswordHandler())\r\n\t}\r\n\r\n\r\n\r\n\tprotected useProps(key: keyof IProps, value: { pre: Partial<IState>, cur: Partial<IState> }) {\r\n\t\t/**传入的props变更触发的函数 */\r\n\t\t// console.log(key, \"change\", value.cur)\r\n\t}\r\n\r\n\tprotected bindUI(): void {\r\n\t\tthis.useState((key, { pre, cur }) => {\r\n\t\t\tthis.propertyNode.props_switchPanel.children.forEach(child => child.active = false)\r\n\t\t\tif (cur === LoginType.PASSWORD) {\r\n\t\t\t\tthis.propertyNode.props_switchPanel.children.find(child => child.name === 'login_password').active = true\r\n\t\t\t} else if (cur === LoginType.PHONE) {\r\n\t\t\t\tthis.propertyNode.props_switchPanel.children.find(child => child.name === 'login_phone').active = true\r\n\t\t\t}\r\n\t\t}, ['showLoginType'])\r\n\t}\r\n\r\n\tprivate login() {\r\n\t\tconst loginData = this.state.showLoginType === LoginType.PASSWORD ? {\r\n\t\t\tareaCode: this.propertyNode.props_intput_phone_areaNum_pwd.string,\r\n\t\t\tnumber: this.propertyNode.props_intput_phone_phoneNum_pwd.string,\r\n\t\t\tauthStr: this.propertyNode.props_input_password.string,\r\n\t\t\tpromotionCode: this.propertyNode.props_intput_promotionCode.string\r\n\t\t} : {\r\n\t\t\tareaCode: this.propertyNode.props_intput_phone_areaNum_phone.string,\r\n\t\t\tnumber: this.propertyNode.props_intput_phone_phoneNum_phone.string,\r\n\t\t\tauthStr: this.propertyNode.props_intput_phone_captcha.string,\r\n\t\t\tpromotionCode: this.propertyNode.props_intput_promotionCode.string\r\n\t\t}\r\n\t\tthis.events.loginHandler(this.state.showLoginType, loginData)\r\n\t}\r\n\r\n\tcallback(event: Event, customEventData: string) {\r\n\t\thallAudio.playOneShot(SoundPathDefine.BTU_CLICK)\r\n\t\tswitch (event.target[\"name\"]) {\r\n\t\t\tcase \"Toggle_phone\":\r\n\t\t\t\t//显示手机登录\r\n\t\t\t\tthis.setState({ showLoginType: LoginType.PHONE })\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"Toggle_password\":\r\n\t\t\t\t//显示密码登录\r\n\t\t\t\tthis.setState({ showLoginType: LoginType.PASSWORD })\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\t}\r\n\tupdate(deltaTime: number) {\r\n\r\n\t}\r\n}\r\n\r\n"]}