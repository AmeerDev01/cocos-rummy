{"version":3,"sources":["file:///Users/geliang/web/dibai/hall/assets/script/hall/components/Hall_AppDownLoadGuide.ts"],"names":["_decorator","Button","Node","sys","tween","UITransform","Vec3","BaseComponent","config","getPackageName","getNodePositionInCanvas","ccclass","property","Hall_AppDownLoadGuide","propertyNode","props_blockBg","props_spr_guide_bg","props_downLoad_btu","props_btn_off","props_btn_download","props","events","preGoToDownLoad","start","initState","bindEvent","node","on","EventType","TOUCH_END","downLoadPanelTroggle","gotoDownload","useProps","key","value","bindUI","isShow","targetNodePosition","x","y","z","position","downLoadBtuTroggle","to","scale","call","active","getComponent","width","openUrl","openURL","os","OS","IOS","appleAppDumpUrl","appDumpUrl","update","deltaTime"],"mappings":"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","sourcesContent":["import { _decorator, Button, Component, Node, sys, tween, UITransform, Vec3 } from 'cc';\r\nimport { BaseComponent } from '../../base/BaseComponent';\r\nimport { config } from '../config';\r\nimport { getPackageName } from '../../common/bridge';\r\nimport { getNodePositionInCanvas } from '../../utils/tool';\r\nimport { hallAudio } from '../index';\r\nimport { SoundPathDefine } from '../sourceDefine/soundDefine';\r\nconst { ccclass, property } = _decorator;\r\n\r\nexport interface IState {\r\n\r\n}\r\nexport interface IProps {\r\n}\r\nexport interface IEvent {\r\n\t/**打开链接前要做的事情，return打开的地址，返回空字符则按照默认链接打开 */\r\n\tpreGoToDownLoad: () => string\r\n}\r\n@ccclass('Hall_AppDownLoadGuide')\r\nexport class Hall_AppDownLoadGuide extends BaseComponent<IState, IProps, IEvent> {\r\n\tstart() { }\r\n\r\n\tprotected propertyNode = {\r\n\t\tprops_blockBg: new Node(),\r\n\t\tprops_spr_guide_bg: new Node(),\r\n\t\tprops_downLoad_btu: new Button(),\r\n\t\tprops_btn_off: new Button(),\r\n\t\tprops_btn_download: new Button()\r\n\t}\r\n\r\n\tpublic props: IProps = {\r\n\t}\r\n\r\n\tpublic events: IEvent = {\r\n\t\tpreGoToDownLoad: () => \"\"\r\n\t}\r\n\r\n\tprotected initState() {\r\n\t\treturn {}\r\n\t}\r\n\r\n\tprotected bindEvent(): void {\r\n\t\tthis.propertyNode.props_btn_off.node.on(Node.EventType.TOUCH_END, () => {\r\n\t\t\tthis.downLoadPanelTroggle(false)\r\n\t\t})\r\n\t\tthis.propertyNode.props_btn_download.node.on(Node.EventType.TOUCH_END, () => {\r\n\t\t\tthis.gotoDownload()\r\n\t\t})\r\n\t\tthis.propertyNode.props_downLoad_btu.node.on(Node.EventType.TOUCH_END, () => {\r\n\t\t\tthis.downLoadPanelTroggle(true)\r\n\t\t})\r\n\t}\r\n\r\n\tprotected useProps(key: keyof IProps, value: { pre: any, cur: any }) {\r\n\r\n\t}\r\n\r\n\tprotected bindUI(): void {\r\n\t\t// const isGuide = (sys.os === sys.OS.ANDROID && getPackageName() === 'web') || (sys.os === sys.OS.IOS && !window.navigator['standalone']) || sys.os === sys.OS.OSX || sys.os === sys.OS.WINDOWS\r\n\t\t// this.propertyNode.props_downLoad_btu.node.active = isGuide\r\n\t\t// this.propertyNode.props_blockBg.active = isGuide\r\n\t}\r\n\tprivate downLoadPanelTroggle(isShow: boolean) {\r\n\t\tif (!isShow) {\r\n\t\t\tconst targetNodePosition = getNodePositionInCanvas(this.propertyNode.props_downLoad_btu.node)\r\n\t\t\tconst { x, y, z } = this.propertyNode.props_spr_guide_bg.position\r\n\t\t\tthis.downLoadBtuTroggle(true)\r\n\t\t\ttween(this.propertyNode.props_spr_guide_bg).to(0.2, { position: targetNodePosition, scale: new Vec3(0, 0, 0) }).call(() => {\r\n\t\t\t\tthis.propertyNode.props_blockBg.active = false\r\n\t\t\t}).start()\r\n\t\t} else {\r\n\t\t\tthis.downLoadBtuTroggle(false)\r\n\t\t\tthis.propertyNode.props_blockBg.active = true\r\n\t\t\ttween(this.propertyNode.props_spr_guide_bg).to(0.2, { position: new Vec3(0, 0, 0), scale: new Vec3(1, 1, 1) }).start()\r\n\t\t}\r\n\t}\r\n\tprivate downLoadBtuTroggle(isShow: boolean) {\r\n\t\tconst { x, y, z } = this.propertyNode.props_downLoad_btu.node.position\r\n\t\tif (isShow) {\r\n\t\t\ttween(this.propertyNode.props_downLoad_btu.node).to(0.3, { position: new Vec3(x + this.propertyNode.props_downLoad_btu.node.getComponent(UITransform).width, y, z) }).start()\r\n\t\t} else {\r\n\t\t\ttween(this.propertyNode.props_downLoad_btu.node).to(0.3, { position: new Vec3(x - this.propertyNode.props_downLoad_btu.node.getComponent(UITransform).width, y, z) }).start()\r\n\t\t}\r\n\t}\r\n\tprivate gotoDownload() {\r\n\t\tconst openUrl = this.events.preGoToDownLoad()\r\n\t\tsys.openURL(openUrl || (sys.os === sys.OS.IOS ? config.appleAppDumpUrl : `${config.appDumpUrl}?pkgId=` + getPackageName()))\r\n\t}\r\n\tupdate(deltaTime: number) {\r\n\r\n\t}\r\n}\r\n\r\n"]}