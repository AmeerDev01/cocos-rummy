{"version":3,"sources":["file:///Users/geliang/web/dibai/hall/assets/script/subGame/dragonV2/components/DragonV2Icon.ts"],"names":["DragonV2Icon","UITransform","Vec3","instantiate","sp","Sprite","Label","sourceManageSeletor","PrefabPathDefine","getNodeByNameDeep","IconId","config","SkeletonAnimationPlayer","SpriteFramePathDefine","SkeletalPathDefine","constructor","iconConfig","isPoolObject","node","faceNode","faceAnimationNode","skeleton","sprite","use","iconIndex","borderNode","borderNode2","amountNode","callback","getFile","ICON","source","getComponent","width","normalRollOption","singleRollerWidth","height","singleRollerHeight","Skeleton","active","removeFromParent","id","BEETLE","getChildByName","string","Math","ceil","random","listenerSkeletonEvent","buildIcon","setCompleteListener","isValid","hideWin","pauseWin","clearTracks","changeIcon","bl","spriteFrame","baicai1","skeletonData","baicai","resetIcon","parentNode","addChild","setScale","scale","getId","restore","toFixed","destory","getNode","getHeight","getIconIndex","setPosition","value","getPosition","skeletonName","fileName","playWin","isBorder","loop","offset","distance","setWorldPosition","worldPosition","clone","add","parent","setAnimation","animationArr","playAnimation","playBaoHeAnimation","done","setSiblingIndex","children","length","playGame2BaoHeAnimation","clearTrack","isUse","setAmount","amount","formatAmountWithLetter","formatAmountWithCommas","showBg","hideBg","getAmountNode","destroy"],"mappings":"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","sourcesContent":["import { Node, UITransform, Vec3, instantiate, sp, Sprite, Label } from \"cc\";\r\nimport { sourceManageSeletor } from \"../index\";\r\nimport { PrefabPathDefine } from \"../sourceDefine/prefabDefine\";\r\nimport { getNodeByNameDeep } from \"../../../utils/tool\";\r\nimport { IconId } from \"../type\";\r\nimport config from \"../config\";\r\nimport SkeletonAnimationPlayer from \"../../../utils/SkeletonPlay\";\r\nimport { SpriteFramePathDefine } from \"../sourceDefine/spriteDefine\";\r\nimport { SkeletalPathDefine } from \"../sourceDefine/skeletalDefine\";\r\nexport class DragonV2Icon {\r\n  private node: Node;\r\n  private faceNode: Node;\r\n  public faceAnimationNode: Node;\r\n  private iconConfig;\r\n  private skeleton: sp.Skeleton;\r\n  private sprite: Sprite\r\n  private use = false;\r\n  private iconIndex = 0;\r\n\r\n  private borderNode: Node;\r\n  public borderNode2: Node;\r\n\r\n  public amountNode: Node;\r\n  // public Particle2DNode: Node;\r\n\r\n  private isPoolObject = true;\r\n  private callback;\r\n\r\n\r\n  constructor(iconConfig, isPoolObject: boolean = true) {\r\n    this.iconConfig = iconConfig;\r\n    this.isPoolObject = isPoolObject;\r\n    this.node = instantiate(sourceManageSeletor().getFile(PrefabPathDefine.ICON).source);\r\n    this.node.getComponent(UITransform).width = config.normalRollOption.singleRollerWidth;\r\n    this.node.getComponent(UITransform).height = config.normalRollOption.singleRollerHeight;\r\n\r\n    this.faceNode = getNodeByNameDeep(\"face\", this.node);\r\n    this.faceAnimationNode = getNodeByNameDeep(\"face-animation\", this.node);\r\n\r\n    this.sprite = this.faceNode.getComponent(Sprite);\r\n    this.skeleton = this.faceAnimationNode.getComponent(sp.Skeleton);\r\n\r\n    this.borderNode = getNodeByNameDeep(\"focusBorder\", this.node);\r\n    this.borderNode.active = false;\r\n    this.borderNode.removeFromParent();\r\n\r\n    // this.borderNode2 = getNodeByNameDeep(\"focusBorder2\", this.node);\r\n    // this.borderNode2.active = true;\r\n    // this.borderNode2.removeFromParent();\r\n    \r\n    if (this.iconConfig.id === IconId.BEETLE) {\r\n      this.amountNode = getNodeByNameDeep(\"amount\", this.node);\r\n      this.amountNode.active = true;\r\n      // this.Particle2DNode = this.amountNode.getChildByName(\"props_Particle\");\r\n      this.amountNode.getChildByName(\"label_number\").getComponent(Label).string = Math.ceil((Math.random() * 100))  + '';\r\n      this.listenerSkeletonEvent();\r\n    }\r\n    this.buildIcon();\r\n  }\r\n\r\n  private listenerSkeletonEvent() {\r\n    this.skeleton.setCompleteListener(() => {\r\n      if (this.node && this.node.isValid && this.callback) {\r\n        this.callback && this.callback();\r\n        this.callback = null;\r\n        this.hideWin();\r\n      }\r\n    })\r\n  }\r\n  public pauseWin() {\r\n    this.borderNode.active = false;\r\n    this.skeleton.clearTracks()\r\n  }\r\n  changeIcon(bl){\r\n    if(bl){\r\n      this.sprite.spriteFrame = sourceManageSeletor().getFile(SpriteFramePathDefine.baicai1).source\r\n      this.skeleton.skeletonData =sourceManageSeletor().getFile(SkeletalPathDefine.baicai1).source\r\n    }else{\r\n      this.sprite.spriteFrame = sourceManageSeletor().getFile(SpriteFramePathDefine.baicai).source\r\n      this.skeleton.skeletonData = sourceManageSeletor().getFile(SkeletalPathDefine.baicai).source\r\n    }\r\n  }\r\n    /**获得图标 */\r\n  public resetIcon(iconConfig, parentNode?: Node, iconIndex?: number) {\r\n    this.use = true;\r\n    this.iconConfig = iconConfig;\r\n    this.iconIndex = iconIndex;\r\n    parentNode && parentNode.addChild(this.node);\r\n    this.node.setScale(iconConfig.scale[0], iconConfig.scale[1]);\r\n  }\r\n\r\n  public getId() {\r\n    return this.iconConfig.id;\r\n  }\r\n\r\n /**归还到缓存池 */\r\n public restore() {\r\n  this.use = false;\r\n  this.iconIndex = -1;\r\n  this.node.active = true;\r\n  this.node.removeFromParent();\r\n  if (this.node && this.node.isValid) {\r\n   this.amountNode && (this.amountNode.getChildByName(\"label_number\").getComponent(Label).string =  (Math.random() * 100).toFixed(0) + '');\r\n  if (this.iconConfig.id === IconId.BEETLE) {\r\n    this.amountNode.active = false;\r\n  }\r\n}\r\n  !this.isPoolObject && this.destory();\r\n}\r\n\r\npublic getNode() {\r\n  return this.node;\r\n}\r\n\r\npublic getHeight() {\r\n  return this.node.getComponent(UITransform).height;\r\n}\r\n\r\npublic getIconIndex() {\r\n  return this.iconIndex;\r\n}\r\n\r\npublic setPosition(value: Vec3) {\r\n  if (this.node) {\r\n    this.node.setPosition(value);\r\n  }\r\n}\r\n\r\npublic getPosition() {\r\n  return this.node.getPosition();\r\n}\r\n\r\nprivate buildIcon() {\r\n  this.faceAnimationNode.active = true;\r\n  this.faceAnimationNode.removeFromParent();\r\n  const skeletonData = sourceManageSeletor().getFile(this.iconConfig.skeletonName).source;\r\n  this.skeleton.skeletonData = skeletonData;\r\n  // this.skeleton.setAnimation(0, this.iconConfig.animationArr[0], false);\r\n  this.sprite.spriteFrame = sourceManageSeletor().getFile(this.iconConfig.fileName).source;\r\n\r\n}\r\n\r\n/**播放普通中奖 */\r\npublic playWin(parentNode: Node, isBorder: boolean = true, loop: boolean = true) {\r\n  const offset = new Vec3(this.iconConfig.distance[0], this.iconConfig.distance[1]);\r\n  this.faceAnimationNode.active = true;\r\n  parentNode.addChild(this.faceAnimationNode)\r\n  this.faceAnimationNode.setWorldPosition(this.node.worldPosition.clone().add(offset));\r\n  \r\n  if (isBorder && !this.borderNode.active) {\r\n    this.borderNode.active = true;\r\n    if (!this.borderNode.parent) {\r\n      parentNode.addChild(this.borderNode)\r\n      this.borderNode.setWorldPosition(this.node.worldPosition);\r\n    }\r\n  }\r\n  this.faceNode.active = false;\r\n  if(loop){\r\n    this.skeleton.setAnimation(0, this.iconConfig.animationArr[1], loop);\r\n  }else{ // 播放一次切换回图片\r\n    new SkeletonAnimationPlayer(this.skeleton, this.iconConfig.animationArr[1], false, () => {\r\n      this.faceNode.active = true;\r\n      this.faceAnimationNode.active = false;\r\n    }).playAnimation()\r\n  }\r\n}\r\n\r\n/**播放宝盒动画 */\r\npublic playBaoHeAnimation(done) {\r\n  this.callback = done;\r\n  this.faceAnimationNode.active = true;\r\n  this.node.addChild(this.faceAnimationNode);\r\n  this.faceAnimationNode.setWorldPosition(this.node.worldPosition);\r\n  this.faceNode.active = true;\r\n  this.amountNode.setSiblingIndex(this.node.children.length);\r\n  this.skeleton.setAnimation(0, this.iconConfig.animationArr[1], true);\r\n}\r\npublic playGame2BaoHeAnimation(done){\r\n  this.callback = done;\r\n}\r\n/**隐藏普通中奖 */\r\npublic hideWin() {\r\n  this.faceAnimationNode.active = false;\r\n  this.faceAnimationNode.removeFromParent();\r\n  this.borderNode.active = false;\r\n  this.skeleton.clearTrack(1)\r\n  this.borderNode.removeFromParent();\r\n  this.faceNode.active = true;\r\n}\r\n\r\n/**是否使用 */\r\npublic isUse() {\r\n  return this.use;\r\n}\r\n\r\npublic setAmount(amount) {\r\n  this.amountNode.getChildByName(\"label_number\").getComponent(Label).string = amount >= 10000 ? amount.formatAmountWithLetter() : amount.formatAmountWithCommas();\r\n}\r\n\r\npublic showBg() {\r\n  this.node.getChildByName(\"bg\").active = true;\r\n}\r\n\r\npublic hideBg() {\r\n  this.node.getChildByName(\"bg\").active = false;\r\n}\r\n\r\npublic getAmountNode() {\r\n  return this.amountNode;\r\n}\r\n\r\n// public getParticleNode() {\r\n//   return this.Particle2DNode;\r\n// }\r\n\r\npublic destory() {\r\n  this.node && this.node.isValid && this.node.destroy();\r\n  this.faceAnimationNode.destroy();\r\n  this.borderNode.destroy();\r\n  this.node = null;\r\n  this.iconConfig = null;\r\n  this.skeleton = null;\r\n}\r\n}"]}