{"version":3,"sources":["file:///Users/geliang/web/dibai/hall/assets/script/subGame/PHOENIX111/components/phoenix_header.ts"],"names":["_decorator","Label","Node","BaseComponent","global","lang","TaskScheduler","StepNumber","playBtnClick","addToastAction","sktInstance","ccclass","property","phoenix_headerComp","taskScheduler","stepNumber","propertyNode","props_btn_up_home","props_btn_up_set","props_Label_up_goldNum","props_btn_up_addGold","props_beli","props_SPECIAL","props","balance","isRollEnd","events","clearCacheData","start","initState","bindEvent","on","EventType","TOUCH_END","isConnect","closeSubGame","hallDispatch","content","write","k","palyingModule","GameExit","placeStr","openPersonCenter","openShop","useProps","key","value","console","log","pre","cur","stop","num","string","toFixed","formatAmountWithCommas","setFlyNode","node","parent","destroyCallBack","destoryQueue","bindUI","update","deltaTime"],"mappings":"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","sourcesContent":["import { _decorator, Component, Label, Node } from 'cc';\r\nimport { BaseComponent } from '../../../base/BaseComponent';\r\nimport { global, lang } from '../../../hall';\r\nimport TaskScheduler, { Task } from '../../../utils/TaskScheduler';\r\nimport StepNumber from '../../../utils/StepNumber';\r\nimport { playBtnClick } from '../index';\r\nimport { chooseSmallGame, rollerPanelViewModel } from '../viewModel/GameBoardViewModel';\r\nimport { addToastAction } from '../../../hall/store/actions/baseBoard';\r\nimport { sktInstance } from '../socketConnect';\r\nimport { EffectType } from '../../../utils/NodeIOEffect';\r\nconst { ccclass, property } = _decorator;\r\n\r\nexport interface IState {\r\n\r\n}\r\n\r\nexport interface IProps {\r\n\tbalance: number,\r\n\tisRollEnd:boolean,\r\n}\r\nexport interface IEvent {\r\n\tclearCacheData: () => void,\r\n}\r\n\r\n@ccclass('phoenix_headerComp')\r\nexport class phoenix_headerComp extends BaseComponent<IState, IProps, IEvent> {\r\n\tstart() { }\r\n\tprivate taskScheduler: TaskScheduler = new TaskScheduler()\r\n\tprivate stepNumber: StepNumber\r\n\tprotected propertyNode = {\r\n\t\tprops_btn_up_home: new Node(),\r\n\t\tprops_btn_up_set: new Node(),\r\n\t\tprops_Label_up_goldNum: new Label(),\r\n\t\tprops_btn_up_addGold: new Node(),\r\n\t\tprops_beli: new Node(),\r\n\t\tprops_SPECIAL: new Node()\r\n\t}\r\n\r\n\tpublic props: IProps = {\r\n\t\tbalance: 0,\r\n\t\tisRollEnd: true,\r\n\t}\r\n\r\n\tpublic events: IEvent = {\r\n\t\tclearCacheData: () => { },\r\n\t}\r\n\r\n\tprotected initState() {\r\n\t\treturn {\r\n\r\n\t\t}\r\n\t}\r\n\r\n\tprotected bindEvent(): void {\r\n\t\tthis.propertyNode.props_btn_up_home.on(Node.EventType.TOUCH_END, () => {\r\n\t\t\tplayBtnClick()\t\t\t\r\n\t\t\tif (this.props.isRollEnd || !sktInstance.isConnect) {\r\n\t\t\t\tthis.events.clearCacheData()\r\n\t\t\t\tglobal.closeSubGame()\r\n\t\t\t} else {\r\n\t\t\t\tglobal.hallDispatch(addToastAction({ content: lang.write(k => k.palyingModule.GameExit, {}, { placeStr: \"游戏中，请勿退出\" }) }))\r\n\t\t\t}\r\n\t\t})\r\n\t\tthis.propertyNode.props_btn_up_set.on(Node.EventType.TOUCH_END, () => {\r\n\t\t\tplayBtnClick()\r\n\t\t\tglobal.openPersonCenter(2)\r\n\t\t})\r\n\t\tthis.propertyNode.props_btn_up_addGold.on(Node.EventType.TOUCH_END, () => {\r\n\t\t\tplayBtnClick()\r\n\t\t\tglobal.openShop()\r\n\t\t})\r\n\t\tthis.propertyNode.props_beli.on(Node.EventType.TOUCH_END, () => {\r\n\t\t\tplayBtnClick()\r\n\t\t\tglobal.openShop()\r\n\t\t})\r\n\t\tthis.propertyNode.props_SPECIAL.on(Node.EventType.TOUCH_END, () => {\r\n\t\t\tplayBtnClick()\r\n\t\t\tglobal.openPersonCenter(5)\r\n\t\t})\r\n\t}\r\n\r\n\tprotected useProps(key: keyof IProps, value: { pre: any, cur: any }) {\r\n\t\tif (key === \"balance\") {\r\n\t\t\tconsole.log(\"value.pre, value.cur\",value.pre, value.cur);\r\n\t\t\tthis.stepNumber && this.stepNumber.stop()\r\n\t\t\tthis.stepNumber = new StepNumber(value.pre, value.cur, (num) => {\r\n\t\t\t\tthis.propertyNode && this.propertyNode.props_Label_up_goldNum && (this.propertyNode.props_Label_up_goldNum.string = (+num.toFixed(0)).formatAmountWithCommas())\r\n\t\t\t}, () => { })\r\n\t\t\tthis.stepNumber.setFlyNode(this.propertyNode.props_Label_up_goldNum.node.parent, this.propertyNode.props_Label_up_goldNum.node, 22)\r\n\t\t\tthis.stepNumber.start()\r\n\t\t\t// this.taskScheduler.joinqQueue(new Task((done) => {\r\n\t\t\t// \tthis.stepNumber && this.stepNumber.stop()\r\n\t\t\t// \tthis.stepNumber = new StepNumber(value.pre, value.cur, (num) => {\r\n\t\t\t// \t\tthis.propertyNode && this.propertyNode.props_Label_up_goldNum && (this.propertyNode.props_Label_up_goldNum.string = (+num.toFixed(0)).formatAmountWithCommas())\r\n\t\t\t// \t}, () => done())\r\n\t\t\t// \tthis.stepNumber.start()\r\n\t\t\t// }), true)\r\n\t\t}\r\n\t}\r\n\r\n\tprotected destroyCallBack() {\r\n\t\tthis.taskScheduler.destoryQueue()\r\n\t}\r\n\r\n\tprotected bindUI(): void {\r\n\r\n\t}\r\n\r\n\tupdate(deltaTime: number) {\r\n\r\n\t}\r\n}\r\n\r\n"]}