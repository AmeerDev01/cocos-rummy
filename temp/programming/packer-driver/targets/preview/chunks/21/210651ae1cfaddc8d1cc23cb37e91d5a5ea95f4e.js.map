{"version":3,"sources":["file:///Users/geliang/web/dibai/hall/assets/script/hall/components/Hall_PC_SubComp/Hall_PC_BackWater.ts"],"names":["_decorator","Button","Label","Node","Sprite","SpriteFrame","BaseComponent","bundleCommon","fetcher","global","lang","sourceManageSeletor","ApiUrl","addToastAction","ToastType","SKT_MAG_TYPE","sktInstance","BaseViewModel","EffectType","PrefabPathDefine","ccclass","property","Hall_PC_BackWater","propertyNode","props_label_water_pro","props_label_sisa","props_label_skalaSaat","props_label_jumlah","props_water_spr_vip","props_water_cuci","props_spr_word_cuci","props_Label_lorem","props_btn_ratio_help","props","memberInfo","events","start","initState","bindEvent","node","on","EventType","TOUCH_END","send","DRAW_WATER","type","then","data","hallDispatch","content","write","k","BaseBoardModule","operateDone","placeStr","SUCCESS","sendSktMessage","MEMBER_INFO","waterHelpViewModel","mountView","getFile","HELL_WATER_HELP","source","appendTo","effectType","EFFECT1","isModal","setEvent","onCloseHandler","unMount","EFFECT2","useProps","key","value","memberId","memberInfoNew","cur","load","vipLevel","err","sp","spriteFrame","string","memberRechargeWater","formatAmountWithCommas","totalFlowingWater","totalReturnWaterAmount","rebateScale","replace","minimumWithdrawal","active","bindUI","update","deltaTime"],"mappings":"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","sourcesContent":["import { _decorator, Button, Component, EditBox, Label, Node, Sprite, SpriteFrame } from 'cc';\r\nimport { BaseComponent } from '../../../base/BaseComponent';\r\nimport { bundleCommon, fetcher, global, lang, sourceManageSeletor } from '../../index';\r\nimport { ApiUrl } from '../../apiUrl';\r\nimport { addToastAction, ToastPosition, ToastType } from '../../store/actions/baseBoard';\r\nimport { Hall_WaterHelp, IState as HHIState, IProps as HHIprops, IEvent as HHIEvent } from '../Hall_WaterHelp';\r\nimport { SKT_MAG_TYPE, sktInstance } from '../../socketConnect';\r\nconst { ccclass, property } = _decorator;\r\nimport { InitStateType } from '../../store/actions/memberInfo';\r\nimport BaseViewModel from '../../viewModel/BaseViewModel';\r\nimport { EffectType } from '../../../utils/NodeIOEffect';\r\nimport { PrefabPathDefine } from '../../sourceDefine/prefabDefine';\r\n\r\nexport interface IState {\r\n\r\n}\r\n\r\nexport interface IProps {\r\n\tmemberInfo: InitStateType\r\n}\r\nexport interface IEvent {\r\n\r\n}\r\n\r\n@ccclass('Hall_PC_BackWater')\r\nexport class Hall_PC_BackWater extends BaseComponent<IState, IProps, IEvent> {\r\n\tstart() { }\r\n\r\n\tprotected propertyNode = {\r\n\t\t/**可提返水 */\r\n\t\tprops_label_water_pro: new Label(),//\r\n\t\t/**有效下注 */\r\n\t\tprops_label_sisa: new Label(),\r\n\t\t/**返水比例 */\r\n\t\tprops_label_skalaSaat: new Label(),\r\n\t\t/**洗码数 */\r\n\t\tprops_label_jumlah: new Label(),\r\n\t\t/**返水的vip级别 */\r\n\t\tprops_water_spr_vip: new Sprite(),\r\n\t\t/**确认抽取返水 */\r\n\t\tprops_water_cuci: new Button(),\r\n\t\t/**返水置灰覆盖节点 */\r\n\t\tprops_spr_word_cuci: new Node(),\r\n\t\t/**返水最小值说明 */\r\n\t\tprops_Label_lorem: new Label(),\r\n\t\t/**返水说明 */\r\n\t\tprops_btn_ratio_help: new Button()\r\n\t}\r\n\r\n\tpublic props: IProps = {\r\n\t\tmemberInfo: null\r\n\t}\r\n\r\n\tpublic events: IEvent = {\r\n\r\n\t}\r\n\r\n\tprotected initState() {\r\n\t\treturn { }\r\n\t}\r\n\r\n\tprotected bindEvent(): void {\r\n\t\t/**确认提取返水 */\r\n\t\tthis.propertyNode.props_water_cuci.node.on(Node.EventType.TOUCH_END, () => {\r\n\t\t\tfetcher.send(ApiUrl.DRAW_WATER, { type: 1 }).then((data) => {\r\n\t\t\t\tglobal.hallDispatch(addToastAction({ content: lang.write(k => k.BaseBoardModule.operateDone, {}, { placeStr: \"操作完成\" }), type: ToastType.SUCCESS }))\r\n\t\t\t\tsktInstance.sendSktMessage(SKT_MAG_TYPE.MEMBER_INFO, {})\r\n\t\t\t})\r\n\t\t})\r\n\t\tthis.propertyNode.props_btn_ratio_help.node.on(Node.EventType.TOUCH_END, () => {\r\n\t\t\tconst waterHelpViewModel = new BaseViewModel<Hall_WaterHelp, HHIState, HHIprops, HHIEvent>(\"Hall_WaterHelp\").mountView(sourceManageSeletor().getFile(PrefabPathDefine.HELL_WATER_HELP).source)\r\n\t\t\t\t.appendTo(this.node, { effectType: EffectType.EFFECT1, isModal: true }).setEvent({ onCloseHandler: () => waterHelpViewModel.unMount(EffectType.EFFECT2) })\r\n\t\t})\r\n\t}\r\n\r\n\tprotected useProps(key: keyof IProps, value: { pre: any, cur: any }) {\r\n\t\tif (key === \"memberInfo\") {\r\n\t\t\tif (!this.props.memberInfo.memberId) return\r\n\t\t\tconst memberInfoNew = value.cur as InitStateType;\r\n\t\t\tbundleCommon.load(`resource/vip/b_VIP${memberInfoNew.vipLevel}/spriteFrame`, SpriteFrame, (err, sp) => {\r\n\t\t\t\t!err && this.propertyNode && (this.propertyNode.props_water_spr_vip.spriteFrame = sp)\r\n\t\t\t})\r\n\t\t\tthis.propertyNode.props_label_water_pro.string = this.props.memberInfo.memberRechargeWater.formatAmountWithCommas()\r\n\t\t\tthis.propertyNode.props_label_sisa.string = this.props.memberInfo.totalFlowingWater.formatAmountWithCommas()\r\n\t\t\tthis.propertyNode.props_label_jumlah.string = this.props.memberInfo.totalReturnWaterAmount.formatAmountWithCommas()\r\n\t\t\tthis.propertyNode.props_label_skalaSaat.string = (this.props.memberInfo.rebateScale * 10000) + ''\r\n\t\t\tthis.propertyNode.props_Label_lorem.string = this.propertyNode.props_Label_lorem.string.replace('0', this.props.memberInfo.minimumWithdrawal.formatAmountWithCommas())\r\n\t\t\t/**如果抽数值小于最小返水线，就置灰 */\r\n\t\t\tthis.propertyNode.props_spr_word_cuci.active = this.props.memberInfo.minimumWithdrawal > this.props.memberInfo.memberRechargeWater\r\n\t\t}\r\n\t}\r\n\r\n\tprotected bindUI(): void {\r\n\r\n\t}\r\n\r\n\tupdate(deltaTime: number) {\r\n\r\n\t}\r\n}\r\n\r\n"]}