{"version":3,"sources":["file:///Users/geliang/web/dibai/hall/assets/script/subGame/yxx/components/Yxx_HistoryMax.ts"],"names":["_decorator","Button","instantiate","Label","Node","Sprite","BaseComponent","BetType","SpriteFramePathDefine","sourceManageSeletor","playBtnClick","ccclass","property","Yxx_HistoryMax","propertyNode","props_btn_history_close","props_history_list","props_history_group","props_spr_result","props_label_shrimp_count","props_label_gourd_count","props_label_deer_count","props_label_chook_count","props_label_crab_count","props_label_fish_count","props","results","newResult","animationStatus","events","close","start","initState","bindEvent","node","on","EventType","TOUCH_END","createResult","result","index","isAdd","groupNode","active","getChildByName","resultListNode","removeAllChildren","insertChild","addChild","betTypes","forEach","v","getComponent","spriteFrame","getSpriteFrame","hideHistoryNewBg","children","betType","fileName","SHRIMP","HISTORY_MIN_BIG1","GOURD","HISTORY_MIN_BIG2","DEER","HISTORY_MIN_BIG3","CHOOK","HISTORY_MIN_BIG4","CRAB","HISTORY_MIN_BIG5","FISH","HISTORY_MIN_BIG6","getFile","source","getCountLabel","collectResultCount","counts","Array","fill","map","type","string","useProps","key","value","cur","reverse","bindUI","update","deltaTime"],"mappings":"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","sourcesContent":["import { _decorator, Button, instantiate, Label, log, Node, Sprite, SpriteFrame, UITransform } from 'cc';\r\nimport { BaseComponent } from '../../../base/BaseComponent';\r\nimport { AnimationStatus, BetType, GameStatus, Result } from '../type';\r\nimport { SpriteFramePathDefine } from '../sourceDefine/spriteDefine';\r\nimport { sourceManageSeletor } from '../index';\r\nimport { playBtnClick } from '../index';\r\nconst { ccclass, property } = _decorator;\r\n\r\nexport interface IState {\r\n\r\n}\r\n\r\nexport interface IProps {\r\n\tresults?: Result[],\r\n\t/**最新结果 */\r\n\tnewResult: Result,\r\n\t/**动画状态 */\r\n\tanimationStatus: AnimationStatus,\r\n}\r\nexport interface IEvent {\r\n\tclose: () => void\r\n}\r\n\r\n@ccclass('Yxx_HistoryMax')\r\nexport class Yxx_HistoryMax extends BaseComponent<IState, IProps, IEvent> {\r\n\tstart() {\r\n\r\n\t}\r\n\r\n\tprotected propertyNode = {\r\n\t\tprops_btn_history_close: new Button(),\r\n\t\tprops_history_list: new Node(),\r\n\t\tprops_history_group: new Node(),\r\n\t\tprops_spr_result: new Node(),\r\n\t\tprops_label_shrimp_count: new Label(),\r\n\t\tprops_label_gourd_count: new Label(),\r\n\t\tprops_label_deer_count: new Label(),\r\n\t\tprops_label_chook_count: new Label(),\r\n\t\tprops_label_crab_count: new Label(),\r\n\t\tprops_label_fish_count: new Label(),\r\n\t}\r\n\r\n\tpublic props: IProps = {\r\n\t\tresults: [],\r\n\t\tnewResult: null,\r\n\t\tanimationStatus: null\r\n\t}\r\n\r\n\tpublic events: IEvent = {\r\n\t\tclose: () => { }\r\n\t}\r\n\r\n\tprotected initState() {\r\n\t\treturn {\r\n\r\n\t\t}\r\n\t}\r\n\r\n\tprotected bindEvent(): void {\r\n\t\tthis.propertyNode.props_btn_history_close.node.on(Node.EventType.TOUCH_END, () => {\r\n\t\t\tplayBtnClick();\r\n\t\t\tthis.events.close();\r\n\t\t});\r\n\t}\r\n\r\n\r\n\tprivate createResult(result: Result, index: number, isAdd: boolean = false): void {\r\n\t\tconst groupNode = instantiate(this.propertyNode.props_history_group);\r\n\t\tgroupNode.active = true;\r\n\t\tgroupNode.getChildByName(\"spr_history_newBg\").active = index === 0;\r\n\t\tconst resultListNode = groupNode.getChildByName(\"result_list\");\r\n\t\tresultListNode.removeAllChildren();\r\n\r\n\t\tisAdd ? this.propertyNode.props_history_list.insertChild(groupNode, 0) : this.propertyNode.props_history_list.addChild(groupNode);\r\n\r\n\t\tresult.betTypes.forEach(v => {\r\n\t\t\tconst node = instantiate(this.propertyNode.props_spr_result);\r\n\t\t\tresultListNode.addChild(node);\r\n\t\t\tnode.getComponent(Sprite).spriteFrame = this.getSpriteFrame(v);\r\n\t\t})\r\n\r\n\t}\r\n\r\n\tprivate hideHistoryNewBg() {\r\n\t\tthis.propertyNode.props_history_list.children.forEach(v => {\r\n\t\t\tv.getChildByName(\"spr_history_newBg\").active = false;\r\n\t\t});\r\n\t}\r\n\r\n\tprivate getSpriteFrame(betType: BetType): SpriteFrame {\r\n\t\tlet fileName = '';\r\n\t\tif (betType === BetType.SHRIMP) {\r\n\t\t\tfileName = SpriteFramePathDefine.HISTORY_MIN_BIG1\r\n\t\t} else if (betType === BetType.GOURD) {\r\n\t\t\tfileName = SpriteFramePathDefine.HISTORY_MIN_BIG2;\r\n\t\t} else if (betType === BetType.DEER) {\r\n\t\t\tfileName = SpriteFramePathDefine.HISTORY_MIN_BIG3;\r\n\t\t} else if (betType === BetType.CHOOK) {\r\n\t\t\tfileName = SpriteFramePathDefine.HISTORY_MIN_BIG4;\r\n\t\t} else if (betType === BetType.CRAB) {\r\n\t\t\tfileName = SpriteFramePathDefine.HISTORY_MIN_BIG5;\r\n\t\t} else if (betType === BetType.FISH) {\r\n\t\t\tfileName = SpriteFramePathDefine.HISTORY_MIN_BIG6;\r\n\t\t}\r\n\t\treturn sourceManageSeletor().getFile(fileName).source;\r\n\t}\r\n\r\n\tprivate getCountLabel(betType: BetType): Label {\r\n\t\tif (betType === BetType.SHRIMP) {\r\n\t\t\treturn this.propertyNode.props_label_shrimp_count;\r\n\t\t} else if (betType === BetType.GOURD) {\r\n\t\t\treturn this.propertyNode.props_label_gourd_count;\r\n\t\t} else if (betType === BetType.DEER) {\r\n\t\t\treturn this.propertyNode.props_label_deer_count;\r\n\t\t} else if (betType === BetType.CHOOK) {\r\n\t\t\treturn this.propertyNode.props_label_chook_count;\r\n\t\t} else if (betType === BetType.CRAB) {\r\n\t\t\treturn this.propertyNode.props_label_crab_count;\r\n\t\t} else if (betType === BetType.FISH) {\r\n\t\t\treturn this.propertyNode.props_label_fish_count;\r\n\t\t}\r\n\t}\r\n\r\n\tprivate collectResultCount(result: Result[]) {\r\n\t\tif (!result) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tconst counts: number[] = new Array(7).fill(0).map(() => 0);\r\n\t\tthis.props.results.forEach(result => {\r\n\t\t\tresult.betTypes.forEach(type => {\r\n\t\t\t\tcounts[type]++;\r\n\t\t\t})\r\n\t\t})\r\n\r\n\t\tthis.propertyNode.props_label_shrimp_count.string = counts[BetType.SHRIMP] + \"\";\r\n\t\tthis.propertyNode.props_label_gourd_count.string = counts[BetType.GOURD] + \"\";\r\n\t\tthis.propertyNode.props_label_deer_count.string = counts[BetType.DEER] + \"\";\r\n\t\tthis.propertyNode.props_label_chook_count.string = counts[BetType.CHOOK] + \"\";\r\n\t\tthis.propertyNode.props_label_crab_count.string = counts[BetType.CRAB] + \"\";\r\n\t\tthis.propertyNode.props_label_fish_count.string = counts[BetType.FISH] + \"\";\r\n\t}\r\n\r\n\tprotected useProps(key: keyof IProps, value: { pre: any, cur: any }) {\r\n\t\tif (key === 'results') {\r\n\t\t\tthis.propertyNode.props_history_list.removeAllChildren();\r\n\t\t\tthis.collectResultCount(value.cur);\r\n\t\t\t[...value.cur].reverse().forEach((v, index) => {\r\n\t\t\t\tthis.createResult(v, index);\r\n\t\t\t})\r\n\t\t// } else if (key === 'animationStatus') {\r\n\t\t// \tif (value.cur === AnimationStatus.KAI_GAI) {\r\n\t\t// \t\tthis.hideHistoryNewBg();\r\n\t\t// \t\tthis.createResult(this.props.newResult, 0, true);\r\n\t\t// \t}\r\n\t\t}\r\n\t}\r\n\r\n\tprotected bindUI(): void {\r\n\t}\r\n\r\n\tupdate(deltaTime: number) {\r\n\r\n\t}\r\n}\r\n\r\n"]}