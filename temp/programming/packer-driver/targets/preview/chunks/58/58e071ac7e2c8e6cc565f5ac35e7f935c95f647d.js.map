{"version":3,"sources":["file:///Users/geliang/web/dibai/hall/assets/script/subGame/godWealth111/index.ts"],"names":["Prefab","assetManager","fruitStore","bundlePkgName","PrefabPathDefine","LoaderPanelViewModel","fruit777FileMap","SubGameRunState","subGameList","socketConnect","HeaderViewModel","FooterViewModel","GameBoardViewModel","listenerFactoy","AudioMgr","SoundPathDefine","UseSetOption","setActiveAudio","config","global","setSubGameRunState","JackPotViewModel","sourceManageMap","bundleGodWealth","sourceManageSeletor","bundleName","find","i","bundle","name","NORMAL_MAG_TYPE","msgListener","startUp","rootNode","configureStore","loadBundle","err","load","LOAING_PANEL","progress","total","hallDispatch","LOADING","setSubGameGate","gameId","prefab","isAllowOpenSubGame","READY","loaderviweModel","mountView","appendTo","setProps","loadBarType","setEvent","onLoadDone","_sourceManageMap","godWealth_Audio","comp","setTipContent","RUN","then","unMount","gameBoardViewModel","getFile","GAME_BOARD","source","connect","headerViewModel","HEADER_UP","getWrapNode","footerViewModel","FOOTER_DOWN","jackPotViewModel","JACK_POT","play","MAIN_BG","Instance","option","music","catch","e","versionStr","md5","startLoad","playMainBg","playGame1Bg","GAME1_BG","playGame2Bg","GAME2_BG","playBtnClick","playOneShot","BTN_CLICK","getCoin","GET_COIN","playShellEnd","SHELL_END","playLing","LING","playTurn","TURN","playMaxCoin","MAX_COIN","playMinCoin","MIN_COIN","playFastRoller","FAST_ROLLER","playBiu","BIU","playSmallGameOver","GAME_OVER_BG"],"mappings":"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","sourcesContent":["import { AssetManager, Node, Prefab, assetManager, sys } from \"cc\"\r\nimport fruitStore from './store';\r\nimport { bundlePkgName } from \"./sourceDefine\";\r\nimport { PrefabPathDefine } from \"./sourceDefine/prefabDefine\";\r\nimport LoaderPanelViewModel from \"../../common/viewModel/LoaderPanelViewModel\";\r\nimport SourceManage from \"../../base/SourceManage\";\r\nimport fruit777FileMap from './sourceDefine';\r\nimport { SubGameRunState, config as hallConfig, subGameList } from \"../../hall/config\";\r\nimport socketConnect, { SKT_MAG_TYPE, sktInstance } from \"./socketConnect\";\r\nimport HeaderViewModel from \"./viewModel/HeaderViewModel\";\r\nimport FooterViewModel from \"./viewModel/FooterViewModel\";\r\nimport GameBoardViewModel from \"./viewModel/GameBoardViewModel\";\r\nimport { listenerFactoy } from \"../../common/listenerFactoy\";\r\nimport { AudioMgr } from \"../../utils/AudioMgr\";\r\nimport { SoundPathDefine } from \"./sourceDefine/soundDefine\";\r\nimport UseSetOption, { setActiveAudio } from \"../../utils/UseSetOption\";\r\nimport config from \"./config\";\r\nimport { baseBoardView, global } from \"../../hall\";\r\nimport { setSubGameRunState } from \"../../hall/store/actions/baseBoard\";\r\nimport baseBoard from \"../../hall/store/reducer/baseBoard\";\r\nimport JackPotViewModel from \"./viewModel/JackPotViewModel\";\r\n\r\n\r\nlet sourceManageMap: Array<SourceManage> = []\r\nexport let bundleGodWealth: AssetManager.Bundle = null\r\nexport let gameBoardViewModel: GameBoardViewModel\r\nexport let footerViewModel: FooterViewModel\r\nexport let headerViewModel: HeaderViewModel\r\nexport let godWealth_Audio: AudioMgr<SoundPathDefine>\r\nexport let jackPotViewModel:JackPotViewModel\r\nexport const sourceManageSeletor = (bundleName: string = 'godWealth111') => sourceManageMap.find(i => i.bundle.name === bundleName)\r\n\r\nexport enum NORMAL_MAG_TYPE {\r\n  /**切换游戏，特效中间触发 */\r\n  CHANGE_GAME\r\n}\r\n/**用于一般逻辑的监听器 */\r\nexport const msgListener = listenerFactoy<NORMAL_MAG_TYPE>()\r\nexport const startUp = (rootNode: Node) => {\r\n  fruitStore.configureStore()\r\n\r\n  assetManager.loadBundle(bundlePkgName, (err, bundle) => {\r\n    bundleGodWealth = bundle\r\n    bundleGodWealth.load(PrefabPathDefine.LOAING_PANEL, Prefab, (progress, total) => {\r\n      global.hallDispatch(setSubGameRunState(SubGameRunState.LOADING))\r\n      global.setSubGameGate(config.gameId, (progress / total))\r\n    }, (err, prefab) => {\r\n      if (!global.isAllowOpenSubGame(config.gameId)) return\r\n      global.hallDispatch(setSubGameRunState(SubGameRunState.READY))\r\n      const loaderviweModel = new LoaderPanelViewModel().mountView(prefab).appendTo(rootNode).setProps({\r\n        loadBarType: 1\r\n      }).setEvent({\r\n        onLoadDone: (_sourceManageMap) => {\r\n          sourceManageMap = _sourceManageMap\r\n          godWealth_Audio = new AudioMgr<SoundPathDefine>(sourceManageSeletor())\r\n          setActiveAudio(godWealth_Audio)\r\n          // hallConfig.gameConfig.find(item => item.name === \"godWealth\")\r\n          loaderviweModel.comp.setTipContent(\"game init...\")\r\n          global.hallDispatch(setSubGameRunState(SubGameRunState.RUN))\r\n          socketConnect().then(() => {\r\n            loaderviweModel.unMount().then(() => {\r\n              gameBoardViewModel = new GameBoardViewModel().mountView(sourceManageSeletor().getFile(PrefabPathDefine.GAME_BOARD).source).appendTo(rootNode).connect();\r\n              headerViewModel = new HeaderViewModel().mountView(sourceManageSeletor().getFile(PrefabPathDefine.HEADER_UP).source).appendTo(gameBoardViewModel.comp.getWrapNode()).connect();\r\n              footerViewModel = new FooterViewModel().mountView(sourceManageSeletor().getFile(PrefabPathDefine.FOOTER_DOWN).source).appendTo(gameBoardViewModel.comp.getWrapNode()).connect();\r\n              jackPotViewModel = new JackPotViewModel().mountView(sourceManageSeletor().getFile(PrefabPathDefine.JACK_POT).source).appendTo(gameBoardViewModel.comp.getWrapNode()).connect();\r\n              godWealth_Audio.play(SoundPathDefine.MAIN_BG, UseSetOption.Instance().option.music)\r\n            })\r\n          }).catch(e => loaderviweModel.comp.setTipContent(e || 'error'))\r\n        }\r\n      }).setProps({\r\n        versionStr: `md5: ${subGameList.find(i => i.gameId === config.gameId).md5}`\r\n      })\r\n      loaderviweModel.comp.startLoad([bundle], [...fruit777FileMap])\r\n    })\r\n  })\r\n}\r\n\r\n/**\r\n * 背景音乐\r\n */\r\nexport const playMainBg = () => {\r\n  godWealth_Audio.play(SoundPathDefine.MAIN_BG, true);\r\n}\r\n/**\r\n* 小游戏1背景\r\n*/\r\nexport const playGame1Bg = () => {\r\n  godWealth_Audio.play(SoundPathDefine.GAME1_BG);\r\n}\r\n/**\r\n* 小游戏2背景\r\n*/\r\nexport const playGame2Bg = () => {\r\n  godWealth_Audio.play(SoundPathDefine.GAME2_BG);\r\n}\r\n/**点击按钮 */\r\nexport const playBtnClick = () => {\r\n  godWealth_Audio.playOneShot(SoundPathDefine.BTN_CLICK);\r\n}\r\n/**金币收集结算 */\r\nexport const getCoin = () => {\r\n  godWealth_Audio.playOneShot(SoundPathDefine.GET_COIN);\r\n}\r\n/**滚轴停止滚动 */\r\nexport const playShellEnd = () => {\r\n  godWealth_Audio.playOneShot(SoundPathDefine.SHELL_END);\r\n}\r\n/** 小游戏进入前铃声*/\r\nexport const playLing = () => {\r\n  godWealth_Audio.playOneShot(SoundPathDefine.LING);\r\n}\r\n/**规则翻页 */\r\nexport const playTurn = () => {\r\n  godWealth_Audio.playOneShot(SoundPathDefine.TURN);\r\n}\r\n/** 增加下注*/\r\nexport const playMaxCoin = () => {\r\n  godWealth_Audio.playOneShot(SoundPathDefine.MAX_COIN);\r\n}\r\n/** 减小下注*/\r\nexport const playMinCoin = () => {\r\n  godWealth_Audio.playOneShot(SoundPathDefine.MIN_COIN);\r\n}\r\n/** 滚轴加速*/\r\nexport const playFastRoller = () => {\r\n  godWealth_Audio.playOneShot(SoundPathDefine.FAST_ROLLER);\r\n}\r\n/** 选择自转次数时音效*/\r\nexport const playBiu = () => {\r\n  godWealth_Audio.playOneShot(SoundPathDefine.BIU);\r\n}\r\n/** 小游戏结束*/\r\nexport const playSmallGameOver = () => {\r\n  godWealth_Audio.playOneShot(SoundPathDefine.GAME_OVER_BG);\r\n}\r\n"]}