{"version":3,"sources":["file:///Users/geliang/web/dibai/hall/assets/script/subGame/dragonV2/components/DragonV2_Roller.ts"],"names":["_decorator","instantiate","Node","tween","Vec3","BaseComponent","config","GameType","getColumnLockIconArr","IconId","Dragonv2_Audio","sourceManageSeletor","PrefabPathDefine","cacheData","getNodeByNameDeep","DragonV2SingleIconRollerViewModel","SoundPathDefine","ccclass","property","DragonV2_Roller","lastIndex","showIconCount","normalRollOption","stopIconIndex","columnIndex","iconPool","iconRollerQueue","isRoll","iconArr","intervalHeight","rollOverCallback","isSpeedBorder","props_column_effect_node","iconAnimationNode","props_lock_icon_list","speddBorderNode","isMergeIcon","lockIcons","singleIconRollerViewModels","rollerCount","bigNode","propertyNode","props_icon_list","props_big_icon","props_pyrosphere","props","gameTypeInfo","lastGameType","NONE","viewGameType","currGameType","leftCount","events","onCheckNextLeftCount","start","initState","setColumnEffectNode","getChildByName","initSlot","Math","floor","random","length","initColumn","isSubGame2","addLockIcon","replaceSingleRollerIcon","iconCount","i","joinIcon","SUBGAME2","addIconIndex","index","value","newValue","isSubGame2SpecialIcon","id","BEETLE","iconId","iconConfig","icon","find","v","getIcon","position","getHeight","lastNode","y","getPosition","getNode","setPosition","push","amountNode","active","changeIcon","setBeetleAmount","hidePyrosphere","state","removeAllChildren","removeDuplicatesByIndex","data","seen","Set","uniqueData","array","indexValue","has","add","joinringOfFireIcon","key","joinToStartMoving","thePresenceOrAbsenceOfARingOfFire","callbak","children","arr","filter","item","node","getFile","PYROSPHERE","source","console","log","nodeMOve","singleRollerHeight","addChild","renderTheRingOfFire","callBack","forEach","ty","scheduleOnce","targetY","isDestroy","duration","playOneShot","fallBall","to","x","z","easing","call","destroy","getId","diff","calIndexDiff","lockIconDatas","fixedChessboardIcon","lockIconData","amount","setAmount","index1","index2","bindEvent","useProps","hideIconWin","stopWinIcon","name","startRoll","hideScatterAnimation","fast_roller","comp","stopRoll","setSpeedBorderStatus","stopSingleRollerIcon","addLastJoinIconIndex","stopIndex","getStopIconIndex","totalCount","bindUI","getRollSpeed","expectRollerSpeed","rollerSpeed","mergeIcon","parentNode","getAlikeIconCount","pos","isWinIcon","worldPosition","clone","wp","rollerLaunchResult","dl","si","values","iconIndexs","show","setWorldPosition","scaleX","expectBorderScaleX","scaleY","expectBorderScaleY","SUBGAME1","subGameRollOption","setScale","buildSkeleton","count","WILD","SCATTER","hideWin","pauseWinIcon","pauseWin","playWinIcon","playWin","playBaoHeAnimation","done","beetleArr","playGame2BaoHeAnimation","playOneScatterAnimation","element","freeGame","freegame","isLoop","Object","keys","faceAnimationNode","scale","rollOverHandle","shell_end","time","isValid","lockValues","DragonV2Icon","iconv","getIconIndex","replaceIcon","restore","pot","removeSingleRollerIcon","getSlotIndex","unMount","splice","removeLockIcon","destory","getIconPosByIndex","height","interval","lock","buildSingleRollerIcon","replaceMultiRollerIcon","firstIcon","getFirstIcon","removeFromParent","viewModel","mountView","SINGLE_ICON_ROLLER","appendTo","viewNode","multiIconRoller","frist","shift","endIcon","isMultiRoll","MAIN","getBeetleAmountNode","nodes","getAmountNode","getBaoHeParticleNode","ParticleNodes","update","deltaTime"],"mappings":"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","sourcesContent":["import { _decorator, instantiate, Node, sp, tween, UITransform, Vec2, Vec3 } from 'cc';\r\nimport { BaseComponent } from '../../../base/BaseComponent';\r\nimport { IconPool } from '../IconPool';\r\nimport config from '../config';\r\nimport { DragonV2Icon } from './DragonV2Icon';\r\nimport { GameType, GameTypeInfo, getColumnLockIconArr, IconId, RollerInfo, RollerStatus } from '../type';\r\nimport { Dragonv2_Audio, sourceManageSeletor } from '../index';\r\nimport { SkeletalPathDefine } from '../sourceDefine/skeletalDefine';\r\nimport { PrefabPathDefine } from '../sourceDefine/prefabDefine';\r\nimport { cacheData } from '../dataTransfer';\r\nimport { getNodeByNameDeep } from '../../../utils/tool';\r\nimport { DragonV2_SingleIconRoller } from './DragonV2_SingleIconRoller';\r\nimport DragonV2SingleIconRollerViewModel from '../viewModel/DragonV2SingleIconRollerViewModel';\r\nimport { SoundPathDefine } from '../sourceDefine/soundDefine';\r\nconst { ccclass, property } = _decorator;\r\n\r\nexport interface IState {\r\n}\r\n\r\nexport interface IProps {\r\n\tgameTypeInfo: GameTypeInfo,\r\n}\r\nexport interface IEvent {\r\n\tonCheckNextLeftCount: () => void\r\n}\r\n@ccclass('DragonV2_Roller')\r\nexport class DragonV2_Roller extends BaseComponent<IState, IProps, IEvent> {\r\n\tstart() {\r\n\r\n\t}\r\n\t/**当前最后添加的图标索引位置 */\r\n\tprivate lastIndex = 0;\r\n\t/**显示图标数量 */\r\n\tprivate showIconCount = config.normalRollOption.showIconCount;\r\n\t/**停止图标索引 */\r\n\tprivate stopIconIndex = -1;\r\n\t/**列的索引 */\r\n\tprivate columnIndex = 0;\r\n\t/**图标池 */\r\n\tprivate iconPool: IconPool;\r\n\t/**图标轮播队列 */\r\n\tprivate iconRollerQueue: any[]\r\n\t/**是否正在滚动 */\r\n\tprivate isRoll = false;\r\n\t/**滚轴上的图标，包含看不见的 */\r\n\tprivate iconArr: DragonV2Icon[] = [];\r\n\t/**图标间隔 */\r\n\tprivate intervalHeight = config.normalRollOption.intervalHeight;\r\n\r\n\t/**滚动结束回调方法 */\r\n\tprivate rollOverCallback;\r\n\t/**是否快速边框（期待scatter中奖边框） */\r\n\tprivate isSpeedBorder;\r\n\t/**列特效层 */\r\n\tprivate props_column_effect_node: Node;\r\n\t/**图标动画层节点 */\r\n\tprivate iconAnimationNode: Node;\r\n\t/**锁定图标节点 */\r\n\tprivate props_lock_icon_list: Node;\r\n\t/**快速滚动层节点 */\r\n\tprivate speddBorderNode: Node;\r\n\t/**是否合并图标了 */\r\n\tprivate isMergeIcon = false;\r\n\r\n\t/**锁定图标列表 */\r\n\tprivate lockIcons: DragonV2Icon[] = [];\r\n\t/**单个图标的滚动 */\r\n\tprivate singleIconRollerViewModels: DragonV2SingleIconRollerViewModel[] = [];\r\n\r\n\t/**滚动次数 */\r\n\tprivate rollerCount = -1;\r\n\r\n\t/**大图标 */\r\n\tprivate bigNode: Node;\r\n\r\n\tprotected propertyNode = {\r\n\t\tprops_icon_list: new Node(),\r\n\t\tprops_big_icon: new Node(),\r\n\t\tprops_pyrosphere: new Node(),\r\n\t}\r\n\tpublic props: IProps = {\r\n\t\t// rollerInfo: undefined,\r\n\t\t// rollerStatus: RollerStatus.END,\r\n\t\tgameTypeInfo: {\r\n\t\t\tlastGameType: GameType.NONE,\r\n\t\t\tviewGameType: GameType.NONE,\r\n\t\t\tcurrGameType: GameType.NONE,\r\n\t\t\tleftCount: 0,\r\n\t\t},\r\n\t}\r\n\r\n\tpublic events: IEvent = {\r\n\t\tonCheckNextLeftCount: () => { }\r\n\t}\r\n\r\n\tprotected initState() {\r\n\t\treturn {}\r\n\t}\r\n\r\n\tpublic setColumnEffectNode(props_column_effect_node: Node) {\r\n\t\tthis.props_column_effect_node = props_column_effect_node;\r\n\t\tthis.iconAnimationNode = this.props_column_effect_node.getChildByName(\"props_icon_animation\")\r\n\t\tthis.speddBorderNode = this.props_column_effect_node.getChildByName(\"props_speed_border\")\r\n\t\tthis.props_lock_icon_list = getNodeByNameDeep(\"props_lock_icon_list\", this.props_column_effect_node);\r\n\t}\r\n\tpublic initSlot(columnIndex: number, iconPool: IconPool) {\r\n\t\tthis.iconPool = iconPool;\r\n\t\tthis.columnIndex = columnIndex;\r\n\t\tthis.iconRollerQueue = config.iconRollerQueue[this.columnIndex]\r\n\t\tthis.lastIndex = Math.floor(Math.random() * this.iconRollerQueue.length);\r\n\r\n\t\tthis.initColumn(this.showIconCount + 1);\r\n\r\n\t\tif (this.isSubGame2()) {\r\n\t\t\tthis.addLockIcon()\r\n\t\t\tthis.replaceSingleRollerIcon();\r\n\t\t}\r\n\t}\r\n\r\n\tprivate initColumn(iconCount: number) {\r\n\t\tfor (let i = 0; i < iconCount; i++) {\r\n\t\t\tthis.joinIcon();\r\n\t\t}\r\n\t}\r\n\r\n\tprivate isSubGame2() {\r\n\t\treturn this.props.gameTypeInfo.viewGameType === GameType.SUBGAME2;\r\n\t}\r\n\r\n\tprivate addIconIndex(index: number, value: number) {\r\n\t\tlet newValue = index + value;\r\n\t\tif (newValue >= this.iconRollerQueue.length) {\r\n\t\t\tnewValue = newValue - this.iconRollerQueue.length;\r\n\t\t}\r\n\t\treturn newValue;\r\n\t}\r\n\r\n\t/**是否小游戏2的特殊图标 */\r\n\tprivate isSubGame2SpecialIcon(id: number) {\r\n\t\treturn id === IconId.BEETLE\r\n\t}\r\n\r\n\tprivate joinIcon() {\r\n\t\tconst length = this.iconArr.length\r\n\t\tthis.lastIndex = this.lastIndex - 1 < 0 ? this.iconRollerQueue.length - 1 : --this.lastIndex;\r\n\t\tconst iconId = this.iconRollerQueue[this.lastIndex];\r\n\t\tconst iconConfig = config.icon.find(v => v.id === iconId);\r\n\t\t// 在子游戏2中，初始化不显示宝盒\r\n\t\tif (this.isSubGame2() && this.isSubGame2SpecialIcon(iconConfig.id)) {\r\n\t\t\tthis.joinIcon();\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tconst icon = this.iconPool.getIcon(iconConfig, this.propertyNode.props_icon_list, this.lastIndex);\r\n\t\tconst position = new Vec3(0, this.intervalHeight + icon.getHeight() / 2);\r\n\t\tif (length > 0) {\r\n\t\t\tconst lastNode = this.iconArr[length - 1];\r\n\t\t\tposition.y = lastNode.getPosition().y + lastNode.getHeight() + this.intervalHeight;\r\n\t\t}\r\n\t\ticon.getNode().setPosition(position);\r\n\t\tthis.iconArr.push(icon);\r\n\t\tif (iconConfig.id === 12) {\r\n\t\t\ticon.amountNode.active = false;\r\n\t\t\ticon.changeIcon(false)\r\n\t\t}\r\n\t\tthis.setBeetleAmount(icon);\r\n\t}\r\n\r\n\tpublic hidePyrosphere(state: 1 | 2 | 3) {  // 1隐藏火圈 2显示火圈 3移除火圈\r\n\t\tif (state == 1) {\r\n\t\t\tthis.propertyNode.props_pyrosphere.active = false\r\n\t\t}\r\n\t\telse if (state == 2) {\r\n\t\t\tthis.propertyNode.props_pyrosphere.active = true\r\n\t\t}\r\n\t\telse {\r\n\t\t\tthis.propertyNode.props_pyrosphere.removeAllChildren()\r\n\t\t}\r\n\t}\r\n\tremoveDuplicatesByIndex(data: number[][]): number[][] {\r\n\t\tconst seen: Set<number> = new Set();\r\n\t\tconst uniqueData: number[][] = [];\r\n\r\n\t\tfor (const array of data) {\r\n\t\t\tconst indexValue = array[1];\r\n\r\n\t\t\tif (!seen.has(indexValue)) {\r\n\t\t\t\tseen.add(indexValue);\r\n\t\t\t\tuniqueData.push(array);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn uniqueData;\r\n\t}\r\n\r\n\tpublic joinringOfFireIcon(key) { // 加入新火圈\r\n\t\tthis.propertyNode.props_pyrosphere.active = true;\r\n\t\tthis.joinToStartMoving(key);\r\n\t}\r\n\tpublic thePresenceOrAbsenceOfARingOfFire(key, callbak) { // 检测是否火圈是否存在\r\n\t\tlet children = this.propertyNode.props_pyrosphere.children;\r\n\t\tif (children.length > 0) {\r\n\t\t\tlet arr = children.filter((item: any) => item.key === key[1])\r\n\t\t\tif (arr.length > 0) {\r\n\t\t\t\tcallbak(true)\r\n\t\t\t} else {\r\n\t\t\t\tcallbak(false)\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tcallbak(false)\r\n\t\t}\r\n\r\n\t}\r\n\tprivate joinToStartMoving(key) {\r\n\t\tlet node = instantiate(sourceManageSeletor().getFile(PrefabPathDefine.PYROSPHERE).source)\r\n\t\tconsole.log(key);\r\n\t\tnode.key = key[1]\r\n\t\tthis.nodeMOve(node, (key[1] * config.normalRollOption.singleRollerHeight + config.normalRollOption.singleRollerHeight), false)\r\n\t\tthis.propertyNode.props_pyrosphere.addChild(node)\r\n\t}\r\n\trenderTheRingOfFire(callBack) { // 有老火圈先移动老火\r\n\t\tlet children = this.propertyNode.props_pyrosphere.children\r\n\t\tif (children.length > 0) {\r\n\t\t\tchildren.forEach((item: any) => {\r\n\t\t\t\titem.key = item.key - 1\r\n\t\t\t\titem.getChildByName('wlid').active = false\r\n\t\t\t\titem.getChildByName('moveRingOfFire').active = true\r\n\t\t\t\tconsole.log(item.getPosition().y - config.normalRollOption.singleRollerHeight,'111111111');\r\n\t\t\t\tlet ty=item.key < 0? -300 :(item.key * config.normalRollOption.singleRollerHeight + config.normalRollOption.singleRollerHeight)\r\n\t\t\t\tthis.nodeMOve(item, ty, item.key < 0)\r\n\t\t\t})\r\n\t\t}\r\n\t\tthis.scheduleOnce(() => {\r\n\t\t\tcallBack()\r\n\t\t}, 0.5)\r\n\t}\r\n\t/* 火圈移动*/\r\n\tprivate nodeMOve(item: Node, targetY, isDestroy = false) {\r\n\t\tlet duration = 0.3\r\n\t\tDragonv2_Audio.playOneShot(SoundPathDefine.fallBall)\r\n\t\ttween(item).to(duration, { position: new Vec3(item.position.x, targetY, item.position.z) })\r\n\t\t\t.to(0.08, { position: new Vec3(item.position.x, targetY + 8, item.position.z) }, { easing: 'sineOut' }) // 初次回弹向上\r\n\t\t\t.to(0.05, { position: new Vec3(item.position.x, targetY, item.position.z) }, { easing: 'sineIn' }) // 最终回到原位\r\n\t\t\t.call(() => {\r\n\t\t\t\tif (isDestroy) {\r\n\t\t\t\t\titem.destroy()\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t\t.start();\r\n\t}\r\n\t/**\r\n\t * 设置宝盒上面的数字\r\n\t */\r\n\tprivate setBeetleAmount(icon: DragonV2Icon) {\r\n\t\tif (icon.getId() !== IconId.BEETLE) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tif (this.props.gameTypeInfo.currGameType !== GameType.SUBGAME2 && this.props.gameTypeInfo.viewGameType === GameType.SUBGAME2) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tconst diff = this.calIndexDiff(this.lastIndex, this.stopIconIndex);\r\n\t\tif (diff >= 3) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\t// console.log(`setBeetleAmount--- diff:${diff},stopIconIndex:${this.stopIconIndex},lastIndex:${this.lastIndex},columnIndex:${this.columnIndex}`);\r\n\r\n\t\tconst lockIconDatas = getColumnLockIconArr(cacheData.fixedChessboardIcon, this.columnIndex)\r\n\r\n\t\tif (lockIconDatas.length === 0) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tconst index = diff === 2 ? 0 : diff === 0 ? 2 : 1;\r\n\r\n\t\tconst lockIconData = lockIconDatas.find(v => v.index === index)\r\n\t\tif (lockIconData) {\r\n\t\t\tconst amount = lockIconData.amount >= 10000 ? lockIconData.amount : lockIconData.amount;\r\n\t\t\ticon.setAmount(amount)\r\n\t\t}\r\n\t}\r\n\r\n\t/**计算两个索引的差值 */\r\n\tprivate calIndexDiff(index1: number, index2: number) {\r\n\t\tlet diff = index1 - index2;\r\n\t\tif (index1 < index2) {\r\n\t\t\tdiff = index1 + this.iconRollerQueue.length - index2\r\n\t\t}\r\n\t\treturn diff;\r\n\t}\r\n\r\n\tprotected bindEvent(): void {\r\n\t}\r\n\r\n\tprotected useProps(key: keyof IProps, value: { pre: any, cur: any }) {\r\n\t\tif (key === 'gameTypeInfo') {\r\n\t\t\tif (this.props.gameTypeInfo.viewGameType === GameType.SUBGAME2 && this.singleIconRollerViewModels.length === 0) {\r\n\t\t\t\tthis.replaceSingleRollerIcon();\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\t/**隐藏图标中奖效果 */\r\n\tprivate hideIconWin() {\r\n\t\tthis.stopWinIcon();\r\n\t\tthis.iconAnimationNode.children.forEach(v => {\r\n\t\t\tv.name === 'bigNode' && v.destroy();\r\n\t\t})\r\n\t\tthis.bigNode && this.bigNode.destroy();\r\n\t\tthis.bigNode = null;\r\n\t\tthis.iconAnimationNode.removeAllChildren();\r\n\t\tthis.propertyNode.props_big_icon.removeAllChildren();\r\n\t}\r\n\r\n\tpublic startRoll() {\r\n\t\tthis.hideIconWin();\r\n\t\tthis.hideScatterAnimation();\r\n\t\tthis.rollerCount = -1;\r\n\t\tthis.isMergeIcon = false;\r\n\t\tthis.isSpeedBorder = false;\r\n\t\tthis.isRoll = true;\r\n\t\tDragonv2_Audio.playOneShot(SoundPathDefine.fast_roller)\r\n\t\tif (this.isSubGame2()) {\r\n\t\t\tthis.singleIconRollerViewModels.forEach(v => v.comp.startRoll());\r\n\t\t}\r\n\t}\r\n\r\n\tpublic stopRoll(stopIconIndex: number, rollOverCallback: Function, isSpeedBorder: boolean = false) {\r\n\t\tthis.isSpeedBorder = isSpeedBorder;\r\n\t\tthis.stopIconIndex = stopIconIndex;\r\n\t\tthis.rollOverCallback = rollOverCallback;\r\n\t\tthis.rollerCount = 0;\r\n\t\tif (!this.isSubGame2()) {\r\n\t\t\tisSpeedBorder && this.setSpeedBorderStatus(true);\r\n\t\t} else {\r\n\t\t\tthis.stopSingleRollerIcon();\r\n\t\t}\r\n\t}\r\n\r\n\tprivate addLastJoinIconIndex(stopIndex: number, value: number) {\r\n\t\tif (stopIndex < 0) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tlet newValue = stopIndex + value;\r\n\t\tif (newValue >= this.iconRollerQueue.length) {\r\n\t\t\tnewValue = newValue - this.iconRollerQueue.length;\r\n\t\t}\r\n\t\tthis.lastIndex = newValue;\r\n\t}\r\n\r\n\tprivate getStopIconIndex() {\r\n\t\t// console.log(`getStopIconIndex--- rollerCount:${this.rollerCount},columnIndex:${this.columnIndex},lastIndex:${this.lastIndex}`);\r\n\t\tlet totalCount = 1 * (this.columnIndex + 1);\r\n\t\tif (this.isSpeedBorder) {\r\n\t\t\ttotalCount = 30;\r\n\t\t}\r\n\t\tif (this.rollerCount <= totalCount) {\r\n\t\t\tif (this.rollerCount === totalCount) {\r\n\t\t\t\t// console.log(`getStopIconIndex--- rollerCount:${this.rollerCount},columnIndex:${this.columnIndex},lastIndex:${this.lastIndex},\tstopIconIndex:${this.stopIconIndex}`);\r\n\t\t\t\tthis.addLastJoinIconIndex(this.stopIconIndex, 3)\r\n\t\t\t}\r\n\t\t\treturn -1;\r\n\t\t}\r\n\t\treturn this.stopIconIndex;\r\n\t}\r\n\r\n\tprotected bindUI(): void {\r\n\t}\r\n\r\n\t/**获得滚动速度 */\r\n\tprivate getRollSpeed() {\r\n\t\tif (this.isSpeedBorder) {\r\n\t\t\treturn config.normalRollOption.expectRollerSpeed;\r\n\t\t}\r\n\t\treturn config.normalRollOption.rollerSpeed;\r\n\t}\r\n\r\n\tprivate mergeIcon(parentNode: Node) {\r\n\t\tlet iconCount = this.getAlikeIconCount();\r\n\t\tlet pos: Vec3;\r\n\t\tif (iconCount === this.showIconCount) {\r\n\t\t\tfor (let i = 0; i < this.showIconCount; i++) {\r\n\t\t\t\tif (!this.isWinIcon(i)) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t// 3个图标取中间的图标的坐标\r\n\t\t\tpos = this.iconArr[1].getNode().worldPosition;\r\n\t\t} else if (iconCount === this.showIconCount - 1) {\r\n\t\t\t// 找出两个相邻的图标\r\n\t\t\tfor (let i = 0; i < this.showIconCount - 1; i++) {\r\n\t\t\t\tif (this.iconArr[i].getId() === this.iconArr[i + 1].getId() && this.isWinIcon(i) && this.isWinIcon(i + 1)) {\r\n\t\t\t\t\tpos = this.iconArr[i].getNode().worldPosition.clone().add(new Vec3(0, this.iconArr[i].getHeight() / 2 + this.intervalHeight));\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t// if (pos) {\r\n\t\t// \tthis.buildSkeleton(parentNode, pos, iconCount);\r\n\t\t// \tthis.isMergeIcon = true;\r\n\t\t// }\r\n\t}\r\n\r\n\t/**是否中奖图标 */\r\n\tprivate isWinIcon(index: number) {\r\n\t\tconst wp = cacheData.rollerLaunchResult.dl.si[0].wp\r\n\t\tfor (const key in wp) {\r\n\t\t\tconst values = wp[key] as [];\r\n\t\t\tconst iconIndexs = values.find(v => v[0] === this.columnIndex)\r\n\t\t\tif (iconIndexs && iconIndexs[1] === index) {\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn false;\r\n\t}\r\n\r\n\tprivate setSpeedBorderStatus(show: boolean) {\r\n\t\tthis.speddBorderNode.active = show;\r\n\t\tif (show) {\r\n\t\t\tthis.speddBorderNode.setWorldPosition(new Vec3(this.node.worldPosition.x, this.node.worldPosition.y));\r\n\t\t\tDragonv2_Audio.playOneShot(SoundPathDefine.fast_roller)\r\n\t\t\tlet scaleX = config.normalRollOption.expectBorderScaleX;\r\n\t\t\tlet scaleY = config.normalRollOption.expectBorderScaleY;\r\n\t\t\tif (this.props.gameTypeInfo.viewGameType === GameType.SUBGAME1) {\r\n\t\t\t\tscaleX = config.subGameRollOption.expectBorderScaleX;\r\n\t\t\t\tscaleY = config.subGameRollOption.expectBorderScaleY;\r\n\t\t\t}\r\n\r\n\t\t\tthis.speddBorderNode.setScale(new Vec3(scaleX, scaleY, 1));\r\n\t\t}\r\n\t}\r\n\r\n\tprivate buildSkeleton(parentNode: Node, pos: Vec3, iconCount: number) {\r\n\t\t// const fileName = iconCount === 2 ? PrefabPathDefine.TWO_ICON : PrefabPathDefine.THREE_ICON;\r\n\t\t// this.bigNode = instantiate(sourceManageSeletor().getFile(fileName).source);\r\n\t\t// this.bigNode.name = \"bigNode\";\r\n\t\t// parentNode.addChild(this.bigNode);\r\n\t\t// this.bigNode.setWorldPosition(pos);\r\n\t}\r\n\r\n\t/**获得相同图标个数 */\r\n\tprivate getAlikeIconCount() {\r\n\t\tlet count = 1;\r\n\t\tfor (let i = 0; i < this.showIconCount - 1; i++) {\r\n\t\t\tif (this.iconArr[i].getId() === IconId.WILD && this.iconArr[i].getId() === this.iconArr[i + 1].getId()) {\r\n\t\t\t\tcount++;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn count;\r\n\t}\r\n\r\n\t/**停止赢的图标闪烁 */\r\n\tpublic stopWinIcon() {\r\n\t\tthis.iconArr.filter(v => v.getId() !== IconId.SCATTER).forEach(v => v.hideWin());\r\n\t}\r\n\t/**暂停赢的图标 */\r\n\tpublic pauseWinIcon() {\r\n\t\tthis.iconArr.filter(v => v.getId() !== IconId.SCATTER).forEach(v => v.pauseWin());\r\n\t}\r\n\r\n\tprivate hideScatterAnimation() {\r\n\t\tthis.iconArr.filter(v => v.getId() === IconId.SCATTER).forEach(v => v.hideWin());\r\n\t}\r\n\r\n\t/**播放中奖图标动画 */\r\n\tpublic playWinIcon(index) {\r\n\t\tif (this.isRoll) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tconst icon = this.iconArr[index];\r\n\t\t// 如果是WILD图标，并且合并了图标，就不在显示边框了\r\n\t\tif (icon.getId() !== IconId.WILD) {\r\n\t\t\tif (this.propertyNode.props_pyrosphere.children.length > 0) {\r\n\t\t\t\tthis.propertyNode.props_pyrosphere.children.forEach((item: any) => {\r\n\t\t\t\t\tif (item.key == index) {\r\n\t\t\t\t\t\titem.getChildByName('moveRingOfFire').active = false\r\n\t\t\t\t\t\titem.getChildByName('wlid').active = true\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\titem.getChildByName('moveRingOfFire').active = true\r\n\t\t\t\t\t\titem.getChildByName('wlid').active = false\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t}\r\n\t\t\ticon.playWin(this.propertyNode.props_big_icon)\r\n\t\t}\r\n\t}\r\n\t/**播放宝盒动画 */\r\n\tpublic playBaoHeAnimation(done) {\r\n\t\tlet count = 0;\r\n\t\tconst beetleArr = this.iconArr.filter((v, index) => v.getId() === IconId.BEETLE && index < this.showIconCount)\r\n\t\tif (beetleArr.length === 0) {\r\n\t\t\tdone && done();\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tbeetleArr.forEach(v => {\r\n\t\t\tif (this.isSubGame2()) {\r\n\t\t\t\tv.playGame2BaoHeAnimation(() => {\r\n\t\t\t\t\tcount++;\r\n\t\t\t\t\tif (count >= beetleArr.length) {\r\n\t\t\t\t\t\tdone && done();\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\r\n\t\t\t} else {\r\n\t\t\t\tv.playBaoHeAnimation(() => {\r\n\t\t\t\t\tcount++;\r\n\t\t\t\t\tif (count >= beetleArr.length) {\r\n\t\t\t\t\t\tdone && done();\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t}\r\n\t\t})\r\n\t}\r\n\r\n\t/**播放一次scatter动画 */\r\n\tprivate playOneScatterAnimation() {\r\n\t\t// 小游戏2不播放\r\n\t\tif (this.isSubGame2()) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tfor (let i = 0; i < this.showIconCount; i++) {\r\n\t\t\tconst element = this.iconArr[i];\r\n\t\t\tconst freeGame = cacheData.rollerLaunchResult.dl.si[0].freegame;\r\n\t\t\tconst isLoop = Object.keys(freeGame).length > 0 ? true : false;\r\n\t\t\tif (element.getId() === IconId.SCATTER) {\r\n\t\t\t\telement.faceAnimationNode.scale = new Vec3(0.9, 0.9);\r\n\t\t\t\telement.playWin(this.propertyNode.props_big_icon, false, isLoop);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tprivate rollOverHandle() {\r\n\t\tthis.isRoll = false;\r\n\t\tthis.stopIconIndex = -1;\r\n\t\tthis.isSpeedBorder && this.setSpeedBorderStatus(false);\r\n\t\t// this.mergeIcon(this.propertyNode.props_big_icon, rollerLaunchResult);\r\n\t\tthis.playOneScatterAnimation();\r\n\t\t// 滚动结束时，只有在小游戏2才立马添加锁定图标\r\n\t\tthis.isSubGame2() && this.addLockIcon();\r\n\t\tDragonv2_Audio.playOneShot(SoundPathDefine.shell_end)\r\n\t\t// 滚动停止之后需要延迟的时间\r\n\t\tconst time = this.isSubGame2() ? 1.5 : 0.05;\r\n\t\t// const time = 0.05;\r\n\t\tthis.events.onCheckNextLeftCount();\r\n\t\tthis.scheduleOnce(() => {\r\n\t\t\tthis.node.isValid && this.rollOverCallback();\r\n\t\t}, time)\r\n\r\n\t}\r\n\r\n\t/**添加锁定图标 */\r\n\tprivate addLockIcon() {\r\n\t\tconst lockValues = getColumnLockIconArr(cacheData.fixedChessboardIcon, this.columnIndex)\r\n\r\n\t\tlockValues.forEach(v => {\r\n\t\t\tlet DragonV2Icon = this.lockIcons.find(iconv => iconv.getIconIndex() === v.index)\r\n\t\t\tif (!DragonV2Icon) {\r\n\t\t\t\tconst iconConfig = config.icon.find(icon => icon.id === v.iconId)\r\n\t\t\t\tDragonV2Icon = this.iconPool.getIcon(iconConfig, this.propertyNode.props_icon_list, v.index);\r\n\t\t\t\tDragonV2Icon.setAmount(v.amount);\r\n\r\n\t\t\t\tconst replaceIcon = this.iconArr[v.index];\r\n\t\t\t\tDragonV2Icon.setPosition(replaceIcon.getPosition())\r\n\t\t\t\tif (iconConfig.id === 12) {\r\n\t\t\t\t\tDragonV2Icon.amountNode.active = true;\r\n\t\t\t\t}\r\n\t\t\t\treplaceIcon.restore();\r\n\t\t\t\tthis.iconArr[v.index] = DragonV2Icon;\r\n\t\t\t\tlet pot = DragonV2Icon.getPosition()\r\n\t\t\t\tDragonV2Icon.setPosition(new Vec3(pot.x + 15, pot.y))\r\n\t\t\t\tthis.lockIcons.push(DragonV2Icon)\r\n\t\t\t\tthis.removeSingleRollerIcon(v.index);\r\n\t\t\t\tDragonV2Icon.changeIcon(true)\r\n\t\t\t\tDragonV2Icon.playBaoHeAnimation(() => {\r\n\t\t\t\t\t// const endPos = this.node.getComponent(UITransform).convertToNodeSpaceAR(mainViewModel.getStartBtnPos());\r\n\t\t\t\t\t// let ParticleNode = instantiate(sourceManageSeletor().getFile(PrefabPathDefine.Particle2D).source);\r\n\t\t\t\t\t// const startPos = this.node.getComponent(UITransform).convertToNodeSpaceAR(ParticleNode.getWorldPosition());\r\n\t\t\t\t\t// ParticleNode.active = true;\r\n\t\t\t\t\t// console.log(\"ParticleNode\",ParticleNode);\r\n\r\n\t\t\t\t\t// mainViewModel.rollerPanelViewModel.viewNode.addChild(ParticleNode);\r\n\t\t\t\t\t// ParticleNode.setPosition(startPos)\r\n\t\t\t\t\t// tween(ParticleNode).to(config.subGameRollOption.beetleFlyTime, { position: endPos }).call(() => {\r\n\t\t\t\t\t// \tParticleNode.destroy();\r\n\t\t\t\t\t// }).start()\r\n\t\t\t\t})\r\n\t\t\t}\r\n\t\t})\r\n\t}\r\n\r\n\tprivate removeSingleRollerIcon(index: number) {\r\n\t\tfor (let i = 0; i < this.singleIconRollerViewModels.length; i++) {\r\n\t\t\tconst element = this.singleIconRollerViewModels[i];\r\n\t\t\tif (element.comp.getSlotIndex() === index) {\r\n\t\t\t\telement.unMount();\r\n\t\t\t\tthis.singleIconRollerViewModels.splice(i, 1);\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\t/**删除锁定图标 */\r\n\tpublic removeLockIcon() {\r\n\t\t// this.lockIcons.forEach(v => v.borderNode2.active = false)\r\n\t\tthis.lockIcons.forEach(v => v.destory());\r\n\t\tthis.lockIcons = [];\r\n\t}\r\n\r\n\t/**\r\n\t * 根据索引获得图标的位置\r\n\t * @param index \r\n\t * @returns \r\n\t */\r\n\tprivate getIconPosByIndex(index: number) {\r\n\t\tconst height = config.normalRollOption.singleRollerHeight;\r\n\t\tconst interval = this.intervalHeight * (index + 1)\r\n\t\tconst y = interval + height / 2 + height * index;\r\n\t\treturn new Vec3(0, y);\r\n\t}\r\n\r\n\t/**替换单个滚动图标 */\r\n\tpublic replaceSingleRollerIcon() {\r\n\t\tconsole.log('替换滚动图标');\r\n\t\tconst lockValues = getColumnLockIconArr(cacheData.fixedChessboardIcon, this.columnIndex)\r\n\t\tfor (let i = 0; i < this.iconArr.length; i++) {\r\n\t\t\tconst v = this.iconArr[i];\r\n\t\t\t// 替换不是甲壳虫和太阳神图标\r\n\t\t\t// if (!this.isSubGame2SpecialIcon(v.getId())) {\r\n\t\t\tif (!lockValues.find(lock => lock.index === i)) {\r\n\t\t\t\tthis.buildSingleRollerIcon(i, v.getPosition(), v);\r\n\t\t\t\tv.getNode().active = false;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\t/**替换多个滚动图标 */\r\n\tpublic replaceMultiRollerIcon() {\r\n\t\tthis.singleIconRollerViewModels.forEach(v => {\r\n\t\t\tconst firstIcon = v.comp.getFirstIcon();\r\n\t\t\tfirstIcon.getNode().removeFromParent();\r\n\r\n\t\t\tconst index = v.comp.getSlotIndex();\r\n\t\t\tthis.propertyNode.props_icon_list.addChild(firstIcon.getNode());\r\n\t\t\tfirstIcon.setPosition(this.getIconPosByIndex(index))\r\n\t\t\tthis.iconArr[index] = firstIcon;\r\n\r\n\t\t\tv.unMount();\r\n\t\t})\r\n\r\n\t\tthis.lockIcons = [];\r\n\t\tthis.singleIconRollerViewModels = [];\r\n\t}\r\n\r\n\t/**构建单个图标滚动 */\r\n\tprivate buildSingleRollerIcon(index: number, pos: Vec3, icon: DragonV2Icon) {\r\n\t\tconst viewModel = new DragonV2SingleIconRollerViewModel()\r\n\t\t\t.mountView(sourceManageSeletor().getFile(PrefabPathDefine.SINGLE_ICON_ROLLER).source)\r\n\t\t\t.appendTo(this.propertyNode.props_icon_list);\r\n\t\tthis.singleIconRollerViewModels.push(viewModel);\r\n\t\tviewModel.viewNode.setPosition(pos);\r\n\r\n\t\tviewModel.comp.initSlot(this.columnIndex, index, icon.getIconIndex(), this.iconPool);\r\n\t}\r\n\r\n\t/**多图标滚动 */\r\n\tprivate multiIconRoller() {\r\n\t\tthis.iconArr.forEach(v => {\r\n\t\t\tv.setPosition(new Vec3(v.getPosition().x, v.getPosition().y - this.getRollSpeed()));\r\n\t\t})\r\n\r\n\t\tconst frist = this.iconArr[0];\r\n\t\tif (frist.getPosition().y <= -(frist.getHeight() / 2 + this.intervalHeight)) {\r\n\t\t\tif (this.rollerCount >= 0) {\r\n\t\t\t\tthis.rollerCount++;\r\n\t\t\t}\r\n\t\t\tthis.iconArr.shift()\r\n\t\t\tfrist.restore();\r\n\t\t\tthis.joinIcon();\r\n\t\t\tconst endIcon = this.iconArr[2]\r\n\r\n\t\t\tif (endIcon.getIconIndex() === this.getStopIconIndex()) {\r\n\t\t\t\t// console.log(`xxxxxxxxxxx-----columnIndex:${this.columnIndex},stopIconIndex:${this.stopIconIndex},endIcon.getIconIndex():${endIcon.getIconIndex()},this.getStopIconIndex():${this.getStopIconIndex()}`);\r\n\t\t\t\tthis.isRoll = false;\r\n\t\t\t\tthis.stopIconIndex = -1;\r\n\r\n\t\t\t\t// 结束之后计算每个图标的最终位置，\r\n\t\t\t\tlet count = 0;\r\n\t\t\t\tfor (let i = 0; i < this.iconArr.length; i++) {\r\n\t\t\t\t\tconst icon = this.iconArr[i];\r\n\t\t\t\t\ttween(icon.getNode()).to(0.1, { position: this.getIconPosByIndex(i) }).call(() => {\r\n\t\t\t\t\t\tcount++;\r\n\t\t\t\t\t\tif (count >= this.iconArr.length) {\r\n\t\t\t\t\t\t\tthis.node && this.node.isValid && this.rollOverHandle();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}).start();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tprivate isMultiRoll() {\r\n\t\treturn this.props.gameTypeInfo.viewGameType === GameType.MAIN || this.props.gameTypeInfo.viewGameType === GameType.SUBGAME1;\r\n\t}\r\n\r\n\t/**停止单个图标的滚动 */\r\n\tprivate stopSingleRollerIcon() {\r\n\t\tlet count = 0;\r\n\t\tif (this.singleIconRollerViewModels.length === 0) {\r\n\t\t\tthis.isRoll = false;\r\n\t\t\tthis.node && this.node.isValid && this.rollOverHandle();\r\n\t\t} else {\r\n\t\t\tthis.singleIconRollerViewModels.forEach(v => v.comp.stopRoll(this.stopIconIndex, () => {\r\n\t\t\t\tcount++;\r\n\t\t\t\tif (count >= this.singleIconRollerViewModels.length) {\r\n\t\t\t\t\tthis.isRoll = false;\r\n\t\t\t\t\tthis.node && this.node.isValid && this.rollOverHandle();\r\n\t\t\t\t}\r\n\t\t\t}));\r\n\t\t}\r\n\t}\r\n\r\n\t/**获得宝盒上面的数字节点 */\r\n\tpublic getBeetleAmountNode() {\r\n\t\tconst nodes: Node[] = [];\r\n\t\tfor (let i = 0; i < this.showIconCount; i++) {\r\n\t\t\tconst element = this.iconArr[i];\r\n\t\t\tif (this.isSubGame2SpecialIcon(element.getId())) {\r\n\t\t\t\tconst amountNode = element.getAmountNode();\r\n\t\t\t\tamountNode && nodes.push(amountNode);\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn nodes;\r\n\t}\r\n\r\n\t/**获得宝盒上面的数字节点 */\r\n\tpublic getBaoHeParticleNode() {\r\n\t\tconsole.log(this.iconArr,this.columnIndex);\r\n\t\t\r\n\t\tconst ParticleNodes: Node[] = [];\r\n\t\tfor (let i = 0; i < this.showIconCount; i++) {\r\n\t\t\tconst element = this.iconArr[i];\r\n\t\t\t\r\n\t\t\tif (this.isSubGame2SpecialIcon(element.getId())) {\r\n\t\t\t\tconst amountNode = element.getAmountNode();\r\n\t\t\t\tamountNode && ParticleNodes.push(amountNode);\r\n\t\t\t\t//  const ParticleNode = element.getParticleNode();\r\n\t\t\t\t// console.log(ParticleNode,'sssssss');\r\n\t\t\t\t// ParticleNode && ParticleNodes.push(ParticleNode);\r\n\t\t\t}\r\n\t\t}\r\n\t\tconsole.log(\"ParticleNodes\",ParticleNodes);\r\n\t\treturn ParticleNodes;\r\n\t}\r\n\r\n\r\n\tupdate(deltaTime: number) {\r\n\t\tif (this.isRoll && this.iconArr.length > 0) {\r\n\t\t\tif (this.isMultiRoll()) {\r\n\t\t\t\tthis.multiIconRoller();\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}\r\n\r\n"]}