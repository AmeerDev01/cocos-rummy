{"version":3,"sources":["file:///Users/geliang/web/dibai/hall/assets/script/hall/viewModel/MainPanelViewModel.ts"],"names":["MainPanelViewModel","Prefab","sys","ViewModel","PrefabPathDefine","EffectType","ApiUrl","baseBoardView","fetcher","global","lang","sourceManageSeletor","SKT_MAG_TYPE","sktInstance","sktMsgListener","ToastType","addToastAction","changeWebView","setLoadingAction","setMemberInfo","setVip","ActivityViewModel","BankViewModel","BindPhoneViewModel","MailBoxViewModel","PersonCenterViewModel","ShareHelpViewModel","ShareSureViewModel","ShopViewModel","SignInViewModel","VipMainViewModel","VipUpViewModel","WithdrawalViewModel","BaseViewModel","config","BuyType","getFirebaseToken","getPackageName","pullPurchaseEvents","purchaseAppsflyerEvents","Task","TaskSchedulerDefault","md5","NATIVE","constructor","personCenterViewModel","giftBoxVM","winningBoxVM","serviceVm","isAutoGiftPop","lastUserGlod","isOpenShop","isCheckPop","retryCount","begin","sendSktMessage","MEMBER_INFO","isLoading","add","data","dispatch","isShow","comp","props","memberAssetGoldPieces","openReliefPanel","send","POP_UPS","then","rsp","activityVo","mallVo","signInVo","upgradesVo","queue","key","sort","a","b","forEach","item","popUps","joinqQueue","done","openAwardPanel","openSign","parentNode","openUpgradePanel","isUnMount","unMount","e","console","error","catch","addOnce","LOG_EXIT","subGameInfo","closeSubGame","confirmContent","write","k","BaseBoardModule","BaseBoardLogin","placeStr","logOut","GIFT_LIST","setGiftButtonDisplay","filter","i","separatePage","length","openGiftBoxanel","WINNING_BOX","pushWinningData","VIP_CHANGE","openVipUp","inceptionVipLevel","vipLevelExperience","RECHANGE_CALLBACK","rechangeCallbackHandle","FRIST_LOGIN","fristLogin","main","getFileAsync","_WINNING_BOX","source","mountView","appendTo","getPropertyNode","props_winnerBox","setEvent","onOpenPersonCenter","index","openPc","onOpenBankPanel","openBank","onOpenMailPanel","mailBoxViewModel","_HELL_MAIL","viewNode","effectType","EFFECT1","isModal","onCloseHandler","EFFECT2","onOpenShopPanel","openShop","onOpenWithdrawalPanel","withdrawalViewModel","getFile","HELL_WITHDRAWAL","onClosePanel","connect","onOpenBindPhonePanel","openBindPhone","onOpenUpgradePanel","onOpenAwardPanel","onOpenGiftBoxanel","onOpenSignInPanel","onOpenVipMainPanel","openVipMain","onOpenService","_HELL_SERVICE_WEBVIEW","setProps","openUrl","customerUrl","nickName","isGuide","os","OS","ANDROID","IOS","window","navigator","OSX","WINDOWS","_HELL_APP_DOWNLOAD_PANEL_IOS","_HELL_APP_DOWNLOAD_PANEL","file","appDownLoadVM","preGoToDownLoad","bingFcmToken","initActivityUnreadStatus","unMountCallBack","removeById","isForce","nodeWrap","bindPhoneViewModel","_HELL_BIND_PHONE","closeHandler","tourist","upgradeViewModel","_HELL_UPGRADE","doneHandler","memberId","openChangePassword","changePwdViewModel","_HELL_CHANGE_PASSWORD","activityViewModel","_HELL_ACTIVITY","defaultBuyType","COIN","shopViewModel","HELL_SHOP","PC_MAIN_PANEL","profileShowIndex","goToShop","bindPhone","openChangePwdPanel","logOutHandler","content","palyingModule","GameExit","openShareHelp","onOpenShareHelp","openShareSure","actingId","promotionCode","onOpenShareSure","isTouristPass","bankViewModel","_HELL_BANK","isMustSetPwd","Promise","resolve","reject","IS_SET_PWD","isDecideShow","HELL_GIFT_BAG","giftList","isAutoShowPopItem","signInViewModel","_HELL_SIGN_IN","close","_HELL_VIP_UP","_HELL_VIP_MAIN","_SHARE_HELP","relief","BENEFIT","undefined","reLiefPanel","_HELL_RE_LIEF","amount","HallModule","CantEditProfile","MainPaneModule","MainPanelCodeError","type","NORMAL","RECOMMEND_MEMBER_INFO","MainPanelPromotion","_SHARE_SURE","avatarIndex","orderOperations","rechargeAmount","currency","isFirstRecharge","salt","token","keys","log","FCM_TOKEN_BIND","scheduleOnce","initReadStatus","inject","state","memberInfo","vipLevel","level","baseBoard","memberName","isConnect","retryConnectTimes","appDownLoadGuide","isUnreadActivity"],"mappings":"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","sourcesContent":["import { Node, Prefab, sys } from \"cc\";\r\nimport ViewModel from \"../../base/ViewModel\";\r\nimport { PrefabPathDefine } from '../../hall/sourceDefine/prefabDefine';\r\nimport { EffectType } from \"../../utils/NodeIOEffect\";\r\nimport { ApiUrl } from \"../apiUrl\";\r\nimport { Hall_MainPanel, IEvent, IProps } from \"../components/Hall_MainPanel\";\r\nimport { baseBoardView, fetcher, global, lang, sourceManageSeletor } from \"../index\";\r\nimport { SKT_MAG_TYPE, sktInstance, sktMsgListener } from \"../socketConnect\";\r\nimport { ToastType, addToastAction, changeWebView, setAppDownLoadGuide, setLoadingAction } from \"../store/actions/baseBoard\";\r\nimport { setMemberInfo, setVip } from \"../store/actions/memberInfo\";\r\nimport { StateType } from \"../store/reducer\";\r\nimport ActivityViewModel from \"./ActivityViewModel\";\r\nimport BankViewModel from \"./BankViewModel\";\r\nimport BindPhoneViewModel from \"./BindPhoneViewModel\";\r\nimport MailBoxViewModel from \"./MailBoxViewModel\";\r\nimport PersonCenterViewModel from \"./PersonCenterViewModel\";\r\nimport ShareHelpViewModel from \"./ShareHelpViewModel\";\r\nimport ShareSureViewModel from \"./ShareSureViewModel\";\r\nimport ShopViewModel from \"./ShopViewModel\";\r\nimport SignInViewModel from \"./SignInViewModel\";\r\nimport VipMainViewModel from \"./VipMainViewModel\";\r\nimport VipUpViewModel from \"./VipUpViewModel\";\r\nimport WithdrawalViewModel from \"./WithdrawalViewModel\";\r\nimport BaseViewModel from \"./BaseViewModel\";\r\nimport { Hall_Service, IState as SIState, IProps as SIProps, IEvent as SIEvent } from '../components/Hall_Service';\r\nimport { Hall_GiftBag, IState as GBState, IProps as GBProps, IEvent as GBEvent, GiftItemType } from '../components/Hall_GiftBag';\r\nimport { config } from \"../config\";\r\nimport { Hall_Upgrade, IState as UGIState, IProps as UGIProps, IEvent as UGIEvent } from \"../components/Hall_Upgrade\";\r\nimport { Hall_ChangePassword, IState as CPIState, IProps as CPIProps, IEvent as CPIEvent } from \"../components/Hall_ChangePassword\";\r\nimport { Hall_ReliefPanel, IState as RPIState, IProps as RPIProps, IEvent as RPIEvent } from \"../components/Hall_ReliefPanel\";\r\nimport { BuyType } from \"../components/Hall_ShopPanel\";\r\nimport { Hall_WinningBox, IState as WBState, IProps as WBProps, IEvent as WBEvent, WinningType } from \"../components/Hall_WinningBox\";\r\nimport { Hall_AppDownLoadGuide, IState as ALState, IProps as ALProps, IEvent as ALEvent } from \"../components/Hall_AppDownLoadGuide\";\r\nimport { getFirebaseToken, getPackageName, pullPurchaseEvents, purchaseAppsflyerEvents } from \"../../common/bridge\";\r\nimport { Task, TaskSchedulerDefault } from \"../../utils/TaskScheduler\";\r\nimport { RechangeCallbackVo } from \"../hallType\";\r\nimport md5 from \"md5\";\r\nimport { NATIVE } from \"cc/env\";\r\n\r\ntype PopType = {\r\n\tpopUps: boolean,\r\n\tsort: number\r\n}\r\nclass MainPanelViewModel extends ViewModel<Hall_MainPanel, IProps, IEvent> {\r\n\tconstructor() {\r\n\t\tsuper('Hall_MainPanel')\r\n\t}\r\n\tprivate personCenterViewModel: PersonCenterViewModel\r\n\tprivate giftBoxVM: BaseViewModel<Hall_GiftBag, GBState, GBProps, GBEvent>\r\n\tprivate winningBoxVM: BaseViewModel<Hall_WinningBox, WBState, WBProps, WBEvent>\r\n\tprivate serviceVm: BaseViewModel<Hall_Service, SIState, SIProps, SIEvent>\r\n\tprivate isAutoGiftPop: boolean = true\r\n\t/**用于只有金额变化之后才开始判断救济金 */\r\n\tprivate lastUserGlod: number = -1\r\n\t/**用于防止打开商城的时候，收到的消息导致还打开礼包弹窗(因为商城也会发送礼包socket) */\r\n\tprivate isOpenShop: boolean = false\r\n\t/**用于只检查一次的值 */\r\n\tprivate isCheckPop: boolean = false\r\n\tprotected begin() {\r\n\t\tsktInstance.sendSktMessage(SKT_MAG_TYPE.MEMBER_INFO, {}, { isLoading: true })\r\n\t\tsktMsgListener.add(SKT_MAG_TYPE.MEMBER_INFO, \"main\", (data) => {\r\n\t\t\tthis.dispatch(setMemberInfo({ ...data }))\r\n\t\t\tthis.dispatch(setLoadingAction({ isShow: false }))\r\n\t\t\tif (this.lastUserGlod !== this.comp.props.memberAssetGoldPieces) {\r\n\t\t\t\tthis.openReliefPanel()\r\n\t\t\t\tthis.lastUserGlod = this.comp.props.memberAssetGoldPieces\r\n\t\t\t}\r\n\t\t\t!this.isCheckPop && fetcher.send(ApiUrl.POP_UPS, {}, \"get\").then((rsp: { [key: string]: PopType }) => {\r\n\t\t\t\ttry {\r\n\t\t\t\t\tconst { activityVo, mallVo, signInVo, upgradesVo } = rsp\r\n\t\t\t\t\tconst queue = [{ key: 'activityVo', ...activityVo }, { key: 'signInVo', ...signInVo }, { key: 'upgradesVo', ...upgradesVo }].sort((a, b) => a.sort - b.sort)\r\n\t\t\t\t\tqueue.forEach(item => {\r\n\t\t\t\t\t\tif (item.popUps && item.key === 'activityVo') {\r\n\t\t\t\t\t\t\tTaskSchedulerDefault().joinqQueue(new Task((done) => this.openAwardPanel(() => {\r\n\t\t\t\t\t\t\t\tdone()\r\n\t\t\t\t\t\t\t})))\r\n\t\t\t\t\t\t} else if (item.popUps && item.key === 'signInVo') {\r\n\t\t\t\t\t\t\tTaskSchedulerDefault().joinqQueue(new Task((done) => this.openSign(this.parentNode, () => {\r\n\t\t\t\t\t\t\t\tdone()\r\n\t\t\t\t\t\t\t})))\r\n\t\t\t\t\t\t} else if (item.popUps && item.key === 'upgradesVo') {\r\n\t\t\t\t\t\t\tTaskSchedulerDefault().joinqQueue(new Task((done) => this.openUpgradePanel(this.parentNode, () => {\r\n\t\t\t\t\t\t\t\tdone()\r\n\t\t\t\t\t\t\t})))\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (item.popUps) {\r\n\t\t\t\t\t\t\t//客服窗口使用的webview，如果出现叠加弹窗，会出现被覆盖的情况，要先关闭掉客服\r\n\t\t\t\t\t\t\tthis.serviceVm && !this.serviceVm.isUnMount && this.serviceVm.unMount()\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t})\r\n\t\t\t\t\tthis.isAutoGiftPop = mallVo.popUps\r\n\t\t\t\t} catch (e) {\r\n\t\t\t\t\tconsole.error('pop_ups data error')\r\n\t\t\t\t}\r\n\t\t\t}).catch((e) => { })\r\n\t\t\tthis.isCheckPop = true\r\n\t\t})\r\n\t\tsktMsgListener.addOnce(SKT_MAG_TYPE.LOG_EXIT, \"log\", () => {\r\n\t\t\tif (this.comp.props && this.comp.props.subGameInfo) {\r\n\t\t\t\tglobal.closeSubGame({\r\n\t\t\t\t\tconfirmContent: lang.write(k => k.BaseBoardModule.BaseBoardLogin, {}, { placeStr: '抱歉，您的登录信息变更，已自动退出~' })\r\n\t\t\t\t})\r\n\t\t\t}\r\n\t\t\tthis.logOut(true)\r\n\t\t})\r\n\t\tsktMsgListener.add(SKT_MAG_TYPE.GIFT_LIST, \"mainboard\", (data: Array<GiftItemType>) => {\r\n\t\t\tif (this.isOpenShop) return\r\n\t\t\tthis.comp.setGiftButtonDisplay(!data.filter(i => i.separatePage === 1).length ? false : true)\r\n\t\t\tif (this.isAutoGiftPop) {\r\n\t\t\t\tthis.serviceVm && !this.serviceVm.isUnMount && this.serviceVm.unMount()\r\n\t\t\t\tthis.openGiftBoxanel(true, data)\r\n\t\t\t}\r\n\t\t})\r\n\t\tsktMsgListener.add(SKT_MAG_TYPE.WINNING_BOX, \"main\", (data: WinningType) => {\r\n\t\t\t// this.winningBoxVM.setProps({ newWinningItem: data })\r\n\t\t\tthis.winningBoxVM && this.winningBoxVM.comp.pushWinningData(data)\r\n\t\t})\r\n\r\n\t\tsktMsgListener.addOnce(SKT_MAG_TYPE.VIP_CHANGE, \"log\", (data) => {\r\n\t\t\tthis.openVipUp();\r\n\t\t\tthis.dispatch(setVip(data.inceptionVipLevel, data.vipLevelExperience));\r\n\t\t})\r\n\t\tsktMsgListener.add(SKT_MAG_TYPE.RECHANGE_CALLBACK, \"main\", (data: RechangeCallbackVo) => {\r\n\t\t\tthis.rechangeCallbackHandle(data);\r\n\t\t})\r\n\r\n\t\tsktMsgListener.add(SKT_MAG_TYPE.FRIST_LOGIN, \"main\", (data: RechangeCallbackVo) => {\r\n\t\t\tconfig.fristLogin.main = true\r\n\t\t})\r\n\r\n\t\tif (!this.winningBoxVM) {\r\n\t\t\tsourceManageSeletor().getFileAsync(PrefabPathDefine._WINNING_BOX, Prefab).then(({ source }) => {\r\n\t\t\t\tthis.winningBoxVM = new BaseViewModel<Hall_WinningBox, WBState, WBProps, WBEvent>(\"Hall_WinningBox\").mountView(source)\r\n\t\t\t\t\t.appendTo((baseBoardView.comp.getPropertyNode().props_winnerBox as Node))\r\n\t\t\t})\r\n\t\t}\r\n\t\tthis.setEvent({\r\n\t\t\tonOpenPersonCenter: (index?: number) => {\r\n\t\t\t\tthis.openPc(index)\r\n\t\t\t},\r\n\t\t\tonOpenBankPanel: () => {\r\n\t\t\t\tthis.openBank()\r\n\t\t\t},\r\n\t\t\tonOpenMailPanel: async () => {\r\n\t\t\t\tconst mailBoxViewModel = new MailBoxViewModel().mountView(\r\n\t\t\t\t\t(await sourceManageSeletor().getFileAsync(PrefabPathDefine._HELL_MAIL, Prefab)).source)\r\n\t\t\t\t\t.appendTo(this.viewNode, { effectType: EffectType.EFFECT1, isModal: true }).setEvent({\r\n\t\t\t\t\t\tonCloseHandler: () => {\r\n\t\t\t\t\t\t\tmailBoxViewModel.unMount(EffectType.EFFECT2)\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t})\r\n\t\t\t},\r\n\t\t\tonOpenShopPanel: () => {\r\n\t\t\t\tthis.openShop()\r\n\t\t\t},\r\n\t\t\tonOpenWithdrawalPanel: () => {\r\n\t\t\t\tconst withdrawalViewModel = new WithdrawalViewModel().mountView(sourceManageSeletor().getFile(PrefabPathDefine.HELL_WITHDRAWAL).source)\r\n\t\t\t\t\t.appendTo(this.viewNode, { effectType: EffectType.EFFECT1, isModal: true }).setEvent({\r\n\t\t\t\t\t\tonClosePanel: () => {\r\n\t\t\t\t\t\t\twithdrawalViewModel.unMount(EffectType.EFFECT2)\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}).connect()\r\n\t\t\t},\r\n\t\t\tonOpenBindPhonePanel: () => {\r\n\t\t\t\tthis.openBindPhone()\r\n\t\t\t},\r\n\t\t\tonOpenUpgradePanel: () => {\r\n\t\t\t\tthis.openUpgradePanel()\r\n\t\t\t},\r\n\t\t\tonOpenAwardPanel: () => {\r\n\t\t\t\tthis.openAwardPanel()\r\n\t\t\t},\r\n\t\t\tonOpenGiftBoxanel: () => this.openGiftBoxanel(false),\r\n\t\t\tonOpenSignInPanel: () => this.openSign(),\r\n\t\t\tonOpenVipMainPanel: () => {\r\n\t\t\t\tthis.openVipMain();\r\n\t\t\t},\r\n\t\t\tonOpenService: async () => {\r\n\t\t\t\tthis.serviceVm = new BaseViewModel<Hall_Service, SIState, SIProps, SIEvent>('Hall_Service').mountView(\r\n\t\t\t\t\t(await sourceManageSeletor().getFileAsync(PrefabPathDefine._HELL_SERVICE_WEBVIEW, Prefab)).source)\r\n\t\t\t\t\t.appendTo(this.viewNode, { effectType: EffectType.EFFECT1, isModal: true }).setEvent({\r\n\t\t\t\t\t\tonClosePanel: () => {\r\n\t\t\t\t\t\t\tthis.serviceVm.unMount(EffectType.EFFECT2)\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}).setProps({\r\n\t\t\t\t\t\topenUrl: `${config.customerUrl}?nc=${this.comp.props.nickName}`\r\n\t\t\t\t\t})\r\n\t\t\t}\r\n\t\t})\r\n\t\tconst isGuide = (sys.os === sys.OS.ANDROID && getPackageName() === 'web')\r\n\t\t\t|| (sys.os === sys.OS.IOS && !window.navigator['standalone'])\r\n\t\t\t|| sys.os === sys.OS.OSX\r\n\t\t\t|| sys.os === sys.OS.WINDOWS\r\n\t\tif (isGuide) {\r\n\t\t\tsourceManageSeletor().getFileAsync(sys.os === sys.OS.IOS ? PrefabPathDefine._HELL_APP_DOWNLOAD_PANEL_IOS : PrefabPathDefine._HELL_APP_DOWNLOAD_PANEL, Prefab).then(file => {\r\n\t\t\t\tconst appDownLoadVM = new BaseViewModel<Hall_AppDownLoadGuide, ALState, ALProps, ALEvent>('Hall_AppDownLoadGuide').mountView(file.source)\r\n\t\t\t\t\t.appendTo(this.viewNode).setEvent({ preGoToDownLoad: () => \"\" })\r\n\t\t\t})\r\n\t\t}\r\n\r\n\t\tthis.bingFcmToken();\r\n\t\tthis.initActivityUnreadStatus();\r\n\t}\r\n\r\n\tprotected unMountCallBack(): void {\r\n\t\tsktMsgListener.removeById(\"main\")\r\n\t\tthis.personCenterViewModel && this.personCenterViewModel.unMount()\r\n\t}\r\n\r\n\tpublic logOut(isForce: boolean = false) { }\r\n\r\n\t/**打开手机绑定框 */\r\n\tprivate async openBindPhone(nodeWrap?: Node) {\r\n\t\tconst bindPhoneViewModel = new BindPhoneViewModel().mountView((await sourceManageSeletor().getFileAsync(PrefabPathDefine._HELL_BIND_PHONE, Prefab)).source)\r\n\t\t\t.appendTo(nodeWrap || this.parentNode, { effectType: EffectType.EFFECT1, isModal: true }).setEvent({\r\n\t\t\t\tonClosePanel: () => {\r\n\t\t\t\t\tbindPhoneViewModel.unMount(EffectType.EFFECT1)\r\n\t\t\t\t}\r\n\t\t\t}).connect()\r\n\t}\r\n\t/**打开升级框 */\r\n\tpublic async openUpgradePanel(nodeWrap?: Node, closeHandler?: () => void) {\r\n\t\tif (!this.comp.props.tourist) {\r\n\t\t\tcloseHandler && closeHandler()\r\n\t\t\treturn\r\n\t\t}\r\n\t\tconst upgradeViewModel = new BaseViewModel<Hall_Upgrade, UGIState, UGIProps, UGIEvent>('Hall_Upgrade').mountView((await sourceManageSeletor().getFileAsync(PrefabPathDefine._HELL_UPGRADE, Prefab)).source)\r\n\t\t\t.appendTo(nodeWrap || this.parentNode, { effectType: EffectType.EFFECT1, isModal: true }).setEvent({\r\n\t\t\t\tonClosePanel: () => upgradeViewModel.unMount(EffectType.EFFECT1).then(() => closeHandler && closeHandler()),\r\n\t\t\t\tdoneHandler: () => {\r\n\t\t\t\t\tsktInstance.sendSktMessage(SKT_MAG_TYPE.MEMBER_INFO, {})\r\n\t\t\t\t\tupgradeViewModel.unMount()\r\n\t\t\t\t}\r\n\t\t\t}).setProps({ memberId: this.comp.props.memberId })\r\n\t}\r\n\t/**打开修改密码框 */\r\n\tpublic async openChangePassword(nodeWrap?: Node) {\r\n\t\tconst changePwdViewModel = new BaseViewModel<Hall_ChangePassword, CPIState, CPIProps, CPIEvent>('Hall_ChangePassword').mountView(\r\n\t\t\t(await sourceManageSeletor().getFileAsync(PrefabPathDefine._HELL_CHANGE_PASSWORD, Prefab)).source)\r\n\t\t\t.appendTo(nodeWrap || this.parentNode, { effectType: EffectType.EFFECT1, isModal: true }).setEvent({\r\n\t\t\t\tonClosePanel: () => changePwdViewModel.unMount(EffectType.EFFECT1),\r\n\t\t\t\tdoneHandler: () => changePwdViewModel.unMount()\r\n\t\t\t})\r\n\t}\r\n\t/**打开活动面板 */\r\n\tpublic async openAwardPanel(closeHandler?: () => void) {\r\n\t\tconst activityViewModel = new ActivityViewModel().mountView((await sourceManageSeletor().getFileAsync(PrefabPathDefine._HELL_ACTIVITY, Prefab)).source)\r\n\t\t\t.appendTo(this.viewNode, { effectType: EffectType.EFFECT1, isModal: true }).setEvent({\r\n\t\t\t\tonClosePanel: () => {\r\n\t\t\t\t\tactivityViewModel.unMount(EffectType.EFFECT2).then(() => {\r\n\t\t\t\t\t\tcloseHandler && closeHandler()\r\n\t\t\t\t\t})\r\n\t\t\t\t}\r\n\t\t\t}).connect()\r\n\t}\r\n\r\n\tpublic openShop(defaultBuyType: BuyType = BuyType.COIN, nodeWrap?: Node, closeHandler?: () => void) {\r\n\t\tthis.isOpenShop = true\r\n\t\tconst shopViewModel = new ShopViewModel().mountView(sourceManageSeletor().getFile(PrefabPathDefine.HELL_SHOP).source)\r\n\t\t\t.appendTo(nodeWrap || this.parentNode, { effectType: EffectType.EFFECT1, isModal: true })\r\n\t\t\t.setProps({ defaultBuyType })\r\n\t\t\t.setEvent({\r\n\t\t\t\tonClosePanel: () => {\r\n\t\t\t\t\tthis.isOpenShop = false\r\n\t\t\t\t\tshopViewModel.unMount(EffectType.EFFECT2).then(() => closeHandler && closeHandler())\r\n\t\t\t\t}\r\n\t\t\t}).connect()\r\n\t}\r\n\r\n\tpublic openPc(index: number = 1, nodeWrap?: Node) {\r\n\t\tthis.personCenterViewModel = new PersonCenterViewModel().mountView(sourceManageSeletor().getFile(PrefabPathDefine.PC_MAIN_PANEL).source)\r\n\t\t\t.appendTo(nodeWrap || this.parentNode, { effectType: EffectType.EFFECT1, isModal: true })\r\n\t\t\t.setProps({\r\n\t\t\t\tprofileShowIndex: index\r\n\t\t\t})\r\n\t\t\t.setEvent({\r\n\t\t\t\tonClosePanel: () => {\r\n\t\t\t\t\tthis.personCenterViewModel.unMount(EffectType.EFFECT2)\r\n\t\t\t\t},\r\n\t\t\t\tgoToShop: () => {\r\n\t\t\t\t\tthis.openShop()\r\n\t\t\t\t},\r\n\t\t\t\tbindPhone: () => {\r\n\t\t\t\t\tthis.openBindPhone()\r\n\t\t\t\t},\r\n\t\t\t\topenChangePwdPanel: () => {\r\n\t\t\t\t\tthis.openChangePassword()\r\n\t\t\t\t},\r\n\t\t\t\tlogOutHandler: () => {\r\n\t\t\t\t\tif (!this.comp.props.subGameInfo) {\r\n\t\t\t\t\t\tthis.logOut()\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tthis.dispatch(addToastAction({ content: lang.write(k => k.palyingModule.GameExit, {}, { placeStr: \"子游戏中不可以退出\" }) }))\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\topenShareHelp: () => {\r\n\t\t\t\t\tthis.onOpenShareHelp();\r\n\t\t\t\t},\r\n\t\t\t\topenShareSure: (actingId: string, promotionCode: string) => {\r\n\t\t\t\t\tthis.onOpenShareSure(actingId, promotionCode);\r\n\t\t\t\t}\r\n\t\t\t}).connect()\r\n\t}\r\n\r\n\tpublic async openBank(nodeWrap?: Node) {\r\n\t\tif (!this.isTouristPass()) return\r\n\t\tconst bankViewModel = new BankViewModel().mountView((await sourceManageSeletor().getFileAsync(PrefabPathDefine._HELL_BANK, Prefab)).source)\r\n\t\t\t.setEvent({\r\n\t\t\t\tonClosePanel: () => {\r\n\t\t\t\t\tbankViewModel.unMount(EffectType.EFFECT2)\r\n\t\t\t\t},\r\n\t\t\t\tisMustSetPwd: () => {\r\n\t\t\t\t\treturn new Promise((resolve, reject) => {\r\n\t\t\t\t\t\tfetcher.send(ApiUrl.IS_SET_PWD, {}, \"get\").then((rsp) => {\r\n\t\t\t\t\t\t\tresolve(rsp)\r\n\t\t\t\t\t\t}).catch((e) => {\r\n\t\t\t\t\t\t\treject(e)\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t})\r\n\t\t\t\t}\r\n\t\t\t}).appendTo(nodeWrap || this.parentNode, { effectType: EffectType.EFFECT1, isModal: true }).connect()\r\n\t}\r\n\r\n\t/**\r\n\t * 打开礼包弹出框\r\n\t * @param isDecideShow 是否还需要判断下自动弹出(数据无弹出标识，就不弹出),此值为true时，第二个参数应该赋值，不然肯定弹窗\r\n\t * @param data 传入的数据，可选\r\n\t */\r\n\tpublic openGiftBoxanel(isDecideShow: boolean, data?: Array<GiftItemType>) {\r\n\t\tif (this.giftBoxVM && !this.giftBoxVM.isUnMount) {\r\n\t\t\t//如果窗口已经是打开状态，不予执行\r\n\t\t\treturn\r\n\t\t}\r\n\t\t// if (isDecideShow && data && !data.some(i => i.separatePage === 1)) {\r\n\t\tif (isDecideShow && data && !data.filter(i => i.separatePage === 1).length) {\r\n\t\t\t//如果无数据就不自动弹\r\n\t\t\treturn\r\n\t\t}\r\n\t\tthis.giftBoxVM = new BaseViewModel<Hall_GiftBag, GBState, GBProps, GBEvent>('Hall_GiftBag').mountView(sourceManageSeletor().getFile(PrefabPathDefine.HELL_GIFT_BAG).source)\r\n\t\t\t.appendTo(this.viewNode, { effectType: EffectType.EFFECT1, isModal: true }).setEvent({\r\n\t\t\t\tonClosePanel: () => {\r\n\t\t\t\t\tthis.giftBoxVM.unMount(EffectType.EFFECT2)\r\n\t\t\t\t}\r\n\t\t\t}).setProps({\r\n\t\t\t\tgiftList: data ? data.filter(i => i.separatePage === 1) : [],\r\n\t\t\t\tisAutoShowPopItem: isDecideShow\r\n\t\t\t})\r\n\t}\r\n\t/**打开签到页 */\r\n\tpublic async openSign(nodeWrap?: Node, closeHandler?: () => void) {\r\n\t\t//这里有个巨坑，SignInViewModel的begin里面声明了close事件，所以直接链式申明起不到作用,Jacky布的坑\r\n\t\t// sourceManageSeletor().getFileAsync(PrefabPathDefine._HELL_SIGN_IN, Prefab).then((source) => {\r\n\t\t// \tconst signInViewModel = new SignInViewModel().mountView(source)\r\n\t\t// \t.appendTo(nodeWrap || this.parentNode, { effectType: EffectType.EFFECT1, isModal: true })\r\n\t\t// \t.setEvent({\r\n\t\t// \t\tclose: () => {\r\n\t\t// \t\t\tsignInViewModel.unMount(EffectType.EFFECT2);\r\n\t\t// \t\t\tcloseHandler && closeHandler()\r\n\t\t// \t\t}\r\n\t\t// \t}).connect()\r\n\t\t// })\r\n\t\tconst signInViewModel = new SignInViewModel().mountView((await sourceManageSeletor().getFileAsync(PrefabPathDefine._HELL_SIGN_IN, Prefab)).source)\r\n\t\t\t.appendTo(nodeWrap || this.parentNode, { effectType: EffectType.EFFECT1, isModal: true })\r\n\t\t\t.setEvent({\r\n\t\t\t\tclose: () => {\r\n\t\t\t\t\tsignInViewModel.unMount(EffectType.EFFECT2);\r\n\t\t\t\t\tcloseHandler && closeHandler()\r\n\t\t\t\t}\r\n\t\t\t}).connect()\r\n\t}\r\n\r\n\tprivate async openVipUp(nodeWrap?: Node) {\r\n\t\tnew VipUpViewModel().mountView((await sourceManageSeletor().getFileAsync(PrefabPathDefine._HELL_VIP_UP, Prefab)).source)\r\n\t\t\t.appendTo(nodeWrap || this.parentNode, { isModal: true }).connect()\r\n\t}\r\n\r\n\tpublic async openVipMain(nodeWrap?: Node) {\r\n\t\tnew VipMainViewModel().mountView((await sourceManageSeletor().getFileAsync(PrefabPathDefine._HELL_VIP_MAIN, Prefab)).source)\r\n\t\t\t.appendTo(nodeWrap || this.parentNode, { effectType: EffectType.EFFECT1, isModal: true }).connect()\r\n\t}\r\n\r\n\tprivate onOpenShareHelp(nodeWrap?: Node) {\r\n\t\tthis.dispatch(changeWebView(false));\r\n\t\tsourceManageSeletor().getFileAsync(PrefabPathDefine._SHARE_HELP, Prefab).then(file => {\r\n\t\t\tnew ShareHelpViewModel().mountView(file.source).appendTo(nodeWrap || this.parentNode, { effectType: EffectType.EFFECT1, isModal: true }).connect()\r\n\t\t})\r\n\t}\r\n\t/**打开救济金面板 */\r\n\tpublic openReliefPanel() {\r\n\t\tif (config.relief > this.comp.props.memberAssetGoldPieces) {\r\n\t\t\tfetcher.send(ApiUrl.BENEFIT, undefined, undefined, undefined, { isLoading: false }).then(async (data) => {\r\n\t\t\t\tif (data !== -1) {\r\n\t\t\t\t\tconst reLiefPanel = new BaseViewModel<Hall_ReliefPanel, RPIState, RPIProps, RPIEvent>('Hall_ReliefPanel').mountView(\r\n\t\t\t\t\t\t(await sourceManageSeletor().getFileAsync(PrefabPathDefine._HELL_RE_LIEF, Prefab)).source)\r\n\t\t\t\t\t\t.appendTo(this.parentNode, { effectType: EffectType.EFFECT1, isModal: true }).setEvent({\r\n\t\t\t\t\t\t\tonClosePanel: () => {\r\n\t\t\t\t\t\t\t\treLiefPanel.unMount(EffectType.EFFECT2)\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}).setProps({ amount: data })\r\n\t\t\t\t}\r\n\t\t\t}).catch(() => {\r\n\t\t\t})\r\n\t\t}\r\n\t}\r\n\t/**是否游客验证 */\r\n\tpublic isTouristPass() {\r\n\t\tif (this.comp.props.tourist) {\r\n\t\t\tthis.dispatch(addToastAction({ content: lang.write(k => k.HallModule.CantEditProfile, {}, { placeStr: \"对不起，请认证用户资料再操作\" }) }))\r\n\t\t\tthis.openUpgradePanel()\r\n\t\t\treturn false\r\n\t\t}\r\n\t\treturn true\r\n\t}\r\n\t/**\r\n\t * 打开绑定代理确认窗口\r\n\t * @param actingId 输入的推荐码\r\n\t * @param promotionCode 自己的推荐码\r\n\t * @param nodeWrap \r\n\t * @returns \r\n\t */\r\n\tprivate onOpenShareSure(actingId: string, promotionCode: string, nodeWrap?: Node) {\r\n\t\tif (actingId === promotionCode) {\r\n\t\t\tthis.dispatch(addToastAction({ content: lang.write(k => k.MainPaneModule.MainPanelCodeError, {}, { placeStr: \"不能输入自己的推荐码\" }), type: ToastType.NORMAL }));\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tfetcher.send(ApiUrl.RECOMMEND_MEMBER_INFO, { promotionCode: actingId }, \"post\").then((rsp) => {\r\n\t\t\tif (!rsp || !rsp.memberId) {\r\n\t\t\t\tthis.dispatch(addToastAction({ content: lang.write(k => k.MainPaneModule.MainPanelPromotion, {}, { placeStr: \"推荐人不存在\" }), type: ToastType.NORMAL }));\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tthis.dispatch(changeWebView(false));\r\n\t\t\tsourceManageSeletor().getFileAsync(PrefabPathDefine._SHARE_SURE, Prefab).then(file => {\r\n\t\t\t\tnew ShareSureViewModel().mountView(file.source)\r\n\t\t\t\t\t.appendTo(nodeWrap || this.parentNode, { effectType: EffectType.EFFECT1, isModal: true }).connect()\r\n\t\t\t\t\t.setProps({\r\n\t\t\t\t\t\tavatarIndex: rsp.avatarIndex,\r\n\t\t\t\t\t\tnickName: rsp.nickName,\r\n\t\t\t\t\t\tmemberId: rsp.memberId,\r\n\t\t\t\t\t\tactingId,\r\n\t\t\t\t\t})\r\n\t\t\t})\r\n\t\t}).catch((e) => {\r\n\t\t\t//this.dispatch(addToastAction({ content: e }))\r\n\t\t})\r\n\t}\r\n\r\n\t/**充值回调处理 */\r\n\tprivate rechangeCallbackHandle(data: RechangeCallbackVo) {\r\n\t\tif (data.orderOperations === 2) {\r\n\t\t\tpurchaseAppsflyerEvents(data.rechargeAmount, data.currency, data.isFirstRecharge)\r\n\t\t} else if (data.orderOperations === 1) {\r\n\t\t\tpullPurchaseEvents(data.rechargeAmount, data.currency, data.isFirstRecharge)\r\n\t\t}\r\n\t}\r\n\r\n\tprivate retryCount = 0;\r\n\t/**绑定token */\r\n\tprivate bingFcmToken() {\r\n\t\tif (!NATIVE) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tconst memberId = this.comp.props.memberId;\r\n\t\t// 加盐密钥\r\n\t\tconst salt = \"HuGe:UBGFlKh3DcU5uO76\";\r\n\t\tconst token = getFirebaseToken();\r\n\t\tconst keys = md5(memberId + salt);\r\n\t\tconsole.log(`fcm keys ${keys}, memberId: ${memberId}, token: ${token}`);\r\n\t\tif (memberId && token) {\r\n\t\t\tfetcher.send(ApiUrl.FCM_TOKEN_BIND, { keys: keys, memberId: memberId, token: token }, \"post\").then((rsp) => {\r\n\t\t\t\tconsole.log(\"fcm bind firebase token success\");\r\n\t\t\t}).catch((e) => {\r\n\t\t\t\tconsole.log(\"fcm bind firebase token failed!!\", e);\r\n\t\t\t})\r\n\t\t} else {\r\n\t\t\t// 重试超过5次就不处理了\r\n\t\t\tthis.retryCount < 5 && this.comp.scheduleOnce(() => {\r\n\t\t\t\tthis.retryCount++;\r\n\t\t\t\tconsole.log(\"fcm bind firebase token retry get!! retryCount: \" + this.retryCount);\r\n\t\t\t\tthis.bingFcmToken();\r\n\t\t\t}, 5)\r\n\t\t}\r\n\t}\r\n\r\n\tprivate initActivityUnreadStatus() {\r\n\t\tnew ActivityViewModel().initReadStatus();\r\n\t}\r\n\r\n\tpublic connect() {\r\n\t\tthis.inject({}, (state: StateType) => {\r\n\t\t\treturn {\r\n\t\t\t\tmemberAssetGoldPieces: state.memberInfo.memberAssetGoldPieces,\r\n\t\t\t\tnickName: state.memberInfo.nickName,\r\n\t\t\t\tavatarIndex: state.memberInfo.avatarIndex,\r\n\t\t\t\tvipLevel: state.memberInfo.vipLevel,\r\n\t\t\t\tlevel: state.memberInfo.level,\r\n\t\t\t\tsubGameInfo: state.baseBoard.subGameInfo,\r\n\t\t\t\ttourist: state.memberInfo.tourist,\r\n\t\t\t\tmemberId: state.memberInfo.memberId,\r\n\t\t\t\tmemberName: state.memberInfo.memberName,\r\n\t\t\t\tisConnect: state.baseBoard.isConnect,\r\n\t\t\t\tretryConnectTimes: state.baseBoard.retryConnectTimes,\r\n\t\t\t\tappDownLoadGuide: state.baseBoard.appDownLoadGuide,\r\n\t\t\t\tisUnreadActivity: state.memberInfo.isUnreadActivity\r\n\t\t\t}\r\n\t\t})\r\n\t\treturn this\r\n\t}\r\n}\r\n\r\nexport default MainPanelViewModel"]}