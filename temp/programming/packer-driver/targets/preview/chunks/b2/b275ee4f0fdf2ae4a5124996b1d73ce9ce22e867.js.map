{"version":3,"sources":["file:///Users/geliang/web/dibai/hall/assets/script/subGame/bandar/components/Bandar_history.ts"],"names":["_decorator","instantiate","Label","Node","Sprite","BaseComponent","getNodeByNameDeep","SpriteFramePathDefine","playBtnClick","sourceManageSelector","ccclass","property","Bandar_history","propertyNode","props_content","props_spr_new_bg","props_layout_other_history","props_history_bg_off","props_Toggle1","props_Toggle2","props_Toggle3","props","tren","statistik","rekor","events","onClosePanel","start","initState","bindEvent","on","EventType","TOUCH_END","useProps","key","value","createHistoryTr","cur","createHistorySta","createHistoryRok","removeAllChildren","forEach","item","index","historyItem","spr_allMark","getComponent","spriteFrame","getFile","BANDAR_HISTORY_BARU","source","semua","getWinLossSpriteFrame","active","setPosition","black","red","plum","diamond","getSpriteFrame","addChild","num","label_winRate","node","label_winMatches","label_loseMatches","tingkatNum","tingkat","toFixed","string","menang","kalah","roker","label_num","label_num_win","label_num_lose","taruhan","chip","result","fileName","BANDAR_HISTORY_MENANG","BANDAR_HISTORY_KALAH","BANDAR_HISTORY_SEMUA_WIN","BANDAR_HISTORY_SEMUA_LOSS","bindUI","update","deltaTime"],"mappings":"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","sourcesContent":["import { _decorator,instantiate,Label,Node, Sprite, SpriteFrame } from 'cc';\r\nimport { BaseComponent } from '../../../base/BaseComponent';\r\nimport { getNodeByNameDeep, initToggle } from '../../../utils/tool';\r\nimport { SpriteFramePathDefine } from '../sourceDefine/spriteDefine';\r\nimport { playBtnClick, sourceManageSelector } from '../index';\r\nimport { Statistik, History, RokerTar } from '../type';\r\nimport { Roker } from '../store/actions/history';\r\nconst { ccclass, property } = _decorator;\r\n\r\n\r\n\r\nexport interface IState {\r\n\r\n}\r\n\r\nexport interface IProps {\r\n\ttren:History[],\r\n\tstatistik : Statistik[],\r\n\trekor:Roker,\r\n}\r\nexport interface IEvent {\r\n\tonClosePanel:()=>void\r\n}\r\n\r\n\r\n@ccclass('Bandar_history')\r\nexport class Bandar_history extends BaseComponent<IState, IProps, IEvent> {\r\n\t\r\n\tstart() {\r\n         \r\n\t\t \r\n\t }\r\n\r\n\tprotected propertyNode = {\r\n\t\tprops_content:new Node(),\r\n\t\tprops_spr_new_bg:new Node(),\r\n\t\tprops_layout_other_history:new Node(),\r\n\t\tprops_history_bg_off:new Node(),\r\n\t\tprops_Toggle1:new Node(),\r\n\t\tprops_Toggle2:new Node(),\r\n        props_Toggle3:new Node(),\r\n\t}\r\n\r\n\tpublic props: IProps = {\r\n\t\ttren:null,\r\n\t    statistik :null,\r\n\t\trekor:null,\r\n\t\t\r\n\t}\r\n\r\n\tpublic events: IEvent = {\r\n\t\tonClosePanel:()=>{}\r\n\t}\r\n\r\n\tprotected initState() {\r\n\t\treturn {\r\n\t\t\t\r\n\t\t}\r\n\t}\r\n\r\n\tprotected bindEvent(): void {\r\n       this.propertyNode.props_Toggle1.on(Node.EventType.TOUCH_END,()=>{\r\n\t\tplayBtnClick()\r\n\t   });\r\n\t   this.propertyNode.props_Toggle2.on(Node.EventType.TOUCH_END,()=>{\r\n\t\tplayBtnClick()\r\n\t   });\r\n\t   this.propertyNode.props_Toggle3.on(Node.EventType.TOUCH_END,()=>{\r\n\t\tplayBtnClick()\r\n\t   });\r\n\t   this.propertyNode.props_history_bg_off.on(Node.EventType.TOUCH_END,()=>{\r\n\t\t playBtnClick()\r\n\t\t this.events.onClosePanel();\r\n\t   })\r\n\t}\r\n\r\n\tprotected useProps(key: keyof IProps, value: { pre: any, cur: any }) {\r\n\t\tif (key === \"tren\") {\r\n\r\n          this.createHistoryTr(value.cur)\r\n\t  }\r\n\t  if(key===\"statistik\"){\r\n\r\n\t\tthis.createHistorySta(value.cur);\r\n\r\n\t  }\r\n\r\n\t  if(key===\"rekor\"){\r\n\r\n\t\tthis.createHistoryRok(value.cur);\r\n\t  }\r\n\t}\r\n\r\n\t/**创建历史记录tren */\r\n\tprivate createHistoryTr(tren){\r\n\t\tthis.propertyNode.props_content.removeAllChildren();\r\n\t\ttren.forEach((item,index)=>{\r\n\t\t   let historyItem\r\n           if(index===0){\r\n\t\t\t historyItem=instantiate(this.propertyNode.props_spr_new_bg);\r\n\t\t\t let spr_allMark=getNodeByNameDeep(\"spr_allMark\",historyItem).getComponent(Sprite);\r\n\t\t\t spr_allMark.spriteFrame=sourceManageSelector().getFile(SpriteFramePathDefine.BANDAR_HISTORY_BARU).source;\r\n\t\t   }else{\r\n\t\t\t historyItem=instantiate(this.propertyNode.props_layout_other_history);\r\n\t\t\t let spr_allMark=getNodeByNameDeep(\"spr_allMark\",historyItem)\r\n\t\t\t spr_allMark.getComponent(Sprite).spriteFrame=item.semua > 0 ? this.getWinLossSpriteFrame(item.semua):this.getWinLossSpriteFrame(1);\r\n\t\t\t spr_allMark.active = item.semua > 0;\r\n\t\t   }\r\n\t\t   historyItem.setPosition(0,-34-index*53);\r\n\t\t   let black= getNodeByNameDeep(\"spr_history_black\",historyItem).getComponent(Sprite);\r\n\t\t   let red=getNodeByNameDeep(\"spr_history_red\",historyItem).getComponent(Sprite)\r\n\t\t   let plum=getNodeByNameDeep(\"spr_history_plum\",historyItem).getComponent(Sprite)\r\n\t\t   let diamond=getNodeByNameDeep(\"spr_history_diamond\",historyItem).getComponent(Sprite)\r\n\t\t   black.spriteFrame=this.getSpriteFrame(item.black);\r\n\t\t   red.spriteFrame=this.getSpriteFrame(item.red);\r\n\t\t   plum.spriteFrame=this.getSpriteFrame(item.plum);\r\n\t\t   diamond.spriteFrame=this.getSpriteFrame(item.diamond);\r\n\t\t   this.propertyNode.props_content.addChild(historyItem)\r\n\t\t})\r\n\t}\r\n\t/**创建历史记录statistilk */\r\n\tprivate createHistorySta(statistik){\r\n\t\tstatistik.forEach((item,index)=>{\r\n\t\t\tlet num=index+1;\r\n\t\t\tlet label_winRate=getNodeByNameDeep(\"label_winRate\", getNodeByNameDeep(\"props_spr_refresh\"+num,this.node));\r\n\t\t\tlet label_winMatches=getNodeByNameDeep(\"label_winMatches\", getNodeByNameDeep(\"props_spr_refresh\"+num,this.node));\r\n\t\t\tlet label_loseMatches=getNodeByNameDeep(\"label_loseMatches\", getNodeByNameDeep(\"props_spr_refresh\"+num,this.node));\r\n\t\t\tlet tingkatNum=(item.tingkat*100).toFixed(2)\r\n\t\t\tlabel_winRate.getComponent(Label).string=\"Tingkat Menang:\"+tingkatNum+\"%\";\r\n\t\t\tlabel_winMatches.getComponent(Label).string=\"Menang:\"+item.menang;\r\n\t\t\tlabel_loseMatches.getComponent(Label).string=\"Kalah:\"+item.kalah;\r\n\t\t})\r\n\t}\r\n\r\n\t/**创建历史记录roker */\r\n\tprivate createHistoryRok(roker){\r\n\t\tfor(let key in roker){\r\n\t\t\tlet item=roker[key];\r\n\t\t\tlet label_num=getNodeByNameDeep(\"label_num\", getNodeByNameDeep(\"spr_userRefresh_\"+key,this.node));\r\n\t\t\tlet label_num_win=getNodeByNameDeep(\"label_num_win\", getNodeByNameDeep(\"spr_userRefresh_\"+key,this.node));\r\n\t\t\tlet label_num_lose=getNodeByNameDeep(\"label_num_lose\", getNodeByNameDeep(\"spr_userRefresh_\"+key,this.node));\r\n\t\t\tlabel_num.getComponent(Label).string=item.taruhan+'';\r\n\t\t\tlabel_num_win.getComponent(Label).string=item.menang+'';\r\n\t\t\tlabel_num_lose.getComponent(Label).string=item.chip+\"\";\r\n\t\t}\r\n\t}\r\n\r\n\r\n\tprivate getSpriteFrame(result:number): SpriteFrame {\r\n\t\tlet fileName = '';\r\n\t\tif (result === 1) {\r\n\t\t\tfileName = SpriteFramePathDefine.BANDAR_HISTORY_MENANG;\r\n\t\t} else if (result === 2) {\r\n\t\t\tfileName = SpriteFramePathDefine.BANDAR_HISTORY_KALAH;\r\n\t\t} \r\n\t\treturn sourceManageSelector().getFile(fileName).source;\r\n\t}\r\n\r\n\tprivate getWinLossSpriteFrame(result:number): SpriteFrame {\r\n\t\tlet fileName = '';\r\n\t    if (result === 1) {\r\n\t\t\tfileName = SpriteFramePathDefine.BANDAR_HISTORY_SEMUA_WIN\r\n\t\t} else if (result === 2) {\r\n\t\t\tfileName = SpriteFramePathDefine.BANDAR_HISTORY_SEMUA_LOSS;\r\n\t\t} \r\n\t\treturn sourceManageSelector().getFile(fileName).source;\r\n\t}\r\n\r\n\tprotected bindUI(): void {\r\n\r\n\t}\r\n\r\n\tupdate(deltaTime: number) {\r\n\r\n\t}\r\n}\r\n\r\n"]}