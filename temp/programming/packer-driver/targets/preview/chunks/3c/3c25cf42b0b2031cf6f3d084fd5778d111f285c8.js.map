{"version":3,"sources":["file:///Users/geliang/web/dibai/hall/assets/script/subGame/phoenixV2/components/PhoenixV2_RollerPanel.ts"],"names":["_decorator","instantiate","Label","Layout","Node","sp","tween","UITransform","Vec3","BaseComponent","IconPool","config","PhoenixV2RollerViewModel","DialogType","GameType","IconId","isAuto","isSubGameToSubGame","RollerStatus","updateRollerStatus","cacheData","changeGame","updateGold","updateSubGameAnimationPlayInfo","updateWinloss","mainViewModel","phoenixV2_Audio","SoundPathDefine","ccclass","property","PhoenixV2_RollerPanel","rollerViewModelArr","iconPool","icon","isManualStop","inStop","isWaitEnding","sendBetTime","rollIndex","chooseSmallGame","isShowMultip","propertyNode","props_column_list","props_roller_column","props_column_effect","props","rollerStatus","END","isSpeed","autoLauncherInfo","gameTypeInfo","lastGameType","NONE","currGameType","viewGameType","leftCount","winloss","events","start","initState","initRoller","i","columnCount","column","roller","mountViewNode","appendTo","connect","push","comp","setColumnEffectNode","initSlot","smallGameInfo","forEach","v","index","MAIN","length","fileName","wildSprite","skeletonName","wildSkeleton","startRoll","isMainGame","dispatch","getSmallMultipleNode","active","getComponent","string","unscheduleAllCallbacks","endRoll","rollTime","getIsSpeed","scheduleOnce","rollerLaunchResult","node","isValid","stopRollAll","RUNNING","ENDING","stopRoll","rollEndHandle","bind","magnification","dl","si","bigWinConfig","getBigWinConfig","isSubGameLastPoint","isMain","auto","winLine","yuanBaoLine","showYuanBaoIcon","normalRollOption","winIconFlickerTime","startPlayWinIcon","playBigWinHandle","playWinAudio","amount","roundTw","totalRewards","isChangeGame","SUBGAME2","balanceAfterSettlement","isSubGame1","freeGameAmount","showYuanBao","otherGameAttributesVo","yuanBaoSpecialEffect","yuanBaoDialogCallBack","updateRollerStatusEnd","flyYinBi","yuanBaoAmount","yuanBaoMagnification","showDialogWin","dialogType","YUAN_BAO_WIN","params","isSubGame2","dialogCallback","SUBGAME1","playOneShot","LING","changeGameHandle","playWildAnimation","nextGameType","freeCount","nextLeftCount","undefined","name","done","nodes","concat","getYuanBaoYinBiNode","endPos","parent","convertToNodeSpaceAR","getGoodLuckPos","count","startPos","getWorldPosition","cloneNode","addChild","setPosition","to","subGameRollOption","beetleFlyTime","position","call","destroy","playBeeteFlyAmount","getBeetleAmountNode","amountNodes","getWildLiZiNode","n","setSiblingIndex","children","setWorldPosition","worldPosition","skeleton","Skeleton","playWild2DFlyNum","getFreeNumPos","count1","PHOENIX_ADD_NUM","delay","isSubGame","changeToSubGame","changeToMainGame","viewGameCountOver","changeSubGameToSubGame","playScatterAnimation","getSlotNode","rollerPanelViewModel","viewNode","getFreeNumNode","showSmallGame","gameType","param","FREE_GAME_SETTLEMENT","changeRollerHeight","winning","find","minRate","maxRate","callBack","time","isEnd","rollerComp","stopIconIndex","rollerId","scatterCount","getScatterCount","nextColmunIsBorder","isSpeedBorder","endColumnIndex","scatter","iconIndex","queue","iconRollerQueue","showIconCount","SCATTER","linePlayTime","wp","winningPosition","lines","key","executeWinIcon","lineNumber","winIconArr","pauseWinIcon","columnIndex","playWinIcon","phoenixMagnification","labelNode","scale","yuanBaoWp","yuanBaoPosition","executeYuanBaoWinIcon","playYuanBaoWinIcon","bindEvent","useProps","value","cur","columnListLayout","rollerWindowX","rollerWindowY","spacingX","columnInterval","replaceMultiRollerIcon","rollerHeight","rollerHeight2","rollerHeight1","height","resetIconPos","bindUI","removeAllChildren","update","deltaTime"],"mappings":"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","sourcesContent":["import { _decorator, instantiate, Label, Layout, Node, sp, tween, UITransform, Vec2, Vec3 } from 'cc';\r\nimport { BaseComponent } from '../../../base/BaseComponent';\r\nimport { IconPool } from '../IconPool';\r\nimport config from '../config';\r\nimport PhoenixV2RollerViewModel from '../viewModel/PhoenixV2RollerViewModel';\r\nimport { AutoLauncherInfo, DialogType, GameType, GameTypeInfo, IconId, isAuto, isSubGameToSubGame, RollerLaunchResult, RollerStatus, SmallGame } from '../type';\r\nimport { updateRollerStatus } from '../store/actions/roller';\r\nimport { cacheData } from '../dataTransfer';\r\nimport { changeGame, updateGold, updateSubGameAnimationPlayInfo, updateWinloss } from '../store/actions/game';\r\nimport { mainViewModel, phoenixV2_Audio, sourceManageSeletor } from '../index';\r\nimport game from '../store/reducer/game';\r\nimport { EffectType } from '../../../utils/NodeIOEffect';\r\nimport PhoenixV2SgChooseSmallViewMode from '../viewModel/PhoenixV2SgChooseSmallViewModel';\r\nimport { PrefabPathDefine } from '../sourceDefine/prefabDefine';\r\nimport SkeletonAnimationPlayer from '../../../utils/SkeletonPlay';\r\nimport { SoundPathDefine } from '../sourceDefine/soundDefine';\r\nconst { ccclass, property } = _decorator;\r\n\r\nexport interface IState {\r\n\r\n}\r\n\r\nexport interface IProps {\r\n\t/**滚动状态 */\r\n\trollerStatus: RollerStatus,\r\n\t/**是否加速 */\r\n\tisSpeed: boolean,\r\n\t/** 自动运行信息 */\r\n\tautoLauncherInfo: AutoLauncherInfo,\r\n\t/**游戏类型信息 */\r\n\tgameTypeInfo: GameTypeInfo,\r\n\t/**总输赢 */\r\n\twinloss: number,\r\n\t/**小游戏选择后的信息 */\r\n\tchooseSmallGame:SmallGame\r\n}\r\nexport interface IEvent {\r\n\r\n}\r\n\r\n@ccclass('PhoenixV2_RollerPanel')\r\nexport class PhoenixV2_RollerPanel extends BaseComponent<IState, IProps, IEvent> {\r\n\tstart() {\r\n\r\n\t}\r\n\r\n\tprivate rollerViewModelArr: PhoenixV2RollerViewModel[] = [];\r\n\tprivate iconPool: IconPool = new IconPool(config.icon);\r\n\tprivate isManualStop: boolean = false;\r\n\tprivate inStop = false;\r\n\r\n\tprivate isWaitEnding = false;\r\n\r\n\tprivate sendBetTime = 0;\r\n\r\n\t/** 当前滚轴 */\r\n\tpublic rollIndex: number = 0;\r\n\r\n\tprivate chooseSmallGame\r\n\tprivate isShowMultip: boolean = false;\r\n\r\n\tprotected propertyNode = {\r\n\t\tprops_column_list: new Node(),\r\n\t\tprops_roller_column: new Node(),\r\n\t\tprops_column_effect: new Node(),\r\n\t}\r\n\r\n\tpublic props: IProps = {\r\n\t\t/**滚动状态 */\r\n\t\trollerStatus: RollerStatus.END,\r\n\t\tisSpeed: false,\r\n\t\tautoLauncherInfo: null,\r\n\t\tgameTypeInfo: {\r\n\t\t\tlastGameType: GameType.NONE,\r\n\t\t\tcurrGameType: GameType.NONE,\r\n\t\t\tviewGameType: GameType.NONE,\r\n\t\t\tleftCount: 0\r\n\t\t},\r\n\t\twinloss: 0,\r\n\t\tchooseSmallGame:null,\r\n\t}\r\n\r\n\tpublic events: IEvent = {\r\n\r\n\t}\r\n\r\n\tprotected initState() {\r\n\t\treturn {}\r\n\t}\r\n\r\n\tprivate initRoller() {\r\n\t\tfor (let i = 0; i < config.columnCount; i++) {\r\n\t\t\tconst column = instantiate(this.propertyNode.props_roller_column);\r\n\t\t\tconst roller = new PhoenixV2RollerViewModel().mountViewNode(column).appendTo(this.propertyNode.props_column_list).connect();\r\n\t\t\tthis.rollerViewModelArr.push(roller);\r\n\t\t\troller.comp.setColumnEffectNode(this.propertyNode.props_column_effect);\r\n\t\t}\r\n\t}\r\n\r\n\tpublic initSlot(smallGameInfo?:SmallGame) {\r\n\t\tthis.rollerViewModelArr.forEach((v, index) => {\r\n\t\t\tif (this.props.gameTypeInfo.viewGameType !==GameType.MAIN && smallGameInfo) {\r\n\t\t\t\tconfig.icon[config.icon.length - 2].fileName = smallGameInfo.wildSprite;\r\n\t\t\t\tconfig.icon[config.icon.length - 2].skeletonName = smallGameInfo.wildSkeleton;\r\n\t\t\t\t// this.iconPool=new IconPool(config.icon,this.props.gameTypeInfo.viewGameType,smallGameInfo.id)\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tv.comp.initSlot(index, this.iconPool);\r\n\t\t})\r\n\t}\r\n\r\n\tprivate startRoll() {\r\n\t\tlet sendBetTime = cacheData.sendBetTime;\r\n\t\tthis.sendBetTime = sendBetTime;\r\n\t\tthis.isManualStop = false;\r\n\t\tthis.isShowMultip = false;\r\n\t\t// console.log(\"start roll time \" + sendBetTime)\r\n\t\tconst isMainGame = this.props.gameTypeInfo.viewGameType === GameType.MAIN;\r\n\t\tif (isMainGame) {\r\n\t\t\tthis.dispatch(updateWinloss(0))\r\n\t\t}\r\n\t\tmainViewModel.comp.getSmallMultipleNode().active = false;\r\n\t\tmainViewModel.comp.getSmallMultipleNode().getComponent(Label).string = '';\r\n\t\tthis.unscheduleAllCallbacks();\r\n\t\tthis.rollerViewModelArr.forEach((v, index) => {\r\n\t\t\tv.comp.startRoll()\r\n\t\t});\r\n\r\n\t\tthis.endRoll(sendBetTime);\r\n\t}\r\n\r\n\tprivate endRoll(sendBetTime: number) {\r\n\t\t// 前期滚动的事件\r\n\t\tconst rollTime = this.getIsSpeed() ? 0.1 : 1;\r\n\r\n\t\tthis.scheduleOnce(() => {\r\n\t\t\t// console.log(\"endRoll scheduleOnce \" + sendBetTime + \" currentTime \" + new Date().getTime());\r\n\t\t\tif (!cacheData.rollerLaunchResult) {\r\n\t\t\t\tthis.isWaitEnding = true;\r\n\t\t\t} else {\r\n\t\t\t\tthis.node.isValid && this.stopRollAll(false, sendBetTime, cacheData.rollerLaunchResult);\r\n\t\t\t}\r\n\t\t}, rollTime)\r\n\t}\r\n\r\n\tprivate stopRollAll(isManualStop: boolean = false, sendBetTime: number, rollerLaunchResult: RollerLaunchResult) {\r\n\t\t\r\n\t\tif (this.inStop) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tthis.unscheduleAllCallbacks();\r\n\t\tthis.inStop = true;\r\n\t\tthis.isManualStop = isManualStop;\r\n\r\n\t\tif (RollerStatus.RUNNING === this.props.rollerStatus) {\r\n\t\t\tthis.dispatch(updateRollerStatus(RollerStatus.ENDING))\r\n\t\t}\r\n\r\n\t\t// console.log(\"rollerpanel stop roll time \" + sendBetTime);\r\n\t\tthis.stopRoll(0, this.rollEndHandle.bind(this, rollerLaunchResult), rollerLaunchResult);\r\n\t}\r\n\r\n\t/**\r\n\t * 动画滚动结束处理\r\n\t */\r\n\tprivate rollEndHandle(rollerLaunchResult: RollerLaunchResult) {\r\n\t\tconst magnification = rollerLaunchResult.dl.si[0].magnification;\r\n\t\tconst bigWinConfig = this.getBigWinConfig(magnification)\r\n\t\t// 是否小游戏最后一局\r\n\t\tconst isSubGameLastPoint = !this.isMain() && this.props.gameTypeInfo.leftCount <= 1;\r\n\r\n\t\tthis.inStop = false;\r\n\t\tconst auto = isAuto(this.props.autoLauncherInfo, this.props.gameTypeInfo);\r\n\t\tlet winLine: number = 0;\r\n\t\tlet yuanBaoLine = this.showYuanBaoIcon(config.normalRollOption.winIconFlickerTime, () => {\r\n\t\t\twinLine = this.startPlayWinIcon(config.normalRollOption.winIconFlickerTime, () => {\r\n\t\t\t}, rollerLaunchResult);\r\n\t\t }, rollerLaunchResult)\r\n\t\t\r\n\t\t// const winLine = this.startPlayWinIcon(config.normalRollOption.winIconFlickerTime, () => {\r\n\t\t// }, rollerLaunchResult);\r\n\r\n\t\tif (yuanBaoLine === 0) {\r\n\t\t\t this.playBigWinHandle(bigWinConfig, auto, isSubGameLastPoint, rollerLaunchResult);\r\n\t\t} else {\r\n\r\n\t\t\t// 中奖之后延迟一点结束\r\n\t\t\tthis.scheduleOnce(() => {\r\n\t\t\t\tthis.playBigWinHandle(bigWinConfig, auto, isSubGameLastPoint, rollerLaunchResult);\r\n\t\t\t}, 1)\r\n\t\t}\r\n\r\n\t\t// if (!auto || winLine === 0 || yuanBaoLine === 0) {\r\n\t\t// \tthis.updateRollerStatusEnd(bigWinConfig, auto, isSubGameLastPoint, rollerLaunchResult);\r\n\t\t// } else {\r\n\t\t// \t// 中奖之后延迟一点结束\r\n\t\t// \tthis.scheduleOnce(() => {\r\n\t\t// \t\tthis.updateRollerStatusEnd(bigWinConfig, auto, isSubGameLastPoint, rollerLaunchResult);\r\n\t\t// \t}, 1)\r\n\t\t// }\r\n\r\n\t\tif (!bigWinConfig) {\r\n\t\t\tthis.updateWinloss(rollerLaunchResult);\r\n\t\t}\r\n\t}\r\n\r\n\tprivate playWinAudio() {\r\n\t\t// if (this.isWinWild()) {\r\n\t\t// \tphoenixV2_Audio.playOneShot(SoundPathDefine.wild)\r\n\t\t// } else {\r\n\t\t// \tphoenixV2_Audio.playOneShot(SoundPathDefine.haveCoin)\r\n\t\t// }\r\n\t}\r\n\r\n\tprivate updateWinloss(rollerLaunchResult: RollerLaunchResult,amount?:number) {\r\n\t\tconst si = rollerLaunchResult && rollerLaunchResult.dl.si[0];\r\n\t\t// 本局输赢\r\n\t\tconst roundTw = si.totalRewards\r\n\t\tif (this.isMain()) {\r\n\t\t\tif (roundTw <= 0) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\t// 在切到小游戏2时，输赢金额不更新，因为中奖的金额在加到小游戏里\r\n\t\t\tif (!this.isChangeGame() || this.props.gameTypeInfo.currGameType !== GameType.SUBGAME2) {\r\n\t\t\t\tthis.dispatch(updateWinloss(roundTw))\r\n\t\t\t\t// 小游戏要在结算时更新余额\r\n\t\t\t\tthis.dispatch(updateGold(si.balanceAfterSettlement))\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\t// 小游戏1在游戏中余额之后在切换到主游戏时才加上去\r\n\t\t\t// console.log(\"amount\",amount,si.freeGameAmount );\r\n\t\t\t\r\n\t\t\tif (amount && si.totalRewards > amount ) {\r\n\t\t\t\tif (this.isSubGame1()) {\r\n\t\t\t\t\tthis.dispatch(updateWinloss(si.freeGameAmount-amount))\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tthis.dispatch(updateWinloss(si.freeGameAmount))\r\n\t\t\t}\r\n\r\n\t\t\tif (this.isChangeGame()) {\r\n\t\t\t\tthis.dispatch(updateGold(si.balanceAfterSettlement))\r\n\t\t\t\tthis.dispatch(updateWinloss(si.freeGameAmount))\r\n\t\t\t}\r\n\r\n\t\t}\r\n\t}\r\n\r\n\t/**播放元宝中奖处理 */\r\n\tprivate playBigWinHandle(bigWinConfig, auto: boolean, isSubGameLastPoint: boolean, rollerLaunchResult: RollerLaunchResult) {\r\n\r\n\t\tconst showYuanBao = rollerLaunchResult && rollerLaunchResult.dl.si[0].otherGameAttributesVo.yuanBaoSpecialEffect;//是否有特殊位置（1 、5列）元宝中奖\r\n\r\n\t\t// 进入小游戏2时不播放大奖\r\n\t\tif (showYuanBao) {\r\n\r\n\t\t\tconst yuanBaoDialogCallBack = () => {\r\n\t\t\t\t// 延迟一点点播放大奖\r\n\t\t\t\tthis.startPlayWinIcon(config.normalRollOption.winIconFlickerTime, () => {\r\n\t\t\t\t}, rollerLaunchResult);\r\n\r\n\t\t\t// this.scheduleOnce(() => {\r\n\t\t\t\tthis.updateRollerStatusEnd(bigWinConfig, auto, isSubGameLastPoint, rollerLaunchResult);\r\n\t\t\t// }, 1)\r\n\t\r\n\t\t\t\t\r\n\t\t\t}\r\n\t\t\tthis.flyYinBi(() => {\r\n\t\t\t\tconst yuanBaoAmount = rollerLaunchResult && rollerLaunchResult.dl.si[0].otherGameAttributesVo.yuanBaoAmount;\r\n\t\t\t\tconst yuanBaoMagnification = rollerLaunchResult && rollerLaunchResult.dl.si[0].otherGameAttributesVo.yuanBaoMagnification;\r\n\t\t\t\tthis.updateWinloss(rollerLaunchResult,yuanBaoAmount);\r\n\t\t\t\t// 元宝中奖框\r\n\t\t\t\tmainViewModel.showDialogWin({\r\n\t\t\t\t\tdialogType: DialogType.YUAN_BAO_WIN,\r\n\t\t\t\t\tparams: [yuanBaoAmount,yuanBaoMagnification],\r\n\t\t\t\t},() => yuanBaoDialogCallBack())\r\n\t\t\t})\r\n\t\t} else {\r\n\t\t\tthis.updateRollerStatusEnd(bigWinConfig, auto, isSubGameLastPoint, rollerLaunchResult);\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * 更新结束滚动状态\r\n\t * @param bigWinConfig 大奖配置\r\n\t * @param auto \r\n\t * @param isSubGameLastPoint 是否小游戏最后一局\r\n\t */\r\n\tprivate updateRollerStatusEnd(bigWinConfig, auto: boolean, isSubGameLastPoint: boolean, rollerLaunchResult: RollerLaunchResult) {\r\n\t\t// 是否小游戏2，包含下一次游戏\r\n\t\tconst isSubGame2 = this.props.gameTypeInfo.viewGameType === GameType.SUBGAME2 || this.props.gameTypeInfo.currGameType === GameType.SUBGAME2;\r\n\t\tconst isChangeGame = this.isChangeGame();\r\n\t\tif (bigWinConfig) {\r\n\t\t\t// 大奖提示框消失后的回调\r\n\t\t\tconst dialogCallback = () => {\r\n\t\t\t\tif (isChangeGame) {\r\n\t\t\t\t\tif (this.props.gameTypeInfo.currGameType === GameType.SUBGAME1) {\r\n\t\t\t\t\t\tphoenixV2_Audio.playOneShot(SoundPathDefine.LING, 1, false)\r\n\t\t\t\t\t}\r\n\t\t\t\t\t// 如果是免费游戏，要接着弹出的免费次数框\r\n\t\t\t\t\tthis.changeGameHandle(isSubGameLastPoint, rollerLaunchResult);\r\n\t\t\t\t} else {\r\n\t\t\t\t\t//处理wild加次数飞动画\r\n\t\t\t\t\tif (this.props.gameTypeInfo.viewGameType === GameType.SUBGAME1) {\r\n\t\t\t\t\t\tthis.playWildAnimation(() => {\r\n\t\t\t\t\t\t\tthis.dispatch(changeGame({\r\n\t\t\t\t\t\t\t\tlastGameType: GameType.NONE,\r\n\t\t\t\t\t\t\t\tviewGameType: this.props.gameTypeInfo.viewGameType,\r\n\t\t\t\t\t\t\t\tcurrGameType: rollerLaunchResult && rollerLaunchResult.dl.si[0].nextGameType,\r\n\t\t\t\t\t\t\t\tleftCount:  rollerLaunchResult && rollerLaunchResult.dl.si[0].freeCount,\r\n\t\t\t\t\t\t\t\tfreeGameAmount: rollerLaunchResult && rollerLaunchResult.dl.si[0].freeGameAmount,\r\n\t\t\t\t\t\t\t\tnextLeftCount: undefined\r\n\t\t\t\t\t\t\t}))\r\n\t\t\t\t\t\t\tthis.scheduleOnce(() => {\r\n\t\t\t\t\t\t\t\tthis.dispatch(updateRollerStatus(RollerStatus.END))\r\n\t\t\t\t\t\t\t},1)\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tthis.dispatch(updateRollerStatus(RollerStatus.END))\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\t// 延迟一点点播放大奖\r\n\t\t\t\tthis.scheduleOnce(() => {\r\n\t\t\t\t\tthis.updateWinloss(rollerLaunchResult);\r\n\t\t\t\t\t// 中大奖提示框\r\n\t\t\t\t\tthis.node.isValid && mainViewModel.showDialogWin({\r\n\t\t\t\t\t\tdialogType: bigWinConfig.name,\r\n\t\t\t\t\t\tparams: [rollerLaunchResult && rollerLaunchResult.dl.si[0].totalRewards],\r\n\t\t\t\t\t}, () => dialogCallback())\r\n\t\t\t\t}, 0.8)\r\n\t\t} else {\r\n\t\t\tif (isChangeGame) {\r\n\t\t\t\tif (this.props.gameTypeInfo.currGameType === GameType.SUBGAME2) {\r\n\t\t\t\t\t// this.playBeetleAnimation(isSubGameLastPoint, rollerLaunchResult);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tif (this.props.gameTypeInfo.currGameType === GameType.SUBGAME1) {\r\n\t\t\t\t\t\tphoenixV2_Audio.playOneShot(SoundPathDefine.LING, 1, false)\r\n\t\t\t\t\t}\r\n\t\t\t\t\tthis.scheduleOnce(() => {\r\n\t\t\t\t\t\tthis.changeGameHandle(isSubGameLastPoint, rollerLaunchResult);\r\n\t\t\t\t\t},1)\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tif (this.props.gameTypeInfo.viewGameType === GameType.SUBGAME1) {\r\n\t\t\t\t\tthis.playWildAnimation(() => {\r\n\t\t\t\t\t\tthis.dispatch(changeGame({\r\n\t\t\t\t\t\t\tlastGameType: GameType.NONE,\r\n\t\t\t\t\t\t\tviewGameType: this.props.gameTypeInfo.viewGameType,\r\n\t\t\t\t\t\t\tcurrGameType: rollerLaunchResult && rollerLaunchResult.dl.si[0].nextGameType,\r\n\t\t\t\t\t\t\tleftCount: rollerLaunchResult && rollerLaunchResult.dl.si[0].freeCount,\r\n\t\t\t\t\t\t\tfreeGameAmount: rollerLaunchResult && rollerLaunchResult.dl.si[0].freeGameAmount,\r\n\t\t\t\t\t\t\tnextLeftCount: undefined\r\n\t\t\t\t\t\t}))\r\n\t\t\t\t\t\tif (isAuto(this.props.autoLauncherInfo, this.props.gameTypeInfo)) {\r\n\t\t\t\t\t\t\tthis.scheduleOnce(() => {\r\n\t\t\t\t\t\t\t\tthis.dispatch(updateRollerStatus(RollerStatus.END))\r\n\t\t\t\t\t\t\t},1)\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tthis.dispatch(updateRollerStatus(RollerStatus.END))\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t})\r\n\t\t\t\t} else {\r\n\t\t\t\t\tif (isAuto(this.props.autoLauncherInfo, this.props.gameTypeInfo)) {\r\n\t\t\t\t\t\tthis.scheduleOnce(() => {\r\n\t\t\t\t\t\t\tthis.dispatch(updateRollerStatus(RollerStatus.END))\r\n\t\t\t\t\t\t},1)\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tthis.dispatch(updateRollerStatus(RollerStatus.END))\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\t/** 播放元宝上的银币动画 */\r\n\tprivate flyYinBi(done) {\r\n\t\t/**第1 、5列中奖的银币才飞银币 */\r\n\t\t/**飞完后打开元宝中奖弹框 */\r\n\t\tlet nodes: Node[] = [];\r\n\t\tthis.rollerViewModelArr.forEach(v => {\r\n\t\t\tnodes = nodes.concat(v.comp.getYuanBaoYinBiNode());\r\n\t\t})\r\n\r\n\t\tconst endPos = this.node.parent.getComponent(UITransform).convertToNodeSpaceAR(mainViewModel.getGoodLuckPos());\r\n\r\n\t\tlet count = 0;\r\n\t\t\r\n\t\tnodes.forEach(v => {\r\n\t\t\tconst startPos = this.node.parent.getComponent(UITransform).convertToNodeSpaceAR(v.getWorldPosition());\r\n\t\t\tconst cloneNode = instantiate(v)\r\n\t\t\tthis.node.parent.addChild(cloneNode);\r\n\t\t\tcloneNode.setPosition(startPos)\r\n\t\t\tv.active = false;\r\n\t\t\ttween(cloneNode).to(config.subGameRollOption.beetleFlyTime, { position: endPos }).call(() => {\r\n\t\t\t\tcloneNode.destroy();\r\n\t\t\t\tcount++;\r\n\t\t\t\tif (count >= nodes.length) {\r\n\t\t\t\t\tdone && done();\r\n\t\t\t\t}\r\n\t\t\t}).start()\r\n\t\t})\r\n\r\n\r\n\t}\r\n\r\n\t// /**播放甲壳虫动画，播放完成之后进去切换游戏 */\r\n\t// private playBeetleAnimation(isSubGameLastPoint: boolean, rollerLaunchResult: RollerLaunchResult) {\r\n\t// \tlet count = 0;\r\n\t// \tthis.rollerViewModelArr.forEach(v => {\r\n\t// \t\tv.comp.playBeetleAnimation(() => {\r\n\t// \t\t\tcount++;\r\n\t// \t\t\tif (count >= this.rollerViewModelArr.length) {\r\n\t// \t\t\t\tthis.changeGameHandle(isSubGameLastPoint, rollerLaunchResult);\r\n\t// \t\t\t}\r\n\t// \t\t})\r\n\t// \t})\r\n\t// }\r\n\r\n\t/**播放甲壳虫的飞数字动画 */\r\n\tprivate playBeeteFlyAmount(done) {\r\n\t\tlet nodes: Node[] = [];\r\n\t\tthis.rollerViewModelArr.forEach(v => {\r\n\t\t\tnodes = nodes.concat(v.comp.getBeetleAmountNode());\r\n\t\t})\r\n\r\n\t\tconst endPos = this.node.parent.getComponent(UITransform).convertToNodeSpaceAR(mainViewModel.getGoodLuckPos());\r\n\r\n\t\tlet count = 0;\r\n\t\tnodes.forEach(v => {\r\n\t\t\tconst startPos = this.node.parent.getComponent(UITransform).convertToNodeSpaceAR(v.getWorldPosition());\r\n\t\t\tconst cloneNode = instantiate(v)\r\n\t\t\tthis.node.parent.addChild(cloneNode);\r\n\t\t\tcloneNode.setPosition(startPos)\r\n\t\t\ttween(cloneNode).to(config.subGameRollOption.beetleFlyTime, { position: endPos }).call(() => {\r\n\t\t\t\tcloneNode.destroy();\r\n\t\t\t\tcount++;\r\n\t\t\t\tif (count >= nodes.length) {\r\n\t\t\t\t\tdone && done();\r\n\t\t\t\t}\r\n\t\t\t}).start()\r\n\t\t})\r\n\t}\r\n\r\n\t/**显示wild的动画 */\r\n\tprivate playWildAnimation(done) {\r\n\t\tlet amountNodes: Node[] = [];\r\n\t\tlet nodes: Node[] = [];\r\n\t\tthis.rollerViewModelArr.forEach(v => {\r\n\t\t\tnodes = nodes.concat(v.comp.getWildLiZiNode().nodes);\r\n\t\t\tamountNodes = amountNodes.concat(v.comp.getWildLiZiNode().amountNodes);\r\n\t\t})\r\n\t\t// console.log(\"amountNodes---------\",amountNodes);\r\n\t\t\r\n\t\tif (amountNodes.length > 0) {\r\n\t\t\t\r\n\t\t\tamountNodes.forEach((n, i) => {\r\n\t\t\t\tamountNodes[i].active = true;\r\n\t\t\t\tnodes[i].active = false;\r\n\t\t\t\tamountNodes[i].setSiblingIndex(amountNodes[i].parent.children.length);\r\n\t\t\t\tamountNodes[i].setWorldPosition(amountNodes[i].parent.worldPosition);\r\n\t\t\t\tconst skeleton = n.getComponent(sp.Skeleton);\r\n\t\t\t\tlet count = 0;\r\n\t\t\t\t// const skeletonPlayer = new SkeletonAnimationPlayer(skeleton, \"animation\", true, () => { \r\n\t\t\t\t// \tcount++\r\n\t\t\t\t// \tif (count >= 2) {\r\n\t\t\t\t// \t\tskeletonPlayer.stopAnimation()\r\n\t\t\t\t// \t}\r\n\t\t\t\t// })\r\n\t\t\t\t// skeletonPlayer.playAnimation();\r\n\t\t\t\tif (i === amountNodes.length - 1) {\r\n\t\t\t\t\tthis.scheduleOnce(() => {\r\n\t\t\t\t\t\tthis.playWild2DFlyNum(done)\r\n\t\t\t\t\t},1)\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t})\r\n\t\t} else {\r\n\t\t\tdone && done()\r\n\t\t}\r\n\t\t// return amountNodes\r\n\t}\r\n\t/**播放wild的加次数动画 */\r\n\tprivate playWild2DFlyNum(done) {\r\n\t\tlet nodes: Node[] = [];\r\n\t\tthis.rollerViewModelArr.forEach(v => {\r\n\t\t\tnodes = nodes.concat(v.comp.getWildLiZiNode().nodes);\r\n\t\t})\r\n\t\t// const amountNodes = this.playWildAnimation()\r\n\t\t\r\n\t\tif (nodes.length > 0) {\r\n\t\t\tconst endPos = this.node.getComponent(UITransform).convertToNodeSpaceAR(mainViewModel.getFreeNumPos());\r\n\t\t\tlet count1 = 0;\r\n\t\t\tphoenixV2_Audio.playOneShot(SoundPathDefine.PHOENIX_ADD_NUM)\r\n\t\t\tnodes.forEach((v, i) => {\r\n\t\t\t\tv.active = true;\r\n\t\t\t\tconst startPos = this.node.getComponent(UITransform).convertToNodeSpaceAR(v.getWorldPosition());\r\n\t\t\t\tconst cloneNode = instantiate(v)\r\n\t\t\t\tcloneNode.active = true;\r\n\t\t\t\tthis.node.addChild(cloneNode);\r\n\t\t\t\tcloneNode.setPosition(startPos)\r\n\t\t\t\tv.active = false;\r\n\t\t\t\ttween(cloneNode).delay(0.5).to(config.subGameRollOption.beetleFlyTime, { position: endPos }).call(() => {\r\n\t\t\t\t\tcloneNode.destroy();\r\n\t\t\t\t\tcount1++;\r\n\t\t\t\t\tif (count1 >= nodes.length) {\r\n\t\t\t\t\t\tdone && done();\r\n\t\t\t\t\t}\r\n\t\t\t\t}).start()\r\n\t\t\t})\r\n\t\r\n\t\t} else {\r\n\t\t\tdone && done();\r\n\t\t}\r\n\t}\r\n\r\n\tprivate changeGameHandle(isSubGameLastPoint: boolean, rollerLaunchResult: RollerLaunchResult) {\r\n\t\t// console.log(\"this.props.gameTypeInfo.currGameType\",this.props.gameTypeInfo.currGameType);\r\n\t\t\r\n\t\tif (this.isSubGame(this.props.gameTypeInfo.currGameType)) {\r\n\t\t\tthis.changeToSubGame(this.props.gameTypeInfo.currGameType, isSubGameLastPoint, rollerLaunchResult);\r\n\t\t} else if (this.props.gameTypeInfo.currGameType === GameType.MAIN) {\r\n\t\t\tthis.changeToMainGame(this.props.gameTypeInfo.viewGameType, rollerLaunchResult)\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * 切换到小游戏处理\r\n\t * @param currGameType 当前游戏\r\n\t * @param viewGameCountOver 当前小游戏次数是否结束\r\n\t * @param nextGameType 下一个游戏\r\n\t */\r\n\tprivate changeToSubGame(currGameType: GameType, viewGameCountOver: boolean, rollerLaunchResult: RollerLaunchResult) {\r\n\t\tif (viewGameCountOver) {\r\n\t\t\tthis.changeSubGameToSubGame(currGameType, rollerLaunchResult);\r\n\t\t} else {\r\n\t\t\tthis.rollerViewModelArr.forEach((v, index) => { \r\n\t\t\t\tv.comp.playScatterAnimation()\r\n\t\t\t})\r\n\t\t\tthis.scheduleOnce(() => {\r\n\t\t\t\tmainViewModel.comp.getSlotNode().active = false;\r\n\t\t\t\tmainViewModel.rollerPanelViewModel.viewNode.active = false;\r\n\t\t\t\tmainViewModel.comp.getFreeNumNode().active = false;\r\n\t\t\t\tmainViewModel.showSmallGame(() => {\r\n\t\t\t\t\t// this.dispatch(updateRollerStatus(RollerStatus.END))\r\n\t\t\t\t\t// 播放切换游戏动画\r\n\t\t\t\t\tthis.dispatch(updateSubGameAnimationPlayInfo({\r\n\t\t\t\t\t\tgameType: currGameType,\r\n\t\t\t\t\t\tparam: 0 //开门类型\r\n\t\t\t\t\t}))\r\n\t\t\t\t})\r\n\t\t\t},2)\r\n\t\t\t// // 如果是免费游戏，要接着弹出的免费次数框\r\n\t\t\t// mainViewModel.showDialogWin({\r\n\t\t\t// \tdialogType: DialogType.FREE_GAME_ENTRY,\r\n\t\t\t// \tparams: [rollerLaunchResult.dl.si[0].freeCount],\r\n\t\t\t// }, () => {\r\n\t\t\t// \t// this.dispatch(updateRollerStatus(RollerStatus.END))\r\n\t\t\t// \t// 播放切换游戏动画\r\n\t\t\t// \tthis.dispatch(updateSubGameAnimationPlayInfo({\r\n\t\t\t// \t\tgameType: currGameType,\r\n\t\t\t// \t\tparam: 0 //开门类型\r\n\t\t\t// \t}))\r\n\t\t\t// })\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t/**切换到主游戏的处理 */\r\n\tprivate changeToMainGame(gameType: GameType, rollerLaunchResult: RollerLaunchResult) {\r\n\t\tif (this.isSubGame(gameType)) {\r\n\t\t\t// 弹出结算面板\r\n\t\t\tmainViewModel.showDialogWin({\r\n\t\t\t\tdialogType: DialogType.FREE_GAME_SETTLEMENT,\r\n\t\t\t\tparams: [rollerLaunchResult && rollerLaunchResult.dl.si[0].freeGameAmount],\r\n\t\t\t}, () => {\r\n\t\t\t\t// 播放切换游戏动画\r\n\t\t\t\tthis.dispatch(updateSubGameAnimationPlayInfo({\r\n\t\t\t\t\tgameType: gameType,\r\n\t\t\t\t\tparam: 1 // 关门动画\r\n\t\t\t\t}))\r\n\t\t\t\t// 在切换回主游戏时，改变滚轴的高度\r\n\t\t\t\tthis.changeRollerHeight(GameType.MAIN);\r\n\t\t\t\t// 在开始切回主游戏时，就要把插槽的位置重置，等到gameTypeInfo数据变化时已经晚了，会看到坐标不正确\r\n\t\t\t\tthis.changeGame(GameType.MAIN);\r\n\t\t\t})\r\n\t\t}\r\n\t}\r\n\r\n\t/**切换小游戏到小游戏，弹出结算面板 */\r\n\tprivate changeSubGameToSubGame(gameType: GameType, rollerLaunchResult: RollerLaunchResult) {\r\n\t\t// 弹出结算面板\r\n\t\tmainViewModel.showDialogWin({\r\n\t\t\tdialogType: DialogType.FREE_GAME_SETTLEMENT,\r\n\t\t\tparams: [rollerLaunchResult.dl.si[0].freeGameAmount],\r\n\t\t}, () => {\r\n\t\t\t// 播放切换游戏动画\r\n\t\t\tthis.dispatch(updateSubGameAnimationPlayInfo({\r\n\t\t\t\tgameType: gameType,\r\n\t\t\t\tparam: 1 // 关门动画\r\n\t\t\t}))\r\n\t\t\t// 只有在切回到小游戏1时，才改变滚轴的高度\r\n\t\t\tgameType === GameType.SUBGAME1 && this.changeRollerHeight(gameType);\r\n\t\t\t// 在开始切回主游戏时，就要把插槽的位置重置，等到gameTypeInfo数据变化时已经晚了，会看到坐标不正确\r\n\t\t\tthis.changeGame(gameType);\r\n\t\t})\r\n\t}\r\n\r\n\t/**是否准备切换游戏 */\r\n\tprivate isChangeGame() {\r\n\t\tif (!this.props.gameTypeInfo) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\tif (isSubGameToSubGame(this.props.gameTypeInfo.viewGameType, this.props.gameTypeInfo.currGameType)) {\r\n\t\t\treturn true;\r\n\t\t}\r\n\r\n\t\treturn this.props.gameTypeInfo.viewGameType !== this.props.gameTypeInfo.currGameType;\r\n\t}\r\n\r\n\tprivate isMain() {\r\n\t\treturn this.props.gameTypeInfo.viewGameType === GameType.MAIN;\r\n\t}\r\n\r\n\tprivate isSubGame(gameType: GameType) {\r\n\t\treturn gameType === GameType.SUBGAME1 || gameType === GameType.SUBGAME2\r\n\t}\r\n\r\n\tprivate getBigWinConfig(magnification: number) {\r\n\t\treturn config.winning.find(v => v.minRate <= magnification && magnification <= v.maxRate)\r\n\t}\r\n\r\n\tprivate getIsSpeed() {\r\n\t\tif (this.isSubGame2()) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\tif (this.isManualStop) {\r\n\t\t\treturn true;\r\n\t\t}\r\n\t\treturn this.props.isSpeed;\r\n\t}\r\n\r\n\tprivate stopRoll(i: number, callBack: (rollerLaunchResult: RollerLaunchResult) => void, rollerLaunchResult: RollerLaunchResult) {\r\n\t\t// 这里调停止滚动的速度\r\n\t\tconst time = this.getIsSpeed() ? 0 : 0.2;\r\n\t\tconst isEnd = i >= this.rollerViewModelArr.length - 1;\r\n\t\tconst rollerComp = this.rollerViewModelArr[i];\r\n\t\tthis.rollIndex = i;\r\n\t\t// const stopIconIndex = Math.floor(Math.random() * config.iconRollerQueue[i].length);\r\n\t\t// 获得停下来的数据\r\n\t\tconst stopIconIndex = rollerLaunchResult && rollerLaunchResult.dl.si[0].rollerId[i];\r\n\r\n\t\tconst scatterCount = this.getScatterCount(i, rollerLaunchResult);\r\n\t\t// 下一个列是否有边框\r\n\t\tconst nextColmunIsBorder = this.getScatterCount(i + 1, rollerLaunchResult) >= 2;\r\n\r\n\t\t// console.log(\"scatterCount\", scatterCount, i, stopIconIndex);\r\n\t\t// 是否快速边框，前面出现2个以上的scatter，这个参数才为true\r\n\t\tconst isSpeedBorder = scatterCount >= 2;\r\n\t\trollerComp.comp.stopRoll(stopIconIndex, () => {\r\n\t\t\tif (this.node.isValid) {\r\n\t\t\t\tif (isEnd) {\r\n\t\t\t\t\tcallBack(rollerLaunchResult)\r\n\t\t\t\t} else {\r\n\t\t\t\t\tnextColmunIsBorder && this.stopRoll(i + 1, callBack, rollerLaunchResult)\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}, isSpeedBorder, rollerLaunchResult)\r\n\t\t// 小游戏2滚轴一起停\r\n\t\tif (this.isSubGame2()) {\r\n\t\t\tif (!isEnd) {\r\n\t\t\t\tthis.stopRoll(i + 1, callBack, rollerLaunchResult)\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\t// console.log(\"stoproll time \", i, time)\r\n\t\t\t!nextColmunIsBorder && this.scheduleOnce(() => {\r\n\t\t\t\tif (this.node.isValid) {\r\n\t\t\t\t\tif (!isEnd) {\r\n\t\t\t\t\t\tthis.stopRoll(i + 1, callBack, rollerLaunchResult)\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}, time)\r\n\t\t}\r\n\t}\r\n\r\n\tprivate isSubGame2() {\r\n\t\treturn this.props.gameTypeInfo.viewGameType === GameType.SUBGAME2;\r\n\t}\r\n\tprivate isSubGame1() {\r\n\t\treturn this.props.gameTypeInfo.viewGameType === GameType.SUBGAME1;\r\n\t}\r\n\r\n\t/**获得前面几列的scatter个数 */\r\n\tprivate getScatterCount(endColumnIndex: number, rollerLaunchResult: RollerLaunchResult) {\r\n\t\t// 前两列不计算数量或者小游戏2也不计算\r\n\t\tif (endColumnIndex < 2 || this.isSubGame2()) {\r\n\t\t\treturn 0;\r\n\t\t}\r\n\t\tendColumnIndex = endColumnIndex >= this.rollerViewModelArr.length ? this.rollerViewModelArr.length : endColumnIndex;\r\n\t\tconst rollerId = rollerLaunchResult && rollerLaunchResult.dl.si[0].rollerId;\r\n\t\tlet scatter = 0;\r\n\t\tfor (let i = 0; i < endColumnIndex; i++) {\r\n\t\t\tlet iconIndex = rollerId[i] as number;\r\n\t\t\tconst queue = config.iconRollerQueue[i]\r\n\t\t\tfor (let i = 0; i < config.normalRollOption.showIconCount; i++) {\r\n\t\t\t\tif (queue[iconIndex] === IconId.SCATTER) {\r\n\t\t\t\t\tscatter++;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t\tif (++iconIndex >= queue.length) {\r\n\t\t\t\t\ticonIndex = 0;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn scatter;\r\n\t}\r\n\r\n\t/**\r\n\t * 显示中奖图标\r\n\t * @param linePlayTime \r\n\t * @param done 所有线路播放完之后执行\r\n\t */\r\n\tprivate startPlayWinIcon(linePlayTime: number, done, rollerLaunchResult: RollerLaunchResult) {\r\n\t\tlet winLine = 0;\r\n\t\tif (rollerLaunchResult) {\r\n\t\t\tconst wp = rollerLaunchResult.dl.si[0].winningPosition\r\n\t\t\tconst lines: any[] = [];\r\n\t\t\tfor (const key in wp) {\r\n\t\t\t\tlines.push(key);\r\n\t\t\t}\r\n\r\n\t\t\twinLine = lines.length;\r\n\r\n\t\t\tif (lines.length > 0) {\r\n\t\t\t\tthis.executeWinIcon(-1, lines, wp, linePlayTime, done);\r\n\t\t\t} else {\r\n\t\t\t\tdone();\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn winLine;\r\n\t}\r\n\r\n\t/**\r\n\t * 播放赢的图标\r\n\t * @param index 线的索引\r\n\t * @param lines 中奖线的数组\r\n\t * @param wp 中间对象\r\n\t * @param linePlayTime 播放一条线的时间\r\n\t * @param done\r\n\t * @returns \r\n\t */\r\n\tprivate executeWinIcon(index: number, lines: any[], wp, linePlayTime: number, done) {\r\n\t\tif (!cacheData.rollerLaunchResult) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tif (index >= lines.length) {\r\n\t\t\tindex = -1;\r\n\t\t\tdone && done();\r\n\t\t}\r\n\t\tconst lineNumber = lines[index];\r\n\t\tlet winIconArr = [];\r\n\t\tif (index === -1) {\r\n\t\t\tif (this.isSubGame1()) {\r\n\t\t\t\tlinePlayTime = 4;\r\n\t\t\t} else {\r\n\t\t\t\tlinePlayTime = 2;\r\n\t\t\t}\r\n\t\t\tfor (const key in wp) {\r\n\t\t\t\twinIconArr = winIconArr.concat(wp[key])\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\twinIconArr = winIconArr.concat(wp[lineNumber])\r\n\t\t\t// 一条线中了几个图标就播放多少秒\r\n\t\t\tlinePlayTime = winIconArr.length;\r\n\t\t}\r\n\t\tthis.rollerViewModelArr.forEach(v => v.comp.pauseWinIcon())\r\n\t\twinIconArr.forEach(v => {\r\n\t\t\tconst columnIndex = v[0];\r\n\t\t\tconst iconIndex = v[1];\r\n\t\t\tthis.rollerViewModelArr[columnIndex].comp.playWinIcon(iconIndex);\r\n\t\t})\r\n\t\tconst magnification = cacheData.rollerLaunchResult && cacheData.rollerLaunchResult.dl.si[0].otherGameAttributesVo.phoenixMagnification;\r\n\t\tconst labelNode = mainViewModel.comp.getSmallMultipleNode();\r\n\t\tlabelNode.active = magnification > 0 && this.isSubGame1();\r\n\t\t// console.log(\"!this.isShowMultip\",!this.isShowMultip,magnification > 0,this.isSubGame1());\r\n\t\t\r\n\t\tlabelNode.getComponent(Label).string = \"X\" + magnification; \r\n\t\tif (!this.isShowMultip && this.isSubGame1() && magnification > 0) {\r\n\t\t\ttween(labelNode).to(0.5, { scale: new Vec3(1.5, 1.5) }).to(0.5, { scale: new Vec3(1, 1) }).call(() => {\r\n\t\t\t\tthis.isShowMultip = true;\r\n\t\t\t}).start()\r\n\t\t}\r\n\r\n\t\tif (this.isMain()) {\r\n\t\t\tthis.scheduleOnce(() => {\r\n\t\t\t\tthis.executeWinIcon(++index, lines, wp, linePlayTime, done);\r\n\t\t\t}, linePlayTime);\r\n\t\t} else {\r\n\t\t\tthis.scheduleOnce(() => {\r\n\t\t\t\tthis.executeWinIcon(-1, lines, wp, linePlayTime, done);\r\n\t\t\t}, linePlayTime);\r\n\t\t}\r\n\t}\r\n\r\n\t/**播放元宝出现 及特殊（1 、5列）中奖动画 */\r\n\tprivate showYuanBaoIcon(linePlayTime: number, done, rollerLaunchResult: RollerLaunchResult) {\r\n\t\tlet winLine = 0;\r\n\t\tconst showYuanBao = rollerLaunchResult.dl.si[0].otherGameAttributesVo.yuanBaoSpecialEffect;//是否有特殊位置（1 、5列）元宝中奖\r\n\t\tconst yuanBaoWp = rollerLaunchResult.dl.si[0].otherGameAttributesVo.yuanBaoPosition;\r\n\r\n\t\tconst lines: any[] = [];\r\n\t\tif (showYuanBao) {\r\n\t\t\tfor (const key in yuanBaoWp) {\r\n\t\t\t\tlines.push(key);\r\n\t\t\t}\r\n\t\t\twinLine = lines.length;\r\n\t\t\tthis.executeYuanBaoWinIcon(0, lines, yuanBaoWp, linePlayTime, done);\r\n\t\t} else {\r\n\t\t\tdone()\r\n\t\t}\r\n\t\treturn winLine;\r\n\t\t\r\n\t}\r\n\r\n\t/**\r\n\t * 播放赢的图标\r\n\t * @param index 线的索引\r\n\t * @param lines 中奖线的数组\r\n\t * @param wp 中间对象\r\n\t * @param linePlayTime 播放一条线的时间\r\n\t * @param done\r\n\t * @returns \r\n\t */\r\n\tprivate executeYuanBaoWinIcon(index: number, lines: any[], wp, linePlayTime: number, done) {\r\n\t\tif (!cacheData.rollerLaunchResult) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tif (index >= lines.length) {\r\n\t\t\tindex = -1;\r\n\t\t\tdone && done();\r\n\t\t}\r\n\t\tlet winIconArr = [];\r\n\t\tif (index === -1) {\r\n\t\t\tlinePlayTime = 2;\r\n\t\t\twinIconArr = wp\r\n\t\t} else {\r\n\t\t\twinIconArr = wp\r\n\t\t\t// 一条线中了几个图标就播放多少秒\r\n\t\t\tlinePlayTime = wp.length;\r\n\t\t}\r\n\t\t// this.rollerViewModelArr.forEach(v => v.comp.pauseWinIcon())\r\n\t\t\r\n\t\twinIconArr.forEach(v => {\r\n\t\t\tconst columnIndex = v[0];\r\n\t\t\tconst iconIndex = v[1];\r\n\t\t\tthis.rollerViewModelArr[columnIndex].comp.playYuanBaoWinIcon(iconIndex);\r\n\t\t})\r\n\r\n\t\t// this.scheduleOnce(() => {\r\n\t\t// \tthis.executeYuanBaoWinIcon(++index, lines, wp, linePlayTime, done);\r\n\t\t// }, linePlayTime);\r\n\t}\r\n\r\n\tprotected bindEvent(): void {\r\n\t}\r\n\r\n\tprotected useProps(key: keyof IProps, value: { pre: any, cur: any }) {\r\n\t\tif (this.node && this.node.isValid) {\r\n\t\t\tif (key === 'rollerStatus') {\r\n\t\t\t\tif (RollerStatus.RUNNING === value.cur) {\r\n\t\t\t\t\tthis.startRoll();\r\n\t\t\t\t} else if (RollerStatus.ENDING === value.cur) {\r\n\t\t\t\t\tthis.stopRollAll(true, this.sendBetTime, cacheData.rollerLaunchResult);\r\n\t\t\t\t}\r\n\t\t\t} else if (key === 'gameTypeInfo') {\r\n\t\t\t\tthis.changeGame(this.props.gameTypeInfo.viewGameType);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tprivate changeGame(gameType: GameType) {\r\n\t\tconst columnListLayout = this.propertyNode.props_column_list.getComponent(Layout);\r\n\t\tconst isSubGame2 = gameType === GameType.SUBGAME2;\r\n\t\tconst isSubGame1 = gameType === GameType.SUBGAME1;\r\n\t\tconst isMain = gameType === GameType.MAIN;\r\n\t\tif (isMain || isSubGame2) {\r\n\t\t\tthis.node.position = new Vec3(config.normalRollOption.rollerWindowX, config.normalRollOption.rollerWindowY);\r\n\t\t\tcolumnListLayout.spacingX = config.normalRollOption.columnInterval;\r\n\t\t} else {\r\n\t\t\tthis.node.position = new Vec3(config.subGameRollOption.rollerWindowX, config.subGameRollOption.rollerWindowY);\r\n\t\t\tcolumnListLayout.spacingX = config.subGameRollOption.columnInterval;\r\n\r\n\t\t\tthis.changeRollerHeight(gameType);\r\n\t\t}\r\n\r\n\t\tif (isMain || isSubGame1) {\r\n\t\t\tthis.rollerViewModelArr.forEach(v => v.comp.replaceMultiRollerIcon());\r\n\t\t}\r\n\t}\r\n\r\n\t/**改变滚轴的高度 */\r\n\tprivate changeRollerHeight(gameType: GameType) {\r\n\t\tlet rollerHeight = config.normalRollOption.rollerHeight\r\n\t\tif (gameType === GameType.SUBGAME2) {\r\n\t\t\trollerHeight = config.subGameRollOption.rollerHeight2;\r\n\t\t} else if (gameType === GameType.SUBGAME1) {\r\n\t\t\trollerHeight = config.subGameRollOption.rollerHeight1;\r\n\t\t}\r\n\t\tthis.node.getComponent(UITransform).height = rollerHeight;\r\n\r\n\t\tthis.rollerViewModelArr.forEach(v => v.comp.resetIconPos(gameType));\r\n\t}\r\n\r\n\tprotected bindUI(): void {\r\n\t\tthis.propertyNode.props_column_list.removeAllChildren();\r\n\r\n\t\tthis.initRoller();\r\n\t}\r\n\r\n\tupdate(deltaTime: number) {\r\n\t\tif (this.isWaitEnding && cacheData.rollerLaunchResult) {\r\n\t\t\tthis.isWaitEnding = false;\r\n\t\t\tthis.node.isValid && this.stopRollAll(false, this.sendBetTime, cacheData.rollerLaunchResult);\r\n\t\t}\r\n\t}\r\n}\r\n\r\n"]}