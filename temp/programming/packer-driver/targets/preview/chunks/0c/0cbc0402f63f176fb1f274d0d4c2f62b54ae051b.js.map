{"version":3,"sources":["file:///Users/geliang/web/dibai/hall/assets/script/subGame/dragon/Slot/Component/dragon_SlotBg.ts"],"names":["_decorator","Button","Animation","AudioSource","Label","Node","Prefab","Sprite","SpriteFrame","UIOpacity","BaseComponent","global","NumberRoller","AudioManager","SoundList","SceneBgMusic","BuyType","ccclass","property","dragon_SlotBg","GoldNumberRoller","timeAccumulator","autoLaunchState","start","bindUI","topButton","on","EventType","TOUCH_END","getInstance","playSound","buttonClick","openShop","beliButton","speclalButton","TAS","settingButton","openPersonCenter","audio","node","addComponent","setAudioSource","playMusic","mainBg","bindEvent","updateBetAmount","baseBetAmount","lineCount","betAmount","numberStr","formatAmountWithCommas","getComponent","string","updateScore","score","_nodes","active","setBtnState","state","type","num","console","log","setBtnLabel","str","toString","setBg","bgName","spriteFrame","Balance_tips","bl","spr_nomoney","setGold","label","startNumberMini","parseInt","replace","Number","labelStr","Math","abs","String","toFixed","animation","play","startRolling","triggeAutoLaunch","autoLaunch","setActiveButton","autoLaunchType","children","forEach","child","index","opacity","setDis_btn","disable","grayscale","setGreyOut","setDisable","button","startButton","sprite","update","deltaTime","updateTheMusicStatus"],"mappings":"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","sourcesContent":["import { _decorator, Button, find, Animation, AudioSource, instantiate, Label, Layers, Material, MeshRenderer, Node, Prefab, sp, Sprite, SpriteFrame, SpriteRenderer, tween, UIOpacity, UITransform, Vec3 } from 'cc';\r\nimport BaseComponent from './BaseComponent';\r\nimport { CommandDefine } from '../Const/CommandDefine';\r\nimport { RollerMediatorConst } from '../Mediator/RollerMediator';\r\nimport { bindClickEvent } from '../utils';\r\nimport { AutoLaunchType } from '../Repositories/BgRepository';\r\nimport { global } from '../../../../hall';\r\nimport { NumberRoller } from \"../utils/NumberRoller\";\r\nimport { AudioManager, SoundList, SceneBgMusic } from \"../Managr/AudioManager\";\r\nimport { BuyType } from '../../../../hall/components/Hall_ShopPanel';\r\nconst { ccclass, property } = _decorator;\r\n\r\n@ccclass('dragon_SlotBg')\r\nexport class dragon_SlotBg extends BaseComponent {\r\n\r\n\t//返回首页\r\n\t@property(Node)\r\n\thomeButton: Node = null\r\n\r\n\t//充值按钮\r\n\t@property(Node)\r\n\ttopButton: Node = null\r\n\r\n\t//商城\r\n\t@property(Node)\r\n\tbeliButton: Node = null\r\n\r\n\t//礼包\r\n\t@property(Node)\r\n\tspeclalButton: Node = null\r\n\r\n\t//设置\r\n\t@property(Node)\r\n\tsettingButton: Node = null\r\n\r\n\t@property(Node)\r\n\tstartButton: Node = null\r\n\r\n\t@property(Node)\r\n\tbaseBet: Node = null\r\n\r\n\t@property(Node)\r\n\tbetAmount: Node = null\r\n\r\n\t@property(Node)\r\n\tlineCount: Node = null\r\n\r\n\t@property(Node)\r\n\tscore: Node = null\r\n\r\n\t@property(Node)\r\n\r\n\tspr_nomoney: Node = null\r\n\r\n\t@property(Node)\r\n\taddShift: Node = null\r\n\r\n\t@property(Node)\r\n\tsubtractShift: Node = null\r\n\r\n\t@property(Node)\r\n\tautoLaunch: Node = null\r\n\r\n\t@property(Node)\r\n\truleButton: Node = null\r\n\r\n\t@property(SpriteFrame)\r\n\tbg_1: SpriteFrame = null\r\n\r\n\t@property(SpriteFrame)\r\n\tbg_2: SpriteFrame = null\r\n\t@property(Node)\r\n\tgameArea: Node = null\r\n\r\n\t@property(Node)\r\n\taddBet: Node = null\r\n\r\n\t@property(Node)\r\n\tsubtractBet: Node = null\r\n\r\n\t@property(Node)\r\n\tmaxBet: Node = null\r\n\t@property(Prefab)\r\n\ttoast: Prefab = null\r\n\t@property(Node)\r\n\tpropsToggleFast: Node = null\r\n\tprivate GoldNumberRoller: NumberRoller = new NumberRoller();\r\n\tprivate timeAccumulator: number = 0\r\n\t// @property(sp.SkeletonData)\r\n\t// flyingCrane: sp.SkeletonData = null\r\n\tautoLaunchState=false\r\n\tstart() {\r\n\r\n\t}\r\n\r\n\r\n\r\n\tprotected bindUI(): void {\r\n\t\t// this.autoLaunch.children.forEach(child => {\r\n\t\t// \tchild.on(Node.EventType.TOUCH_START, ({ target }) => {\r\n\t\t// \t\t(target as Node).getComponent(UIOpacity).opacity = 0\r\n\t\t// \t})\r\n\t\t// \tchild.on(Node.EventType.TOUCH_END, ({ target }) => {\r\n\t\t// \t\ttween(target.getComponent(UIOpacity)).to(0.2, { opacity: 255 }).start();\r\n\t\t// \t})\r\n\t\t// })\r\n\t\t// const flyCrane = this.startFlyingCrane()\r\n\t\t// flyCrane.setScale(new Vec3(-1, 1, 1))\r\n\t\t// this.scheduleOnce(() => {\r\n\t\t// \tthis.startFlyingCrane()\r\n\t\t// }, 3)\r\n\r\n\r\n\t\t// 点击充值按钮\r\n\t\tthis.topButton.on(Node.EventType.TOUCH_END, () => {\r\n\t\t\tAudioManager.getInstance().playSound(SoundList.buttonClick);\r\n\t\t\tglobal.openShop()\r\n\t\t})\r\n\t\t// 点击商城按钮\r\n\t\tthis.beliButton.on(Node.EventType.TOUCH_END, () => {\r\n\t\t\tAudioManager.getInstance().playSound(SoundList.buttonClick);\r\n\t\t\tglobal.openShop()\r\n\t\t})\r\n\t\t// 点击礼包按钮\r\n\t\tthis.speclalButton.on(Node.EventType.TOUCH_END, () => {\r\n\t\t\tAudioManager.getInstance().playSound(SoundList.buttonClick);\r\n\t\t\tglobal.openShop(BuyType.TAS)\r\n\t\t})\r\n\t\t// 点击设置按钮\r\n\t\tthis.settingButton.on(Node.EventType.TOUCH_END, () => {\r\n\t\t\tAudioManager.getInstance().playSound(SoundList.buttonClick);\r\n\t\t\tglobal.openPersonCenter(2)\r\n\t\t})\r\n\t\tlet audio: any = this.node.addComponent(AudioSource);\r\n\t\tAudioManager.getInstance().setAudioSource(audio);\r\n\t\tAudioManager.getInstance().playMusic(SceneBgMusic.mainBg, true);\r\n\t}\r\n\r\n\tprotected bindEvent(): void {\r\n\t\t// bindClickEvent(this.startButton, () => { })\r\n\t}\r\n\r\n\t/**更新下注金额 */\r\n\tpublic updateBetAmount(baseBetAmount: number, lineCount: number): void {\r\n\t\tconst betAmount = baseBetAmount * lineCount\r\n\t\tlet numberStr: string = betAmount.formatAmountWithCommas()\r\n\t\t// if (betAmount > 1000 * 100) {\r\n\t\t// \t//显示K\r\n\t\t// } else if (betAmount > 10000 * 100) {\r\n\t\t// \t//显示M\r\n\t\t// } else {\r\n\t\t// \t//转为科学计数法\r\n\t\t// \tnumberStr = betAmount.formatAmountWithCommas()\r\n\t\t// }\r\n\t\tthis.lineCount.getComponent(Label).string = `${lineCount} × ${baseBetAmount}`;\r\n\t\tthis.betAmount.getComponent(Label).string = betAmount + ''//numberStr\r\n\t}\r\n\r\n\t/**更新积分 */\r\n\tpublic updateScore(score: number): void {\r\n\t\tif (score == 0) {\r\n\t\t\tthis._nodes['goodluck'].active = true\r\n\t\t\tthis._nodes['bottom_score'].active = false\r\n\t\t} else {\r\n\t\t\tthis._nodes['goodluck'].active = false\r\n\t\t\tthis._nodes['bottom_score'].active = true\r\n\t\t\tthis.score.getComponent(Label).string = score + \"\"\r\n\t\t}\r\n\t}\r\n\t/**更新按钮状态 */\r\n\tpublic setBtnState(state, type = 0, num?) {\r\n\t\tif (type == 0) { // 主游戏按钮\r\n\t\t\tthis._nodes['STARTBG'].active = state\r\n\t\t\tthis._nodes['scrollingThePicture'].active = !state\r\n\t\t\tthis._nodes['START'].active = false\r\n\t\t\tthis._nodes['AUTO'].active = false\r\n\t\t} else if (type == 1) { // 小游戏按钮\r\n\t\t\tthis._nodes['STARTBG'].active = false\r\n\t\t\tthis._nodes['scrollingThePicture'].active = false\r\n\t\t\tthis._nodes['START'].active = true\r\n\t\t\tthis._nodes['AUTO'].active = false\r\n\t\t} else { // 自动按钮\r\n\t\t\tthis._nodes['scrollingThePicture'].active = false\r\n\t\t\tthis._nodes['START'].active = false\r\n\t\t\tthis._nodes['STARTBG'].active = false\r\n\t\t\tthis._nodes['AUTO'].active = true\r\n\t\t\tconsole.log(num);\r\n\t\t\tthis._nodes['AUTO'].getComponent(Label).string = num\r\n\t\t}\r\n\t}\r\n\tpublic setBtnLabel(str) {\r\n\t\tthis._nodes['START'].getComponent(Label).string = str > 0 ? str.toString() : '0'\r\n\t}\r\n\t/**设置背景图片 */\r\n\tpublic setBg(bgName: 'bg_1' | 'bg_2') {\r\n\t\tthis.node.getComponent(Sprite).spriteFrame = this[bgName]\r\n\t}\r\n\tpublic Balance_tips(bl) {\r\n\t\tthis.spr_nomoney.active = bl\r\n\t}\r\n\t// 更新金币数量\r\n\tpublic setGold(str) {\r\n\t\tlet label = this._nodes['MoenyLabel'].getComponent(Label)\r\n\t\tlet startNumberMini = parseInt(label.string.replace(/,/g, \"\"));\r\n\t\tif (startNumberMini != Number(str)) {\r\n\t\t\tthis._nodes['number2'].active = true\r\n\t\t\t// 漂浮效果\r\n\t\t\tlet labelStr = ''\r\n\t\t\tif (startNumberMini - Number(str) < 0) {\r\n\t\t\t\tlabelStr = '+' + Math.abs(startNumberMini - Number(str))\r\n\t\t\t} else {\r\n\t\t\t\tlabelStr = '-' + (startNumberMini - Number(str))\r\n\t\t\t}\r\n\t\t\tthis._nodes['number2'].getComponent(Label).string = String(Number(labelStr).toFixed(0))\r\n\t\t\tlet animation: Animation = this._nodes['number2'].getComponent(Animation)\r\n\t\t\tanimation.play();\r\n\t\t\t// 动画播放\r\n\t\t\tthis.GoldNumberRoller.startRolling(startNumberMini, str.toFixed(0), 500, label)\r\n\t\t}\r\n\t}\r\n\t/**展示自动启动按钮组面板 */\r\n\tpublic triggeAutoLaunch(state?) {\r\n\t\tif(state===false){\r\n\t\t\tif(this.autoLaunchState){\r\n\t\t\t\tthis.autoLaunch.getComponent(Animation).play('animation_autoLauncher_down')\r\n\t\t\t\tthis.autoLaunchState=false\r\n\t\t\t}\r\n\t\t\treturn\r\n\t\t}else{\r\n\t\t\tthis.autoLaunchState=!this.autoLaunchState\r\n\t\t\tif(this.autoLaunchState){\r\n\t\t\t\tthis.autoLaunch.getComponent(Animation).play('animation_autoLauncher_up')\r\n\t\t\t}else{\r\n\t\t\t\tthis.autoLaunch.getComponent(Animation).play('animation_autoLauncher_down')\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t/**自动按钮设置为激活状态 */\r\n\tpublic setActiveButton(autoLaunchType: AutoLaunchType) {\r\n\t\tthis.autoLaunch.children.forEach((child, index) => {\r\n\t\t\tif (index === autoLaunchType) {\r\n\t\t\t\tchild.getComponent(UIOpacity).opacity = 60\r\n\t\t\t} else {\r\n\t\t\t\tchild.getComponent(UIOpacity).opacity = 255\r\n\t\t\t}\r\n\t\t})\r\n\r\n\t\tif(this.autoLaunchState){\r\n\t\t\tthis.autoLaunch.getComponent(Animation).play('animation_autoLauncher_down')\r\n\t\t\tthis.autoLaunchState=false\r\n\t\t}\r\n\t\t\r\n\t}\r\n\t// 设置小游戏按钮置灰\r\n\tsetDis_btn(disable: boolean) {\r\n\t\tthis._nodes['SZX_-'].getComponent(Sprite).grayscale = disable\r\n\t\tthis._nodes['SZX_+'].getComponent(Sprite).grayscale = disable\r\n\t\tthis._nodes['maxBet'].getComponent(Sprite).grayscale = disable\r\n\t}\r\n\tsetGreyOut(str,disable){\r\n        this._nodes[str].getComponent(Sprite).grayscale = disable\r\n    }\r\n\t/**设置面板按钮可用性 */\r\n\tsetDisable(disable: boolean) {\r\n\t\t// const op = this.startButton.getComponent(UIOpacity)\r\n\t\t// op.opacity = disable ? 100 : 255\r\n\t\tconst button = this.startButton.getComponent(Button); // 获取节点的 Sprite 组件\r\n\t\t// button.interactable = disable\r\n\t\tconst sprite = this.startButton.getComponent(Sprite);\r\n\t\tsprite.grayscale = disable\r\n\t\t// const material = Material.getBuiltinMaterial(Material.BUILTIN_NAME.GRAY_SPRITE); // 获取置灰材质\r\n\t\t// const material = Material.getInstantiatedBuiltinMaterial(Material.BUILTIN_NAME.GRAY_SPRITE);\r\n\t\t// node.setMaterial(material, 0);\r\n\r\n\t\t// const mat = new Material();\r\n\t\t// mat.initialize({\r\n\t\t// \t// 通过 effect 名指定材质使用的着色器资源\r\n\t\t// \teffectAsset: 'pipeline/skybox',\r\n\t\t// \tdefines: {\r\n\t\t// \t\tUSE_RGBE_CUBEMAP: true\r\n\t\t// \t}\r\n\t\t// })\r\n\t\t// this.node.getComponent(Sprite).setMaterial(Material.getBuiltinMaterial(Material.BUILTIN_NAME.GRAY_SPRITE + ''), 0);\r\n\t}\r\n\tupdate(deltaTime: number) {\r\n\t\tthis.timeAccumulator += deltaTime;\r\n\t\tif (this.timeAccumulator >= 3) {\r\n\t\t\tthis.timeAccumulator = 0;\r\n\t\t\tAudioManager.getInstance().updateTheMusicStatus()\r\n\t\t}\r\n\t\tthis.GoldNumberRoller.update(deltaTime); // 手动触发滚动逻辑\r\n\t}\r\n}\r\n\r\n"]}